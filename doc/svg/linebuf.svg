<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="7634pt" height="1662pt"
 viewBox="0.00 0.00 7633.80 1662.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1658.0022)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1658.0022 7629.7972,-1658.0022 7629.7972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1308.5" cy="-1636.0022" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1308.5" y="-1631.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 176</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1308.5" cy="-1564.0022" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1308.5" y="-1559.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;47</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1308.5,-1617.8335C1308.5,-1610.1331 1308.5,-1600.9765 1308.5,-1592.4188"/>
<polygon fill="#000000" stroke="#000000" points="1312.0001,-1592.4154 1308.5,-1582.4155 1305.0001,-1592.4155 1312.0001,-1592.4154"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="124.5" cy="-1492.0022" rx="51.319" ry="18"/>
<text text-anchor="middle" x="124.5" y="-1487.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Linebuf</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1247.8483,-1562.3457C1087.8239,-1557.6506 641.0395,-1542.4411 270.5,-1510.0022 241.3979,-1507.4544 209.1538,-1503.5898 182.3857,-1500.0937"/>
<polygon fill="#000000" stroke="#000000" points="182.7852,-1496.6161 172.4127,-1498.7753 181.8677,-1503.5557 182.7852,-1496.6161"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="311.5" cy="-1492.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="311.5" y="-1487.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1249.1189,-1559.7139C1065.9408,-1546.4854 512.505,-1506.5181 354.2138,-1495.0868"/>
<polygon fill="#000000" stroke="#000000" points="354.1639,-1491.5742 343.9377,-1494.3447 353.6596,-1498.556 354.1639,-1491.5742"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1056.5" cy="-1492.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1056.5" y="-1487.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1264.6049,-1551.4607C1216.7535,-1537.7889 1140.9188,-1516.1219 1095.2127,-1503.063"/>
<polygon fill="#000000" stroke="#000000" points="1095.9614,-1499.6369 1085.3846,-1500.2549 1094.0383,-1506.3675 1095.9614,-1499.6369"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1374.5" cy="-1492.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1374.5" y="-1487.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1324.4768,-1546.573C1332.9056,-1537.3779 1343.3747,-1525.957 1352.5539,-1515.9434"/>
<polygon fill="#000000" stroke="#000000" points="1355.3979,-1518.0205 1359.5751,-1508.2839 1350.2378,-1513.2904 1355.3979,-1518.0205"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2438.5" cy="-1492.0022" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2438.5" y="-1487.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 12&#45;47</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1368.0587,-1560.2073C1558.8475,-1548.0508 2154.6195,-1510.0901 2364.4601,-1496.7198"/>
<polygon fill="#000000" stroke="#000000" points="2364.6987,-1500.2118 2374.4558,-1496.0829 2364.2535,-1493.2259 2364.6987,-1500.2118"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="4265.5" cy="-1492.0022" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="4265.5" y="-1487.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 48&#45;58</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.2443,-1562.5231C1746.9023,-1553.3275 3771.0952,-1504.0404 4189.7101,-1493.8476"/>
<polygon fill="#000000" stroke="#000000" points="4189.9707,-1497.3424 4199.8825,-1493.5999 4189.8002,-1490.3445 4189.9707,-1497.3424"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="79,-1438.0022 0,-1438.0022 0,-1402.0022 79,-1402.0022 79,-1438.0022"/>
<text text-anchor="middle" x="39.5" y="-1416.5022" font-family="Inconsolata" font-size="14.00" fill="#000000">* Linebuf</text>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M104.7856,-1475.303C94.1066,-1466.2572 80.7025,-1454.9031 68.8228,-1444.8404"/>
<polygon fill="#000000" stroke="#000000" points="70.7869,-1441.9172 60.8942,-1438.1243 66.2625,-1447.2585 70.7869,-1441.9172"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="124.5" cy="-1420.0022" rx="27" ry="18"/>
<text text-anchor="middle" x="124.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M283.2815,-1483.0393C252.6521,-1473.0507 202.4919,-1455.9318 160.5,-1438.0022 158.7167,-1437.2407 156.8969,-1436.4329 155.0697,-1435.5976"/>
<polygon fill="#000000" stroke="#000000" points="156.5375,-1432.42 146.004,-1431.2807 153.528,-1438.7401 156.5375,-1432.42"/>
</g>
<!-- prespace_10 -->
<g id="node11" class="node">
<title>prespace_10</title>
<ellipse fill="none" stroke="#000000" cx="215.5" cy="-1420.0022" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="215.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_3&#45;&gt;prespace_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;prespace_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.073,-1477.4319C278.5746,-1467.3081 260.3362,-1453.6294 245.0453,-1442.1612"/>
<polygon fill="#000000" stroke="#000000" points="247.0024,-1439.254 236.9024,-1436.054 242.8024,-1444.854 247.0024,-1439.254"/>
</g>
<!-- literal_11 -->
<g id="node12" class="node">
<title>literal_11</title>
<ellipse fill="none" stroke="#000000" cx="311.5" cy="-1420.0022" rx="31.481" ry="18"/>
<text text-anchor="middle" x="311.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_3&#45;&gt;literal_11 -->
<g id="edge11" class="edge">
<title>prose_3&#45;&gt;literal_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M311.5,-1473.8335C311.5,-1466.1331 311.5,-1456.9765 311.5,-1448.4188"/>
<polygon fill="#000000" stroke="#000000" points="315.0001,-1448.4154 311.5,-1438.4155 308.0001,-1448.4155 315.0001,-1448.4154"/>
</g>
<!-- raw_12 -->
<g id="node13" class="node">
<title>raw_12</title>
<ellipse fill="none" stroke="#000000" cx="424.5" cy="-1420.0022" rx="27" ry="18"/>
<text text-anchor="middle" x="424.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_12 -->
<g id="edge12" class="edge">
<title>prose_3&#45;&gt;raw_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.7544,-1478.4595C350.7174,-1467.0141 376.5942,-1450.5263 396.2896,-1437.977"/>
<polygon fill="#000000" stroke="#000000" points="398.3004,-1440.8459 404.8532,-1432.5205 394.5389,-1434.9424 398.3004,-1440.8459"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="990.5" cy="-1420.0022" rx="27" ry="18"/>
<text text-anchor="middle" x="990.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_4&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1041.5236,-1475.6643C1032.7951,-1466.1423 1021.6398,-1453.9729 1011.9871,-1443.4427"/>
<polygon fill="#000000" stroke="#000000" points="1014.3009,-1440.7872 1004.9636,-1435.7806 1009.1408,-1445.5172 1014.3009,-1440.7872"/>
</g>
<!-- prespace_19 -->
<g id="node20" class="node">
<title>prespace_19</title>
<ellipse fill="none" stroke="#000000" cx="1190.5" cy="-1420.0022" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="1190.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_5&#45;&gt;prespace_19 -->
<g id="edge19" class="edge">
<title>prose_5&#45;&gt;prespace_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1347.7448,-1481.5328C1317.6798,-1469.7682 1268.4621,-1450.5091 1233.0942,-1436.6695"/>
<polygon fill="#000000" stroke="#000000" points="1234.1012,-1433.3051 1223.5133,-1432.9204 1231.5503,-1439.8239 1234.1012,-1433.3051"/>
</g>
<!-- literal_20 -->
<g id="node21" class="node">
<title>literal_20</title>
<ellipse fill="none" stroke="#000000" cx="1294.5" cy="-1420.0022" rx="31.481" ry="18"/>
<text text-anchor="middle" x="1294.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_5&#45;&gt;literal_20 -->
<g id="edge20" class="edge">
<title>prose_5&#45;&gt;literal_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1357.1412,-1476.3793C1346.0583,-1466.4046 1331.5177,-1453.3181 1319.2358,-1442.2644"/>
<polygon fill="#000000" stroke="#000000" points="1321.3245,-1439.4354 1311.5501,-1435.3473 1316.6417,-1444.6385 1321.3245,-1439.4354"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1374.5" cy="-1420.0022" rx="27" ry="18"/>
<text text-anchor="middle" x="1374.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_5&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1374.5,-1473.8335C1374.5,-1466.1331 1374.5,-1456.9765 1374.5,-1448.4188"/>
<polygon fill="#000000" stroke="#000000" points="1378.0001,-1448.4154 1374.5,-1438.4155 1371.0001,-1448.4155 1378.0001,-1448.4154"/>
</g>
<!-- prespace_22 -->
<g id="node23" class="node">
<title>prespace_22</title>
<ellipse fill="none" stroke="#000000" cx="1465.5" cy="-1420.0022" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="1465.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_5&#45;&gt;prespace_22 -->
<g id="edge22" class="edge">
<title>prose_5&#45;&gt;prespace_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1393.3553,-1477.0837C1405.8886,-1467.1673 1422.5865,-1453.9557 1436.7614,-1442.7404"/>
<polygon fill="#000000" stroke="#000000" points="1439.0948,-1445.3573 1444.7653,-1436.4077 1434.7514,-1439.8677 1439.0948,-1445.3573"/>
</g>
<!-- literal_23 -->
<g id="node24" class="node">
<title>literal_23</title>
<ellipse fill="none" stroke="#000000" cx="1561.5" cy="-1420.0022" rx="31.481" ry="18"/>
<text text-anchor="middle" x="1561.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_5&#45;&gt;literal_23 -->
<g id="edge23" class="edge">
<title>prose_5&#45;&gt;literal_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1401.863,-1482.4298C1431.3398,-1471.9908 1479.531,-1454.5548 1520.5,-1438.0022 1522.8335,-1437.0594 1525.2325,-1436.0672 1527.6432,-1435.0531"/>
<polygon fill="#000000" stroke="#000000" points="1529.0721,-1438.2487 1536.8845,-1431.092 1526.3143,-1431.8148 1529.0721,-1438.2487"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1698.5" cy="-1420.0022" rx="27" ry="18"/>
<text text-anchor="middle" x="1698.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_5&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1404.6902,-1485.2933C1464.6612,-1471.9664 1598.5385,-1442.2158 1662.7736,-1427.9414"/>
<polygon fill="#000000" stroke="#000000" points="1663.8267,-1431.2928 1672.8293,-1425.7068 1662.3081,-1424.4595 1663.8267,-1431.2928"/>
</g>
<!-- header_31 -->
<g id="node32" class="node">
<title>header_31</title>
<ellipse fill="none" stroke="#000000" cx="2020.5" cy="-1420.0022" rx="78.8574" ry="18"/>
<text text-anchor="middle" x="2020.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Instance fields</text>
</g>
<!-- section_6&#45;&gt;header_31 -->
<g id="edge31" class="edge">
<title>section_6&#45;&gt;header_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2382.5604,-1482.3667C2308.0293,-1469.5288 2176.0128,-1446.7891 2093.6539,-1432.6029"/>
<polygon fill="#000000" stroke="#000000" points="2094.0645,-1429.1221 2083.6155,-1430.8738 2092.8762,-1436.0205 2094.0645,-1429.1221"/>
</g>
<!-- prose_32 -->
<g id="node33" class="node">
<title>prose_32</title>
<ellipse fill="none" stroke="#000000" cx="2226.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2226.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_32 -->
<g id="edge32" class="edge">
<title>section_6&#45;&gt;prose_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2397.121,-1477.9489C2358.4057,-1464.8004 2301.0926,-1445.3355 2263.7679,-1432.6592"/>
<polygon fill="#000000" stroke="#000000" points="2264.8624,-1429.3346 2254.268,-1429.4328 2262.6113,-1435.9628 2264.8624,-1429.3346"/>
</g>
<!-- prose_33 -->
<g id="node34" class="node">
<title>prose_33</title>
<ellipse fill="none" stroke="#000000" cx="2346.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2346.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_33 -->
<g id="edge33" class="edge">
<title>section_6&#45;&gt;prose_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2416.6973,-1474.9392C2403.7603,-1464.8146 2387.2538,-1451.8964 2373.4978,-1441.1309"/>
<polygon fill="#000000" stroke="#000000" points="2375.377,-1438.1571 2365.3448,-1434.7503 2371.0628,-1443.6697 2375.377,-1438.1571"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="2438.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2438.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_6&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2438.5,-1473.8335C2438.5,-1466.1331 2438.5,-1456.9765 2438.5,-1448.4188"/>
<polygon fill="#000000" stroke="#000000" points="2442.0001,-1448.4154 2438.5,-1438.4155 2435.0001,-1448.4155 2442.0001,-1448.4154"/>
</g>
<!-- prose_35 -->
<g id="node36" class="node">
<title>prose_35</title>
<ellipse fill="none" stroke="#000000" cx="2553.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2553.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_35 -->
<g id="edge35" class="edge">
<title>section_6&#45;&gt;prose_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2464.8833,-1475.4839C2482.3214,-1464.5662 2505.2234,-1450.2275 2523.3766,-1438.862"/>
<polygon fill="#000000" stroke="#000000" points="2525.2435,-1441.8227 2531.862,-1433.5495 2521.5288,-1435.8896 2525.2435,-1441.8227"/>
</g>
<!-- codeblock_36 -->
<g id="node37" class="node">
<title>codeblock_36</title>
<ellipse fill="none" stroke="#000000" cx="2760.5" cy="-1420.0022" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2760.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 26&#45;29</text>
</g>
<!-- section_6&#45;&gt;codeblock_36 -->
<g id="edge36" class="edge">
<title>section_6&#45;&gt;codeblock_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2489.5219,-1480.5936C2545.0402,-1468.1795 2633.9799,-1448.2924 2694.7109,-1434.7128"/>
<polygon fill="#000000" stroke="#000000" points="2695.5855,-1438.1037 2704.5807,-1432.5059 2694.0579,-1431.2724 2695.5855,-1438.1037"/>
</g>
<!-- codeblock_37 -->
<g id="node38" class="node">
<title>codeblock_37</title>
<ellipse fill="none" stroke="#000000" cx="3043.5" cy="-1420.0022" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3043.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 31&#45;33</text>
</g>
<!-- section_6&#45;&gt;codeblock_37 -->
<g id="edge37" class="edge">
<title>section_6&#45;&gt;codeblock_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2499.0004,-1484.8021C2609.0297,-1471.7077 2841.8123,-1444.0047 2964.3138,-1429.426"/>
<polygon fill="#000000" stroke="#000000" points="2964.8623,-1432.8855 2974.3786,-1428.2282 2964.035,-1425.9346 2964.8623,-1432.8855"/>
</g>
<!-- codeblock_38 -->
<g id="node39" class="node">
<title>codeblock_38</title>
<ellipse fill="none" stroke="#000000" cx="3312.5" cy="-1420.0022" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3312.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 35&#45;45</text>
</g>
<!-- section_6&#45;&gt;codeblock_38 -->
<g id="edge38" class="edge">
<title>section_6&#45;&gt;codeblock_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2502.3639,-1487.4414C2624.3165,-1478.6369 2898.7594,-1458.3639 3129.5,-1438.0022 3162.7863,-1435.0648 3199.4463,-1431.5203 3231.1566,-1428.3561"/>
<polygon fill="#000000" stroke="#000000" points="3231.6663,-1431.8227 3241.2676,-1427.3434 3230.9686,-1424.8575 3231.6663,-1431.8227"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="3791.5" cy="-1420.0022" rx="127.6874" ry="18"/>
<text text-anchor="middle" x="3791.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Linebuf.insert(linebuf, frag)</text>
</g>
<!-- section_7&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_7&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4207.8522,-1483.2456C4128.5018,-1471.1923 3984.5544,-1449.3269 3888.4751,-1434.7326"/>
<polygon fill="#000000" stroke="#000000" points="3888.8716,-1431.2527 3878.4594,-1433.2112 3887.8203,-1438.1734 3888.8716,-1431.2527"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4056.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4056.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_7&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4224.2083,-1477.7773C4186.2582,-1464.7036 4130.4932,-1445.4927 4093.8454,-1432.8676"/>
<polygon fill="#000000" stroke="#000000" points="4094.6411,-1429.4399 4084.0464,-1429.4919 4092.3611,-1436.0582 4094.6411,-1429.4399"/>
</g>
<!-- prose_59 -->
<g id="node60" class="node">
<title>prose_59</title>
<ellipse fill="none" stroke="#000000" cx="4474.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4474.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_59 -->
<g id="edge59" class="edge">
<title>section_7&#45;&gt;prose_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4306.7917,-1477.7773C4344.7418,-1464.7036 4400.5068,-1445.4927 4437.1546,-1432.8676"/>
<polygon fill="#000000" stroke="#000000" points="4438.6389,-1436.0582 4446.9536,-1429.4919 4436.3589,-1429.4399 4438.6389,-1436.0582"/>
</g>
<!-- prose_60 -->
<g id="node61" class="node">
<title>prose_60</title>
<ellipse fill="none" stroke="#000000" cx="4751.5" cy="-1420.0022" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4751.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_60 -->
<g id="edge60" class="edge">
<title>section_7&#45;&gt;prose_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4323.6402,-1483.3888C4423.1479,-1468.6469 4623.7262,-1438.9316 4710.2384,-1426.115"/>
<polygon fill="#000000" stroke="#000000" points="4710.8297,-1429.5657 4720.2088,-1424.6379 4709.8038,-1422.6413 4710.8297,-1429.5657"/>
</g>
<!-- section_61 -->
<g id="node62" class="node">
<title>section_61</title>
<ellipse fill="none" stroke="#000000" cx="6384.5" cy="-1420.0022" rx="70.655" ry="18"/>
<text text-anchor="middle" x="6384.5" y="-1415.8022" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 59&#45;176</text>
</g>
<!-- section_7&#45;&gt;section_61 -->
<g id="edge61" class="edge">
<title>section_7&#45;&gt;section_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4330.9485,-1489.7784C4641.3457,-1479.2316 5964.1656,-1434.2844 6304.4342,-1422.7227"/>
<polygon fill="#000000" stroke="#000000" points="6304.5768,-1426.22 6314.4521,-1422.3823 6304.339,-1419.224 6304.5768,-1426.22"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="132.5,-1328.3032 78.5,-1328.3032 78.5,-1256.5009 132.5,-1256.5009 132.5,-1328.3032"/>
<text text-anchor="middle" x="105.5" y="-1264.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">The</text>
</g>
<!-- raw_9&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>raw_9&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M121.8181,-1401.9908C119.3631,-1385.504 115.6243,-1360.3951 112.3447,-1338.3694"/>
<polygon fill="#000000" stroke="#000000" points="115.7626,-1337.5586 110.8279,-1328.1831 108.8389,-1338.5896 115.7626,-1337.5586"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="204.5,-1310.4021 150.5,-1310.4021 150.5,-1274.4021 204.5,-1274.4021 204.5,-1310.4021"/>
<text text-anchor="middle" x="177.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_10&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>prespace_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M210.1361,-1401.9908C203.8068,-1380.7376 193.2105,-1345.1562 185.8147,-1320.3221"/>
<polygon fill="#000000" stroke="#000000" points="189.1683,-1319.32 182.9596,-1310.735 182.4595,-1321.318 189.1683,-1319.32"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="288,-1310.4021 223,-1310.4021 223,-1274.4021 288,-1274.4021 288,-1310.4021"/>
<text text-anchor="middle" x="255.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">linebuf</text>
</g>
<!-- literal_11&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>literal_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M303.8309,-1402.5275C294.4694,-1381.1968 278.5297,-1344.8768 267.5299,-1319.813"/>
<polygon fill="#000000" stroke="#000000" points="270.6613,-1318.2387 263.4375,-1310.4883 264.2514,-1321.0519 270.6613,-1318.2387"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="581,-1310.4021 306,-1310.4021 306,-1274.4021 581,-1274.4021 581,-1310.4021"/>
<text text-anchor="middle" x="443.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> class buffers a single line of text.</text>
</g>
<!-- raw_12&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_12&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M427.1819,-1401.9908C430.3325,-1380.832 435.5977,-1345.4722 439.2932,-1320.6539"/>
<polygon fill="#000000" stroke="#000000" points="442.7591,-1321.1414 440.7702,-1310.735 435.8355,-1320.1104 442.7591,-1321.1414"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1140,-1319.7025 599,-1319.7025 599,-1265.1016 1140,-1265.1016 1140,-1319.7025"/>
<text text-anchor="middle" x="869.5" y="-1288.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">To make editing practical, we model the line as an array of codepoints when</text>
<text text-anchor="middle" x="869.5" y="-1273.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">active, and a simple string otherwise.</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M975.9046,-1404.6106C957.9042,-1385.6284 926.7517,-1352.7767 902.7912,-1327.5092"/>
<polygon fill="#000000" stroke="#000000" points="905.0292,-1324.7827 895.6086,-1319.9347 899.9498,-1329.5993 905.0292,-1324.7827"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1212.5,-1310.4021 1158.5,-1310.4021 1158.5,-1274.4021 1212.5,-1274.4021 1212.5,-1310.4021"/>
</g>
<!-- prespace_19&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>prespace_19&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.7942,-1401.9908C1188.9688,-1380.9265 1187.5919,-1345.7876 1186.6201,-1320.9869"/>
<polygon fill="#000000" stroke="#000000" points="1190.1073,-1320.5902 1186.2184,-1310.735 1183.1127,-1320.8644 1190.1073,-1320.5902"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1296,-1310.4021 1231,-1310.4021 1231,-1274.4021 1296,-1274.4021 1296,-1310.4021"/>
<text text-anchor="middle" x="1263.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">linebuf</text>
</g>
<!-- literal_20&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>literal_20&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1290.1242,-1401.9908C1284.9838,-1380.832 1276.3932,-1345.4722 1270.3637,-1320.6539"/>
<polygon fill="#000000" stroke="#000000" points="1273.7159,-1319.626 1267.9539,-1310.735 1266.9137,-1321.2786 1273.7159,-1319.626"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="1442.5,-1310.4021 1314.5,-1310.4021 1314.5,-1274.4021 1442.5,-1274.4021 1442.5,-1310.4021"/>
<text text-anchor="middle" x="1378.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> are promoted to</text>
</g>
<!-- raw_21&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>raw_21&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1375.0646,-1401.9908C1375.7249,-1380.9265 1376.8265,-1345.7876 1377.6039,-1320.9869"/>
<polygon fill="#000000" stroke="#000000" points="1381.1102,-1320.8397 1377.9253,-1310.735 1374.1136,-1320.6204 1381.1102,-1320.8397"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="1514.5,-1310.4021 1460.5,-1310.4021 1460.5,-1274.4021 1514.5,-1274.4021 1514.5,-1310.4021"/>
<text text-anchor="middle" x="1487.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_22&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>prespace_22&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1468.6054,-1401.9908C1472.2535,-1380.832 1478.35,-1345.4722 1482.629,-1320.6539"/>
<polygon fill="#000000" stroke="#000000" points="1486.0891,-1321.1843 1484.3392,-1310.735 1479.1909,-1319.9949 1486.0891,-1321.1843"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="1590.5,-1310.4021 1532.5,-1310.4021 1532.5,-1274.4021 1590.5,-1274.4021 1590.5,-1310.4021"/>
<text text-anchor="middle" x="1561.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">txtbuf</text>
</g>
<!-- literal_23&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>literal_23&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1561.5,-1401.9908C1561.5,-1380.9265 1561.5,-1345.7876 1561.5,-1320.9869"/>
<polygon fill="#000000" stroke="#000000" points="1565.0001,-1320.7349 1561.5,-1310.735 1558.0001,-1320.735 1565.0001,-1320.7349"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="1912,-1312.3041 1609,-1312.3041 1609,-1272.5 1912,-1272.5 1912,-1312.3041"/>
<text text-anchor="middle" x="1760.5" y="-1296.9021" font-family="Inconsolata" font-size="14.00" fill="#000000"> if editing needs to span multiple lines.</text>
</g>
<!-- raw_24&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>raw_24&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1706.8616,-1402.7935C1717.0025,-1381.9227 1734.2502,-1346.426 1746.4461,-1321.3259"/>
<polygon fill="#000000" stroke="#000000" points="1749.6253,-1322.7914 1750.8476,-1312.2673 1743.3291,-1319.7322 1749.6253,-1322.7914"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2072.5,-1310.4021 1930.5,-1310.4021 1930.5,-1274.4021 2072.5,-1274.4021 2072.5,-1310.4021"/>
<text text-anchor="middle" x="2001.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">** Instance fields</text>
</g>
<!-- header_31&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>header_31&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2017.8181,-1401.9908C2014.6675,-1380.832 2009.4023,-1345.4722 2005.7068,-1320.6539"/>
<polygon fill="#000000" stroke="#000000" points="2009.1645,-1320.1104 2004.2298,-1310.735 2002.2409,-1321.1414 2009.1645,-1320.1104"/>
</g>
<!-- raw_40 -->
<g id="node41" class="node">
<title>raw_40</title>
<ellipse fill="none" stroke="#000000" cx="2117.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="2117.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_32&#45;&gt;raw_40 -->
<g id="edge40" class="edge">
<title>prose_32&#45;&gt;raw_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2203.4804,-1407.0254C2187.8388,-1397.3133 2167.5223,-1382.8403 2153.5,-1366.0022 2142.1103,-1352.3254 2133.2542,-1334.4354 2127.176,-1319.7182"/>
<polygon fill="#000000" stroke="#000000" points="2130.3241,-1318.1589 2123.4148,-1310.127 2123.8073,-1320.7145 2130.3241,-1318.1589"/>
</g>
<!-- raw_42 -->
<g id="node43" class="node">
<title>raw_42</title>
<ellipse fill="none" stroke="#000000" cx="2189.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="2189.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_33&#45;&gt;raw_42 -->
<g id="edge42" class="edge">
<title>prose_33&#45;&gt;raw_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2316.5781,-1412.9089C2289.8476,-1405.2457 2251.0692,-1390.6879 2225.5,-1366.0022 2212.4044,-1353.3591 2203.4056,-1334.9649 2197.6801,-1319.7286"/>
<polygon fill="#000000" stroke="#000000" points="2200.9774,-1318.5545 2194.3801,-1310.2644 2194.3677,-1320.8592 2200.9774,-1318.5545"/>
</g>
<!-- raw_44 -->
<g id="node45" class="node">
<title>raw_44</title>
<ellipse fill="none" stroke="#000000" cx="2261.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="2261.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_44 -->
<g id="edge44" class="edge">
<title>prose_34&#45;&gt;raw_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2411.3967,-1410.2023C2371.6919,-1395.7631 2301.9126,-1370.0379 2297.5,-1366.0022 2283.9817,-1353.6385 2274.9537,-1335.0872 2269.3194,-1319.7031"/>
<polygon fill="#000000" stroke="#000000" points="2272.6085,-1318.5031 2266.0939,-1310.1478 2265.9761,-1320.742 2272.6085,-1318.5031"/>
</g>
<!-- prespace_45 -->
<g id="node46" class="node">
<title>prespace_45</title>
<ellipse fill="none" stroke="#000000" cx="2352.5" cy="-1292.4021" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2352.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_34&#45;&gt;prespace_45 -->
<g id="edge45" class="edge">
<title>prose_34&#45;&gt;prespace_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2427.0799,-1403.0579C2412.4477,-1381.3479 2386.9427,-1343.5055 2369.8906,-1318.2048"/>
<polygon fill="#000000" stroke="#000000" points="2372.7345,-1316.162 2364.2432,-1309.8257 2366.9298,-1320.0743 2372.7345,-1316.162"/>
</g>
<!-- literal_46 -->
<g id="node47" class="node">
<title>literal_46</title>
<ellipse fill="none" stroke="#000000" cx="2448.5" cy="-1292.4021" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2448.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_34&#45;&gt;literal_46 -->
<g id="edge46" class="edge">
<title>prose_34&#45;&gt;literal_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2439.9115,-1401.9908C2441.5624,-1380.9265 2444.3162,-1345.7876 2446.2598,-1320.9869"/>
<polygon fill="#000000" stroke="#000000" points="2449.7712,-1320.9779 2447.0633,-1310.735 2442.7926,-1320.4309 2449.7712,-1320.9779"/>
</g>
<!-- raw_47 -->
<g id="node48" class="node">
<title>raw_47</title>
<ellipse fill="none" stroke="#000000" cx="2524.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="2524.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_47 -->
<g id="edge47" class="edge">
<title>prose_34&#45;&gt;raw_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2455.148,-1404.5206C2465.5741,-1394.2568 2478.8197,-1380.1235 2488.5,-1366.0022 2498.4981,-1351.4173 2507.275,-1333.642 2513.6592,-1319.2139"/>
<polygon fill="#000000" stroke="#000000" points="2516.9545,-1320.4102 2517.6824,-1309.8404 2510.5219,-1317.6493 2516.9545,-1320.4102"/>
</g>
<!-- raw_52 -->
<g id="node53" class="node">
<title>raw_52</title>
<ellipse fill="none" stroke="#000000" cx="2596.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="2596.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_35&#45;&gt;raw_52 -->
<g id="edge52" class="edge">
<title>prose_35&#45;&gt;raw_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2559.479,-1402.2599C2566.6994,-1380.8336 2578.9207,-1344.5676 2587.3342,-1319.6012"/>
<polygon fill="#000000" stroke="#000000" points="2590.695,-1320.5877 2590.5718,-1309.9936 2584.0616,-1318.3523 2590.695,-1320.5877"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="3057,-1311.7026 2642,-1311.7026 2642,-1273.1015 3057,-1273.1015 3057,-1311.7026"/>
<text text-anchor="middle" x="2849.5" y="-1296.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub, byte = assert(string.sub), assert(string.byte)</text>
<text text-anchor="middle" x="2849.5" y="-1281.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = assert(string.gsub)</text>
</g>
<!-- codeblock_36&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>codeblock_36&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2773.0628,-1401.9908C2787.8931,-1380.7285 2812.7257,-1345.1257 2830.0483,-1320.2901"/>
<polygon fill="#000000" stroke="#000000" points="2832.9835,-1322.2 2835.8336,-1311.9957 2827.2421,-1318.1954 2832.9835,-1322.2"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="3252,-1310.4021 3075,-1310.4021 3075,-1274.4021 3252,-1274.4021 3252,-1310.4021"/>
<text text-anchor="middle" x="3163.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = meta {}</text>
</g>
<!-- codeblock_37&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>codeblock_37&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3060.1855,-1402.2599C3080.8458,-1380.2912 3116.1775,-1342.7216 3139.6834,-1317.727"/>
<polygon fill="#000000" stroke="#000000" points="3142.2682,-1320.0875 3146.5694,-1310.405 3137.1689,-1315.2919 3142.2682,-1320.0875"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="3566.5,-1366.1024 3270.5,-1366.1024 3270.5,-1218.7017 3566.5,-1218.7017 3566.5,-1366.1024"/>
<text text-anchor="middle" x="3418.5" y="-1350.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = table.concat</text>
<text text-anchor="middle" x="3418.5" y="-1319.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.__tostring(linebuf)</text>
<text text-anchor="middle" x="3418.5" y="-1304.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if type(linebuf.line) == &quot;table&quot; then</text>
<text text-anchor="middle" x="3418.5" y="-1288.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return concat(linebuf.line)</text>
<text text-anchor="middle" x="3418.5" y="-1273.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="3418.5" y="-1257.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf.line</text>
<text text-anchor="middle" x="3418.5" y="-1242.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3418.5" y="-1227.002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_38&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_38&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3327.2388,-1402.2599C3333.7848,-1394.3801 3341.9981,-1384.4931 3350.7986,-1373.8993"/>
<polygon fill="#000000" stroke="#000000" points="3353.5973,-1376.0076 3357.2951,-1366.079 3348.2129,-1371.5346 3353.5973,-1376.0076"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="1483.5,-680.4013 921.5,-680.4013 921.5,-593.8007 1483.5,-593.8007 1483.5,-680.4013"/>
<text text-anchor="middle" x="1202.5" y="-617.301" font-family="Inconsolata" font-size="14.00" fill="#000000">Instance fields for a linebuf may be read by other code, but should be written</text>
<text text-anchor="middle" x="1202.5" y="-601.901" font-family="Inconsolata" font-size="14.00" fill="#000000">internally.</text>
</g>
<!-- raw_40&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>raw_40&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2114.0958,-1274.4442C2109.7607,-1257.0269 2100.4309,-1231.4351 2081.5,-1218.8019 1972.4242,-1146.0121 1602.7818,-1253.7515 1492.5,-1182.8019 1313.61,-1067.7134 1237.8661,-803.5723 1212.8006,-690.286"/>
<polygon fill="#000000" stroke="#000000" points="1216.2074,-689.4806 1210.6682,-680.4492 1209.3663,-690.9637 1216.2074,-689.4806"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="1791,-657.0031 1502,-657.0031 1502,-617.1989 1791,-617.1989 1791,-657.0031"/>
<text text-anchor="middle" x="1646.5" y="-625.601" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; lines : &#160;An array of string fragments</text>
</g>
<!-- raw_42&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>raw_42&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2185.9034,-1274.2788C2181.4491,-1256.9928 2172.0558,-1231.7327 2153.5,-1218.8019 2023.7515,-1128.3856 1920.5175,-1284.6083 1799.5,-1182.8019 1639.4387,-1048.1499 1639.7041,-760.8306 1644.398,-667.2464"/>
<polygon fill="#000000" stroke="#000000" points="1647.9035,-667.2425 1644.9667,-657.0629 1640.9144,-666.8521 1647.9035,-667.2425"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="2322,-664.4014 1809,-664.4014 1809,-609.8006 2322,-609.8006 2322,-664.4014"/>
<text text-anchor="middle" x="2065.5" y="-633.301" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; cursor : &#160;An uint representing the number of bytes to be skipped over</text>
<text text-anchor="middle" x="2065.5" y="-617.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;before executing</text>
</g>
<!-- raw_44&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>raw_44&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2256.1558,-1274.5345C2229.779,-1186.3469 2113.2752,-796.8312 2076.5964,-674.2005"/>
<polygon fill="#000000" stroke="#000000" points="2079.9149,-673.0812 2073.6961,-664.5035 2073.2085,-675.0871 2079.9149,-673.0812"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="2394.5,-655.101 2340.5,-655.101 2340.5,-619.101 2394.5,-619.101 2394.5,-655.101"/>
<text text-anchor="middle" x="2367.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_45&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>prespace_45&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2352.9168,-1274.1916C2355.0027,-1183.0692 2364.307,-776.5909 2366.8538,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="2370.3553,-665.3009 2367.0852,-655.2234 2363.3572,-665.1407 2370.3553,-665.3009"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="2484.5,-655.101 2412.5,-655.101 2412.5,-619.101 2484.5,-619.101 2484.5,-655.101"/>
<text text-anchor="middle" x="2448.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">insert()</text>
</g>
<!-- literal_46&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>literal_46&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2448.5,-1274.1916C2448.5,-1183.0692 2448.5,-776.5909 2448.5,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="2452.0001,-665.2234 2448.5,-655.2234 2445.0001,-665.2234 2452.0001,-665.2234"/>
</g>
<!-- leaf_51 -->
<g id="node52" class="node">
<title>leaf_51</title>
<polygon fill="none" stroke="#c0c0c0" points="2770.5,-656.4016 2502.5,-656.4016 2502.5,-617.8004 2770.5,-617.8004 2770.5,-656.4016"/>
<text text-anchor="middle" x="2636.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000">. &#160;Not 1&#45;1 the same as the column</text>
<text text-anchor="middle" x="2636.5" y="-625.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;index of the tty cursor.</text>
</g>
<!-- raw_47&#45;&gt;leaf_51 -->
<g id="edge51" class="edge">
<title>raw_47&#45;&gt;leaf_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2527.6124,-1274.1916C2543.1338,-1183.3778 2612.1894,-779.3401 2631.4798,-666.4736"/>
<polygon fill="#000000" stroke="#000000" points="2634.953,-666.9271 2633.1878,-656.4803 2628.053,-665.7477 2634.953,-666.9271"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3288,-664.4014 2789,-664.4014 2789,-609.8006 3288,-609.8006 3288,-664.4014"/>
<text text-anchor="middle" x="3038.5" y="-633.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursor is moved by linebuf, ensuring we stay on codepoint</text>
<text text-anchor="middle" x="3038.5" y="-617.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;boundaries.</text>
</g>
<!-- raw_52&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>raw_52&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2600.5926,-1274.5003C2605.3858,-1257.631 2614.9965,-1232.8993 2632.5,-1218.8019 2684.886,-1176.6101 2727.3633,-1225.3015 2779.5,-1182.8019 2947.6995,-1045.6929 3013.2058,-773.696 3032.1391,-674.4552"/>
<polygon fill="#000000" stroke="#000000" points="3035.5878,-675.0534 3033.9768,-664.5817 3028.706,-673.7725 3035.5878,-675.0534"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="3824.5,-1310.4021 3584.5,-1310.4021 3584.5,-1274.4021 3824.5,-1274.4021 3824.5,-1310.4021"/>
<text text-anchor="middle" x="3704.5" y="-1288.9021" font-family="Inconsolata" font-size="14.00" fill="#000000">** Linebuf.insert(linebuf, frag)</text>
</g>
<!-- header_57&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>header_57&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3779.2195,-1401.9908C3764.4711,-1380.3598 3739.603,-1343.8866 3722.6404,-1319.008"/>
<polygon fill="#000000" stroke="#000000" points="3725.5249,-1317.0256 3716.9997,-1310.735 3719.7413,-1320.9689 3725.5249,-1317.0256"/>
</g>
<!-- raw_63 -->
<g id="node64" class="node">
<title>raw_63</title>
<ellipse fill="none" stroke="#000000" cx="3869.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="3869.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_63 -->
<g id="edge63" class="edge">
<title>prose_58&#45;&gt;raw_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4024.8937,-1415.8318C3991.6135,-1409.9577 3939.4308,-1396.3469 3905.5,-1366.0022 3891.8446,-1353.7901 3882.8175,-1335.2377 3877.2179,-1319.8153"/>
<polygon fill="#000000" stroke="#000000" points="3880.5049,-1318.6082 3874.0189,-1310.2306 3873.865,-1320.8244 3880.5049,-1318.6082"/>
</g>
<!-- prespace_64 -->
<g id="node65" class="node">
<title>prespace_64</title>
<ellipse fill="none" stroke="#000000" cx="3960.5" cy="-1292.4021" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="3960.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_58&#45;&gt;prespace_64 -->
<g id="edge64" class="edge">
<title>prose_58&#45;&gt;prespace_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4043.9497,-1403.3207C4027.6026,-1381.5927 3998.8615,-1343.3909 3979.7495,-1317.9879"/>
<polygon fill="#000000" stroke="#000000" points="3982.478,-1315.7927 3973.6691,-1309.906 3976.8843,-1320.0012 3982.478,-1315.7927"/>
</g>
<!-- literal_65 -->
<g id="node66" class="node">
<title>literal_65</title>
<ellipse fill="none" stroke="#000000" cx="4056.5" cy="-1292.4021" rx="31.481" ry="18"/>
<text text-anchor="middle" x="4056.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_58&#45;&gt;literal_65 -->
<g id="edge65" class="edge">
<title>prose_58&#45;&gt;literal_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4056.5,-1401.9908C4056.5,-1380.9265 4056.5,-1345.7876 4056.5,-1320.9869"/>
<polygon fill="#000000" stroke="#000000" points="4060.0001,-1320.7349 4056.5,-1310.735 4053.0001,-1320.735 4060.0001,-1320.7349"/>
</g>
<!-- raw_66 -->
<g id="node67" class="node">
<title>raw_66</title>
<ellipse fill="none" stroke="#000000" cx="4132.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="4132.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_66 -->
<g id="edge66" class="edge">
<title>prose_58&#45;&gt;raw_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4069.932,-1403.5297C4078.1152,-1393.1072 4088.5,-1379.1615 4096.5,-1366.0022 4105.6256,-1350.9912 4114.3248,-1333.3345 4120.8851,-1319.0782"/>
<polygon fill="#000000" stroke="#000000" points="4124.1374,-1320.3803 4125.0641,-1309.8261 4117.7579,-1317.4988 4124.1374,-1320.3803"/>
</g>
<!-- raw_71 -->
<g id="node72" class="node">
<title>raw_71</title>
<ellipse fill="none" stroke="#000000" cx="4383.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="4383.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_59&#45;&gt;raw_71 -->
<g id="edge71" class="edge">
<title>prose_59&#45;&gt;raw_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4456.3351,-1405.0353C4444.7833,-1394.8707 4430.0661,-1380.6551 4419.5,-1366.0022 4409.1576,-1351.6595 4400.3707,-1333.8911 4394.0674,-1319.4062"/>
<polygon fill="#000000" stroke="#000000" points="4397.2103,-1317.8504 4390.1118,-1309.9851 4390.7561,-1320.5604 4397.2103,-1317.8504"/>
</g>
<!-- prespace_72 -->
<g id="node73" class="node">
<title>prespace_72</title>
<ellipse fill="none" stroke="#000000" cx="4474.5" cy="-1292.4021" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="4474.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_59&#45;&gt;prespace_72 -->
<g id="edge72" class="edge">
<title>prose_59&#45;&gt;prespace_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4474.5,-1401.9908C4474.5,-1380.9265 4474.5,-1345.7876 4474.5,-1320.9869"/>
<polygon fill="#000000" stroke="#000000" points="4478.0001,-1320.7349 4474.5,-1310.735 4471.0001,-1320.735 4478.0001,-1320.7349"/>
</g>
<!-- literal_73 -->
<g id="node74" class="node">
<title>literal_73</title>
<ellipse fill="none" stroke="#000000" cx="4570.5" cy="-1292.4021" rx="31.481" ry="18"/>
<text text-anchor="middle" x="4570.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_59&#45;&gt;literal_73 -->
<g id="edge73" class="edge">
<title>prose_59&#45;&gt;literal_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4492.4055,-1404.843C4503.8509,-1394.5994 4518.5469,-1380.3681 4529.5,-1366.0022 4540.6304,-1351.4037 4550.7018,-1333.429 4558.0774,-1318.8974"/>
<polygon fill="#000000" stroke="#000000" points="4561.2237,-1320.4307 4562.5189,-1309.9153 4554.9489,-1317.3279 4561.2237,-1320.4307"/>
</g>
<!-- raw_74 -->
<g id="node75" class="node">
<title>raw_74</title>
<ellipse fill="none" stroke="#000000" cx="4733.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="4733.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_59&#45;&gt;raw_74 -->
<g id="edge74" class="edge">
<title>prose_59&#45;&gt;raw_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4502.1552,-1410.5074C4530.0398,-1400.5914 4574.0531,-1383.9961 4610.5,-1366.0022 4644.2847,-1349.3226 4681.131,-1326.6281 4705.5999,-1310.8678"/>
<polygon fill="#000000" stroke="#000000" points="4707.5433,-1313.779 4714.0261,-1305.3991 4703.7324,-1307.9073 4707.5433,-1313.779"/>
</g>
<!-- raw_79 -->
<g id="node80" class="node">
<title>raw_79</title>
<ellipse fill="none" stroke="#000000" cx="5140.5" cy="-1292.4021" rx="27" ry="18"/>
<text text-anchor="middle" x="5140.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_60&#45;&gt;raw_79 -->
<g id="edge79" class="edge">
<title>prose_60&#45;&gt;raw_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4779.4759,-1410.8255C4849.1657,-1387.9658 5030.3492,-1328.5338 5106.2569,-1303.6345"/>
<polygon fill="#000000" stroke="#000000" points="5107.414,-1306.9385 5115.8249,-1300.496 5105.2322,-1300.2872 5107.414,-1306.9385"/>
</g>
<!-- header_81 -->
<g id="node82" class="node">
<title>header_81</title>
<ellipse fill="none" stroke="#000000" cx="5822.5" cy="-1292.4021" rx="83.677" ry="18"/>
<text text-anchor="middle" x="5822.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : join(token, frag)</text>
</g>
<!-- section_61&#45;&gt;header_81 -->
<g id="edge81" class="edge">
<title>section_61&#45;&gt;header_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6315.6033,-1415.7989C6237.3543,-1409.7868 6106.4076,-1395.953 5997.5,-1366.0022 5950.4412,-1353.0605 5899.2711,-1330.4653 5864.4909,-1313.7144"/>
<polygon fill="#000000" stroke="#000000" points="5865.6558,-1310.3888 5855.1328,-1309.1576 5862.5913,-1316.6823 5865.6558,-1310.3888"/>
</g>
<!-- prose_82 -->
<g id="node83" class="node">
<title>prose_82</title>
<ellipse fill="none" stroke="#000000" cx="6038.5" cy="-1292.4021" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="6038.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_61&#45;&gt;prose_82 -->
<g id="edge82" class="edge">
<title>section_61&#45;&gt;prose_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6315.9507,-1415.7047C6260.9269,-1410.0091 6182.9845,-1396.7697 6121.5,-1366.0022 6097.3743,-1353.9294 6074.8001,-1333.0323 6059.3029,-1316.5825"/>
<polygon fill="#000000" stroke="#000000" points="6061.6229,-1313.9334 6052.2879,-1308.9225 6056.4605,-1318.6611 6061.6229,-1313.9334"/>
</g>
<!-- codeblock_83 -->
<g id="node84" class="node">
<title>codeblock_83</title>
<ellipse fill="none" stroke="#000000" cx="6212.5" cy="-1292.4021" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="6212.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 63&#45;134</text>
</g>
<!-- section_61&#45;&gt;codeblock_83 -->
<g id="edge83" class="edge">
<title>section_61&#45;&gt;codeblock_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6361.3033,-1402.7935C6331.0406,-1380.3427 6277.9644,-1340.9676 6244.0597,-1315.815"/>
<polygon fill="#000000" stroke="#000000" points="6245.9951,-1312.8928 6235.8785,-1309.7457 6241.8244,-1318.5147 6245.9951,-1312.8928"/>
</g>
<!-- codeblock_84 -->
<g id="node85" class="node">
<title>codeblock_84</title>
<ellipse fill="none" stroke="#000000" cx="6557.5" cy="-1292.4021" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6557.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 138&#45;151</text>
</g>
<!-- section_61&#45;&gt;codeblock_84 -->
<g id="edge84" class="edge">
<title>section_61&#45;&gt;codeblock_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6407.8315,-1402.7935C6438.2702,-1380.3427 6491.655,-1340.9676 6525.7568,-1315.815"/>
<polygon fill="#000000" stroke="#000000" points="6528.0154,-1318.4982 6533.9856,-1309.7457 6523.8603,-1312.8648 6528.0154,-1318.4982"/>
</g>
<!-- codeblock_85 -->
<g id="node86" class="node">
<title>codeblock_85</title>
<ellipse fill="none" stroke="#000000" cx="6928.5" cy="-1292.4021" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6928.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 153&#45;163</text>
</g>
<!-- section_61&#45;&gt;codeblock_85 -->
<g id="edge85" class="edge">
<title>section_61&#45;&gt;codeblock_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6442.1876,-1409.5176C6496.814,-1399.3308 6581.03,-1382.956 6653.5,-1366.0022 6727.7262,-1348.6376 6812.336,-1325.4802 6867.8729,-1309.8137"/>
<polygon fill="#000000" stroke="#000000" points="6868.8836,-1313.1652 6877.5535,-1307.0756 6866.9784,-1306.4294 6868.8836,-1313.1652"/>
</g>
<!-- codeblock_86 -->
<g id="node87" class="node">
<title>codeblock_86</title>
<ellipse fill="none" stroke="#000000" cx="7230.5" cy="-1292.4021" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7230.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 165&#45;172</text>
</g>
<!-- section_61&#45;&gt;codeblock_86 -->
<g id="edge86" class="edge">
<title>section_61&#45;&gt;codeblock_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6453.7095,-1416.4306C6596.0307,-1408.7146 6917.1642,-1389.2912 7024.5,-1366.0022 7081.0219,-1353.7384 7143.1969,-1330.0194 7184.2966,-1312.8143"/>
<polygon fill="#000000" stroke="#000000" points="7185.9145,-1315.9302 7193.7612,-1308.8112 7183.1877,-1309.4832 7185.9145,-1315.9302"/>
</g>
<!-- codeblock_87 -->
<g id="node88" class="node">
<title>codeblock_87</title>
<ellipse fill="none" stroke="#000000" cx="7538.5" cy="-1292.4021" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7538.5" y="-1288.2021" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 174&#45;176</text>
</g>
<!-- section_61&#45;&gt;codeblock_87 -->
<g id="edge87" class="edge">
<title>section_61&#45;&gt;codeblock_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6454.8286,-1418.4887C6643.831,-1414.02 7159.6909,-1399.0712 7326.5,-1366.0022 7385.178,-1354.3696 7449.7303,-1330.2153 7492.0029,-1312.7439"/>
<polygon fill="#000000" stroke="#000000" points="7493.5847,-1315.8764 7501.4625,-1308.7919 7490.8862,-1309.4174 7493.5847,-1315.8764"/>
</g>
<!-- leaf_67 -->
<g id="node68" class="node">
<title>leaf_67</title>
<polygon fill="none" stroke="#c0c0c0" points="3741.5,-655.101 3687.5,-655.101 3687.5,-619.101 3741.5,-619.101 3741.5,-655.101"/>
</g>
<!-- raw_63&#45;&gt;leaf_67 -->
<g id="edge67" class="edge">
<title>raw_63&#45;&gt;leaf_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3864.6568,-1274.5012C3859.4033,-1258.1078 3849.5449,-1234.1304 3833.5,-1218.8019 3804.426,-1191.0262 3773.6568,-1215.6737 3750.5,-1182.8019 3634.496,-1018.131 3686.0371,-751.6196 3707.0967,-665.1526"/>
<polygon fill="#000000" stroke="#000000" points="3710.5316,-665.8434 3709.5584,-655.2934 3703.7401,-664.1476 3710.5316,-665.8434"/>
</g>
<!-- leaf_68 -->
<g id="node69" class="node">
<title>leaf_68</title>
<polygon fill="none" stroke="#c0c0c0" points="3813.5,-655.101 3759.5,-655.101 3759.5,-619.101 3813.5,-619.101 3813.5,-655.101"/>
</g>
<!-- prespace_64&#45;&gt;leaf_68 -->
<g id="edge68" class="edge">
<title>prespace_64&#45;&gt;leaf_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3950.8142,-1274.5505C3941.1721,-1258.1918 3925.0181,-1234.2379 3905.5,-1218.8019 3873.9616,-1193.8596 3845.6568,-1215.6737 3822.5,-1182.8019 3763.2079,-1098.6351 3778.5385,-765.4435 3784.6103,-665.5525"/>
<polygon fill="#000000" stroke="#000000" points="3788.1187,-665.5266 3785.2497,-655.3276 3781.1323,-665.0896 3788.1187,-665.5266"/>
</g>
<!-- leaf_69 -->
<g id="node70" class="node">
<title>leaf_69</title>
<polygon fill="none" stroke="#c0c0c0" points="3889.5,-655.101 3831.5,-655.101 3831.5,-619.101 3889.5,-619.101 3889.5,-655.101"/>
<text text-anchor="middle" x="3860.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">insert</text>
</g>
<!-- literal_65&#45;&gt;leaf_69 -->
<g id="edge69" class="edge">
<title>literal_65&#45;&gt;leaf_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4050.8554,-1274.3768C4044.7254,-1257.6592 4033.3485,-1233.2508 4015.5,-1218.8019 3973.2133,-1184.5698 3932.3241,-1225.4157 3898.5,-1182.8019 3834.4064,-1102.0527 3851.6953,-765.7695 3858.4271,-665.4635"/>
<polygon fill="#000000" stroke="#000000" points="3861.9383,-665.4208 3859.1348,-655.2036 3854.9549,-664.9391 3861.9383,-665.4208"/>
</g>
<!-- leaf_70 -->
<g id="node71" class="node">
<title>leaf_70</title>
<polygon fill="none" stroke="#c0c0c0" points="4357.5,-655.101 3907.5,-655.101 3907.5,-619.101 4357.5,-619.101 4357.5,-655.101"/>
<text text-anchor="middle" x="4132.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> takes a fragment and carefully places it at the cursor point.</text>
</g>
<!-- raw_66&#45;&gt;leaf_70 -->
<g id="edge70" class="edge">
<title>raw_66&#45;&gt;leaf_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4132.5,-1274.1916C4132.5,-1183.0692 4132.5,-776.5909 4132.5,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="4136.0001,-665.2234 4132.5,-655.2234 4129.0001,-665.2234 4136.0001,-665.2234"/>
</g>
<!-- leaf_75 -->
<g id="node76" class="node">
<title>leaf_75</title>
<polygon fill="none" stroke="#c0c0c0" points="4429.5,-657.0031 4375.5,-657.0031 4375.5,-617.1989 4429.5,-617.1989 4429.5,-657.0031"/>
<text text-anchor="middle" x="4402.5" y="-625.601" font-family="Inconsolata" font-size="14.00" fill="#000000">A</text>
</g>
<!-- raw_71&#45;&gt;leaf_75 -->
<g id="edge75" class="edge">
<title>raw_71&#45;&gt;leaf_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4384.028,-1274.1916C4386.6553,-1183.578 4398.3243,-781.1204 4401.6266,-667.2245"/>
<polygon fill="#000000" stroke="#000000" points="4405.1281,-667.2206 4401.9195,-657.1233 4398.131,-667.0176 4405.1281,-667.2206"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="4501.5,-655.101 4447.5,-655.101 4447.5,-619.101 4501.5,-619.101 4501.5,-655.101"/>
<text text-anchor="middle" x="4474.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_72&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>prespace_72&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4474.5,-1274.1916C4474.5,-1183.0692 4474.5,-776.5909 4474.5,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="4478.0001,-665.2234 4474.5,-655.2234 4471.0001,-665.2234 4478.0001,-665.2234"/>
</g>
<!-- leaf_77 -->
<g id="node78" class="node">
<title>leaf_77</title>
<polygon fill="none" stroke="#c0c0c0" points="4573.5,-655.101 4519.5,-655.101 4519.5,-619.101 4573.5,-619.101 4573.5,-655.101"/>
<text text-anchor="middle" x="4546.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">frag</text>
</g>
<!-- literal_73&#45;&gt;leaf_77 -->
<g id="edge77" class="edge">
<title>literal_73&#45;&gt;leaf_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4569.8331,-1274.1916C4566.4958,-1183.0692 4551.6087,-776.5909 4547.534,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="4551.0275,-665.0886 4547.1637,-655.2234 4544.0322,-665.3448 4551.0275,-665.0886"/>
</g>
<!-- leaf_78 -->
<g id="node79" class="node">
<title>leaf_78</title>
<polygon fill="none" stroke="#c0c0c0" points="5049,-655.101 4592,-655.101 4592,-619.101 5049,-619.101 5049,-655.101"/>
<text text-anchor="middle" x="4820.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> is any kind of string that we won&#39;t want to break into pieces.</text>
</g>
<!-- raw_74&#45;&gt;leaf_78 -->
<g id="edge78" class="edge">
<title>raw_74&#45;&gt;leaf_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4735.9177,-1274.1916C4748.0154,-1183.0692 4801.9808,-776.5909 4816.7518,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="4820.2474,-665.5971 4818.094,-655.2234 4813.3083,-664.6758 4820.2474,-665.5971"/>
</g>
<!-- leaf_80 -->
<g id="node81" class="node">
<title>leaf_80</title>
<polygon fill="none" stroke="#c0c0c0" points="5601.5,-680.3013 5067.5,-680.3013 5067.5,-593.9007 5601.5,-593.9007 5601.5,-680.3013"/>
<text text-anchor="middle" x="5334.5" y="-649.001" font-family="Inconsolata" font-size="14.00" fill="#000000">At first that means pasting long strings will cause syntax highlighting to</text>
<text text-anchor="middle" x="5334.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">fall over. Harmlessly. &#160;Once lexing is working we can trip an interrupt on</text>
<text text-anchor="middle" x="5334.5" y="-618.201" font-family="Inconsolata" font-size="14.00" fill="#000000">long input.</text>
</g>
<!-- raw_79&#45;&gt;leaf_80 -->
<g id="edge80" class="edge">
<title>raw_79&#45;&gt;leaf_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5145.7896,-1274.5345C5170.8503,-1189.8836 5278.1066,-827.5887 5318.7786,-690.2054"/>
<polygon fill="#000000" stroke="#000000" points="5322.2219,-690.904 5321.7046,-680.3218 5315.5098,-688.9169 5322.2219,-690.904"/>
</g>
<!-- leaf_88 -->
<g id="node89" class="node">
<title>leaf_88</title>
<polygon fill="none" stroke="#c0c0c0" points="5783,-655.101 5620,-655.101 5620,-619.101 5783,-619.101 5783,-655.101"/>
<text text-anchor="middle" x="5701.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">*** join(token, frag)</text>
</g>
<!-- header_81&#45;&gt;leaf_88 -->
<g id="edge88" class="edge">
<title>header_81&#45;&gt;leaf_88</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5816.9387,-1274.3139C5810.4355,-1252.6995 5799.6523,-1215.3656 5792.5,-1182.8019 5749.4023,-986.5832 5715.9823,-746.7168 5705.1959,-665.5129"/>
<polygon fill="#000000" stroke="#000000" points="5708.6038,-664.5849 5703.8254,-655.1288 5701.664,-665.5008 5708.6038,-664.5849"/>
</g>
<!-- raw_89 -->
<g id="node90" class="node">
<title>raw_89</title>
<ellipse fill="none" stroke="#000000" cx="5828.5" cy="-637.101" rx="27" ry="18"/>
<text text-anchor="middle" x="5828.5" y="-632.901" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_82&#45;&gt;raw_89 -->
<g id="edge89" class="edge">
<title>prose_82&#45;&gt;raw_89</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6016.4489,-1279.2427C5970.637,-1251.8051 5869.0224,-1190.3931 5864.5,-1182.8019 5761.746,-1010.3213 5804.1797,-750.4599 5822.0576,-665.2502"/>
<polygon fill="#000000" stroke="#000000" points="5825.5175,-665.809 5824.2035,-655.296 5818.6747,-664.3338 5825.5175,-665.809"/>
</g>
<!-- leaf_91 -->
<g id="node92" class="node">
<title>leaf_91</title>
<polygon fill="none" stroke="#c0c0c0" points="6393.5,-1183.003 5873.5,-1183.003 5873.5,-91.199 6393.5,-91.199 6393.5,-1183.003"/>
<text text-anchor="middle" x="6133.5" y="-1167.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">local function join(token, frag)</text>
<text text-anchor="middle" x="6133.5" y="-1152.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if sub(token, &#45;1) == &quot; &quot; and sub(frag, 1,1) ~= &quot; &quot; then</text>
<text text-anchor="middle" x="6133.5" y="-1136.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return token, frag</text>
<text text-anchor="middle" x="6133.5" y="-1121.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6133.5" y="-1106.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return token .. frag, nil</text>
<text text-anchor="middle" x="6133.5" y="-1090.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6133.5" y="-1075.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6133.5" y="-1043.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local t_insert, splice = assert(table.insert), assert(table.splice)</text>
<text text-anchor="middle" x="6133.5" y="-1028.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local utf8, codepoints = string.utf8, string.codepoints</text>
<text text-anchor="middle" x="6133.5" y="-997.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.insert(linebuf, frag)</text>
<text text-anchor="middle" x="6133.5" y="-981.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local line = linebuf.line</text>
<text text-anchor="middle" x="6133.5" y="-966.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if type(line) == &quot;string&quot; then</text>
<text text-anchor="middle" x="6133.5" y="-950.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;line = codepoints(line)</text>
<text text-anchor="middle" x="6133.5" y="-935.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.line = line</text>
<text text-anchor="middle" x="6133.5" y="-920.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6133.5" y="-904.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local wide_frag = utf8(frag)</text>
<text text-anchor="middle" x="6133.5" y="-889.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if wide_frag &lt; #frag then &#45;&#45; a paste</text>
<text text-anchor="middle" x="6133.5" y="-873.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Normalize whitespace</text>
<text text-anchor="middle" x="6133.5" y="-858.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;frag = gsub(frag, &quot;\r\n&quot;, &quot;\n&quot;):gsub(&quot;\r&quot;, &quot;\n&quot;):gsub(&quot;\t&quot;, &quot; &#160;&#160;&quot;)</text>
<text text-anchor="middle" x="6133.5" y="-843.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;wide_frag = codepoints(frag)</text>
<text text-anchor="middle" x="6133.5" y="-827.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6133.5" y="-812.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;wide_frag = false</text>
<text text-anchor="middle" x="6133.5" y="-796.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6133.5" y="-781.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not wide_frag then</text>
<text text-anchor="middle" x="6133.5" y="-766.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;t_insert(line, linebuf.cursor, frag)</text>
<text text-anchor="middle" x="6133.5" y="-750.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor + 1</text>
<text text-anchor="middle" x="6133.5" y="-735.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="6133.5" y="-719.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6133.5" y="-704.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;splice(line, linebuf.cursor, wide_frag)</text>
<text text-anchor="middle" x="6133.5" y="-689.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor + #wide_frag</text>
<text text-anchor="middle" x="6133.5" y="-673.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="6133.5" y="-658.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6133.5" y="-626.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="6133.5" y="-611.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6133.5" y="-580.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local remove = table.remove</text>
<text text-anchor="middle" x="6133.5" y="-548.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.d_back(linebuf)</text>
<text text-anchor="middle" x="6133.5" y="-533.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;remove(linebuf.line, linebuf.cursor &#45; 1)</text>
<text text-anchor="middle" x="6133.5" y="-517.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = linebuf.cursor &gt; 1 and linebuf.cursor &#45; 1 or 1</text>
<text text-anchor="middle" x="6133.5" y="-502.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6133.5" y="-455.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.d_fwd(linebuf)</text>
<text text-anchor="middle" x="6133.5" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;remove(linebuf.line, linebuf.cursor)</text>
<text text-anchor="middle" x="6133.5" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6133.5" y="-392.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.left(linebuf, disp)</text>
<text text-anchor="middle" x="6133.5" y="-377.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local disp = disp or 1</text>
<text text-anchor="middle" x="6133.5" y="-362.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if linebuf.cursor &#45; disp &gt;= 1 then</text>
<text text-anchor="middle" x="6133.5" y="-346.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor &#45; disp</text>
<text text-anchor="middle" x="6133.5" y="-331.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf.cursor</text>
<text text-anchor="middle" x="6133.5" y="-315.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6133.5" y="-300.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = 1</text>
<text text-anchor="middle" x="6133.5" y="-285.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf.cursor</text>
<text text-anchor="middle" x="6133.5" y="-269.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6133.5" y="-254.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6133.5" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.right(linebuf, disp)</text>
<text text-anchor="middle" x="6133.5" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;disp = disp or 1</text>
<text text-anchor="middle" x="6133.5" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if linebuf.cursor + disp &lt;= #linebuf.line + 1 then</text>
<text text-anchor="middle" x="6133.5" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor + disp</text>
<text text-anchor="middle" x="6133.5" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6133.5" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="6133.5" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6133.5" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf.cursor</text>
<text text-anchor="middle" x="6133.5" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_83&#45;&gt;leaf_91 -->
<g id="edge91" class="edge">
<title>codeblock_83&#45;&gt;leaf_91</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6210.3046,-1274.1916C6208.2318,-1256.9975 6204.8053,-1228.5751 6200.5198,-1193.0266"/>
<polygon fill="#000000" stroke="#000000" points="6203.9605,-1192.3237 6199.2886,-1182.8146 6197.0108,-1193.1616 6203.9605,-1192.3237"/>
</g>
<!-- leaf_92 -->
<g id="node93" class="node">
<title>leaf_92</title>
<polygon fill="none" stroke="#c0c0c0" points="6861.5,-734.1013 6411.5,-734.1013 6411.5,-540.1007 6861.5,-540.1007 6861.5,-734.1013"/>
<text text-anchor="middle" x="6636.5" y="-718.9011" font-family="Inconsolata" font-size="14.00" fill="#000000">local cl = assert(table.clone, &quot;table.clone must be provided&quot;)</text>
<text text-anchor="middle" x="6636.5" y="-687.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.suspend(linebuf)</text>
<text text-anchor="middle" x="6636.5" y="-672.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.line = tostring(linebuf)</text>
<text text-anchor="middle" x="6636.5" y="-656.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="6636.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6636.5" y="-609.901" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.resume(linebuf)</text>
<text text-anchor="middle" x="6636.5" y="-594.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.line = codepoints(linebuf.line)</text>
<text text-anchor="middle" x="6636.5" y="-579.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="6636.5" y="-563.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="6636.5" y="-548.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_84&#45;&gt;leaf_92 -->
<g id="edge92" class="edge">
<title>codeblock_84&#45;&gt;leaf_92</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6559.6954,-1274.1916C6568.8152,-1198.5428 6604.1375,-905.5459 6623.5452,-744.5603"/>
<polygon fill="#000000" stroke="#000000" points="6627.078,-744.4981 6624.8001,-734.151 6620.1283,-743.6602 6627.078,-744.4981"/>
</g>
<!-- leaf_93 -->
<g id="node94" class="node">
<title>leaf_93</title>
<polygon fill="none" stroke="#c0c0c0" points="7175.5,-710.2018 6879.5,-710.2018 6879.5,-564.0002 7175.5,-564.0002 7175.5,-710.2018"/>
<text text-anchor="middle" x="7027.5" y="-695.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.clone(linebuf)</text>
<text text-anchor="middle" x="7027.5" y="-679.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = cl(linebuf)</text>
<text text-anchor="middle" x="7027.5" y="-664.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if type(lb.line) == &quot;table&quot; then</text>
<text text-anchor="middle" x="7027.5" y="-649.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lb.line = cl(lb.line)</text>
<text text-anchor="middle" x="7027.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif type(lb.line) == &quot;string&quot; then</text>
<text text-anchor="middle" x="7027.5" y="-618.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lb:resume()</text>
<text text-anchor="middle" x="7027.5" y="-602.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="7027.5" y="-587.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lb</text>
<text text-anchor="middle" x="7027.5" y="-572.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_85&#45;&gt;leaf_93 -->
<g id="edge93" class="edge">
<title>codeblock_85&#45;&gt;leaf_93</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6931.2512,-1274.1916C6943.2714,-1194.6274 6991.6145,-874.6346 7014.8743,-720.6733"/>
<polygon fill="#000000" stroke="#000000" points="7018.404,-720.7391 7016.4371,-710.3284 7011.4825,-719.6934 7018.404,-720.7391"/>
</g>
<!-- leaf_94 -->
<g id="node95" class="node">
<title>leaf_94</title>
<polygon fill="none" stroke="#c0c0c0" points="7483,-687.502 7194,-687.502 7194,-586.7 7483,-586.7 7483,-687.502"/>
<text text-anchor="middle" x="7338.5" y="-672.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(line)</text>
<text text-anchor="middle" x="7338.5" y="-656.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = meta(Linebuf)</text>
<text text-anchor="middle" x="7338.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = line and #line or 1</text>
<text text-anchor="middle" x="7338.5" y="-625.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.line &#160;= line or {}</text>
<text text-anchor="middle" x="7338.5" y="-610.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="7338.5" y="-595.1009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_86&#45;&gt;leaf_94 -->
<g id="edge94" class="edge">
<title>codeblock_86&#45;&gt;leaf_94</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7233.5013,-1274.1916C7247.3109,-1190.4002 7305.0679,-839.9536 7328.5291,-697.6005"/>
<polygon fill="#000000" stroke="#000000" points="7332.052,-697.7478 7330.2248,-687.3117 7325.1451,-696.6094 7332.052,-697.7478"/>
</g>
<!-- leaf_95 -->
<g id="node96" class="node">
<title>leaf_95</title>
<polygon fill="none" stroke="#c0c0c0" points="7587.5,-655.101 7501.5,-655.101 7501.5,-619.101 7587.5,-619.101 7587.5,-655.101"/>
<text text-anchor="middle" x="7544.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_87&#45;&gt;leaf_95 -->
<g id="edge95" class="edge">
<title>codeblock_87&#45;&gt;leaf_95</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7538.6667,-1274.1916C7539.5011,-1183.0692 7543.2228,-776.5909 7544.2415,-665.3333"/>
<polygon fill="#000000" stroke="#000000" points="7547.7423,-665.2551 7544.3341,-655.2234 7540.7426,-665.1909 7547.7423,-665.2551"/>
</g>
<!-- leaf_90 -->
<g id="node91" class="node">
<title>leaf_90</title>
<polygon fill="none" stroke="#c0c0c0" points="5952,-55.6015 5705,-55.6015 5705,.2015 5952,.2015 5952,-55.6015"/>
<text text-anchor="middle" x="5828.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Decides when to emit a new token.</text>
</g>
<!-- raw_89&#45;&gt;leaf_90 -->
<g id="edge90" class="edge">
<title>raw_89&#45;&gt;leaf_90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5828.5,-618.8628C5828.5,-534.747 5828.5,-183.3603 5828.5,-66.0304"/>
<polygon fill="#000000" stroke="#000000" points="5832.0001,-65.7413 5828.5,-55.7414 5825.0001,-65.7414 5832.0001,-65.7413"/>
</g>
</g>
</svg>
