<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="8385pt" height="1586pt"
 viewBox="0.00 0.00 8384.80 1586.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1582.202)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1582.202 8380.7972,-1582.202 8380.7972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1308.5" cy="-1560.202" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1308.5" y="-1556.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 181</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1308.5" cy="-1488.202" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="1308.5" y="-1484.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;52</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1308.5,-1542.0333C1308.5,-1534.3329 1308.5,-1525.1763 1308.5,-1516.6186"/>
<polygon fill="#000000" stroke="#000000" points="1312.0001,-1516.6152 1308.5,-1506.6152 1305.0001,-1516.6153 1312.0001,-1516.6152"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="124.5" cy="-1416.202" rx="51.319" ry="18"/>
<text text-anchor="middle" x="124.5" y="-1412.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Linebuf</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1247.8483,-1486.5455C1087.8239,-1481.8504 641.0395,-1466.6409 270.5,-1434.202 241.3979,-1431.6542 209.1538,-1427.7895 182.3857,-1424.2935"/>
<polygon fill="#000000" stroke="#000000" points="182.7852,-1420.8159 172.4127,-1422.9751 181.8677,-1427.7555 182.7852,-1420.8159"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="311.5" cy="-1416.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="311.5" y="-1412.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1249.1189,-1483.9137C1065.9408,-1470.6852 512.505,-1430.7179 354.2138,-1419.2866"/>
<polygon fill="#000000" stroke="#000000" points="354.1639,-1415.774 343.9377,-1418.5445 353.6596,-1422.7558 354.1639,-1415.774"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1056.5" cy="-1416.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1056.5" y="-1412.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1264.6049,-1475.6605C1216.7535,-1461.9887 1140.9188,-1440.3216 1095.2127,-1427.2627"/>
<polygon fill="#000000" stroke="#000000" points="1095.9614,-1423.8366 1085.3846,-1424.4547 1094.0383,-1430.5673 1095.9614,-1423.8366"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1374.5" cy="-1416.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1374.5" y="-1412.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1324.4768,-1470.7728C1332.9056,-1461.5777 1343.3747,-1450.1568 1352.5539,-1440.1432"/>
<polygon fill="#000000" stroke="#000000" points="1355.3979,-1442.2203 1359.5751,-1432.4837 1350.2378,-1437.4902 1355.3979,-1442.2203"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2212.5" cy="-1416.202" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2212.5" y="-1412.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 12&#45;27</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1367.4653,-1483.5056C1526.5957,-1470.8315 1964.5411,-1435.9509 2139.1932,-1422.0406"/>
<polygon fill="#000000" stroke="#000000" points="2139.6223,-1425.5176 2149.3128,-1421.2346 2139.0665,-1418.5397 2139.6223,-1425.5176"/>
</g>
<!-- section_7 -->
<g id="node8" class="node">
<title>section_7</title>
<ellipse fill="none" stroke="#000000" cx="4951.5" cy="-1416.202" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="4951.5" y="-1412.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 53&#45;63</text>
</g>
<!-- section_1&#45;&gt;section_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;section_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.4449,-1486.9975C1801.4106,-1478.4601 4397.2709,-1427.1557 4875.7241,-1417.6996"/>
<polygon fill="#000000" stroke="#000000" points="4876.0381,-1421.1942 4885.967,-1417.4972 4875.8997,-1414.1955 4876.0381,-1421.1942"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="79,-1362.202 0,-1362.202 0,-1326.202 79,-1326.202 79,-1362.202"/>
<text text-anchor="middle" x="39.5" y="-1340.702" font-family="Inconsolata" font-size="14.00" fill="#000000">* Linebuf</text>
</g>
<!-- header_2&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>header_2&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M104.7856,-1399.5027C94.1066,-1390.457 80.7025,-1379.1029 68.8228,-1369.0401"/>
<polygon fill="#000000" stroke="#000000" points="70.7869,-1366.1169 60.8942,-1362.3241 66.2625,-1371.4583 70.7869,-1366.1169"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="124.5" cy="-1344.202" rx="27" ry="18"/>
<text text-anchor="middle" x="124.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M283.2815,-1407.2391C252.6521,-1397.2505 202.4919,-1380.1316 160.5,-1362.202 158.7167,-1361.4405 156.8969,-1360.6327 155.0697,-1359.7974"/>
<polygon fill="#000000" stroke="#000000" points="156.5375,-1356.6198 146.004,-1355.4805 153.528,-1362.9398 156.5375,-1356.6198"/>
</g>
<!-- prespace_10 -->
<g id="node11" class="node">
<title>prespace_10</title>
<ellipse fill="none" stroke="#000000" cx="215.5" cy="-1344.202" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="215.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_3&#45;&gt;prespace_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;prespace_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.073,-1401.6317C278.5746,-1391.5079 260.3362,-1377.8291 245.0453,-1366.3609"/>
<polygon fill="#000000" stroke="#000000" points="247.0024,-1363.4538 236.9024,-1360.2538 242.8024,-1369.0538 247.0024,-1363.4538"/>
</g>
<!-- literal_11 -->
<g id="node12" class="node">
<title>literal_11</title>
<ellipse fill="none" stroke="#000000" cx="311.5" cy="-1344.202" rx="31.481" ry="18"/>
<text text-anchor="middle" x="311.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_3&#45;&gt;literal_11 -->
<g id="edge11" class="edge">
<title>prose_3&#45;&gt;literal_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M311.5,-1398.0333C311.5,-1390.3329 311.5,-1381.1763 311.5,-1372.6186"/>
<polygon fill="#000000" stroke="#000000" points="315.0001,-1372.6152 311.5,-1362.6152 308.0001,-1372.6153 315.0001,-1372.6152"/>
</g>
<!-- raw_12 -->
<g id="node13" class="node">
<title>raw_12</title>
<ellipse fill="none" stroke="#000000" cx="424.5" cy="-1344.202" rx="27" ry="18"/>
<text text-anchor="middle" x="424.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_12 -->
<g id="edge12" class="edge">
<title>prose_3&#45;&gt;raw_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.7544,-1402.6593C350.7174,-1391.2139 376.5942,-1374.726 396.2896,-1362.1768"/>
<polygon fill="#000000" stroke="#000000" points="398.3004,-1365.0456 404.8532,-1356.7203 394.5389,-1359.1422 398.3004,-1365.0456"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="990.5" cy="-1344.202" rx="27" ry="18"/>
<text text-anchor="middle" x="990.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_4&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1041.5236,-1399.8641C1032.7951,-1390.342 1021.6398,-1378.1727 1011.9871,-1367.6424"/>
<polygon fill="#000000" stroke="#000000" points="1014.3009,-1364.9869 1004.9636,-1359.9804 1009.1408,-1369.717 1014.3009,-1364.9869"/>
</g>
<!-- prespace_19 -->
<g id="node20" class="node">
<title>prespace_19</title>
<ellipse fill="none" stroke="#000000" cx="1190.5" cy="-1344.202" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="1190.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_5&#45;&gt;prespace_19 -->
<g id="edge19" class="edge">
<title>prose_5&#45;&gt;prespace_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1347.7448,-1405.7325C1317.6798,-1393.968 1268.4621,-1374.7089 1233.0942,-1360.8693"/>
<polygon fill="#000000" stroke="#000000" points="1234.1012,-1357.5049 1223.5133,-1357.1202 1231.5503,-1364.0236 1234.1012,-1357.5049"/>
</g>
<!-- literal_20 -->
<g id="node21" class="node">
<title>literal_20</title>
<ellipse fill="none" stroke="#000000" cx="1294.5" cy="-1344.202" rx="31.481" ry="18"/>
<text text-anchor="middle" x="1294.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_5&#45;&gt;literal_20 -->
<g id="edge20" class="edge">
<title>prose_5&#45;&gt;literal_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1357.1412,-1400.579C1346.0583,-1390.6044 1331.5177,-1377.5179 1319.2358,-1366.4642"/>
<polygon fill="#000000" stroke="#000000" points="1321.3245,-1363.6352 1311.5501,-1359.5471 1316.6417,-1368.8383 1321.3245,-1363.6352"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1374.5" cy="-1344.202" rx="27" ry="18"/>
<text text-anchor="middle" x="1374.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_5&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1374.5,-1398.0333C1374.5,-1390.3329 1374.5,-1381.1763 1374.5,-1372.6186"/>
<polygon fill="#000000" stroke="#000000" points="1378.0001,-1372.6152 1374.5,-1362.6152 1371.0001,-1372.6153 1378.0001,-1372.6152"/>
</g>
<!-- prespace_22 -->
<g id="node23" class="node">
<title>prespace_22</title>
<ellipse fill="none" stroke="#000000" cx="1465.5" cy="-1344.202" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="1465.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_5&#45;&gt;prespace_22 -->
<g id="edge22" class="edge">
<title>prose_5&#45;&gt;prespace_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1393.3553,-1401.2835C1405.8886,-1391.367 1422.5865,-1378.1555 1436.7614,-1366.9402"/>
<polygon fill="#000000" stroke="#000000" points="1439.0948,-1369.5571 1444.7653,-1360.6074 1434.7514,-1364.0675 1439.0948,-1369.5571"/>
</g>
<!-- literal_23 -->
<g id="node24" class="node">
<title>literal_23</title>
<ellipse fill="none" stroke="#000000" cx="1561.5" cy="-1344.202" rx="31.481" ry="18"/>
<text text-anchor="middle" x="1561.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_5&#45;&gt;literal_23 -->
<g id="edge23" class="edge">
<title>prose_5&#45;&gt;literal_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1401.863,-1406.6296C1431.3398,-1396.1905 1479.531,-1378.7546 1520.5,-1362.202 1522.8335,-1361.2592 1525.2325,-1360.2669 1527.6432,-1359.2529"/>
<polygon fill="#000000" stroke="#000000" points="1529.0721,-1362.4484 1536.8845,-1355.2918 1526.3143,-1356.0145 1529.0721,-1362.4484"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1699.5" cy="-1344.202" rx="27" ry="18"/>
<text text-anchor="middle" x="1699.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_5&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1404.4927,-1409.5574C1464.4812,-1396.2677 1599.0157,-1366.4631 1663.584,-1352.1587"/>
<polygon fill="#000000" stroke="#000000" points="1664.6859,-1355.4996 1673.6921,-1349.9194 1663.1718,-1348.6653 1664.6859,-1355.4996"/>
</g>
<!-- header_31 -->
<g id="node32" class="node">
<title>header_31</title>
<ellipse fill="none" stroke="#000000" cx="2001.5" cy="-1344.202" rx="78.8574" ry="18"/>
<text text-anchor="middle" x="2001.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Instance fields</text>
</g>
<!-- section_6&#45;&gt;header_31 -->
<g id="edge31" class="edge">
<title>section_6&#45;&gt;header_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2171.3162,-1402.1487C2138.2095,-1390.8517 2091.4387,-1374.8919 2055.3615,-1362.5812"/>
<polygon fill="#000000" stroke="#000000" points="2056.0842,-1359.1298 2045.4897,-1359.2127 2053.8235,-1365.7547 2056.0842,-1359.1298"/>
</g>
<!-- prose_32 -->
<g id="node33" class="node">
<title>prose_32</title>
<ellipse fill="none" stroke="#000000" cx="2130.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2130.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_32 -->
<g id="edge32" class="edge">
<title>section_6&#45;&gt;prose_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2192.6501,-1398.7728C2181.5588,-1389.0341 2167.6239,-1376.7985 2155.7613,-1366.3826"/>
<polygon fill="#000000" stroke="#000000" points="2157.764,-1363.4834 2147.9403,-1359.5154 2153.1454,-1368.7435 2157.764,-1363.4834"/>
</g>
<!-- prose_33 -->
<g id="node34" class="node">
<title>prose_33</title>
<ellipse fill="none" stroke="#000000" cx="2212.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2212.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_33 -->
<g id="edge33" class="edge">
<title>section_6&#45;&gt;prose_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2212.5,-1398.0333C2212.5,-1390.3329 2212.5,-1381.1763 2212.5,-1372.6186"/>
<polygon fill="#000000" stroke="#000000" points="2216.0001,-1372.6152 2212.5,-1362.6152 2209.0001,-1372.6153 2216.0001,-1372.6152"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="2352.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2352.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_6&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2243.5705,-1400.2228C2266.0856,-1388.6437 2296.4792,-1373.0127 2319.4406,-1361.204"/>
<polygon fill="#000000" stroke="#000000" points="2321.1758,-1364.2473 2328.468,-1356.5613 2317.9743,-1358.0223 2321.1758,-1364.2473"/>
</g>
<!-- prose_35 -->
<g id="node36" class="node">
<title>prose_35</title>
<ellipse fill="none" stroke="#000000" cx="2634.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2634.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_35 -->
<g id="edge35" class="edge">
<title>section_6&#45;&gt;prose_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2268.5383,-1406.6409C2354.6194,-1391.9541 2517.3892,-1364.183 2593.4263,-1351.2098"/>
<polygon fill="#000000" stroke="#000000" points="2594.294,-1354.6124 2603.5629,-1349.4803 2593.1167,-1347.7121 2594.294,-1354.6124"/>
</g>
<!-- section_36 -->
<g id="node37" class="node">
<title>section_36</title>
<ellipse fill="none" stroke="#000000" cx="3589.5" cy="-1344.202" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="3589.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 28&#45;52</text>
</g>
<!-- section_6&#45;&gt;section_36 -->
<g id="edge36" class="edge">
<title>section_6&#45;&gt;section_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2277.0686,-1412.8258C2504.9584,-1400.91 3270.9791,-1360.8567 3514.505,-1348.1233"/>
<polygon fill="#000000" stroke="#000000" points="3514.8686,-1351.6091 3524.6721,-1347.5917 3514.503,-1344.6187 3514.8686,-1351.6091"/>
</g>
<!-- header_63 -->
<g id="node64" class="node">
<title>header_63</title>
<ellipse fill="none" stroke="#000000" cx="4419.5" cy="-1344.202" rx="127.6874" ry="18"/>
<text text-anchor="middle" x="4419.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Linebuf.insert(linebuf, frag)</text>
</g>
<!-- section_7&#45;&gt;header_63 -->
<g id="edge63" class="edge">
<title>section_7&#45;&gt;header_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4892.534,-1408.2216C4803.0752,-1396.1144 4631.856,-1372.9419 4521.8024,-1358.0474"/>
<polygon fill="#000000" stroke="#000000" points="4522.0576,-1354.5501 4511.6785,-1356.6773 4521.1187,-1361.4869 4522.0576,-1354.5501"/>
</g>
<!-- prose_64 -->
<g id="node65" class="node">
<title>prose_64</title>
<ellipse fill="none" stroke="#000000" cx="4684.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4684.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_64 -->
<g id="edge64" class="edge">
<title>section_7&#45;&gt;prose_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4904.6866,-1403.5781C4853.3036,-1389.722 4771.7356,-1367.7262 4723.6282,-1354.7534"/>
<polygon fill="#000000" stroke="#000000" points="4724.4599,-1351.3527 4713.8934,-1352.1283 4722.6373,-1358.1113 4724.4599,-1351.3527"/>
</g>
<!-- prose_65 -->
<g id="node66" class="node">
<title>prose_65</title>
<ellipse fill="none" stroke="#000000" cx="5218.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5218.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_65 -->
<g id="edge65" class="edge">
<title>section_7&#45;&gt;prose_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4998.3134,-1403.5781C5049.6964,-1389.722 5131.2644,-1367.7262 5179.3718,-1354.7534"/>
<polygon fill="#000000" stroke="#000000" points="5180.3627,-1358.1113 5189.1066,-1352.1283 5178.5401,-1351.3527 5180.3627,-1358.1113"/>
</g>
<!-- prose_66 -->
<g id="node67" class="node">
<title>prose_66</title>
<ellipse fill="none" stroke="#000000" cx="5557.5" cy="-1344.202" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5557.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_7&#45;&gt;prose_66 -->
<g id="edge66" class="edge">
<title>section_7&#45;&gt;prose_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5011.8211,-1409.0351C5134.5419,-1394.4544 5410.5387,-1361.6627 5515.7124,-1349.1668"/>
<polygon fill="#000000" stroke="#000000" points="5516.4137,-1352.6082 5525.9309,-1347.9528 5515.5878,-1345.6571 5516.4137,-1352.6082"/>
</g>
<!-- section_67 -->
<g id="node68" class="node">
<title>section_67</title>
<ellipse fill="none" stroke="#000000" cx="7128.5" cy="-1344.202" rx="70.655" ry="18"/>
<text text-anchor="middle" x="7128.5" y="-1340.002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 64&#45;181</text>
</g>
<!-- section_7&#45;&gt;section_67 -->
<g id="edge67" class="edge">
<title>section_7&#45;&gt;section_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5016.9495,-1414.0374C5333.0477,-1403.583 6700.6413,-1358.3526 7048.0202,-1346.8637"/>
<polygon fill="#000000" stroke="#000000" points="7048.3633,-1350.3543 7058.2422,-1346.5256 7048.1319,-1343.3582 7048.3633,-1350.3543"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="132.5,-1290.4031 78.5,-1290.4031 78.5,-1218.6008 132.5,-1218.6008 132.5,-1290.4031"/>
<text text-anchor="middle" x="105.5" y="-1227.002" font-family="Inconsolata" font-size="14.00" fill="#000000">The</text>
</g>
<!-- raw_9&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>raw_9&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M120.6551,-1326.0498C119.0624,-1318.5309 117.1364,-1309.438 115.1993,-1300.293"/>
<polygon fill="#000000" stroke="#000000" points="118.6046,-1299.4788 113.1083,-1290.4211 111.7565,-1300.9294 118.6046,-1299.4788"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="204.5,-1272.502 150.5,-1272.502 150.5,-1236.502 204.5,-1236.502 204.5,-1272.502"/>
<text text-anchor="middle" x="177.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_10&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>prespace_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M207.8101,-1326.0498C202.4535,-1313.4053 195.211,-1296.3093 189.149,-1281.9997"/>
<polygon fill="#000000" stroke="#000000" points="192.302,-1280.4696 185.1784,-1272.6271 185.8565,-1283.2002 192.302,-1280.4696"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="288,-1272.502 223,-1272.502 223,-1236.502 288,-1236.502 288,-1272.502"/>
<text text-anchor="middle" x="255.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000">linebuf</text>
</g>
<!-- literal_11&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>literal_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M300.7026,-1326.9069C292.6486,-1314.0061 281.4942,-1296.139 272.2812,-1281.3819"/>
<polygon fill="#000000" stroke="#000000" points="275.1056,-1279.2967 266.8409,-1272.6676 269.1677,-1283.0038 275.1056,-1279.2967"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="581,-1272.502 306,-1272.502 306,-1236.502 581,-1236.502 581,-1272.502"/>
<text text-anchor="middle" x="443.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> class buffers a single line of text.</text>
</g>
<!-- raw_12&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_12&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M428.3449,-1326.0498C430.9975,-1313.5268 434.5749,-1296.6377 437.5879,-1282.4132"/>
<polygon fill="#000000" stroke="#000000" points="441.0125,-1283.1353 439.6608,-1272.6271 434.1645,-1281.6847 441.0125,-1283.1353"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1140,-1281.8024 599,-1281.8024 599,-1227.2015 1140,-1227.2015 1140,-1281.8024"/>
<text text-anchor="middle" x="869.5" y="-1250.702" font-family="Inconsolata" font-size="14.00" fill="#000000">To make editing practical, we model the line as an array of codepoints when</text>
<text text-anchor="middle" x="869.5" y="-1235.302" font-family="Inconsolata" font-size="14.00" fill="#000000">active, and a simple string otherwise.</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M972.3851,-1330.773C957.2037,-1319.5187 934.8667,-1302.9598 914.8815,-1288.1443"/>
<polygon fill="#000000" stroke="#000000" points="916.8974,-1285.2819 906.7797,-1282.1382 912.7287,-1290.9052 916.8974,-1285.2819"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1212.5,-1272.502 1158.5,-1272.502 1158.5,-1236.502 1212.5,-1236.502 1212.5,-1272.502"/>
</g>
<!-- prespace_19&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>prespace_19&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.4882,-1326.0498C1188.7969,-1313.6484 1187.867,-1296.9652 1187.0789,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="1190.5615,-1282.4168 1186.5103,-1272.6271 1183.5724,-1282.8064 1190.5615,-1282.4168"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1296,-1272.502 1231,-1272.502 1231,-1236.502 1296,-1236.502 1296,-1272.502"/>
<text text-anchor="middle" x="1263.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000">linebuf</text>
</g>
<!-- literal_20&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>literal_20&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1288.3754,-1326.4801C1284.0589,-1313.9902 1278.1887,-1297.0043 1273.2347,-1282.6698"/>
<polygon fill="#000000" stroke="#000000" points="1276.3992,-1281.111 1269.8247,-1272.8028 1269.7832,-1283.3976 1276.3992,-1281.111"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="1442.5,-1272.502 1314.5,-1272.502 1314.5,-1236.502 1442.5,-1236.502 1442.5,-1272.502"/>
<text text-anchor="middle" x="1378.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> are promoted to</text>
</g>
<!-- raw_21&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>raw_21&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1375.3095,-1326.0498C1375.8625,-1313.6484 1376.6064,-1296.9652 1377.2368,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="1380.7427,-1282.7731 1377.6917,-1272.6271 1373.7496,-1282.4612 1380.7427,-1282.7731"/>
</g>
<!-- leaf_28 -->
<g id="node29" class="node">
<title>leaf_28</title>
<polygon fill="none" stroke="#c0c0c0" points="1514.5,-1272.502 1460.5,-1272.502 1460.5,-1236.502 1514.5,-1236.502 1514.5,-1272.502"/>
<text text-anchor="middle" x="1487.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_22&#45;&gt;leaf_28 -->
<g id="edge28" class="edge">
<title>prespace_22&#45;&gt;leaf_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1469.952,-1326.0498C1473.0234,-1313.5268 1477.1657,-1296.6377 1480.6544,-1282.4132"/>
<polygon fill="#000000" stroke="#000000" points="1484.0718,-1283.173 1483.0546,-1272.6271 1477.2732,-1281.5055 1484.0718,-1283.173"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="1590.5,-1272.502 1532.5,-1272.502 1532.5,-1236.502 1590.5,-1236.502 1590.5,-1272.502"/>
<text text-anchor="middle" x="1561.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000">txtbuf</text>
</g>
<!-- literal_23&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>literal_23&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1561.5,-1326.0498C1561.5,-1313.6484 1561.5,-1296.9652 1561.5,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="1565.0001,-1282.6271 1561.5,-1272.6271 1558.0001,-1282.6271 1565.0001,-1282.6271"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="1912,-1274.404 1609,-1274.404 1609,-1234.5999 1912,-1234.5999 1912,-1274.404"/>
<text text-anchor="middle" x="1760.5" y="-1259.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> if editing needs to span multiple lines.</text>
</g>
<!-- raw_24&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>raw_24&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1710.6883,-1327.7496C1719.2564,-1315.1503 1731.2786,-1297.4718 1741.3655,-1282.6391"/>
<polygon fill="#000000" stroke="#000000" points="1744.3109,-1284.5319 1747.0401,-1274.2946 1738.5226,-1280.5955 1744.3109,-1284.5319"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="2072.5,-1272.502 1930.5,-1272.502 1930.5,-1236.502 2072.5,-1236.502 2072.5,-1272.502"/>
<text text-anchor="middle" x="2001.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000">** Instance fields</text>
</g>
<!-- header_31&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>header_31&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2001.5,-1326.0498C2001.5,-1313.6484 2001.5,-1296.9652 2001.5,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="2005.0001,-1282.6271 2001.5,-1272.6271 1998.0001,-1282.6271 2005.0001,-1282.6271"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2117.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="2117.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_32&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_32&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2127.8693,-1326.0498C2126.072,-1313.6484 2123.6541,-1296.9652 2121.6053,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="2125.025,-1282.0217 2120.1268,-1272.6271 2118.0974,-1283.0257 2125.025,-1282.0217"/>
</g>
<!-- raw_40 -->
<g id="node41" class="node">
<title>raw_40</title>
<ellipse fill="none" stroke="#000000" cx="2189.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="2189.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_33&#45;&gt;raw_40 -->
<g id="edge40" class="edge">
<title>prose_33&#45;&gt;raw_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2207.8456,-1326.0498C2204.6135,-1313.4445 2200.247,-1296.4153 2196.5848,-1282.1328"/>
<polygon fill="#000000" stroke="#000000" points="2199.9431,-1281.1383 2194.069,-1272.321 2193.1625,-1282.877 2199.9431,-1281.1383"/>
</g>
<!-- raw_42 -->
<g id="node43" class="node">
<title>raw_42</title>
<ellipse fill="none" stroke="#000000" cx="2261.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="2261.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_42 -->
<g id="edge42" class="edge">
<title>prose_34&#45;&gt;raw_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2336.114,-1328.1558C2325.1671,-1317.4257 2310.4543,-1302.9843 2297.5,-1290.202 2293.0848,-1285.8454 2288.3725,-1281.1822 2283.8613,-1276.7112"/>
<polygon fill="#000000" stroke="#000000" points="2286.1116,-1274.0136 2276.5469,-1269.4566 2281.1822,-1278.9837 2286.1116,-1274.0136"/>
</g>
<!-- prespace_43 -->
<g id="node44" class="node">
<title>prespace_43</title>
<ellipse fill="none" stroke="#000000" cx="2352.5" cy="-1254.502" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2352.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_34&#45;&gt;prespace_43 -->
<g id="edge43" class="edge">
<title>prose_34&#45;&gt;prespace_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2352.5,-1326.0498C2352.5,-1313.6484 2352.5,-1296.9652 2352.5,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="2356.0001,-1282.6271 2352.5,-1272.6271 2349.0001,-1282.6271 2356.0001,-1282.6271"/>
</g>
<!-- literal_44 -->
<g id="node45" class="node">
<title>literal_44</title>
<ellipse fill="none" stroke="#000000" cx="2448.5" cy="-1254.502" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2448.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_34&#45;&gt;literal_44 -->
<g id="edge44" class="edge">
<title>prose_34&#45;&gt;literal_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2369.2219,-1328.5774C2384.5019,-1314.3002 2407.2719,-1293.0245 2424.494,-1276.9325"/>
<polygon fill="#000000" stroke="#000000" points="2427.0525,-1279.3321 2431.9697,-1269.9475 2422.2734,-1274.2174 2427.0525,-1279.3321"/>
</g>
<!-- raw_45 -->
<g id="node46" class="node">
<title>raw_45</title>
<ellipse fill="none" stroke="#000000" cx="2572.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="2572.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_45 -->
<g id="edge45" class="edge">
<title>prose_34&#45;&gt;raw_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2379.1567,-1333.835C2406.6313,-1323.099 2450.6692,-1305.7489 2488.5,-1290.202 2505.735,-1283.1191 2524.8604,-1275.0104 2540.5029,-1268.3129"/>
<polygon fill="#000000" stroke="#000000" points="2541.9352,-1271.507 2549.7444,-1264.3469 2539.1746,-1265.0743 2541.9352,-1271.507"/>
</g>
<!-- raw_50 -->
<g id="node51" class="node">
<title>raw_50</title>
<ellipse fill="none" stroke="#000000" cx="2833.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="2833.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_35&#45;&gt;raw_50 -->
<g id="edge50" class="edge">
<title>prose_35&#45;&gt;raw_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2659.7035,-1332.8414C2695.7628,-1316.5875 2762.0687,-1286.6999 2801.5332,-1268.9111"/>
<polygon fill="#000000" stroke="#000000" points="2803.2751,-1271.9651 2810.9535,-1264.6649 2800.3985,-1265.5835 2803.2751,-1271.9651"/>
</g>
<!-- header_52 -->
<g id="node53" class="node">
<title>header_52</title>
<ellipse fill="none" stroke="#000000" cx="3350.5" cy="-1254.502" rx="51.2759" ry="18"/>
<text text-anchor="middle" x="3350.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : imports</text>
</g>
<!-- section_36&#45;&gt;header_52 -->
<g id="edge52" class="edge">
<title>section_36&#45;&gt;header_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3550.5686,-1329.5905C3508.0541,-1313.6342 3440.0729,-1288.1199 3395.3538,-1271.3362"/>
<polygon fill="#000000" stroke="#000000" points="3396.4971,-1268.027 3385.9049,-1267.7899 3394.0374,-1274.5806 3396.4971,-1268.027"/>
</g>
<!-- prose_53 -->
<g id="node54" class="node">
<title>prose_53</title>
<ellipse fill="none" stroke="#000000" cx="3511.5" cy="-1254.502" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3511.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_36&#45;&gt;prose_53 -->
<g id="edge53" class="edge">
<title>section_36&#45;&gt;prose_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3574.0897,-1326.4801C3562.2522,-1312.867 3545.7703,-1293.9128 3532.6912,-1278.8718"/>
<polygon fill="#000000" stroke="#000000" points="3535.0292,-1276.2266 3525.8263,-1270.9772 3529.747,-1280.8199 3535.0292,-1276.2266"/>
</g>
<!-- codeblock_54 -->
<g id="node55" class="node">
<title>codeblock_54</title>
<ellipse fill="none" stroke="#000000" cx="3668.5" cy="-1254.502" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3668.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 30&#45;34</text>
</g>
<!-- section_36&#45;&gt;codeblock_54 -->
<g id="edge54" class="edge">
<title>section_36&#45;&gt;codeblock_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3605.1079,-1326.4801C3616.7936,-1313.2116 3632.9482,-1294.869 3646.0245,-1280.0216"/>
<polygon fill="#000000" stroke="#000000" points="3648.9418,-1282.0047 3652.9246,-1272.187 3643.6887,-1277.3782 3648.9418,-1282.0047"/>
</g>
<!-- codeblock_55 -->
<g id="node56" class="node">
<title>codeblock_55</title>
<ellipse fill="none" stroke="#000000" cx="3890.5" cy="-1254.502" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="3890.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 36&#45;38</text>
</g>
<!-- section_36&#45;&gt;codeblock_55 -->
<g id="edge55" class="edge">
<title>section_36&#45;&gt;codeblock_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3634.2377,-1330.8698C3687.106,-1315.1147 3775.1829,-1288.8672 3833.0514,-1271.622"/>
<polygon fill="#000000" stroke="#000000" points="3834.1948,-1274.9335 3842.7787,-1268.7232 3832.1956,-1268.225 3834.1948,-1274.9335"/>
</g>
<!-- codeblock_56 -->
<g id="node57" class="node">
<title>codeblock_56</title>
<ellipse fill="none" stroke="#000000" cx="4099.5" cy="-1254.502" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="4099.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 40&#45;50</text>
</g>
<!-- section_36&#45;&gt;codeblock_56 -->
<g id="edge56" class="edge">
<title>section_36&#45;&gt;codeblock_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3651.6431,-1338.3145C3728.4951,-1330.3965 3863.0584,-1314.4477 3976.5,-1290.202 3999.1196,-1285.3675 4023.666,-1278.5672 4044.8384,-1272.197"/>
<polygon fill="#000000" stroke="#000000" points="4046.0791,-1275.4778 4054.6227,-1269.2123 4044.0366,-1268.7824 4046.0791,-1275.4778"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="1461.5,-680.4013 899.5,-680.4013 899.5,-593.8007 1461.5,-593.8007 1461.5,-680.4013"/>
<text text-anchor="middle" x="1180.5" y="-617.301" font-family="Inconsolata" font-size="14.00" fill="#000000">Instance fields for a linebuf may be read by other code, but should be written</text>
<text text-anchor="middle" x="1180.5" y="-601.901" font-family="Inconsolata" font-size="14.00" fill="#000000">internally.</text>
</g>
<!-- raw_38&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_38&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2105.6624,-1238.2568C2099.3732,-1230.9533 2090.9836,-1223.0374 2081.5,-1218.8019 1957.3096,-1163.337 1584.9665,-1256.2664 1470.5,-1182.8019 1291.4839,-1067.9096 1215.8093,-803.6608 1190.7814,-690.3159"/>
<polygon fill="#000000" stroke="#000000" points="1194.1876,-689.5078 1188.6522,-680.4739 1187.3459,-690.9879 1194.1876,-689.5078"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="1775.5,-657.0031 1479.5,-657.0031 1479.5,-617.1989 1775.5,-617.1989 1775.5,-657.0031"/>
<text text-anchor="middle" x="1627.5" y="-625.601" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; line &#160;&#160;: &#160;An array of string fragments</text>
</g>
<!-- raw_40&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>raw_40&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2177.2675,-1238.0448C2170.9992,-1230.8809 2162.7412,-1223.1439 2153.5,-1218.8019 2078.9313,-1183.7662 1847.8345,-1235.4968 1784.5,-1182.8019 1623.2166,-1048.6127 1621.5892,-760.3879 1625.628,-666.982"/>
<polygon fill="#000000" stroke="#000000" points="1629.132,-666.9841 1626.1249,-656.825 1622.1404,-666.642 1629.132,-666.9841"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="2307,-664.4014 1794,-664.4014 1794,-609.8006 2307,-609.8006 2307,-664.4014"/>
<text text-anchor="middle" x="2050.5" y="-633.301" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; cursor : &#160;An uint representing the number of bytes to be skipped over</text>
<text text-anchor="middle" x="2050.5" y="-617.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;before executing</text>
</g>
<!-- raw_42&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>raw_42&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2255.4127,-1236.6902C2226.5569,-1152.256 2103.2792,-791.5367 2063.1671,-674.1659"/>
<polygon fill="#000000" stroke="#000000" points="2066.4221,-672.8671 2059.8762,-664.5363 2059.7982,-675.1309 2066.4221,-672.8671"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="2379.5,-655.101 2325.5,-655.101 2325.5,-619.101 2379.5,-619.101 2379.5,-655.101"/>
<text text-anchor="middle" x="2352.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_43&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>prespace_43&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2352.5,-1236.3587C2352.5,-1149.0293 2352.5,-771.8268 2352.5,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="2356.0001,-665.2452 2352.5,-655.2452 2349.0001,-665.2453 2356.0001,-665.2452"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="2469.5,-655.101 2397.5,-655.101 2397.5,-619.101 2469.5,-619.101 2469.5,-655.101"/>
<text text-anchor="middle" x="2433.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">insert()</text>
</g>
<!-- literal_44&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>literal_44&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2448.0592,-1236.3587C2445.9375,-1149.0293 2436.7732,-771.8268 2434.1838,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="2437.6828,-665.1572 2433.9408,-655.2452 2430.6848,-665.3273 2437.6828,-665.1572"/>
</g>
<!-- leaf_49 -->
<g id="node50" class="node">
<title>leaf_49</title>
<polygon fill="none" stroke="#c0c0c0" points="2755.5,-656.4016 2487.5,-656.4016 2487.5,-617.8004 2755.5,-617.8004 2755.5,-656.4016"/>
<text text-anchor="middle" x="2621.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000">. &#160;Not 1&#45;1 the same as the column</text>
<text text-anchor="middle" x="2621.5" y="-625.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;index of the tty cursor.</text>
</g>
<!-- raw_45&#45;&gt;leaf_49 -->
<g id="edge49" class="edge">
<title>raw_45&#45;&gt;leaf_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2573.9399,-1236.3587C2580.8403,-1149.4144 2610.5439,-775.1482 2619.1531,-666.6719"/>
<polygon fill="#000000" stroke="#000000" points="2622.6615,-666.704 2619.9637,-656.4584 2615.6834,-666.1501 2622.6615,-666.704"/>
</g>
<!-- leaf_51 -->
<g id="node52" class="node">
<title>leaf_51</title>
<polygon fill="none" stroke="#c0c0c0" points="3273,-672.4013 2774,-672.4013 2774,-601.8006 3273,-601.8006 3273,-672.4013"/>
<text text-anchor="middle" x="3023.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursor is moved by linebuf, ensuring we stay on codepoint</text>
<text text-anchor="middle" x="3023.5" y="-625.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;boundaries.</text>
</g>
<!-- raw_50&#45;&gt;leaf_51 -->
<g id="edge51" class="edge">
<title>raw_50&#45;&gt;leaf_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2838.9814,-1236.6902C2864.3956,-1154.1075 2971.146,-807.2241 3009.611,-682.2328"/>
<polygon fill="#000000" stroke="#000000" points="3012.9867,-683.1631 3012.5829,-672.5759 3006.2963,-681.1041 3012.9867,-683.1631"/>
</g>
<!-- leaf_57 -->
<g id="node58" class="node">
<title>leaf_57</title>
<polygon fill="none" stroke="#c0c0c0" points="3391.5,-655.101 3291.5,-655.101 3291.5,-619.101 3391.5,-619.101 3391.5,-655.101"/>
<text text-anchor="middle" x="3341.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">**** imports</text>
</g>
<!-- header_52&#45;&gt;leaf_57 -->
<g id="edge57" class="edge">
<title>header_52&#45;&gt;leaf_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3350.2355,-1236.3587C3348.9625,-1149.0293 3343.4639,-771.8268 3341.9103,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="3345.41,-665.1931 3341.7645,-655.2452 3338.4107,-665.2952 3345.41,-665.1931"/>
</g>
<!-- raw_58 -->
<g id="node59" class="node">
<title>raw_58</title>
<ellipse fill="none" stroke="#000000" cx="3436.5" cy="-637.101" rx="27" ry="18"/>
<text text-anchor="middle" x="3436.5" y="-632.901" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_53&#45;&gt;raw_58 -->
<g id="edge58" class="edge">
<title>prose_53&#45;&gt;raw_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3499.6494,-1237.7412C3490.4594,-1223.7621 3478.3365,-1202.9453 3472.5,-1182.8019 3417.1192,-991.667 3428.2898,-747.7243 3434.1601,-665.5576"/>
<polygon fill="#000000" stroke="#000000" points="3437.6576,-665.7209 3434.9122,-655.488 3430.677,-665.1995 3437.6576,-665.7209"/>
</g>
<!-- leaf_60 -->
<g id="node61" class="node">
<title>leaf_60</title>
<polygon fill="none" stroke="#c0c0c0" points="3897,-664.3014 3482,-664.3014 3482,-609.9005 3897,-609.9005 3897,-664.3014"/>
<text text-anchor="middle" x="3689.5" y="-649.001" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub, byte = assert(string.sub), assert(string.byte)</text>
<text text-anchor="middle" x="3689.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = assert(string.gsub)</text>
<text text-anchor="middle" x="3689.5" y="-618.201" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(meta, &quot;linebuf requires meta&quot;)</text>
</g>
<!-- codeblock_54&#45;&gt;leaf_60 -->
<g id="edge60" class="edge">
<title>codeblock_54&#45;&gt;leaf_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3669.1171,-1236.3587C3672.0045,-1151.4688 3684.2084,-792.6743 3688.2178,-674.7991"/>
<polygon fill="#000000" stroke="#000000" points="3691.7267,-674.5927 3688.5688,-664.4795 3684.7308,-674.3547 3691.7267,-674.5927"/>
</g>
<!-- leaf_61 -->
<g id="node62" class="node">
<title>leaf_61</title>
<polygon fill="none" stroke="#c0c0c0" points="4092,-655.101 3915,-655.101 3915,-619.101 4092,-619.101 4092,-655.101"/>
<text text-anchor="middle" x="4003.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = meta {}</text>
</g>
<!-- codeblock_55&#45;&gt;leaf_61 -->
<g id="edge61" class="edge">
<title>codeblock_55&#45;&gt;leaf_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3894.4663,-1236.2597C3897.5769,-1221.7861 3901.9576,-1201.0283 3905.5,-1182.8019 3943.9012,-985.2182 3984.9555,-746.3158 3998.7062,-665.43"/>
<polygon fill="#000000" stroke="#000000" points="4002.1673,-665.9535 4000.3905,-655.5088 3995.2661,-664.7819 4002.1673,-665.9535"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="4413,-710.8014 4110,-710.8014 4110,-563.4006 4413,-563.4006 4413,-710.8014"/>
<text text-anchor="middle" x="4261.5" y="-695.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = table.concat</text>
<text text-anchor="middle" x="4261.5" y="-664.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.__tostring(linebuf)</text>
<text text-anchor="middle" x="4261.5" y="-648.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if type(linebuf.lines) == &quot;table&quot; then</text>
<text text-anchor="middle" x="4261.5" y="-633.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return concat(linebuf.lines)</text>
<text text-anchor="middle" x="4261.5" y="-617.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="4261.5" y="-602.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf.lines</text>
<text text-anchor="middle" x="4261.5" y="-587.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4261.5" y="-571.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_56&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>codeblock_56&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4104.2606,-1236.3587C4124.1343,-1160.6176 4201.2215,-866.8294 4239.5748,-720.6606"/>
<polygon fill="#000000" stroke="#000000" points="4243.0033,-721.3841 4242.156,-710.8233 4236.2325,-719.6075 4243.0033,-721.3841"/>
</g>
<!-- leaf_59 -->
<g id="node60" class="node">
<title>leaf_59</title>
<polygon fill="none" stroke="#c0c0c0" points="3463.5,-45.7 3409.5,-45.7 3409.5,-9.7 3463.5,-9.7 3463.5,-45.7"/>
</g>
<!-- raw_58&#45;&gt;leaf_59 -->
<g id="edge59" class="edge">
<title>raw_58&#45;&gt;leaf_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3436.5,-618.8628C3436.5,-532.2167 3436.5,-161.9787 3436.5,-56.0914"/>
<polygon fill="#000000" stroke="#000000" points="3440.0001,-55.867 3436.5,-45.867 3433.0001,-55.8671 3440.0001,-55.867"/>
</g>
<!-- leaf_68 -->
<g id="node69" class="node">
<title>leaf_68</title>
<polygon fill="none" stroke="#c0c0c0" points="4452.5,-1272.502 4212.5,-1272.502 4212.5,-1236.502 4452.5,-1236.502 4452.5,-1272.502"/>
<text text-anchor="middle" x="4332.5" y="-1251.002" font-family="Inconsolata" font-size="14.00" fill="#000000">** Linebuf.insert(linebuf, frag)</text>
</g>
<!-- header_63&#45;&gt;leaf_68 -->
<g id="edge68" class="edge">
<title>header_63&#45;&gt;leaf_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4401.8943,-1326.0498C4389.0407,-1312.7973 4371.4446,-1294.6552 4357.1878,-1279.9559"/>
<polygon fill="#000000" stroke="#000000" points="4359.5542,-1277.3686 4350.0796,-1272.6271 4354.5294,-1282.2422 4359.5542,-1277.3686"/>
</g>
<!-- raw_69 -->
<g id="node70" class="node">
<title>raw_69</title>
<ellipse fill="none" stroke="#000000" cx="4497.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="4497.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_64&#45;&gt;raw_69 -->
<g id="edge69" class="edge">
<title>prose_64&#45;&gt;raw_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4654.3956,-1337.5796C4622.612,-1329.6735 4571.8931,-1314.3973 4533.5,-1290.202 4527.9289,-1286.6911 4522.5395,-1282.1834 4517.7014,-1277.5613"/>
<polygon fill="#000000" stroke="#000000" points="4520.1078,-1275.0164 4510.6055,-1270.3306 4515.1117,-1279.9194 4520.1078,-1275.0164"/>
</g>
<!-- prespace_70 -->
<g id="node71" class="node">
<title>prespace_70</title>
<ellipse fill="none" stroke="#000000" cx="4588.5" cy="-1254.502" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="4588.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_64&#45;&gt;prespace_70 -->
<g id="edge70" class="edge">
<title>prose_64&#45;&gt;prespace_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4667.7781,-1328.5774C4652.8708,-1314.6484 4630.8344,-1294.0581 4613.7758,-1278.1191"/>
<polygon fill="#000000" stroke="#000000" points="4616.0282,-1275.4335 4606.3319,-1271.1636 4611.2491,-1280.5483 4616.0282,-1275.4335"/>
</g>
<!-- literal_71 -->
<g id="node72" class="node">
<title>literal_71</title>
<ellipse fill="none" stroke="#000000" cx="4684.5" cy="-1254.502" rx="31.481" ry="18"/>
<text text-anchor="middle" x="4684.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_64&#45;&gt;literal_71 -->
<g id="edge71" class="edge">
<title>prose_64&#45;&gt;literal_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4684.5,-1326.0498C4684.5,-1313.6484 4684.5,-1296.9652 4684.5,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="4688.0001,-1282.6271 4684.5,-1272.6271 4681.0001,-1282.6271 4688.0001,-1282.6271"/>
</g>
<!-- raw_72 -->
<g id="node73" class="node">
<title>raw_72</title>
<ellipse fill="none" stroke="#000000" cx="4837.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="4837.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_64&#45;&gt;raw_72 -->
<g id="edge72" class="edge">
<title>prose_64&#45;&gt;raw_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4706.7475,-1331.1588C4733.6367,-1315.3944 4778.9498,-1288.8284 4808.5407,-1271.48"/>
<polygon fill="#000000" stroke="#000000" points="4810.325,-1274.4912 4817.1815,-1266.4141 4806.7846,-1268.4525 4810.325,-1274.4912"/>
</g>
<!-- raw_77 -->
<g id="node78" class="node">
<title>raw_77</title>
<ellipse fill="none" stroke="#000000" cx="5127.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="5127.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_65&#45;&gt;raw_77 -->
<g id="edge77" class="edge">
<title>prose_65&#45;&gt;raw_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5202.114,-1328.1558C5191.1671,-1317.4257 5176.4543,-1302.9843 5163.5,-1290.202 5159.0848,-1285.8454 5154.3725,-1281.1822 5149.8613,-1276.7112"/>
<polygon fill="#000000" stroke="#000000" points="5152.1116,-1274.0136 5142.5469,-1269.4566 5147.1822,-1278.9837 5152.1116,-1274.0136"/>
</g>
<!-- prespace_78 -->
<g id="node79" class="node">
<title>prespace_78</title>
<ellipse fill="none" stroke="#000000" cx="5218.5" cy="-1254.502" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5218.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_65&#45;&gt;prespace_78 -->
<g id="edge78" class="edge">
<title>prose_65&#45;&gt;prespace_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5218.5,-1326.0498C5218.5,-1313.6484 5218.5,-1296.9652 5218.5,-1282.8283"/>
<polygon fill="#000000" stroke="#000000" points="5222.0001,-1282.6271 5218.5,-1272.6271 5215.0001,-1282.6271 5222.0001,-1282.6271"/>
</g>
<!-- literal_79 -->
<g id="node80" class="node">
<title>literal_79</title>
<ellipse fill="none" stroke="#000000" cx="5314.5" cy="-1254.502" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5314.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_65&#45;&gt;literal_79 -->
<g id="edge79" class="edge">
<title>prose_65&#45;&gt;literal_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5235.2219,-1328.5774C5250.5019,-1314.3002 5273.2719,-1293.0245 5290.494,-1276.9325"/>
<polygon fill="#000000" stroke="#000000" points="5293.0525,-1279.3321 5297.9697,-1269.9475 5288.2734,-1274.2174 5293.0525,-1279.3321"/>
</g>
<!-- raw_80 -->
<g id="node81" class="node">
<title>raw_80</title>
<ellipse fill="none" stroke="#000000" cx="5477.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="5477.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_65&#45;&gt;raw_80 -->
<g id="edge80" class="edge">
<title>prose_65&#45;&gt;raw_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5246.2175,-1334.6025C5294.0532,-1318.0355 5391.943,-1284.1331 5443.6958,-1266.2094"/>
<polygon fill="#000000" stroke="#000000" points="5445.0988,-1269.4275 5453.4027,-1262.8476 5442.808,-1262.813 5445.0988,-1269.4275"/>
</g>
<!-- raw_85 -->
<g id="node86" class="node">
<title>raw_85</title>
<ellipse fill="none" stroke="#000000" cx="5814.5" cy="-1254.502" rx="27" ry="18"/>
<text text-anchor="middle" x="5814.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_66&#45;&gt;raw_85 -->
<g id="edge85" class="edge">
<title>prose_66&#45;&gt;raw_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5585.0035,-1334.6025C5632.3484,-1318.0778 5729.1071,-1284.3064 5780.562,-1266.3473"/>
<polygon fill="#000000" stroke="#000000" points="5781.9327,-1269.5759 5790.2208,-1262.9761 5779.626,-1262.9669 5781.9327,-1269.5759"/>
</g>
<!-- header_87 -->
<g id="node88" class="node">
<title>header_87</title>
<ellipse fill="none" stroke="#000000" cx="6566.5" cy="-1254.502" rx="83.677" ry="18"/>
<text text-anchor="middle" x="6566.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : join(token, frag)</text>
</g>
<!-- section_67&#45;&gt;header_87 -->
<g id="edge87" class="edge">
<title>section_67&#45;&gt;header_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7064.6237,-1336.5334C6987.7426,-1327.0167 6854.8297,-1309.6487 6741.5,-1290.202 6706.3399,-1284.1687 6667.4378,-1276.3479 6635.2583,-1269.5649"/>
<polygon fill="#000000" stroke="#000000" points="6635.5685,-1266.0529 6625.06,-1267.4026 6634.1165,-1272.9007 6635.5685,-1266.0529"/>
</g>
<!-- prose_88 -->
<g id="node89" class="node">
<title>prose_88</title>
<ellipse fill="none" stroke="#000000" cx="6782.5" cy="-1254.502" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="6782.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_67&#45;&gt;prose_88 -->
<g id="edge88" class="edge">
<title>section_67&#45;&gt;prose_88</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7067.0181,-1335.2192C7013.1382,-1326.4903 6933.0944,-1311.4343 6865.5,-1290.202 6848.8045,-1284.9577 6830.8976,-1277.5043 6816.0059,-1270.7632"/>
<polygon fill="#000000" stroke="#000000" points="6817.2446,-1267.4801 6806.6984,-1266.4665 6814.3107,-1273.8356 6817.2446,-1267.4801"/>
</g>
<!-- codeblock_89 -->
<g id="node90" class="node">
<title>codeblock_89</title>
<ellipse fill="none" stroke="#000000" cx="6956.5" cy="-1254.502" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="6956.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 68&#45;139</text>
</g>
<!-- section_67&#45;&gt;codeblock_89 -->
<g id="edge89" class="edge">
<title>section_67&#45;&gt;codeblock_89</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7097.3521,-1327.958C7069.4533,-1313.4084 7028.3365,-1291.9655 6997.7206,-1275.999"/>
<polygon fill="#000000" stroke="#000000" points="6999.0676,-1272.7541 6988.5824,-1271.2333 6995.8307,-1278.9608 6999.0676,-1272.7541"/>
</g>
<!-- codeblock_90 -->
<g id="node91" class="node">
<title>codeblock_90</title>
<ellipse fill="none" stroke="#000000" cx="7301.5" cy="-1254.502" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7301.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 143&#45;156</text>
</g>
<!-- section_67&#45;&gt;codeblock_90 -->
<g id="edge90" class="edge">
<title>section_67&#45;&gt;codeblock_90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7159.829,-1327.958C7187.89,-1313.4084 7229.2458,-1291.9655 7260.0398,-1275.999"/>
<polygon fill="#000000" stroke="#000000" points="7261.9645,-1278.9436 7269.231,-1271.2333 7258.7423,-1272.7292 7261.9645,-1278.9436"/>
</g>
<!-- codeblock_91 -->
<g id="node92" class="node">
<title>codeblock_91</title>
<ellipse fill="none" stroke="#000000" cx="7635.5" cy="-1254.502" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7635.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 158&#45;168</text>
</g>
<!-- section_67&#45;&gt;codeblock_91 -->
<g id="edge91" class="edge">
<title>section_67&#45;&gt;codeblock_91</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7186.6593,-1333.9122C7278.5373,-1317.6569 7457.2804,-1286.0331 7559.2967,-1267.9841"/>
<polygon fill="#000000" stroke="#000000" points="7559.9895,-1271.416 7569.2267,-1266.2272 7558.7699,-1264.523 7559.9895,-1271.416"/>
</g>
<!-- codeblock_92 -->
<g id="node93" class="node">
<title>codeblock_92</title>
<ellipse fill="none" stroke="#000000" cx="7959.5" cy="-1254.502" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="7959.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 170&#45;177</text>
</g>
<!-- section_67&#45;&gt;codeblock_92 -->
<g id="edge92" class="edge">
<title>section_67&#45;&gt;codeblock_92</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7196.9306,-1339.5519C7308.9237,-1331.6099 7538.2451,-1313.9587 7731.5,-1290.202 7782.0428,-1283.9888 7838.5992,-1275.1452 7882.7394,-1267.8146"/>
<polygon fill="#000000" stroke="#000000" points="7883.5328,-1271.2307 7892.8196,-1266.1311 7882.3796,-1264.3263 7883.5328,-1271.2307"/>
</g>
<!-- codeblock_93 -->
<g id="node94" class="node">
<title>codeblock_93</title>
<ellipse fill="none" stroke="#000000" cx="8289.5" cy="-1254.502" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="8289.5" y="-1250.302" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 179&#45;181</text>
</g>
<!-- section_67&#45;&gt;codeblock_93 -->
<g id="edge93" class="edge">
<title>section_67&#45;&gt;codeblock_93</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7198.7459,-1342.345C7353.7529,-1337.7577 7736.6517,-1323.7375 8055.5,-1290.202 8108.4094,-1284.6371 8167.6475,-1275.5709 8213.2829,-1267.9677"/>
<polygon fill="#000000" stroke="#000000" points="8214.1127,-1271.3775 8223.3951,-1266.2699 8212.9536,-1264.4741 8214.1127,-1271.3775"/>
</g>
<!-- leaf_73 -->
<g id="node74" class="node">
<title>leaf_73</title>
<polygon fill="none" stroke="#c0c0c0" points="4485.5,-655.101 4431.5,-655.101 4431.5,-619.101 4485.5,-619.101 4485.5,-655.101"/>
</g>
<!-- raw_69&#45;&gt;leaf_73 -->
<g id="edge73" class="edge">
<title>raw_69&#45;&gt;leaf_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4496.3539,-1236.3587C4490.8375,-1149.0293 4467.0104,-771.8268 4460.2779,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="4463.7697,-665.0047 4459.6461,-655.2452 4456.7836,-665.446 4463.7697,-665.0047"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="4557.5,-655.101 4503.5,-655.101 4503.5,-619.101 4557.5,-619.101 4557.5,-655.101"/>
</g>
<!-- prespace_70&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>prespace_70&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4581.7087,-1236.5203C4576.6093,-1222.1905 4569.937,-1201.4989 4566.5,-1182.8019 4530.5959,-987.4842 4529.33,-747.0465 4530.0687,-665.6034"/>
<polygon fill="#000000" stroke="#000000" points="4533.5729,-665.2257 4530.1828,-655.1879 4526.5733,-665.1489 4533.5729,-665.2257"/>
</g>
<!-- leaf_75 -->
<g id="node76" class="node">
<title>leaf_75</title>
<polygon fill="none" stroke="#c0c0c0" points="4633.5,-655.101 4575.5,-655.101 4575.5,-619.101 4633.5,-619.101 4633.5,-655.101"/>
<text text-anchor="middle" x="4604.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">insert</text>
</g>
<!-- literal_71&#45;&gt;leaf_75 -->
<g id="edge75" class="edge">
<title>literal_71&#45;&gt;leaf_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4671.7476,-1237.8778C4661.8563,-1223.978 4648.8037,-1203.2011 4642.5,-1182.8019 4583.7334,-992.6291 4595.7216,-748.0732 4601.9996,-665.6524"/>
<polygon fill="#000000" stroke="#000000" points="4605.4991,-665.7972 4602.8038,-655.551 4598.5212,-665.2417 4605.4991,-665.7972"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="5101.5,-655.101 4651.5,-655.101 4651.5,-619.101 5101.5,-619.101 5101.5,-655.101"/>
<text text-anchor="middle" x="4876.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> takes a fragment and carefully places it at the cursor point.</text>
</g>
<!-- raw_72&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>raw_72&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4838.6461,-1236.3587C4844.1625,-1149.0293 4867.9896,-771.8268 4874.7221,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="4878.2164,-665.446 4875.3539,-655.2452 4871.2303,-665.0047 4878.2164,-665.446"/>
</g>
<!-- leaf_81 -->
<g id="node82" class="node">
<title>leaf_81</title>
<polygon fill="none" stroke="#c0c0c0" points="5173.5,-657.0031 5119.5,-657.0031 5119.5,-617.1989 5173.5,-617.1989 5173.5,-657.0031"/>
<text text-anchor="middle" x="5146.5" y="-625.601" font-family="Inconsolata" font-size="14.00" fill="#000000">A</text>
</g>
<!-- raw_77&#45;&gt;leaf_81 -->
<g id="edge81" class="edge">
<title>raw_77&#45;&gt;leaf_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5128.0583,-1236.3587C5130.7281,-1149.607 5142.2007,-776.8046 5145.5677,-667.3965"/>
<polygon fill="#000000" stroke="#000000" points="5149.0759,-667.1814 5145.8852,-657.0784 5142.0792,-666.966 5149.0759,-667.1814"/>
</g>
<!-- leaf_82 -->
<g id="node83" class="node">
<title>leaf_82</title>
<polygon fill="none" stroke="#c0c0c0" points="5245.5,-655.101 5191.5,-655.101 5191.5,-619.101 5245.5,-619.101 5245.5,-655.101"/>
<text text-anchor="middle" x="5218.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_78&#45;&gt;leaf_82 -->
<g id="edge82" class="edge">
<title>prespace_78&#45;&gt;leaf_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5218.5,-1236.3587C5218.5,-1149.0293 5218.5,-771.8268 5218.5,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="5222.0001,-665.2452 5218.5,-655.2452 5215.0001,-665.2453 5222.0001,-665.2452"/>
</g>
<!-- leaf_83 -->
<g id="node84" class="node">
<title>leaf_83</title>
<polygon fill="none" stroke="#c0c0c0" points="5317.5,-655.101 5263.5,-655.101 5263.5,-619.101 5317.5,-619.101 5317.5,-655.101"/>
<text text-anchor="middle" x="5290.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">frag</text>
</g>
<!-- literal_79&#45;&gt;leaf_83 -->
<g id="edge83" class="edge">
<title>literal_79&#45;&gt;leaf_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5313.7947,-1236.3587C5310.4,-1149.0293 5295.7371,-771.8268 5291.5941,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="5295.0912,-665.1017 5291.2053,-655.2452 5288.0965,-665.3737 5295.0912,-665.1017"/>
</g>
<!-- leaf_84 -->
<g id="node85" class="node">
<title>leaf_84</title>
<polygon fill="none" stroke="#c0c0c0" points="5793,-655.101 5336,-655.101 5336,-619.101 5793,-619.101 5793,-655.101"/>
<text text-anchor="middle" x="5564.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> is any kind of string that we won&#39;t want to break into pieces.</text>
</g>
<!-- raw_80&#45;&gt;leaf_84 -->
<g id="edge84" class="edge">
<title>raw_80&#45;&gt;leaf_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5480.0566,-1236.3587C5492.3625,-1149.0293 5545.5153,-771.8268 5560.534,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="5564.0136,-665.6358 5561.9432,-655.2452 5557.082,-664.659 5564.0136,-665.6358"/>
</g>
<!-- leaf_86 -->
<g id="node87" class="node">
<title>leaf_86</title>
<polygon fill="none" stroke="#c0c0c0" points="6345.5,-680.3013 5811.5,-680.3013 5811.5,-593.9007 6345.5,-593.9007 6345.5,-680.3013"/>
<text text-anchor="middle" x="6078.5" y="-649.001" font-family="Inconsolata" font-size="14.00" fill="#000000">At first that means pasting long strings will cause syntax highlighting to</text>
<text text-anchor="middle" x="6078.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">fall over. Harmlessly. &#160;Once lexing is working we can trip an interrupt on</text>
<text text-anchor="middle" x="6078.5" y="-618.201" font-family="Inconsolata" font-size="14.00" fill="#000000">long input.</text>
</g>
<!-- raw_85&#45;&gt;leaf_86 -->
<g id="edge86" class="edge">
<title>raw_85&#45;&gt;leaf_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5821.9757,-1237.0189C5856.3581,-1156.611 6000.0017,-820.6802 6056.0058,-689.7068"/>
<polygon fill="#000000" stroke="#000000" points="6059.329,-690.837 6060.0426,-680.2662 6052.8928,-688.0848 6059.329,-690.837"/>
</g>
<!-- leaf_94 -->
<g id="node95" class="node">
<title>leaf_94</title>
<polygon fill="none" stroke="#c0c0c0" points="6527,-655.101 6364,-655.101 6364,-619.101 6527,-619.101 6527,-655.101"/>
<text text-anchor="middle" x="6445.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">*** join(token, frag)</text>
</g>
<!-- header_87&#45;&gt;leaf_94 -->
<g id="edge94" class="edge">
<title>header_87&#45;&gt;leaf_94</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6557.5284,-1236.3551C6550.8258,-1222.1073 6541.9213,-1201.6016 6536.5,-1182.8019 6480.7214,-989.3771 6455.2797,-746.894 6447.8883,-665.3318"/>
<polygon fill="#000000" stroke="#000000" points="6451.3718,-664.9892 6447.0008,-655.338 6444.3992,-665.6085 6451.3718,-664.9892"/>
</g>
<!-- raw_95 -->
<g id="node96" class="node">
<title>raw_95</title>
<ellipse fill="none" stroke="#000000" cx="6572.5" cy="-637.101" rx="27" ry="18"/>
<text text-anchor="middle" x="6572.5" y="-632.901" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_88&#45;&gt;raw_95 -->
<g id="edge95" class="edge">
<title>prose_88&#45;&gt;raw_95</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6753.4773,-1246.5757C6708.7,-1233.7181 6626.0837,-1207.2816 6608.5,-1182.8019 6548.437,-1099.1835 6564.3028,-765.6112 6570.5563,-665.591"/>
<polygon fill="#000000" stroke="#000000" points="6574.0656,-665.5566 6571.2145,-655.3526 6567.0801,-665.1074 6574.0656,-665.5566"/>
</g>
<!-- leaf_97 -->
<g id="node98" class="node">
<title>leaf_97</title>
<polygon fill="none" stroke="#c0c0c0" points="7137.5,-1183.003 6617.5,-1183.003 6617.5,-91.199 7137.5,-91.199 7137.5,-1183.003"/>
<text text-anchor="middle" x="6877.5" y="-1167.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">local function join(token, frag)</text>
<text text-anchor="middle" x="6877.5" y="-1152.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if sub(token, &#45;1) == &quot; &quot; and sub(frag, 1,1) ~= &quot; &quot; then</text>
<text text-anchor="middle" x="6877.5" y="-1136.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return token, frag</text>
<text text-anchor="middle" x="6877.5" y="-1121.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6877.5" y="-1106.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return token .. frag, nil</text>
<text text-anchor="middle" x="6877.5" y="-1090.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6877.5" y="-1075.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6877.5" y="-1043.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">local t_insert, splice = assert(table.insert), assert(table.splice)</text>
<text text-anchor="middle" x="6877.5" y="-1028.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">local utf8, codepoints = string.utf8, string.codepoints</text>
<text text-anchor="middle" x="6877.5" y="-997.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.insert(linebuf, frag)</text>
<text text-anchor="middle" x="6877.5" y="-981.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local line = linebuf.lines</text>
<text text-anchor="middle" x="6877.5" y="-966.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if type(line) == &quot;string&quot; then</text>
<text text-anchor="middle" x="6877.5" y="-950.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;line = codepoints(line)</text>
<text text-anchor="middle" x="6877.5" y="-935.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.lines = line</text>
<text text-anchor="middle" x="6877.5" y="-920.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6877.5" y="-904.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local wide_frag = utf8(frag)</text>
<text text-anchor="middle" x="6877.5" y="-889.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if wide_frag &lt; #frag then &#45;&#45; a paste</text>
<text text-anchor="middle" x="6877.5" y="-873.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Normalize whitespace</text>
<text text-anchor="middle" x="6877.5" y="-858.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;frag = gsub(frag, &quot;\r\n&quot;, &quot;\n&quot;):gsub(&quot;\r&quot;, &quot;\n&quot;):gsub(&quot;\t&quot;, &quot; &#160;&#160;&quot;)</text>
<text text-anchor="middle" x="6877.5" y="-843.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;wide_frag = codepoints(frag)</text>
<text text-anchor="middle" x="6877.5" y="-827.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6877.5" y="-812.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;wide_frag = false</text>
<text text-anchor="middle" x="6877.5" y="-796.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6877.5" y="-781.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not wide_frag then</text>
<text text-anchor="middle" x="6877.5" y="-766.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;t_insert(line, linebuf.cursor, frag)</text>
<text text-anchor="middle" x="6877.5" y="-750.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor + 1</text>
<text text-anchor="middle" x="6877.5" y="-735.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="6877.5" y="-719.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6877.5" y="-704.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;splice(line, linebuf.cursor, wide_frag)</text>
<text text-anchor="middle" x="6877.5" y="-689.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor + #wide_frag</text>
<text text-anchor="middle" x="6877.5" y="-673.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="6877.5" y="-658.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6877.5" y="-626.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="6877.5" y="-611.4009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6877.5" y="-580.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">local remove = table.remove</text>
<text text-anchor="middle" x="6877.5" y="-548.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.d_back(linebuf)</text>
<text text-anchor="middle" x="6877.5" y="-533.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;remove(linebuf.lines, linebuf.cursor &#45; 1)</text>
<text text-anchor="middle" x="6877.5" y="-517.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = linebuf.cursor &gt; 1 and linebuf.cursor &#45; 1 or 1</text>
<text text-anchor="middle" x="6877.5" y="-502.4007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6877.5" y="-455.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.d_fwd(linebuf)</text>
<text text-anchor="middle" x="6877.5" y="-439.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;remove(linebuf.lines, linebuf.cursor)</text>
<text text-anchor="middle" x="6877.5" y="-424.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6877.5" y="-392.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.left(linebuf, disp)</text>
<text text-anchor="middle" x="6877.5" y="-377.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local disp = disp or 1</text>
<text text-anchor="middle" x="6877.5" y="-362.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if linebuf.cursor &#45; disp &gt;= 1 then</text>
<text text-anchor="middle" x="6877.5" y="-346.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor &#45; disp</text>
<text text-anchor="middle" x="6877.5" y="-331.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf.cursor</text>
<text text-anchor="middle" x="6877.5" y="-315.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6877.5" y="-300.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = 1</text>
<text text-anchor="middle" x="6877.5" y="-285.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf.cursor</text>
<text text-anchor="middle" x="6877.5" y="-269.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6877.5" y="-254.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6877.5" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.right(linebuf, disp)</text>
<text text-anchor="middle" x="6877.5" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;disp = disp or 1</text>
<text text-anchor="middle" x="6877.5" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if linebuf.cursor + disp &lt;= #linebuf.lines + 1 then</text>
<text text-anchor="middle" x="6877.5" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = linebuf.cursor + disp</text>
<text text-anchor="middle" x="6877.5" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6877.5" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf.cursor = #linebuf.lines + 1</text>
<text text-anchor="middle" x="6877.5" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6877.5" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf.cursor</text>
<text text-anchor="middle" x="6877.5" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_89&#45;&gt;leaf_97 -->
<g id="edge97" class="edge">
<title>codeblock_89&#45;&gt;leaf_97</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6954.1785,-1236.3587C6952.8282,-1225.8064 6950.9365,-1211.0217 6948.6296,-1192.9935"/>
<polygon fill="#000000" stroke="#000000" points="6952.0874,-1192.4396 6947.3464,-1182.9647 6945.144,-1193.3281 6952.0874,-1192.4396"/>
</g>
<!-- leaf_98 -->
<g id="node99" class="node">
<title>leaf_98</title>
<polygon fill="none" stroke="#c0c0c0" points="7605.5,-734.1013 7155.5,-734.1013 7155.5,-540.1007 7605.5,-540.1007 7605.5,-734.1013"/>
<text text-anchor="middle" x="7380.5" y="-718.9011" font-family="Inconsolata" font-size="14.00" fill="#000000">local cl = assert(table.clone, &quot;table.clone must be provided&quot;)</text>
<text text-anchor="middle" x="7380.5" y="-687.5011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.suspend(linebuf)</text>
<text text-anchor="middle" x="7380.5" y="-672.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.lines = tostring(linebuf)</text>
<text text-anchor="middle" x="7380.5" y="-656.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="7380.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="7380.5" y="-609.901" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.resume(linebuf)</text>
<text text-anchor="middle" x="7380.5" y="-594.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.lines = codepoints(linebuf.lines)</text>
<text text-anchor="middle" x="7380.5" y="-579.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.lines + 1</text>
<text text-anchor="middle" x="7380.5" y="-563.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="7380.5" y="-548.3009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_90&#45;&gt;leaf_98 -->
<g id="edge98" class="edge">
<title>codeblock_90&#45;&gt;leaf_98</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7303.8215,-1236.3587C7313.0085,-1164.5604 7347.2667,-896.8257 7366.7402,-744.6362"/>
<polygon fill="#000000" stroke="#000000" points="7370.2611,-744.6958 7368.0587,-734.3324 7363.3177,-743.8073 7370.2611,-744.6958"/>
</g>
<!-- leaf_99 -->
<g id="node100" class="node">
<title>leaf_99</title>
<polygon fill="none" stroke="#c0c0c0" points="7927,-710.2018 7624,-710.2018 7624,-564.0002 7927,-564.0002 7927,-710.2018"/>
<text text-anchor="middle" x="7775.5" y="-695.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Linebuf.clone(linebuf)</text>
<text text-anchor="middle" x="7775.5" y="-679.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = cl(linebuf)</text>
<text text-anchor="middle" x="7775.5" y="-664.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if type(lb.lines) == &quot;table&quot; then</text>
<text text-anchor="middle" x="7775.5" y="-649.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lb.lines = cl(lb.lines)</text>
<text text-anchor="middle" x="7775.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;elseif type(lb.lines) == &quot;string&quot; then</text>
<text text-anchor="middle" x="7775.5" y="-618.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lb:resume()</text>
<text text-anchor="middle" x="7775.5" y="-602.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="7775.5" y="-587.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return lb</text>
<text text-anchor="middle" x="7775.5" y="-572.0009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_91&#45;&gt;leaf_99 -->
<g id="edge99" class="edge">
<title>codeblock_91&#45;&gt;leaf_99</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7639.6141,-1236.3587C7656.811,-1160.5202 7723.5788,-866.0738 7756.6799,-720.0977"/>
<polygon fill="#000000" stroke="#000000" points="7760.1091,-720.8014 7758.9073,-710.275 7753.2824,-719.2534 7760.1091,-720.8014"/>
</g>
<!-- leaf_100 -->
<g id="node101" class="node">
<title>leaf_100</title>
<polygon fill="none" stroke="#c0c0c0" points="8234,-687.502 7945,-687.502 7945,-586.7 8234,-586.7 8234,-687.502"/>
<text text-anchor="middle" x="8089.5" y="-672.1011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(line)</text>
<text text-anchor="middle" x="8089.5" y="-656.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = meta(Linebuf)</text>
<text text-anchor="middle" x="8089.5" y="-641.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = line and #line or 1</text>
<text text-anchor="middle" x="8089.5" y="-625.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.lines &#160;= line or {}</text>
<text text-anchor="middle" x="8089.5" y="-610.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="8089.5" y="-595.1009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_92&#45;&gt;leaf_100 -->
<g id="edge100" class="edge">
<title>codeblock_92&#45;&gt;leaf_100</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7963.3202,-1236.3587C7980.1775,-1156.2996 8048.3309,-832.6231 8076.8522,-697.1685"/>
<polygon fill="#000000" stroke="#000000" points="8080.2819,-697.8662 8078.9175,-687.3596 8073.4321,-696.4239 8080.2819,-697.8662"/>
</g>
<!-- leaf_101 -->
<g id="node102" class="node">
<title>leaf_101</title>
<polygon fill="none" stroke="#c0c0c0" points="8338.5,-655.101 8252.5,-655.101 8252.5,-619.101 8338.5,-619.101 8338.5,-655.101"/>
<text text-anchor="middle" x="8295.5" y="-633.601" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_93&#45;&gt;leaf_101 -->
<g id="edge101" class="edge">
<title>codeblock_93&#45;&gt;leaf_101</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8289.6763,-1236.3587C8290.525,-1149.0293 8294.1907,-771.8268 8295.2265,-665.246"/>
<polygon fill="#000000" stroke="#000000" points="8298.7262,-665.2788 8295.3237,-655.2452 8291.7266,-665.2107 8298.7262,-665.2788"/>
</g>
<!-- leaf_96 -->
<g id="node97" class="node">
<title>leaf_96</title>
<polygon fill="none" stroke="#c0c0c0" points="6696,-55.6015 6449,-55.6015 6449,.2015 6696,.2015 6696,-55.6015"/>
<text text-anchor="middle" x="6572.5" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Decides when to emit a new token.</text>
</g>
<!-- raw_95&#45;&gt;leaf_96 -->
<g id="edge96" class="edge">
<title>raw_95&#45;&gt;leaf_96</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6572.5,-618.8628C6572.5,-534.747 6572.5,-183.3603 6572.5,-66.0304"/>
<polygon fill="#000000" stroke="#000000" points="6576.0001,-65.7413 6572.5,-55.7414 6569.0001,-65.7414 6576.0001,-65.7413"/>
</g>
</g>
</svg>
