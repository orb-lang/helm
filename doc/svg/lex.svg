<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="3204pt" height="2942pt"
 viewBox="0.00 0.00 3204.00 2942.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2938.0041)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2938.0041 3200,-2938.0041 3200,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2916.0041" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="873" y="-2911.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 198</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2844.0041" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="873" y="-2839.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;128</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2897.8354C873,-2890.135 873,-2880.9784 873,-2872.4207"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2872.4173 873,-2862.4173 869.5001,-2872.4174 876.5001,-2872.4173"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="371" cy="-2772.0041" rx="36.8096" ry="18"/>
<text text-anchor="middle" x="371" y="-2767.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Lex</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M814.4318,-2835.6038C713.1974,-2821.0842 507.5905,-2791.5947 416.3577,-2778.5095"/>
<polygon fill="#000000" stroke="#000000" points="416.7273,-2775.0268 406.3317,-2777.0715 415.7334,-2781.9559 416.7273,-2775.0268"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="544" cy="-2772.0041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="544" y="-2767.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.5938,-2832.7541C755.9905,-2818.3971 643.8757,-2793.8613 584.1773,-2780.7967"/>
<polygon fill="#000000" stroke="#000000" points="584.8789,-2777.3674 574.3618,-2778.6486 583.3823,-2784.2056 584.8789,-2777.3674"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2772.0041" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="873" y="-2767.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 8&#45;17</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2825.8354C873,-2818.135 873,-2808.9784 873,-2800.4207"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2800.4173 873,-2790.4173 869.5001,-2800.4174 876.5001,-2800.4173"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1218" cy="-2772.0041" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1218" y="-2767.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 20&#45;128</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M925.3981,-2833.0688C986.4488,-2820.3278 1087.344,-2799.2714 1153.2464,-2785.5179"/>
<polygon fill="#000000" stroke="#000000" points="1154.0348,-2788.9288 1163.1088,-2783.4596 1152.6047,-2782.0764 1154.0348,-2788.9288"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1990" cy="-2772.0041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="1990" y="-2767.8041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 129&#45;133</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M937.0667,-2839.8744C1127.9449,-2827.5707 1692.8021,-2791.161 1906.6695,-2777.3754"/>
<polygon fill="#000000" stroke="#000000" points="1907.1375,-2780.8526 1916.8916,-2776.7165 1906.6871,-2773.8671 1907.1375,-2780.8526"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="312,-2670.4039 258,-2670.4039 258,-2634.4039 312,-2634.4039 312,-2670.4039"/>
<text text-anchor="middle" x="285" y="-2648.9039" font-family="Inconsolata" font-size="14.00" fill="#000000">* Lex</text>
</g>
<!-- header_2&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>header_2&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M354.1115,-2755.8999C343.8453,-2745.6161 330.86,-2731.6867 321,-2718.0041 312.43,-2706.1115 304.4209,-2691.9582 298.1431,-2679.8475"/>
<polygon fill="#000000" stroke="#000000" points="301.1334,-2678.0044 293.502,-2670.6551 294.8846,-2681.1593 301.1334,-2678.0044"/>
</g>
<!-- raw_8 -->
<g id="node9" class="node">
<title>raw_8</title>
<ellipse fill="none" stroke="#000000" cx="357" cy="-2652.4039" rx="27" ry="18"/>
<text text-anchor="middle" x="357" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;raw_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.6692,-2767.5182C479.6219,-2761.3774 427.6344,-2747.5432 393,-2718.0041 381.1063,-2707.8601 372.44,-2692.7591 366.5947,-2679.6021"/>
<polygon fill="#000000" stroke="#000000" points="369.7027,-2677.9564 362.668,-2670.034 363.2269,-2680.6141 369.7027,-2677.9564"/>
</g>
<!-- prespace_9 -->
<g id="node10" class="node">
<title>prespace_9</title>
<ellipse fill="none" stroke="#000000" cx="448" cy="-2652.4039" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="448" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_3&#45;&gt;prespace_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;prespace_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M530.6516,-2755.3742C514.5001,-2735.2521 487.1404,-2701.1664 468.3536,-2677.7612"/>
<polygon fill="#000000" stroke="#000000" points="470.8459,-2675.2747 461.8567,-2669.6671 465.3869,-2679.6565 470.8459,-2675.2747"/>
</g>
<!-- literal_10 -->
<g id="node11" class="node">
<title>literal_10</title>
<ellipse fill="none" stroke="#000000" cx="544" cy="-2652.4039" rx="31.481" ry="18"/>
<text text-anchor="middle" x="544" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_3&#45;&gt;literal_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;literal_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M544,-2753.8394C544,-2734.4333 544,-2703.414 544,-2680.7819"/>
<polygon fill="#000000" stroke="#000000" points="547.5001,-2680.7395 544,-2670.7396 540.5001,-2680.7396 547.5001,-2680.7395"/>
</g>
<!-- raw_11 -->
<g id="node12" class="node">
<title>raw_11</title>
<ellipse fill="none" stroke="#000000" cx="620" cy="-2652.4039" rx="27" ry="18"/>
<text text-anchor="middle" x="620" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_11 -->
<g id="edge11" class="edge">
<title>prose_3&#45;&gt;raw_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.2159,-2755.3967C565.3179,-2744.9235 575.6931,-2730.9718 584,-2718.0041 592.0728,-2705.4018 600.1703,-2690.8571 606.6354,-2678.6704"/>
<polygon fill="#000000" stroke="#000000" points="609.9065,-2679.968 611.4387,-2669.4845 603.7033,-2676.7243 609.9065,-2679.968"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1080.5,-2718.1043 665.5,-2718.1043 665.5,-2586.7035 1080.5,-2586.7035 1080.5,-2718.1043"/>
<text text-anchor="middle" x="873" y="-2702.8041" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="873" y="-2687.404" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, R, S, match = L.P, L.R, L.S, L.match</text>
<text text-anchor="middle" x="873" y="-2672.004" font-family="Inconsolata" font-size="14.00" fill="#000000">local Lex = meta {}</text>
<text text-anchor="middle" x="873" y="-2656.604" font-family="Inconsolata" font-size="14.00" fill="#000000">local Rainbuf = require &quot;rainbuf&quot;</text>
<text text-anchor="middle" x="873" y="-2641.2039" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub, gsub = assert(string.sub), assert(string.gsub)</text>
<text text-anchor="middle" x="873" y="-2625.8039" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = assert(table.concat)</text>
<text text-anchor="middle" x="873" y="-2610.4039" font-family="Inconsolata" font-size="14.00" fill="#000000">local c = require &quot;color&quot;</text>
<text text-anchor="middle" x="873" y="-2595.0038" font-family="Inconsolata" font-size="14.00" fill="#000000">local codepoints = assert(string.codepoints)</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_4&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2753.8394C873,-2746.5644 873,-2737.6573 873,-2728.1719"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2728.1219 873,-2718.1219 869.5001,-2728.1219 876.5001,-2728.1219"/>
</g>
<!-- header_17 -->
<g id="node18" class="node">
<title>header_17</title>
<ellipse fill="none" stroke="#000000" cx="1162" cy="-2652.4039" rx="63.3963" ry="18"/>
<text text-anchor="middle" x="1162" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Lua lexers</text>
</g>
<!-- section_5&#45;&gt;header_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;header_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1209.6162,-2754.0987C1200.3787,-2734.37 1185.4168,-2702.4157 1174.7302,-2679.592"/>
<polygon fill="#000000" stroke="#000000" points="1177.8513,-2678.0039 1170.4411,-2670.4317 1171.5118,-2680.9723 1177.8513,-2678.0039"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="1275" cy="-2652.4039" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1275" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_5&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1226.5335,-2754.0987C1235.9903,-2734.256 1251.3413,-2702.0459 1262.2307,-2679.1971"/>
<polygon fill="#000000" stroke="#000000" points="1265.4515,-2680.5743 1266.5942,-2670.0413 1259.1324,-2677.5627 1265.4515,-2680.5743"/>
</g>
<!-- codeblock_19 -->
<g id="node20" class="node">
<title>codeblock_19</title>
<ellipse fill="none" stroke="#000000" cx="1494" cy="-2652.4039" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1494" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;126</text>
</g>
<!-- section_5&#45;&gt;codeblock_19 -->
<g id="edge19" class="edge">
<title>section_5&#45;&gt;codeblock_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1253.7992,-2756.491C1303.1961,-2735.0857 1392.3391,-2696.457 1447.0351,-2672.7554"/>
<polygon fill="#000000" stroke="#000000" points="1448.7147,-2675.8421 1456.4986,-2668.6546 1445.9314,-2669.4192 1448.7147,-2675.8421"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="1914" cy="-2652.4039" rx="103.0387" ry="18"/>
<text text-anchor="middle" x="1914" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Lex.lua_thor(linebuf)</text>
</g>
<!-- section_6&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_6&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1978.622,-2754.0987C1965.9735,-2734.1939 1945.4168,-2701.8441 1930.8896,-2678.9828"/>
<polygon fill="#000000" stroke="#000000" points="1933.7731,-2676.9946 1925.4557,-2670.4317 1927.865,-2680.749 1933.7731,-2676.9946"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2067" cy="-2652.4039" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2067" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_6&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2002.133,-2754.0913C2009.1773,-2743.6204 2018.1773,-2730.1204 2026,-2718.0041 2034.4173,-2704.9669 2043.5888,-2690.3343 2051.1188,-2678.2025"/>
<polygon fill="#000000" stroke="#000000" points="2054.2304,-2679.8256 2056.5175,-2669.4806 2048.2783,-2676.1414 2054.2304,-2679.8256"/>
</g>
<!-- section_26 -->
<g id="node27" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2470" cy="-2652.4039" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="2470" y="-2648.2039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 134&#45;198</text>
</g>
<!-- section_6&#45;&gt;section_26 -->
<g id="edge26" class="edge">
<title>section_6&#45;&gt;section_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2042.2822,-2758.9771C2131.4585,-2736.7573 2312.5626,-2691.6321 2407.9817,-2667.8568"/>
<polygon fill="#000000" stroke="#000000" points="2408.9252,-2671.2288 2417.7823,-2665.4149 2407.2327,-2664.4365 2408.9252,-2671.2288"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="408,-1780.9038 0,-1780.9038 0,-1709.1015 408,-1709.1015 408,-1780.9038"/>
<text text-anchor="middle" x="204" y="-1717.5027" font-family="Inconsolata" font-size="14.00" fill="#000000">We&#39;re going to do this will straight el peg, and fold in</text>
</g>
<!-- raw_8&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>raw_8&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M353.9438,-2634.2782C335.5758,-2525.343 239.707,-1956.771 211.6939,-1790.633"/>
<polygon fill="#000000" stroke="#000000" points="215.1389,-1790.0136 210.0249,-1780.7348 208.2364,-1791.1775 215.1389,-1790.0136"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="480,-1763.0027 426,-1763.0027 426,-1727.0027 480,-1727.0027 480,-1763.0027"/>
<text text-anchor="middle" x="453" y="-1741.5027" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_9&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>prespace_9&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M448.0999,-2634.2782C448.723,-2521.1915 452.0756,-1912.7672 452.8433,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="456.3446,-1773.1907 452.8999,-1763.1715 449.3447,-1773.152 456.3446,-1773.1907"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="577,-1763.0027 505,-1763.0027 505,-1727.0027 577,-1727.0027 577,-1763.0027"/>
<text text-anchor="middle" x="541" y="-1741.5027" font-family="Inconsolata" font-size="14.00" fill="#000000">espalier</text>
</g>
<!-- literal_10&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>literal_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.9401,-2634.2782C543.5662,-2521.1915 541.5547,-1912.7672 541.094,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="544.5932,-1773.1598 541.0601,-1763.1715 537.5932,-1773.1831 544.5932,-1773.1598"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="653,-1763.0027 595,-1763.0027 595,-1727.0027 653,-1727.0027 653,-1763.0027"/>
<text text-anchor="middle" x="624" y="-1741.5027" font-family="Inconsolata" font-size="14.00" fill="#000000"> ASAP.</text>
</g>
<!-- raw_11&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M620.0799,-2634.2782C620.5784,-2521.1915 623.2605,-1912.7672 623.8746,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="627.3757,-1773.1869 623.9199,-1763.1715 620.3758,-1773.1559 627.3757,-1773.1869"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1176,-1763.0027 1062,-1763.0027 1062,-1727.0027 1176,-1727.0027 1176,-1763.0027"/>
<text text-anchor="middle" x="1119" y="-1741.5027" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Lua lexers</text>
</g>
<!-- header_17&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>header_17&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1161.1411,-2634.2782C1155.7821,-2521.1915 1126.95,-1912.7672 1120.3476,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="1123.8305,-1772.9946 1119.861,-1763.1715 1116.8384,-1773.326 1123.8305,-1772.9946"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1221" cy="-1745.0027" rx="27" ry="18"/>
<text text-anchor="middle" x="1221" y="-1740.8027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_18&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_18&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1271.1004,-2634.5205C1266.8637,-2614.3059 1260.2643,-2580.3607 1257,-2550.8038 1223.5203,-2247.66 1220.9504,-1877.0948 1220.9291,-1773.235"/>
<polygon fill="#000000" stroke="#000000" points="1224.429,-1773.2274 1220.9351,-1763.2253 1217.429,-1773.2231 1224.429,-1773.2274"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1807.5,-2550.605 1266.5,-2550.605 1266.5,-939.4003 1807.5,-939.4003 1807.5,-2550.605"/>
<text text-anchor="middle" x="1537" y="-2535.6038" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = (P&quot; &quot;)^0</text>
<text text-anchor="middle" x="1537" y="-2504.2038" font-family="Inconsolata" font-size="14.00" fill="#000000">local NL = P&quot;\n&quot;</text>
<text text-anchor="middle" x="1537" y="-2472.8037" font-family="Inconsolata" font-size="14.00" fill="#000000">local terminal = S&quot; \&quot;&#39;+&#45;*^~%#;,&lt;&gt;={}[]().:\n&quot; + &#45;P(1)</text>
<text text-anchor="middle" x="1537" y="-2441.4037" font-family="Inconsolata" font-size="14.00" fill="#000000">local KW = (P&quot;function&quot; + &quot;local&quot; + &quot;for&quot; + &quot;in&quot; + &quot;do&quot;</text>
<text text-anchor="middle" x="1537" y="-2426.0037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;and&quot; + &quot;or&quot; + &quot;not&quot; + &quot;true&quot; + &quot;false&quot;</text>
<text text-anchor="middle" x="1537" y="-2410.6037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;while&quot; + &quot;break&quot; + &quot;if&quot; + &quot;then&quot; + &quot;else&quot; + &quot;elseif&quot;</text>
<text text-anchor="middle" x="1537" y="-2395.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;goto&quot; + &quot;repeat&quot; + &quot;until&quot; + &quot;return&quot; + &quot;nil&quot;</text>
<text text-anchor="middle" x="1537" y="-2379.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;end&quot;) * #terminal</text>
<text text-anchor="middle" x="1537" y="-2348.4036" font-family="Inconsolata" font-size="14.00" fill="#000000">local OP = P&quot;+&quot; + &quot;&#45;&quot; + &quot;*&quot; + &quot;/&quot; + &quot;%&quot; + &quot;^&quot; + &quot;#&quot;</text>
<text text-anchor="middle" x="1537" y="-2333.0035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;==&quot; + &quot;~=&quot; + &quot;&lt;=&quot; + &quot;&gt;=&quot; + &quot;&lt;&quot; + &quot;&gt;&quot;</text>
<text text-anchor="middle" x="1537" y="-2317.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;=&quot; + &quot;(&quot; + &quot;)&quot; + &quot;{&quot; + &quot;}&quot; + &quot;[&quot; + &quot;]&quot;</text>
<text text-anchor="middle" x="1537" y="-2302.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;;&quot; + &quot;;&quot; + &quot;...&quot; + &quot;..&quot; + &quot;.&quot; + &quot;,&quot;</text>
<text text-anchor="middle" x="1537" y="-2270.8034" font-family="Inconsolata" font-size="14.00" fill="#000000">local digit = R&quot;09&quot;</text>
<text text-anchor="middle" x="1537" y="-2239.4034" font-family="Inconsolata" font-size="14.00" fill="#000000">local _decimal = P&quot;&#45;&quot;^0 * ((digit^1 * P&quot;.&quot;^&#45;1 * digit^0</text>
<text text-anchor="middle" x="1537" y="-2224.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((P&quot;e&quot; + P&quot;E&quot;)^&#45;1 * P&quot;&#45;&quot;^&#45;1 * digit^1)^&#45;1</text>
<text text-anchor="middle" x="1537" y="-2208.6033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ digit^1)^1 + digit^1)</text>
<text text-anchor="middle" x="1537" y="-2177.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">local higit = R&quot;09&quot; + R&quot;af&quot; + R&quot;AF&quot;</text>
<text text-anchor="middle" x="1537" y="-2145.8033" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; hexadecimal floats. are a thing. that exists.</text>
<text text-anchor="middle" x="1537" y="-2130.4032" font-family="Inconsolata" font-size="14.00" fill="#000000">local _hexadecimal = P&quot;&#45;&quot;^0 * P&quot;0&quot; * (P&quot;x&quot; + P&quot;X&quot;)</text>
<text text-anchor="middle" x="1537" y="-2115.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((higit^1 * P&quot;.&quot;^&#45;1 * higit^0</text>
<text text-anchor="middle" x="1537" y="-2099.6032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((P&quot;p&quot; + P&quot;P&quot;)^&#45;1 * P&quot;&#45;&quot;^&#45;1 * higit^1)^&#45;1</text>
<text text-anchor="middle" x="1537" y="-2084.2032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ higit^1)^1 + higit^1)</text>
<text text-anchor="middle" x="1537" y="-2052.8031" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; long strings, straight from the LPEG docs</text>
<text text-anchor="middle" x="1537" y="-2021.4031" font-family="Inconsolata" font-size="14.00" fill="#000000">local _equals = P&quot;=&quot;^0</text>
<text text-anchor="middle" x="1537" y="-2006.0031" font-family="Inconsolata" font-size="14.00" fill="#000000">local _open = &quot;[&quot; * L.Cg(_equals, &quot;init&quot;) * &quot;[&quot; * P&quot;\n&quot;^&#45;1</text>
<text text-anchor="middle" x="1537" y="-1990.603" font-family="Inconsolata" font-size="14.00" fill="#000000">local _close = &quot;]&quot; * L.C(_equals) * &quot;]&quot;</text>
<text text-anchor="middle" x="1537" y="-1975.203" font-family="Inconsolata" font-size="14.00" fill="#000000">local _closeeq = L.Cmt(_close * L.Cb(&quot;init&quot;),</text>
<text text-anchor="middle" x="1537" y="-1959.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;function (s, i, a, b) return a == b end)</text>
<text text-anchor="middle" x="1537" y="-1928.4029" font-family="Inconsolata" font-size="14.00" fill="#000000">local long_str = (_open * L.C((P(1) &#45; _closeeq)^0) * _close) / 0 * L.Cp()</text>
<text text-anchor="middle" x="1537" y="-1897.0029" font-family="Inconsolata" font-size="14.00" fill="#000000">local str_esc = P&quot;\\&quot; * (S&quot;abfnrtvz\\\&quot;&#39;[]\n&quot;</text>
<text text-anchor="middle" x="1537" y="-1881.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ (R&quot;09&quot; * R&quot;09&quot;^&#45;2)</text>
<text text-anchor="middle" x="1537" y="-1866.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ (P&quot;x&quot; + P&quot;X&quot;) * higit * higit)</text>
<text text-anchor="middle" x="1537" y="-1834.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">local double_str = P&quot;\&quot;&quot; * (P(1) &#45; (P&quot;\&quot;&quot; + P&quot;\\&quot;) + str_esc)^0 * P&quot;\&quot;&quot;</text>
<text text-anchor="middle" x="1537" y="-1819.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">local single_str = P&quot;\&#39;&quot; * (P(1) &#45; (P&quot;\&#39;&quot; + P&quot;\\&quot;) + str_esc)^0 * P&quot;\&#39;&quot;</text>
<text text-anchor="middle" x="1537" y="-1788.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">local string_esc = double_str + single_str</text>
<text text-anchor="middle" x="1537" y="-1756.6027" font-family="Inconsolata" font-size="14.00" fill="#000000">local string_long = long_str</text>
<text text-anchor="middle" x="1537" y="-1725.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local letter = R&quot;az&quot; + R&quot;AZ&quot;</text>
<text text-anchor="middle" x="1537" y="-1693.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local symbol = &#160;&#160;(letter^1 + P&quot;_&quot;^1)</text>
<text text-anchor="middle" x="1537" y="-1678.4026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* (letter + digit + P&quot;_&quot;)^0</text>
<text text-anchor="middle" x="1537" y="-1663.0026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* #terminal</text>
<text text-anchor="middle" x="1537" y="-1631.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local number = _hexadecimal + _decimal</text>
<text text-anchor="middle" x="1537" y="-1600.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local comment = P&quot;&#45;&#45;&quot; * long_str</text>
<text text-anchor="middle" x="1537" y="-1584.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ P&quot;&#45;&#45;&quot; * (P(1) &#45; NL)^0 * (NL + &#45; P(1))</text>
<text text-anchor="middle" x="1537" y="-1553.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">local ERR = P(1)</text>
<text text-anchor="middle" x="1537" y="-1522.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local lua_toks = {comment, KW, string_long, string_esc, number, OP, symbol,</text>
<text text-anchor="middle" x="1537" y="-1506.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WS, NL, ERR}</text>
<text text-anchor="middle" x="1537" y="-1475.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local lex_kv = { KW = KW,</text>
<text text-anchor="middle" x="1537" y="-1459.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;number = number,</text>
<text text-anchor="middle" x="1537" y="-1444.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;OP = OP,</text>
<text text-anchor="middle" x="1537" y="-1429.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;symbol = symbol,</text>
<text text-anchor="middle" x="1537" y="-1413.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string_long = string_long,</text>
<text text-anchor="middle" x="1537" y="-1398.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string_esc = string_esc,</text>
<text text-anchor="middle" x="1537" y="-1382.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment = comment,</text>
<text text-anchor="middle" x="1537" y="-1367.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WS = WS,</text>
<text text-anchor="middle" x="1537" y="-1352.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;NL = NL,</text>
<text text-anchor="middle" x="1537" y="-1336.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ERR = ERR}</text>
<text text-anchor="middle" x="1537" y="-1305.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local color_map = {</text>
<text text-anchor="middle" x="1537" y="-1289.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;KW = c.color.keyword(),</text>
<text text-anchor="middle" x="1537" y="-1274.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;OP = c.color.operator(),</text>
<text text-anchor="middle" x="1537" y="-1259.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;number = c.color.number(),</text>
<text text-anchor="middle" x="1537" y="-1243.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;symbol = c.color.field(),</text>
<text text-anchor="middle" x="1537" y="-1228.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;string_esc = c.color.string(),</text>
<text text-anchor="middle" x="1537" y="-1212.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;string_long = c.color.string(),</text>
<text text-anchor="middle" x="1537" y="-1197.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;comment = c.color.comment(),</text>
<text text-anchor="middle" x="1537" y="-1182.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ERR = c.color.error(),</text>
<text text-anchor="middle" x="1537" y="-1166.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">}</text>
<text text-anchor="middle" x="1537" y="-1119.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">local lex_map = {}</text>
<text text-anchor="middle" x="1537" y="-1087.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">for k, v in pairs(lex_kv) do</text>
<text text-anchor="middle" x="1537" y="-1072.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;lex_map[v] = k</text>
<text text-anchor="middle" x="1537" y="-1057.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1537" y="-1025.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">lex_kv = nil</text>
<text text-anchor="middle" x="1537" y="-994.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.lex_map = lex_map</text>
<text text-anchor="middle" x="1537" y="-962.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.long_str = long_str</text>
<text text-anchor="middle" x="1537" y="-947.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.string = string_long</text>
</g>
<!-- codeblock_19&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_19&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1494.8589,-2634.2782C1495.6045,-2618.5458 1496.8043,-2593.2266 1498.3354,-2560.9174"/>
<polygon fill="#000000" stroke="#000000" points="1501.8437,-2560.8234 1498.821,-2550.6689 1494.8515,-2560.492 1501.8437,-2560.8234"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1248,-515.3008 1194,-515.3008 1194,-479.3008 1248,-479.3008 1248,-515.3008"/>
</g>
<!-- raw_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>raw_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1221,-1726.8838C1221,-1588.3281 1221,-697.343 1221,-525.8388"/>
<polygon fill="#000000" stroke="#000000" points="1224.5001,-525.5982 1221,-515.5982 1217.5001,-525.5983 1224.5001,-525.5982"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="2010,-1763.0027 1826,-1763.0027 1826,-1727.0027 2010,-1727.0027 2010,-1763.0027"/>
<text text-anchor="middle" x="1918" y="-1741.5027" font-family="Inconsolata" font-size="14.00" fill="#000000">** Lex.lua_thor(linebuf)</text>
</g>
<!-- header_24&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>header_24&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1914.0799,-2634.2782C1914.5784,-2521.1915 1917.2605,-1912.7672 1917.8746,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="1921.3757,-1773.1869 1917.9199,-1763.1715 1914.3758,-1773.1559 1921.3757,-1773.1869"/>
</g>
<!-- raw_28 -->
<g id="node29" class="node">
<title>raw_28</title>
<ellipse fill="none" stroke="#000000" cx="2063" cy="-1745.0027" rx="27" ry="18"/>
<text text-anchor="middle" x="2063" y="-1740.8027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_28 -->
<g id="edge28" class="edge">
<title>prose_25&#45;&gt;raw_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2066.9201,-2634.2782C2066.4216,-2521.1915 2063.7395,-1912.7672 2063.1254,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="2066.6242,-1773.1559 2063.0801,-1763.1715 2059.6243,-1773.1869 2066.6242,-1773.1559"/>
</g>
<!-- header_30 -->
<g id="node31" class="node">
<title>header_30</title>
<ellipse fill="none" stroke="#000000" cx="2287" cy="-1745.0027" rx="88.0294" ry="18"/>
<text text-anchor="middle" x="2287" y="-1740.8027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : chomp_token(lb)</text>
</g>
<!-- section_26&#45;&gt;header_30 -->
<g id="edge30" class="edge">
<title>section_26&#45;&gt;header_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2461.4174,-2634.454C2452.1769,-2614.4603 2437.643,-2580.9749 2429,-2550.8038 2343.7064,-2253.0591 2300.6965,-1877.9741 2289.8153,-1773.2689"/>
<polygon fill="#000000" stroke="#000000" points="2293.283,-1772.7743 2288.7803,-1763.1839 2286.3196,-1773.489 2293.283,-1772.7743"/>
</g>
<!-- prose_31 -->
<g id="node32" class="node">
<title>prose_31</title>
<ellipse fill="none" stroke="#000000" cx="2470" cy="-1745.0027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2470" y="-1740.8027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_26&#45;&gt;prose_31 -->
<g id="edge31" class="edge">
<title>section_26&#45;&gt;prose_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2470,-2634.2782C2470,-2521.1915 2470,-1912.7672 2470,-1773.4397"/>
<polygon fill="#000000" stroke="#000000" points="2473.5001,-1773.1715 2470,-1763.1715 2466.5001,-1773.1715 2473.5001,-1773.1715"/>
</g>
<!-- codeblock_32 -->
<g id="node33" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="2731" cy="-1745.0027" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2731" y="-1740.8027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 139&#45;192</text>
</g>
<!-- section_26&#45;&gt;codeblock_32 -->
<g id="edge32" class="edge">
<title>section_26&#45;&gt;codeblock_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2478.0596,-2634.2911C2486.8423,-2614.1548 2500.9774,-2580.5451 2511,-2550.8038 2611.9727,-2251.1753 2700.5341,-1877.4154 2724.5814,-1773.1446"/>
<polygon fill="#000000" stroke="#000000" points="2728.0606,-1773.6321 2726.8898,-1763.1022 2721.2385,-1772.064 2728.0606,-1773.6321"/>
</g>
<!-- codeblock_33 -->
<g id="node34" class="node">
<title>codeblock_33</title>
<ellipse fill="none" stroke="#000000" cx="3100" cy="-1745.0027" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3100" y="-1740.8027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 195&#45;197</text>
</g>
<!-- section_26&#45;&gt;codeblock_33 -->
<g id="edge33" class="edge">
<title>section_26&#45;&gt;codeblock_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2531.5966,-2641.9779C2622.004,-2625.5286 2784.5235,-2591.2324 2827,-2550.8038 3063.577,-2325.6326 3095.1427,-1888.2757 3099.3526,-1773.2671"/>
<polygon fill="#000000" stroke="#000000" points="3102.8542,-1773.2698 3099.6805,-1763.1615 3095.8579,-1773.0427 3102.8542,-1773.2698"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="2093.5,-533.2019 1986.5,-533.2019 1986.5,-461.3996 2093.5,-461.3996 2093.5,-533.2019"/>
<text text-anchor="middle" x="2040" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">...it&#39;s late.</text>
</g>
<!-- raw_28&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>raw_28&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2062.666,-1726.8838C2060.19,-1592.566 2044.6793,-751.1432 2040.8526,-543.5531"/>
<polygon fill="#000000" stroke="#000000" points="2044.3475,-543.2407 2040.6637,-533.3069 2037.3487,-543.3697 2044.3475,-543.2407"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2260.5,-515.3008 2111.5,-515.3008 2111.5,-479.3008 2260.5,-479.3008 2260.5,-515.3008"/>
<text text-anchor="middle" x="2186" y="-493.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">*** chomp_token(lb)</text>
</g>
<!-- header_30&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>header_30&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2285.5333,-1726.8838C2274.3118,-1588.2589 2202.1212,-696.4536 2188.2894,-525.5826"/>
<polygon fill="#000000" stroke="#000000" points="2191.7767,-525.2832 2187.4812,-515.5982 2184.7995,-525.8481 2191.7767,-525.2832"/>
</g>
<!-- raw_35 -->
<g id="node36" class="node">
<title>raw_35</title>
<ellipse fill="none" stroke="#000000" cx="2306" cy="-497.3008" rx="27" ry="18"/>
<text text-anchor="middle" x="2306" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_35 -->
<g id="edge35" class="edge">
<title>prose_31&#45;&gt;raw_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2472.7049,-1726.9053C2485.4084,-1635.9026 2532.5152,-1221.5387 2384,-939.2015 2372.5544,-917.4427 2353.2508,-925.0616 2342,-903.2015 2276.0832,-775.1258 2292.2467,-594.0181 2301.6236,-525.2521"/>
<polygon fill="#000000" stroke="#000000" points="2305.1094,-525.5995 2303.0567,-515.2055 2298.1795,-524.611 2305.1094,-525.5995"/>
</g>
<!-- prespace_36 -->
<g id="node37" class="node">
<title>prespace_36</title>
<ellipse fill="none" stroke="#000000" cx="2397" cy="-497.3008" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2397" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_31&#45;&gt;prespace_36 -->
<g id="edge36" class="edge">
<title>prose_31&#45;&gt;prespace_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2468.9399,-1726.8838C2460.8293,-1588.2589 2408.6519,-696.4536 2398.6547,-525.5826"/>
<polygon fill="#000000" stroke="#000000" points="2402.1487,-525.3767 2398.0705,-515.5982 2395.1607,-525.7856 2402.1487,-525.3767"/>
</g>
<!-- literal_37 -->
<g id="node38" class="node">
<title>literal_37</title>
<ellipse fill="none" stroke="#000000" cx="2493" cy="-497.3008" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2493" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_31&#45;&gt;literal_37 -->
<g id="edge37" class="edge">
<title>prose_31&#45;&gt;literal_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2470.334,-1726.8838C2472.8881,-1588.3281 2489.3124,-697.343 2492.4739,-525.8388"/>
<polygon fill="#000000" stroke="#000000" points="2495.9777,-525.6611 2492.6627,-515.5982 2488.9789,-525.532 2495.9777,-525.6611"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2569" cy="-497.3008" rx="27" ry="18"/>
<text text-anchor="middle" x="2569" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_31&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2471.4377,-1726.8838C2482.437,-1588.2589 2553.198,-696.4536 2566.756,-525.5826"/>
<polygon fill="#000000" stroke="#000000" points="2570.2461,-525.8438 2567.5482,-515.5982 2563.2681,-525.29 2570.2461,-525.8438"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3092,-903.1023 2614,-903.1023 2614,-91.4993 3092,-91.4993 3092,-903.1023"/>
<text text-anchor="middle" x="2853" y="-888.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function chomp_token(lb)</text>
<text text-anchor="middle" x="2853" y="-872.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(lua_toks) do</text>
<text text-anchor="middle" x="2853" y="-857.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bite = match(v, lb)</text>
<text text-anchor="middle" x="2853" y="-841.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if bite ~= nil then</text>
<text text-anchor="middle" x="2853" y="-826.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return sub(lb, 1, bite &#45; 1), sub(lb, bite), v</text>
<text text-anchor="middle" x="2853" y="-811.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-795.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-780.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="2853" y="-764.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2853" y="-733.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.chomp = chomp_token</text>
<text text-anchor="middle" x="2853" y="-686.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Not using this. Want to replace it with a less&#45;dumb match&#45;based</text>
<text text-anchor="middle" x="2853" y="-670.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; lpeg system but kind over it for now.</text>
<text text-anchor="middle" x="2853" y="-655.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _str_hl(str)</text>
<text text-anchor="middle" x="2853" y="-639.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local mark = sub(str,1,1) == &quot;&#39;&quot; and &quot;&#39;&quot; or &#39;&quot;&#39;</text>
<text text-anchor="middle" x="2853" y="-624.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;mark = c.color.string(mark)</text>
<text text-anchor="middle" x="2853" y="-609.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return mark .. ts(str) .. mark</text>
<text text-anchor="middle" x="2853" y="-593.601" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2853" y="-546.201" font-family="Inconsolata" font-size="14.00" fill="#000000">function Lex.lua_thor(linebuf)</text>
<text text-anchor="middle" x="2853" y="-530.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local toks = {}</text>
<text text-anchor="middle" x="2853" y="-515.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="2853" y="-500.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;while lb ~= &quot;&quot; do</text>
<text text-anchor="middle" x="2853" y="-484.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local len = #lb</text>
<text text-anchor="middle" x="2853" y="-469.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bite, tok_t</text>
<text text-anchor="middle" x="2853" y="-453.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;bite, lb, tok_t = chomp_token(lb)</text>
<text text-anchor="middle" x="2853" y="-438.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if bite == nil then</text>
<text text-anchor="middle" x="2853" y="-423.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break</text>
<text text-anchor="middle" x="2853" y="-407.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2853" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; #todo add a color</text>
<text text-anchor="middle" x="2853" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local col = color_map[lex_map[tok_t]]</text>
<text text-anchor="middle" x="2853" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if col then</text>
<text text-anchor="middle" x="2853" y="-346.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = col</text>
<text text-anchor="middle" x="2853" y="-330.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = bite</text>
<text text-anchor="middle" x="2853" y="-315.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif tok_t == string_esc then</text>
<text text-anchor="middle" x="2853" y="-299.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = _str_hl(bite)</text>
<text text-anchor="middle" x="2853" y="-284.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2853" y="-269.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = bite</text>
<text text-anchor="middle" x="2853" y="-253.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if len == #lb then</text>
<text text-anchor="middle" x="2853" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = a.clear .. color_map.ERR</text>
<text text-anchor="middle" x="2853" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = sub(lb, 1, 1)</text>
<text text-anchor="middle" x="2853" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;lb = sub(lb,2)</text>
<text text-anchor="middle" x="2853" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;toks[#toks + 1] = a.clear()</text>
<text text-anchor="middle" x="2853" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return toks</text>
<text text-anchor="middle" x="2853" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_32&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2732.7717,-1726.8838C2741.5187,-1637.4273 2780.934,-1234.3246 2812.2836,-913.7104"/>
<polygon fill="#000000" stroke="#000000" points="2815.8121,-913.5887 2813.3019,-903.2956 2808.8453,-912.9075 2815.8121,-913.5887"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="3196,-515.3008 3110,-515.3008 3110,-479.3008 3196,-479.3008 3196,-515.3008"/>
<text text-anchor="middle" x="3153" y="-493.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">return Lex</text>
</g>
<!-- codeblock_33&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_33&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3100.7697,-1726.8838C3106.6552,-1588.3281 3144.5026,-697.343 3151.7878,-525.8388"/>
<polygon fill="#000000" stroke="#000000" points="3155.2951,-525.7378 3152.2228,-515.5982 3148.3014,-525.4407 3155.2951,-525.7378"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2357.5,-55.6015 2082.5,-55.6015 2082.5,.2015 2357.5,.2015 2357.5,-55.6015"/>
<text text-anchor="middle" x="2220" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">This is an almost pessimal way to use</text>
</g>
<!-- raw_35&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_35&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2307.8348,-479.085C2313.028,-420.423 2324.0955,-232.0702 2269,-91.4 2265.2219,-81.7538 2259.5134,-72.3446 2253.3121,-63.8463"/>
<polygon fill="#000000" stroke="#000000" points="2255.8835,-61.4498 2246.9998,-55.6766 2250.3443,-65.7297 2255.8835,-61.4498"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="2430,-45.7 2376,-45.7 2376,-9.7 2430,-9.7 2430,-45.7"/>
<text text-anchor="middle" x="2403" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_36&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>prespace_36&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2397.2315,-479.1796C2398.1475,-407.4902 2401.5221,-143.3669 2402.6387,-55.9809"/>
<polygon fill="#000000" stroke="#000000" points="2406.141,-55.8111 2402.7692,-45.7672 2399.1416,-55.7216 2406.141,-55.8111"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="2514,-45.7 2460,-45.7 2460,-9.7 2514,-9.7 2514,-45.7"/>
<text text-anchor="middle" x="2487" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_37&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>literal_37&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2492.7685,-479.1796C2491.8525,-407.4902 2488.4779,-143.3669 2487.3613,-55.9809"/>
<polygon fill="#000000" stroke="#000000" points="2490.8584,-55.7216 2487.2308,-45.7672 2483.859,-55.8111 2490.8584,-55.7216"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="2779.5,-47.0006 2532.5,-47.0006 2532.5,-8.3994 2779.5,-8.3994 2779.5,-47.0006"/>
<text text-anchor="middle" x="2656" y="-31.9" font-family="Inconsolata" font-size="14.00" fill="#000000">, which is quite capable of</text>
<text text-anchor="middle" x="2656" y="-16.5" font-family="Inconsolata" font-size="14.00" fill="#000000">handling a full line in one pass.</text>
</g>
<!-- raw_38&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_38&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2566.9941,-479.0434C2561.2756,-420.2558 2548.7243,-231.5664 2605,-91.4 2610.3418,-78.0951 2619.4305,-65.3545 2628.4688,-54.8115"/>
<polygon fill="#000000" stroke="#000000" points="2631.2247,-56.9811 2635.3076,-47.2045 2626.0192,-52.3011 2631.2247,-56.9811"/>
</g>
</g>
</svg>
