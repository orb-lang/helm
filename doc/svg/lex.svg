<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="3142pt" height="2988pt"
 viewBox="0.00 0.00 3142.30 2988.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2984.2042)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2984.2042 3138.2972,-2984.2042 3138.2972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2962.2042" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="873" y="-2958.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 201</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2890.2042" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="873" y="-2886.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;127</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2944.0355C873,-2936.3351 873,-2927.1785 873,-2918.6208"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2918.6174 873,-2908.6174 869.5001,-2918.6175 876.5001,-2918.6174"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="371" cy="-2818.2042" rx="36.8096" ry="18"/>
<text text-anchor="middle" x="371" y="-2814.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Lex</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M814.4318,-2881.8039C713.1974,-2867.2843 507.5905,-2837.7948 416.3577,-2824.7096"/>
<polygon fill="#000000" stroke="#000000" points="416.7273,-2821.2269 406.3317,-2823.2716 415.7334,-2828.156 416.7273,-2821.2269"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="544" cy="-2818.2042" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="544" y="-2814.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.5938,-2878.9542C755.9905,-2864.5972 643.8757,-2840.0614 584.1773,-2826.9967"/>
<polygon fill="#000000" stroke="#000000" points="584.8789,-2823.5675 574.3618,-2824.8487 583.3823,-2830.4057 584.8789,-2823.5675"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2818.2042" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="873" y="-2814.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 8&#45;16</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2872.0355C873,-2864.3351 873,-2855.1785 873,-2846.6208"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2846.6174 873,-2836.6174 869.5001,-2846.6175 876.5001,-2846.6174"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1218" cy="-2818.2042" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1218" y="-2814.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 19&#45;127</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M925.3981,-2879.2689C986.4488,-2866.5279 1087.344,-2845.4715 1153.2464,-2831.718"/>
<polygon fill="#000000" stroke="#000000" points="1154.0348,-2835.1289 1163.1088,-2829.6597 1152.6047,-2828.2765 1154.0348,-2835.1289"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1996" cy="-2818.2042" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="1996" y="-2814.0042" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 128&#45;132</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M937.0023,-2886.1007C1128.5949,-2873.8169 1697.574,-2837.3374 1912.5175,-2823.5565"/>
<polygon fill="#000000" stroke="#000000" points="1913.0344,-2827.0307 1922.7899,-2822.8979 1912.5865,-2820.045 1913.0344,-2827.0307"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="312,-2724.304 258,-2724.304 258,-2688.304 312,-2688.304 312,-2724.304"/>
<text text-anchor="middle" x="285" y="-2702.8041" font-family="Inconsolata" font-size="14.00" fill="#000000">* Lex</text>
</g>
<!-- header_2&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>header_2&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M354.3707,-2801.9078C344.202,-2791.5517 331.2282,-2777.6138 321,-2764.2042 313.5803,-2754.4765 306.2835,-2743.1655 300.2199,-2733.1354"/>
<polygon fill="#000000" stroke="#000000" points="303.1352,-2731.1893 295.0298,-2724.3663 297.1113,-2734.7547 303.1352,-2731.1893"/>
</g>
<!-- raw_8 -->
<g id="node9" class="node">
<title>raw_8</title>
<ellipse fill="none" stroke="#000000" cx="357" cy="-2706.304" rx="27" ry="18"/>
<text text-anchor="middle" x="357" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;raw_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.6773,-2813.2859C479.8763,-2806.803 428.316,-2792.7037 393,-2764.2042 382.7408,-2755.9251 374.5943,-2743.8907 368.6642,-2732.9355"/>
<polygon fill="#000000" stroke="#000000" points="371.6441,-2731.0706 364.0259,-2723.7077 365.3897,-2734.2144 371.6441,-2731.0706"/>
</g>
<!-- prespace_9 -->
<g id="node10" class="node">
<title>prespace_9</title>
<ellipse fill="none" stroke="#000000" cx="448" cy="-2706.304" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="448" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_3&#45;&gt;prespace_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;prespace_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M529.8349,-2801.6929C513.9256,-2783.1486 487.9266,-2752.8435 469.5069,-2731.373"/>
<polygon fill="#000000" stroke="#000000" points="472.0229,-2728.9305 462.8552,-2723.6197 466.7101,-2733.4884 472.0229,-2728.9305"/>
</g>
<!-- literal_10 -->
<g id="node11" class="node">
<title>literal_10</title>
<ellipse fill="none" stroke="#000000" cx="544" cy="-2706.304" rx="31.481" ry="18"/>
<text text-anchor="middle" x="544" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_3&#45;&gt;literal_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;literal_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M544,-2799.7261C544,-2782.0462 544,-2755.1274 544,-2734.7193"/>
<polygon fill="#000000" stroke="#000000" points="547.5001,-2734.4382 544,-2724.4382 540.5001,-2734.4383 547.5001,-2734.4382"/>
</g>
<!-- raw_11 -->
<g id="node12" class="node">
<title>raw_11</title>
<ellipse fill="none" stroke="#000000" cx="620" cy="-2706.304" rx="27" ry="18"/>
<text text-anchor="middle" x="620" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_11 -->
<g id="edge11" class="edge">
<title>prose_3&#45;&gt;raw_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.97,-2801.4346C564.9794,-2790.9003 575.3437,-2776.9414 584,-2764.2042 591.0296,-2753.8605 598.3888,-2742.1924 604.6082,-2732.0549"/>
<polygon fill="#000000" stroke="#000000" points="607.7526,-2733.6202 609.9573,-2723.2573 601.7714,-2729.9835 607.7526,-2733.6202"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1080.5,-2764.1044 665.5,-2764.1044 665.5,-2648.5037 1080.5,-2648.5037 1080.5,-2764.1044"/>
<text text-anchor="middle" x="873" y="-2749.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="873" y="-2733.6041" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, R, S, match = L.P, L.R, L.S, L.match</text>
<text text-anchor="middle" x="873" y="-2718.2041" font-family="Inconsolata" font-size="14.00" fill="#000000">local Lex = meta {}</text>
<text text-anchor="middle" x="873" y="-2702.8041" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub, gsub = assert(string.sub), assert(string.gsub)</text>
<text text-anchor="middle" x="873" y="-2687.404" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = assert(table.concat)</text>
<text text-anchor="middle" x="873" y="-2672.004" font-family="Inconsolata" font-size="14.00" fill="#000000">local c = require &quot;color&quot;</text>
<text text-anchor="middle" x="873" y="-2656.604" font-family="Inconsolata" font-size="14.00" fill="#000000">local codepoints = assert(string.codepoints)</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_4&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2799.7261C873,-2792.5234 873,-2783.7873 873,-2774.5827"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2774.4613 873,-2764.4613 869.5001,-2774.4614 876.5001,-2774.4613"/>
</g>
<!-- header_17 -->
<g id="node18" class="node">
<title>header_17</title>
<ellipse fill="none" stroke="#000000" cx="1162" cy="-2706.304" rx="63.3963" ry="18"/>
<text text-anchor="middle" x="1162" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Lua lexers</text>
</g>
<!-- section_5&#45;&gt;header_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;header_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1209.0026,-2800.2255C1199.9403,-2782.117 1185.8497,-2753.9609 1175.458,-2733.196"/>
<polygon fill="#000000" stroke="#000000" points="1178.5804,-2731.6144 1170.975,-2724.2381 1172.3205,-2734.7472 1178.5804,-2731.6144"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="1275" cy="-2706.304" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1275" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_5&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1227.158,-2800.2255C1236.4367,-2782.0099 1250.8943,-2753.6274 1261.4891,-2732.8282"/>
<polygon fill="#000000" stroke="#000000" points="1264.6324,-2734.3684 1266.0526,-2723.8692 1258.395,-2731.1911 1264.6324,-2734.3684"/>
</g>
<!-- codeblock_19 -->
<g id="node20" class="node">
<title>codeblock_19</title>
<ellipse fill="none" stroke="#000000" cx="1497" cy="-2706.304" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1497" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 21&#45;125</text>
</g>
<!-- section_5&#45;&gt;codeblock_19 -->
<g id="edge19" class="edge">
<title>section_5&#45;&gt;codeblock_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1255.9175,-2802.9963C1305.6732,-2783.0406 1393.0852,-2747.9818 1447.864,-2726.0113"/>
<polygon fill="#000000" stroke="#000000" points="1449.3844,-2729.1726 1457.3628,-2722.2015 1446.7786,-2722.6756 1449.3844,-2729.1726"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="1922" cy="-2706.304" rx="98.678" ry="18"/>
<text text-anchor="middle" x="1922" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Lex.lua_thor(txtbuf)</text>
</g>
<!-- section_6&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_6&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1984.1106,-2800.2255C1972.0276,-2781.9539 1953.1797,-2753.4528 1939.4138,-2732.6366"/>
<polygon fill="#000000" stroke="#000000" points="1942.2953,-2730.6486 1933.8599,-2724.2381 1936.4565,-2734.5098 1942.2953,-2730.6486"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2071" cy="-2706.304" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2071" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_6&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2008.05,-2800.2255C2020.4413,-2781.7377 2039.8521,-2752.7768 2053.844,-2731.9008"/>
<polygon fill="#000000" stroke="#000000" points="2056.8123,-2733.7585 2059.4725,-2723.5031 2050.9975,-2729.8612 2056.8123,-2733.7585"/>
</g>
<!-- section_26 -->
<g id="node27" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2474" cy="-2706.304" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="2474" y="-2702.104" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 133&#45;201</text>
</g>
<!-- section_6&#45;&gt;section_26 -->
<g id="edge26" class="edge">
<title>section_6&#45;&gt;section_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2049.9035,-2805.5853C2138.6872,-2784.801 2315.2775,-2743.4611 2410.1675,-2721.2473"/>
<polygon fill="#000000" stroke="#000000" points="2410.9883,-2724.6498 2419.9273,-2718.9625 2409.3927,-2717.8341 2410.9883,-2724.6498"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="408,-1842.8039 0,-1842.8039 0,-1771.0016 408,-1771.0016 408,-1842.8039"/>
<text text-anchor="middle" x="204" y="-1779.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">We&#39;re going to do this will straight el peg, and fold in</text>
</g>
<!-- raw_8&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>raw_8&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M353.9438,-2688.3382C335.6147,-2580.5921 240.1129,-2019.1902 211.8729,-1853.1829"/>
<polygon fill="#000000" stroke="#000000" points="215.2391,-1852.1005 210.1115,-1842.8291 208.3382,-1853.2745 215.2391,-1852.1005"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="480,-1824.9028 426,-1824.9028 426,-1788.9028 480,-1788.9028 480,-1824.9028"/>
<text text-anchor="middle" x="453" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_9&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>prespace_9&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M448.1021,-2687.9306C448.7305,-2574.9008 452.0702,-1974.1475 452.8411,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="456.3423,-1835.2663 452.898,-1825.247 449.3424,-1835.2274 456.3423,-1835.2663"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="577,-1824.9028 505,-1824.9028 505,-1788.9028 577,-1788.9028 577,-1824.9028"/>
<text text-anchor="middle" x="541" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">espalier</text>
</g>
<!-- literal_10&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>literal_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.9387,-2687.9306C543.5617,-2574.9008 541.5579,-1974.1475 541.0953,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="544.5946,-1835.2352 541.0612,-1825.247 537.5947,-1835.2587 544.5946,-1835.2352"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="653,-1824.9028 595,-1824.9028 595,-1788.9028 653,-1788.9028 653,-1824.9028"/>
<text text-anchor="middle" x="624" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> ASAP.</text>
</g>
<!-- raw_11&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M620.0817,-2687.9306C620.5844,-2574.9008 623.2562,-1974.1475 623.8729,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="627.3738,-1835.2625 623.9184,-1825.247 620.3739,-1835.2313 627.3738,-1835.2625"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1174,-1824.9028 1060,-1824.9028 1060,-1788.9028 1174,-1788.9028 1174,-1824.9028"/>
<text text-anchor="middle" x="1117" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Lua lexers</text>
</g>
<!-- header_17&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>header_17&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1161.0807,-2687.9306C1155.4255,-2574.9008 1125.3678,-1974.1475 1118.4297,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="1121.9133,-1835.0596 1117.9178,-1825.247 1114.922,-1835.4094 1121.9133,-1835.0596"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1219" cy="-1806.9028" rx="27" ry="18"/>
<text text-anchor="middle" x="1219" y="-1802.7028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_18&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_18&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1270.2768,-2688.4541C1265.5257,-2669.6755 1258.427,-2639.1874 1255,-2612.4039 1216.3065,-2309.9957 1217.3941,-1939.1316 1218.5806,-1835.1662"/>
<polygon fill="#000000" stroke="#000000" points="1222.0805,-1835.1888 1218.7052,-1825.146 1215.0811,-1835.1017 1222.0805,-1835.1888"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1819.5,-2612.4051 1264.5,-2612.4051 1264.5,-1001.4004 1819.5,-1001.4004 1819.5,-2612.4051"/>
<text text-anchor="middle" x="1542" y="-2597.2039" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = (P&quot; &quot;)^1</text>
<text text-anchor="middle" x="1542" y="-2565.8039" font-family="Inconsolata" font-size="14.00" fill="#000000">local NL = P&quot;\n&quot;</text>
<text text-anchor="middle" x="1542" y="-2534.4039" font-family="Inconsolata" font-size="14.00" fill="#000000">local terminal = S&quot; \&quot;&#39;+&#45;*^~%#;,&lt;&gt;={}[]().:\n&quot; + &#45;P(1)</text>
<text text-anchor="middle" x="1542" y="-2503.0038" font-family="Inconsolata" font-size="14.00" fill="#000000">local KW = (P&quot;function&quot; + &quot;local&quot; + &quot;for&quot; + &quot;in&quot; + &quot;do&quot;</text>
<text text-anchor="middle" x="1542" y="-2487.6038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;and&quot; + &quot;or&quot; + &quot;not&quot; + &quot;true&quot; + &quot;false&quot;</text>
<text text-anchor="middle" x="1542" y="-2472.2038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;while&quot; + &quot;break&quot; + &quot;if&quot; + &quot;then&quot; + &quot;else&quot; + &quot;elseif&quot;</text>
<text text-anchor="middle" x="1542" y="-2456.8037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;goto&quot; + &quot;repeat&quot; + &quot;until&quot; + &quot;return&quot; + &quot;nil&quot;</text>
<text text-anchor="middle" x="1542" y="-2441.4037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;end&quot;) * #terminal</text>
<text text-anchor="middle" x="1542" y="-2410.0037" font-family="Inconsolata" font-size="14.00" fill="#000000">local OP = P&quot;+&quot; + &quot;&#45;&quot; + &quot;*&quot; + &quot;/&quot; + &quot;%&quot; + &quot;^&quot; + &quot;#&quot;</text>
<text text-anchor="middle" x="1542" y="-2394.6037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;==&quot; + &quot;~=&quot; + &quot;&lt;=&quot; + &quot;&gt;=&quot; + &quot;&lt;&quot; + &quot;&gt;&quot;</text>
<text text-anchor="middle" x="1542" y="-2379.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;=&quot; + &quot;(&quot; + &quot;)&quot; + &quot;{&quot; + &quot;}&quot; + &quot;[&quot; + &quot;]&quot;</text>
<text text-anchor="middle" x="1542" y="-2363.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;;&quot; + &quot;:&quot; + &quot;...&quot; + &quot;..&quot; + &quot;.&quot; + &quot;,&quot;</text>
<text text-anchor="middle" x="1542" y="-2332.4036" font-family="Inconsolata" font-size="14.00" fill="#000000">local digit = R&quot;09&quot;</text>
<text text-anchor="middle" x="1542" y="-2301.0035" font-family="Inconsolata" font-size="14.00" fill="#000000">local _decimal = P&quot;&#45;&quot;^0 * ((digit^1 * P&quot;.&quot;^&#45;1 * digit^0</text>
<text text-anchor="middle" x="1542" y="-2285.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((P&quot;e&quot; + P&quot;E&quot;)^&#45;1 * P&quot;&#45;&quot;^&#45;1 * digit^1)^&#45;1</text>
<text text-anchor="middle" x="1542" y="-2270.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ digit^1)^1 + digit^1)</text>
<text text-anchor="middle" x="1542" y="-2238.8034" font-family="Inconsolata" font-size="14.00" fill="#000000">local higit = R&quot;09&quot; + R&quot;af&quot; + R&quot;AF&quot;</text>
<text text-anchor="middle" x="1542" y="-2207.4034" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; hexadecimal floats. are a thing. that exists. in luajit.</text>
<text text-anchor="middle" x="1542" y="-2192.0034" font-family="Inconsolata" font-size="14.00" fill="#000000">local _hexadecimal = P&quot;&#45;&quot;^0 * P&quot;0&quot; * (P&quot;x&quot; + P&quot;X&quot;)</text>
<text text-anchor="middle" x="1542" y="-2176.6033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((higit^1 * P&quot;.&quot;^&#45;1 * higit^0</text>
<text text-anchor="middle" x="1542" y="-2161.2033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((P&quot;p&quot; + P&quot;P&quot;)^&#45;1 * P&quot;&#45;&quot;^&#45;1 * higit^1)^&#45;1</text>
<text text-anchor="middle" x="1542" y="-2145.8033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ higit^1)^1 + higit^1)</text>
<text text-anchor="middle" x="1542" y="-2114.4032" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; long strings, straight from the LPEG docs</text>
<text text-anchor="middle" x="1542" y="-2099.0032" font-family="Inconsolata" font-size="14.00" fill="#000000">local _equals = P&quot;=&quot;^0</text>
<text text-anchor="middle" x="1542" y="-2083.6032" font-family="Inconsolata" font-size="14.00" fill="#000000">local _open = &quot;[&quot; * L.Cg(_equals, &quot;init&quot;) * &quot;[&quot; * P&quot;\n&quot;^&#45;1</text>
<text text-anchor="middle" x="1542" y="-2068.2032" font-family="Inconsolata" font-size="14.00" fill="#000000">local _close = &quot;]&quot; * L.C(_equals) * &quot;]&quot;</text>
<text text-anchor="middle" x="1542" y="-2052.8031" font-family="Inconsolata" font-size="14.00" fill="#000000">local _closeeq = L.Cmt(_close * L.Cb(&quot;init&quot;),</text>
<text text-anchor="middle" x="1542" y="-2037.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;function (s, i, a, b) return a == b end)</text>
<text text-anchor="middle" x="1542" y="-2006.0031" font-family="Inconsolata" font-size="14.00" fill="#000000">local long_str = (_open * L.C((P(1) &#45; _closeeq)^0) * _close) / 0 * L.Cp()</text>
<text text-anchor="middle" x="1542" y="-1974.603" font-family="Inconsolata" font-size="14.00" fill="#000000">local str_esc = P&quot;\\&quot; * (S&quot;abfnrtvz\\\&quot;&#39;[]\n&quot;</text>
<text text-anchor="middle" x="1542" y="-1959.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ (R&quot;09&quot; * R&quot;09&quot;^&#45;2)</text>
<text text-anchor="middle" x="1542" y="-1943.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ (P&quot;x&quot; + P&quot;X&quot;) * higit * higit)</text>
<text text-anchor="middle" x="1542" y="-1912.4029" font-family="Inconsolata" font-size="14.00" fill="#000000">local double_str = P&quot;\&quot;&quot; * (P(1) &#45; (P&quot;\&quot;&quot; + P&quot;\\&quot;) + str_esc)^0 * P&quot;\&quot;&quot;</text>
<text text-anchor="middle" x="1542" y="-1897.0029" font-family="Inconsolata" font-size="14.00" fill="#000000">local single_str = P&quot;\&#39;&quot; * (P(1) &#45; (P&quot;\&#39;&quot; + P&quot;\\&quot;) + str_esc)^0 * P&quot;\&#39;&quot;</text>
<text text-anchor="middle" x="1542" y="-1865.6029" font-family="Inconsolata" font-size="14.00" fill="#000000">local string_short = double_str + single_str</text>
<text text-anchor="middle" x="1542" y="-1834.2028" font-family="Inconsolata" font-size="14.00" fill="#000000">local string_long = long_str</text>
<text text-anchor="middle" x="1542" y="-1802.8028" font-family="Inconsolata" font-size="14.00" fill="#000000">local letter = R&quot;az&quot; + R&quot;AZ&quot;</text>
<text text-anchor="middle" x="1542" y="-1771.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">local symbol = &#160;&#160;(letter^1 + P&quot;_&quot;^1)</text>
<text text-anchor="middle" x="1542" y="-1756.0027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* (letter + digit + P&quot;_&quot;)^0</text>
<text text-anchor="middle" x="1542" y="-1740.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* #terminal</text>
<text text-anchor="middle" x="1542" y="-1709.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local number = _hexadecimal + _decimal</text>
<text text-anchor="middle" x="1542" y="-1677.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local comment = P&quot;&#45;&#45;&quot; * long_str</text>
<text text-anchor="middle" x="1542" y="-1662.4026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ P&quot;&#45;&#45;&quot; * (P(1) &#45; NL)^0 * (NL + &#45; P(1))</text>
<text text-anchor="middle" x="1542" y="-1631.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">local ERR = P(1)</text>
<text text-anchor="middle" x="1542" y="-1599.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local lua_toks = {comment, KW, string_long, string_short, number, OP, symbol,</text>
<text text-anchor="middle" x="1542" y="-1584.2025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WS, NL, ERR}</text>
<text text-anchor="middle" x="1542" y="-1552.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local lex_kv = { KW = KW,</text>
<text text-anchor="middle" x="1542" y="-1537.4025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;number = number,</text>
<text text-anchor="middle" x="1542" y="-1522.0024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;OP = OP,</text>
<text text-anchor="middle" x="1542" y="-1506.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;symbol = symbol,</text>
<text text-anchor="middle" x="1542" y="-1491.2024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string_long = string_long,</text>
<text text-anchor="middle" x="1542" y="-1475.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string_short = string_short,</text>
<text text-anchor="middle" x="1542" y="-1460.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment = comment,</text>
<text text-anchor="middle" x="1542" y="-1445.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WS = WS,</text>
<text text-anchor="middle" x="1542" y="-1429.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;NL = NL,</text>
<text text-anchor="middle" x="1542" y="-1414.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ERR = ERR}</text>
<text text-anchor="middle" x="1542" y="-1382.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local color_map = {</text>
<text text-anchor="middle" x="1542" y="-1367.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;KW = c.color.keyword(),</text>
<text text-anchor="middle" x="1542" y="-1352.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;OP = c.color.operator(),</text>
<text text-anchor="middle" x="1542" y="-1336.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;number = c.color.number(),</text>
<text text-anchor="middle" x="1542" y="-1321.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;symbol = c.color.field(),</text>
<text text-anchor="middle" x="1542" y="-1305.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;string_short = c.color.string(),</text>
<text text-anchor="middle" x="1542" y="-1290.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;string_long = c.color.string(),</text>
<text text-anchor="middle" x="1542" y="-1275.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;comment = c.color.comment(),</text>
<text text-anchor="middle" x="1542" y="-1259.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ERR = c.color.error(),</text>
<text text-anchor="middle" x="1542" y="-1244.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;NL = a.clear(),</text>
<text text-anchor="middle" x="1542" y="-1228.8019" font-family="Inconsolata" font-size="14.00" fill="#000000">}</text>
<text text-anchor="middle" x="1542" y="-1181.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">local lex_map = {}</text>
<text text-anchor="middle" x="1542" y="-1150.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">for k, v in pairs(lex_kv) do</text>
<text text-anchor="middle" x="1542" y="-1134.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;lex_map[v] = k</text>
<text text-anchor="middle" x="1542" y="-1119.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1542" y="-1087.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">lex_kv = nil</text>
<text text-anchor="middle" x="1542" y="-1056.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.lex_map = lex_map</text>
<text text-anchor="middle" x="1542" y="-1025.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.long_str = long_str</text>
<text text-anchor="middle" x="1542" y="-1009.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.string = string_long</text>
</g>
<!-- codeblock_19&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_19&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1497.9193,-2687.9306C1498.6408,-2673.5105 1499.7594,-2651.1523 1501.1766,-2622.828"/>
<polygon fill="#000000" stroke="#000000" points="1504.686,-2622.7263 1501.6901,-2612.5638 1497.6947,-2622.3764 1504.686,-2622.7263"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1246,-546.4008 1192,-546.4008 1192,-510.4008 1246,-510.4008 1246,-546.4008"/>
</g>
<!-- raw_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>raw_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1219,-1788.8295C1219,-1648.2851 1219,-730.9405 1219,-556.8854"/>
<polygon fill="#000000" stroke="#000000" points="1222.5001,-556.7274 1219,-546.7274 1215.5001,-556.7275 1222.5001,-556.7274"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="2014.5,-1824.9028 1837.5,-1824.9028 1837.5,-1788.9028 2014.5,-1788.9028 2014.5,-1824.9028"/>
<text text-anchor="middle" x="1926" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000">** Lex.lua_thor(txtbuf)</text>
</g>
<!-- header_24&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>header_24&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1922.0817,-2687.9306C1922.5844,-2574.9008 1925.2562,-1974.1475 1925.8729,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="1929.3738,-1835.2625 1925.9184,-1825.247 1922.3739,-1835.2313 1929.3738,-1835.2625"/>
</g>
<!-- raw_28 -->
<g id="node29" class="node">
<title>raw_28</title>
<ellipse fill="none" stroke="#000000" cx="2067" cy="-1806.9028" rx="27" ry="18"/>
<text text-anchor="middle" x="2067" y="-1802.7028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_28 -->
<g id="edge28" class="edge">
<title>prose_25&#45;&gt;raw_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2070.9183,-2687.9306C2070.4156,-2574.9008 2067.7438,-1974.1475 2067.1271,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="2070.6261,-1835.2313 2067.0816,-1825.247 2063.6262,-1835.2625 2070.6261,-1835.2313"/>
</g>
<!-- header_30 -->
<g id="node31" class="node">
<title>header_30</title>
<ellipse fill="none" stroke="#000000" cx="2291" cy="-1806.9028" rx="88.0294" ry="18"/>
<text text-anchor="middle" x="2291" y="-1802.7028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : chomp_token(lb)</text>
</g>
<!-- section_26&#45;&gt;header_30 -->
<g id="edge30" class="edge">
<title>section_26&#45;&gt;header_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2464.6704,-2688.4354C2455.3574,-2669.8928 2441.2742,-2639.8219 2433,-2612.4039 2343.5506,-2315.998 2303.4638,-1940.189 2293.5411,-1835.2395"/>
<polygon fill="#000000" stroke="#000000" points="2297.0119,-1834.763 2292.6001,-1825.1305 2290.0421,-1835.4119 2297.0119,-1834.763"/>
</g>
<!-- prose_31 -->
<g id="node32" class="node">
<title>prose_31</title>
<ellipse fill="none" stroke="#000000" cx="2474" cy="-1806.9028" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2474" y="-1802.7028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_26&#45;&gt;prose_31 -->
<g id="edge31" class="edge">
<title>section_26&#45;&gt;prose_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2474,-2687.9306C2474,-2574.9008 2474,-1974.1475 2474,-1835.4775"/>
<polygon fill="#000000" stroke="#000000" points="2477.5001,-1835.247 2474,-1825.247 2470.5001,-1835.247 2477.5001,-1835.247"/>
</g>
<!-- codeblock_32 -->
<g id="node33" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="2716" cy="-1806.9028" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2716" y="-1802.7028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 138&#45;195</text>
</g>
<!-- section_26&#45;&gt;codeblock_32 -->
<g id="edge32" class="edge">
<title>section_26&#45;&gt;codeblock_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2482.935,-2688.3088C2491.9338,-2669.6653 2505.7708,-2639.5153 2515,-2612.4039 2616.2712,-2314.9119 2690.8403,-1939.8668 2710.7309,-1835.1679"/>
<polygon fill="#000000" stroke="#000000" points="2714.2187,-1835.5593 2712.6359,-1825.0834 2707.3404,-1834.2599 2714.2187,-1835.5593"/>
</g>
<!-- codeblock_33 -->
<g id="node34" class="node">
<title>codeblock_33</title>
<ellipse fill="none" stroke="#000000" cx="3047" cy="-1806.9028" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3047" y="-1802.7028" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 198&#45;200</text>
</g>
<!-- section_26&#45;&gt;codeblock_33 -->
<g id="edge33" class="edge">
<title>section_26&#45;&gt;codeblock_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2537.1761,-2696.2596C2623.8327,-2681.2629 2773.2636,-2650.6443 2812,-2612.4039 3041.229,-2386.1103 3049.7905,-1949.7938 3047.8676,-1835.0895"/>
<polygon fill="#000000" stroke="#000000" points="3051.3653,-1834.9352 3047.6559,-1825.0109 3044.3668,-1835.0823 3051.3653,-1834.9352"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="2097.5,-564.302 1990.5,-564.302 1990.5,-492.4997 2097.5,-492.4997 2097.5,-564.302"/>
<text text-anchor="middle" x="2044" y="-516.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">...it&#39;s late.</text>
</g>
<!-- raw_28&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>raw_28&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2066.6749,-1788.8295C2064.2211,-1652.4297 2048.6048,-784.3694 2044.8236,-574.1841"/>
<polygon fill="#000000" stroke="#000000" points="2048.3218,-574.0437 2044.6424,-564.1083 2041.3229,-574.1697 2048.3218,-574.0437"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2264.5,-546.4008 2115.5,-546.4008 2115.5,-510.4008 2264.5,-510.4008 2264.5,-546.4008"/>
<text text-anchor="middle" x="2190" y="-524.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">*** chomp_token(lb)</text>
</g>
<!-- header_30&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>header_30&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2289.5722,-1788.8295C2278.4694,-1648.2851 2206.0004,-730.9405 2192.2502,-556.8854"/>
<polygon fill="#000000" stroke="#000000" points="2195.7245,-556.4207 2191.4478,-546.7274 2188.7463,-556.9721 2195.7245,-556.4207"/>
</g>
<!-- raw_35 -->
<g id="node36" class="node">
<title>raw_35</title>
<ellipse fill="none" stroke="#000000" cx="2310" cy="-528.4008" rx="27" ry="18"/>
<text text-anchor="middle" x="2310" y="-524.2008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_35 -->
<g id="edge35" class="edge">
<title>prose_31&#45;&gt;raw_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2476.703,-1788.8121C2489.3972,-1697.8429 2536.4661,-1283.6319 2388,-1001.4016 2376.554,-979.6431 2357.1822,-987.2969 2346,-965.4016 2274.8638,-826.1138 2294.7213,-628.93 2305.3363,-556.4929"/>
<polygon fill="#000000" stroke="#000000" points="2308.8357,-556.7618 2306.8844,-546.3482 2301.9158,-555.7057 2308.8357,-556.7618"/>
</g>
<!-- prespace_36 -->
<g id="node37" class="node">
<title>prespace_36</title>
<ellipse fill="none" stroke="#000000" cx="2401" cy="-528.4008" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2401" y="-524.2008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_31&#45;&gt;prespace_36 -->
<g id="edge36" class="edge">
<title>prose_31&#45;&gt;prespace_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2472.968,-1788.8295C2464.9432,-1648.2851 2412.5646,-730.9405 2402.6264,-556.8854"/>
<polygon fill="#000000" stroke="#000000" points="2406.1109,-556.5116 2402.0464,-546.7274 2399.1223,-556.9107 2406.1109,-556.5116"/>
</g>
<!-- literal_37 -->
<g id="node38" class="node">
<title>literal_37</title>
<ellipse fill="none" stroke="#000000" cx="2497" cy="-528.4008" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2497" y="-524.2008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_31&#45;&gt;literal_37 -->
<g id="edge37" class="edge">
<title>prose_31&#45;&gt;literal_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2474.3251,-1788.8295C2476.8535,-1648.2851 2493.3564,-730.9405 2496.4876,-556.8854"/>
<polygon fill="#000000" stroke="#000000" points="2499.9898,-556.7888 2496.6703,-546.7274 2492.9909,-556.6628 2499.9898,-556.7888"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2573" cy="-528.4008" rx="27" ry="18"/>
<text text-anchor="middle" x="2573" y="-524.2008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_31&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2475.3995,-1788.8295C2486.2825,-1648.2851 2557.3165,-730.9405 2570.7943,-556.8854"/>
<polygon fill="#000000" stroke="#000000" points="2574.2983,-556.9678 2571.5809,-546.7274 2567.3192,-556.4274 2574.2983,-556.9678"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3019.5,-965.4024 2618.5,-965.4024 2618.5,-91.3993 3019.5,-91.3993 3019.5,-965.4024"/>
<text text-anchor="middle" x="2819" y="-950.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function chomp_token(lb)</text>
<text text-anchor="middle" x="2819" y="-934.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(lua_toks) do</text>
<text text-anchor="middle" x="2819" y="-919.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bite = match(v, lb)</text>
<text text-anchor="middle" x="2819" y="-904.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if bite ~= nil then</text>
<text text-anchor="middle" x="2819" y="-888.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return sub(lb, 1, bite &#45; 1), sub(lb, bite), v</text>
<text text-anchor="middle" x="2819" y="-873.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2819" y="-857.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2819" y="-842.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="2819" y="-827.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2819" y="-795.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.chomp = chomp_token</text>
<text text-anchor="middle" x="2819" y="-748.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; a bit of finesse to mark up strings with quotemarks.</text>
<text text-anchor="middle" x="2819" y="-732.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;</text>
<text text-anchor="middle" x="2819" y="-701.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _str_hl(str)</text>
<text text-anchor="middle" x="2819" y="-686.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local mark = sub(str,1,1) == &quot;&#39;&quot; and &quot;&#39;&quot; or &#39;&quot;&#39;</text>
<text text-anchor="middle" x="2819" y="-670.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;mark = c.color.string(mark)</text>
<text text-anchor="middle" x="2819" y="-655.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return mark .. ts(str) .. mark</text>
<text text-anchor="middle" x="2819" y="-639.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2819" y="-592.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">function Lex.lua_thor(txtbuf)</text>
<text text-anchor="middle" x="2819" y="-577.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local toks = {}</text>
<text text-anchor="middle" x="2819" y="-561.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local wid = {}</text>
<text text-anchor="middle" x="2819" y="-546.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(txtbuf)</text>
<text text-anchor="middle" x="2819" y="-530.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;while lb ~= &quot;&quot; do</text>
<text text-anchor="middle" x="2819" y="-515.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local len = #lb</text>
<text text-anchor="middle" x="2819" y="-500.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bite, tok_t</text>
<text text-anchor="middle" x="2819" y="-484.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;bite, lb, tok_t = chomp_token(lb)</text>
<text text-anchor="middle" x="2819" y="-469.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if bite == nil then</text>
<text text-anchor="middle" x="2819" y="-453.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break</text>
<text text-anchor="middle" x="2819" y="-438.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2819" y="-423.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local col = color_map[lex_map[tok_t]]</text>
<text text-anchor="middle" x="2819" y="-407.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if col then</text>
<text text-anchor="middle" x="2819" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = col</text>
<text text-anchor="middle" x="2819" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;wid[#wid + 1] &#160;&#160;= 0</text>
<text text-anchor="middle" x="2819" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = bite</text>
<text text-anchor="middle" x="2819" y="-346.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;wid[#wid + 1] &#160;&#160;= #bite</text>
<text text-anchor="middle" x="2819" y="-330.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif tok_t == string_short then</text>
<text text-anchor="middle" x="2819" y="-315.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = _str_hl(bite)</text>
<text text-anchor="middle" x="2819" y="-299.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;wid[#wid + 1] = #bite</text>
<text text-anchor="middle" x="2819" y="-284.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2819" y="-269.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = bite</text>
<text text-anchor="middle" x="2819" y="-253.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;wid[#wid + 1] = #bite</text>
<text text-anchor="middle" x="2819" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2819" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2819" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if len == #lb then</text>
<text text-anchor="middle" x="2819" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error &quot;lua&#45;thor has failed you&quot;</text>
<text text-anchor="middle" x="2819" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2819" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2819" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;toks[#toks + 1] = a.clear()</text>
<text text-anchor="middle" x="2819" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;wid[#wid + 1] = 0</text>
<text text-anchor="middle" x="2819" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return toks, wid</text>
<text text-anchor="middle" x="2819" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_32&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2717.456,-1788.8295C2724.6073,-1700.0629 2756.7228,-1301.4255 2782.9483,-975.8975"/>
<polygon fill="#000000" stroke="#000000" points="2786.4471,-976.0527 2783.7615,-965.8039 2779.4697,-975.4905 2786.4471,-976.0527"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="3124,-546.4008 3038,-546.4008 3038,-510.4008 3124,-510.4008 3124,-546.4008"/>
<text text-anchor="middle" x="3081" y="-524.9008" font-family="Inconsolata" font-size="14.00" fill="#000000">return Lex</text>
</g>
<!-- codeblock_33&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_33&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3047.4806,-1788.8295C3051.2182,-1648.2851 3075.6137,-730.9405 3080.2425,-556.8854"/>
<polygon fill="#000000" stroke="#000000" points="3083.7455,-556.817 3080.5126,-546.7274 3076.7479,-556.6308 3083.7455,-556.817"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2361.5,-55.6015 2086.5,-55.6015 2086.5,.2015 2361.5,.2015 2361.5,-55.6015"/>
<text text-anchor="middle" x="2224" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">This is an almost pessimal way to use</text>
</g>
<!-- raw_35&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_35&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2312.013,-510.1079C2318.0628,-448.5183 2332.2089,-244.0174 2273,-91.4 2269.253,-81.7417 2263.5575,-72.3274 2257.3591,-63.828"/>
<polygon fill="#000000" stroke="#000000" points="2259.9304,-61.4313 2251.0465,-55.6584 2254.3913,-65.7114 2259.9304,-61.4313"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="2434,-45.7 2380,-45.7 2380,-9.7 2434,-9.7 2434,-45.7"/>
<text text-anchor="middle" x="2407" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_36&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>prespace_36&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2401.2171,-510.2848C2402.1175,-435.1452 2405.5625,-147.6615 2406.6612,-55.9749"/>
<polygon fill="#000000" stroke="#000000" points="2410.163,-55.8329 2406.7832,-45.7917 2403.1635,-55.749 2410.163,-55.8329"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="2518,-45.7 2464,-45.7 2464,-9.7 2518,-9.7 2518,-45.7"/>
<text text-anchor="middle" x="2491" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_37&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>literal_37&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2496.7829,-510.2848C2495.8825,-435.1452 2492.4375,-147.6615 2491.3388,-55.9749"/>
<polygon fill="#000000" stroke="#000000" points="2494.8365,-55.749 2491.2168,-45.7917 2487.837,-55.8329 2494.8365,-55.749"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="2783.5,-47.0006 2536.5,-47.0006 2536.5,-8.3994 2783.5,-8.3994 2783.5,-47.0006"/>
<text text-anchor="middle" x="2660" y="-31.9" font-family="Inconsolata" font-size="14.00" fill="#000000">, which is quite capable of</text>
<text text-anchor="middle" x="2660" y="-16.5" font-family="Inconsolata" font-size="14.00" fill="#000000">handling a full line in one pass.</text>
</g>
<!-- raw_38&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_38&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2570.8186,-510.0662C2564.2276,-448.3446 2548.4957,-243.4751 2609,-91.4 2614.3001,-78.0784 2623.3801,-65.3344 2632.423,-54.7932"/>
<polygon fill="#000000" stroke="#000000" points="2635.1792,-56.9628 2639.2678,-47.1886 2629.9763,-52.2798 2635.1792,-56.9628"/>
</g>
</g>
</svg>
