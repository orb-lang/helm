<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="3204pt" height="2927pt"
 viewBox="0.00 0.00 3204.00 2927.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2923.204)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2923.204 3200,-2923.204 3200,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2901.204" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="873" y="-2897.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 195</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2829.204" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="873" y="-2825.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;125</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2883.0354C873,-2875.3349 873,-2866.1783 873,-2857.6206"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2857.6172 873,-2847.6173 869.5001,-2857.6173 876.5001,-2857.6172"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="371" cy="-2757.204" rx="36.8096" ry="18"/>
<text text-anchor="middle" x="371" y="-2753.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Lex</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M814.4318,-2820.8038C713.1974,-2806.2841 507.5905,-2776.7947 416.3577,-2763.7095"/>
<polygon fill="#000000" stroke="#000000" points="416.7273,-2760.2268 406.3317,-2762.2715 415.7334,-2767.1559 416.7273,-2760.2268"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="544" cy="-2757.204" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="544" y="-2753.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.5938,-2817.954C755.9905,-2803.5971 643.8757,-2779.0613 584.1773,-2765.9966"/>
<polygon fill="#000000" stroke="#000000" points="584.8789,-2762.5674 574.3618,-2763.8485 583.3823,-2769.4055 584.8789,-2762.5674"/>
</g>
<!-- codeblock_4 -->
<g id="node5" class="node">
<title>codeblock_4</title>
<ellipse fill="none" stroke="#000000" cx="873" cy="-2757.204" rx="72.5844" ry="18"/>
<text text-anchor="middle" x="873" y="-2753.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 6&#45;15</text>
</g>
<!-- section_1&#45;&gt;codeblock_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;codeblock_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2811.0354C873,-2803.3349 873,-2794.1783 873,-2785.6206"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2785.6172 873,-2775.6173 869.5001,-2785.6173 876.5001,-2785.6172"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="1218" cy="-2757.204" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1218" y="-2753.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 18&#45;125</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M925.3981,-2818.2687C986.4488,-2805.5277 1087.344,-2784.4713 1153.2464,-2770.7178"/>
<polygon fill="#000000" stroke="#000000" points="1154.0348,-2774.1287 1163.1088,-2768.6595 1152.6047,-2767.2764 1154.0348,-2774.1287"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="1990" cy="-2757.204" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="1990" y="-2753.004" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 126&#45;130</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M937.0667,-2825.0744C1127.9449,-2812.7707 1692.8021,-2776.3609 1906.6695,-2762.5753"/>
<polygon fill="#000000" stroke="#000000" points="1907.1375,-2766.0525 1916.8916,-2761.9164 1906.6871,-2759.067 1907.1375,-2766.0525"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="312,-2655.6039 258,-2655.6039 258,-2619.6039 312,-2619.6039 312,-2655.6039"/>
<text text-anchor="middle" x="285" y="-2634.1039" font-family="Inconsolata" font-size="14.00" fill="#000000">* Lex</text>
</g>
<!-- header_2&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>header_2&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M354.1115,-2741.0998C343.8453,-2730.816 330.86,-2716.8866 321,-2703.204 312.43,-2691.3115 304.4209,-2677.1582 298.1431,-2665.0474"/>
<polygon fill="#000000" stroke="#000000" points="301.1334,-2663.2043 293.502,-2655.855 294.8846,-2666.3592 301.1334,-2663.2043"/>
</g>
<!-- raw_8 -->
<g id="node9" class="node">
<title>raw_8</title>
<ellipse fill="none" stroke="#000000" cx="357" cy="-2637.6039" rx="27" ry="18"/>
<text text-anchor="middle" x="357" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;raw_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.6692,-2752.7181C479.6219,-2746.5773 427.6344,-2732.7432 393,-2703.204 381.1063,-2693.06 372.44,-2677.959 366.5947,-2664.802"/>
<polygon fill="#000000" stroke="#000000" points="369.7027,-2663.1563 362.668,-2655.234 363.2269,-2665.8141 369.7027,-2663.1563"/>
</g>
<!-- prespace_9 -->
<g id="node10" class="node">
<title>prespace_9</title>
<ellipse fill="none" stroke="#000000" cx="448" cy="-2637.6039" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="448" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_3&#45;&gt;prespace_9 -->
<g id="edge9" class="edge">
<title>prose_3&#45;&gt;prespace_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M530.6516,-2740.5741C514.5001,-2720.452 487.1404,-2686.3663 468.3536,-2662.9611"/>
<polygon fill="#000000" stroke="#000000" points="470.8459,-2660.4747 461.8567,-2654.867 465.3869,-2664.8564 470.8459,-2660.4747"/>
</g>
<!-- literal_10 -->
<g id="node11" class="node">
<title>literal_10</title>
<ellipse fill="none" stroke="#000000" cx="544" cy="-2637.6039" rx="31.481" ry="18"/>
<text text-anchor="middle" x="544" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_3&#45;&gt;literal_10 -->
<g id="edge10" class="edge">
<title>prose_3&#45;&gt;literal_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M544,-2739.0393C544,-2719.6332 544,-2688.614 544,-2665.9818"/>
<polygon fill="#000000" stroke="#000000" points="547.5001,-2665.9395 544,-2655.9395 540.5001,-2665.9395 547.5001,-2665.9395"/>
</g>
<!-- raw_11 -->
<g id="node12" class="node">
<title>raw_11</title>
<ellipse fill="none" stroke="#000000" cx="620" cy="-2637.6039" rx="27" ry="18"/>
<text text-anchor="middle" x="620" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_11 -->
<g id="edge11" class="edge">
<title>prose_3&#45;&gt;raw_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.2159,-2740.5967C565.3179,-2730.1235 575.6931,-2716.1718 584,-2703.204 592.0728,-2690.6017 600.1703,-2676.0571 606.6354,-2663.8703"/>
<polygon fill="#000000" stroke="#000000" points="609.9065,-2665.1679 611.4387,-2654.6844 603.7033,-2661.9243 609.9065,-2665.1679"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="1080.5,-2703.3043 665.5,-2703.3043 665.5,-2571.9035 1080.5,-2571.9035 1080.5,-2703.3043"/>
<text text-anchor="middle" x="873" y="-2688.004" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="873" y="-2672.604" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, R, S, match = L.P, L.R, L.S, L.match</text>
<text text-anchor="middle" x="873" y="-2657.2039" font-family="Inconsolata" font-size="14.00" fill="#000000">local Lex = meta {}</text>
<text text-anchor="middle" x="873" y="-2641.8039" font-family="Inconsolata" font-size="14.00" fill="#000000">local Rainbuf = require &quot;rainbuf&quot;</text>
<text text-anchor="middle" x="873" y="-2626.4039" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub, gsub = assert(string.sub), assert(string.gsub)</text>
<text text-anchor="middle" x="873" y="-2611.0038" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = assert(table.concat)</text>
<text text-anchor="middle" x="873" y="-2595.6038" font-family="Inconsolata" font-size="14.00" fill="#000000">local c = require &quot;color&quot;</text>
<text text-anchor="middle" x="873" y="-2580.2038" font-family="Inconsolata" font-size="14.00" fill="#000000">local codepoints = assert(string.codepoints)</text>
</g>
<!-- codeblock_4&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>codeblock_4&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M873,-2739.0393C873,-2731.7643 873,-2722.8573 873,-2713.3719"/>
<polygon fill="#000000" stroke="#000000" points="876.5001,-2713.3218 873,-2703.3218 869.5001,-2713.3219 876.5001,-2713.3218"/>
</g>
<!-- header_17 -->
<g id="node18" class="node">
<title>header_17</title>
<ellipse fill="none" stroke="#000000" cx="1162" cy="-2637.6039" rx="63.3963" ry="18"/>
<text text-anchor="middle" x="1162" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Lua lexers</text>
</g>
<!-- section_5&#45;&gt;header_17 -->
<g id="edge17" class="edge">
<title>section_5&#45;&gt;header_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1209.6162,-2739.2986C1200.3787,-2719.57 1185.4168,-2687.6156 1174.7302,-2664.7919"/>
<polygon fill="#000000" stroke="#000000" points="1177.8513,-2663.2039 1170.4411,-2655.6316 1171.5118,-2666.1722 1177.8513,-2663.2039"/>
</g>
<!-- prose_18 -->
<g id="node19" class="node">
<title>prose_18</title>
<ellipse fill="none" stroke="#000000" cx="1275" cy="-2637.6039" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1275" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_18 -->
<g id="edge18" class="edge">
<title>section_5&#45;&gt;prose_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1226.5335,-2739.2986C1235.9903,-2719.4559 1251.3413,-2687.2458 1262.2307,-2664.3971"/>
<polygon fill="#000000" stroke="#000000" points="1265.4515,-2665.7743 1266.5942,-2655.2412 1259.1324,-2662.7626 1265.4515,-2665.7743"/>
</g>
<!-- codeblock_19 -->
<g id="node20" class="node">
<title>codeblock_19</title>
<ellipse fill="none" stroke="#000000" cx="1494" cy="-2637.6039" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1494" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 20&#45;123</text>
</g>
<!-- section_5&#45;&gt;codeblock_19 -->
<g id="edge19" class="edge">
<title>section_5&#45;&gt;codeblock_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1253.7992,-2741.691C1303.1961,-2720.2857 1392.3391,-2681.657 1447.0351,-2657.9553"/>
<polygon fill="#000000" stroke="#000000" points="1448.7147,-2661.0421 1456.4986,-2653.8545 1445.9314,-2654.6192 1448.7147,-2661.0421"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="1914" cy="-2637.6039" rx="103.0387" ry="18"/>
<text text-anchor="middle" x="1914" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Lex.lua_thor(linebuf)</text>
</g>
<!-- section_6&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_6&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1978.622,-2739.2986C1965.9735,-2719.3938 1945.4168,-2687.044 1930.8896,-2664.1828"/>
<polygon fill="#000000" stroke="#000000" points="1933.7731,-2662.1946 1925.4557,-2655.6316 1927.865,-2665.9489 1933.7731,-2662.1946"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2067" cy="-2637.6039" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2067" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_6&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2002.133,-2739.2912C2009.1773,-2728.8203 2018.1773,-2715.3203 2026,-2703.204 2034.4173,-2690.1668 2043.5888,-2675.5343 2051.1188,-2663.4025"/>
<polygon fill="#000000" stroke="#000000" points="2054.2304,-2665.0256 2056.5175,-2654.6805 2048.2783,-2661.3414 2054.2304,-2665.0256"/>
</g>
<!-- section_26 -->
<g id="node27" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2470" cy="-2637.6039" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="2470" y="-2633.4039" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 131&#45;195</text>
</g>
<!-- section_6&#45;&gt;section_26 -->
<g id="edge26" class="edge">
<title>section_6&#45;&gt;section_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2042.2822,-2744.177C2131.4585,-2721.9572 2312.5626,-2676.8321 2407.9817,-2653.0568"/>
<polygon fill="#000000" stroke="#000000" points="2408.9252,-2656.4288 2417.7823,-2650.6148 2407.2327,-2649.6365 2408.9252,-2656.4288"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="408,-1773.5038 0,-1773.5038 0,-1701.7015 408,-1701.7015 408,-1773.5038"/>
<text text-anchor="middle" x="204" y="-1710.1026" font-family="Inconsolata" font-size="14.00" fill="#000000">We&#39;re going to do this will straight el peg, and fold in</text>
</g>
<!-- raw_8&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>raw_8&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M353.9438,-2619.626C335.5964,-2511.7004 239.9222,-1948.9099 211.7885,-1783.4175"/>
<polygon fill="#000000" stroke="#000000" points="215.2381,-1782.8249 210.1115,-1773.553 208.3371,-1783.9981 215.2381,-1782.8249"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="480,-1755.6026 426,-1755.6026 426,-1719.6026 480,-1719.6026 480,-1755.6026"/>
<text text-anchor="middle" x="453" y="-1734.1026" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_9&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>prespace_9&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M448.1021,-2619.2182C448.7305,-2506.113 452.0702,-1904.9589 452.8411,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="456.3423,-1765.9784 452.898,-1755.9591 449.3424,-1765.9395 456.3423,-1765.9784"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="577,-1755.6026 505,-1755.6026 505,-1719.6026 577,-1719.6026 577,-1755.6026"/>
<text text-anchor="middle" x="541" y="-1734.1026" font-family="Inconsolata" font-size="14.00" fill="#000000">espalier</text>
</g>
<!-- literal_10&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>literal_10&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543.9387,-2619.2182C543.5617,-2506.113 541.5579,-1904.9589 541.0953,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="544.5946,-1765.9473 541.0612,-1755.9591 537.5946,-1765.9707 544.5946,-1765.9473"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="653,-1755.6026 595,-1755.6026 595,-1719.6026 653,-1719.6026 653,-1755.6026"/>
<text text-anchor="middle" x="624" y="-1734.1026" font-family="Inconsolata" font-size="14.00" fill="#000000"> ASAP.</text>
</g>
<!-- raw_11&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M620.0817,-2619.2182C620.5844,-2506.113 623.2562,-1904.9589 623.8729,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="627.3738,-1765.9746 623.9184,-1755.9591 620.3739,-1765.9434 627.3738,-1765.9746"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1176,-1755.6026 1062,-1755.6026 1062,-1719.6026 1176,-1719.6026 1176,-1755.6026"/>
<text text-anchor="middle" x="1119" y="-1734.1026" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Lua lexers</text>
</g>
<!-- header_17&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>header_17&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1161.1216,-2619.2182C1155.7177,-2506.113 1126.9959,-1904.9589 1120.3661,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="1123.8504,-1765.7806 1119.877,-1755.9591 1116.8583,-1766.1148 1123.8504,-1765.7806"/>
</g>
<!-- raw_21 -->
<g id="node22" class="node">
<title>raw_21</title>
<ellipse fill="none" stroke="#000000" cx="1221" cy="-1737.6026" rx="27" ry="18"/>
<text text-anchor="middle" x="1221" y="-1733.4026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_18&#45;&gt;raw_21 -->
<g id="edge21" class="edge">
<title>prose_18&#45;&gt;raw_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1271.1027,-2619.7202C1266.868,-2599.5054 1260.2704,-2565.5599 1257,-2536.0037 1223.7986,-2235.9489 1221.029,-1869.2245 1220.9457,-1765.8887"/>
<polygon fill="#000000" stroke="#000000" points="1224.4456,-1765.6581 1220.9459,-1755.6579 1217.4456,-1765.6578 1224.4456,-1765.6581"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1807.5,-2535.9049 1266.5,-2535.9049 1266.5,-939.3004 1807.5,-939.3004 1807.5,-2535.9049"/>
<text text-anchor="middle" x="1537" y="-2520.8037" font-family="Inconsolata" font-size="14.00" fill="#000000">local WS = (P&quot; &quot;)^0</text>
<text text-anchor="middle" x="1537" y="-2489.4037" font-family="Inconsolata" font-size="14.00" fill="#000000">local NL = P&quot;\n&quot;</text>
<text text-anchor="middle" x="1537" y="-2458.0037" font-family="Inconsolata" font-size="14.00" fill="#000000">local terminal = S&quot; \&quot;&#39;+&#45;*^~%#;,&lt;&gt;={}[]().:\n&quot; + &#45;P(1)</text>
<text text-anchor="middle" x="1537" y="-2426.6037" font-family="Inconsolata" font-size="14.00" fill="#000000">local KW = (P&quot;function&quot; + &quot;local&quot; + &quot;for&quot; + &quot;in&quot; + &quot;do&quot;</text>
<text text-anchor="middle" x="1537" y="-2411.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;and&quot; + &quot;or&quot; + &quot;not&quot; + &quot;true&quot; + &quot;false&quot;</text>
<text text-anchor="middle" x="1537" y="-2395.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;while&quot; + &quot;break&quot; + &quot;if&quot; + &quot;then&quot; + &quot;else&quot; + &quot;elseif&quot;</text>
<text text-anchor="middle" x="1537" y="-2380.4036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;goto&quot; + &quot;repeat&quot; + &quot;until&quot; + &quot;return&quot; + &quot;nil&quot;</text>
<text text-anchor="middle" x="1537" y="-2365.0035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;end&quot;) * #terminal</text>
<text text-anchor="middle" x="1537" y="-2333.6035" font-family="Inconsolata" font-size="14.00" fill="#000000">local OP = P&quot;+&quot; + &quot;&#45;&quot; + &quot;*&quot; + &quot;/&quot; + &quot;%&quot; + &quot;^&quot; + &quot;#&quot;</text>
<text text-anchor="middle" x="1537" y="-2318.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;==&quot; + &quot;~=&quot; + &quot;&lt;=&quot; + &quot;&gt;=&quot; + &quot;&lt;&quot; + &quot;&gt;&quot;</text>
<text text-anchor="middle" x="1537" y="-2302.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;=&quot; + &quot;(&quot; + &quot;)&quot; + &quot;{&quot; + &quot;}&quot; + &quot;[&quot; + &quot;]&quot;</text>
<text text-anchor="middle" x="1537" y="-2287.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ &quot;;&quot; + &quot;;&quot; + &quot;...&quot; + &quot;..&quot; + &quot;.&quot; + &quot;,&quot;</text>
<text text-anchor="middle" x="1537" y="-2256.0034" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; long strings, straight from the LPEG docs</text>
<text text-anchor="middle" x="1537" y="-2224.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">local _equals = P&quot;=&quot;^0</text>
<text text-anchor="middle" x="1537" y="-2209.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">local _open = &quot;[&quot; * L.Cg(_equals, &quot;init&quot;) * &quot;[&quot; * P&quot;\n&quot;^&#45;1</text>
<text text-anchor="middle" x="1537" y="-2193.8033" font-family="Inconsolata" font-size="14.00" fill="#000000">local _close = &quot;]&quot; * L.C(_equals) * &quot;]&quot;</text>
<text text-anchor="middle" x="1537" y="-2178.4032" font-family="Inconsolata" font-size="14.00" fill="#000000">local _closeeq = L.Cmt(_close * L.Cb(&quot;init&quot;),</text>
<text text-anchor="middle" x="1537" y="-2163.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;function (s, i, a, b) return a == b end)</text>
<text text-anchor="middle" x="1537" y="-2131.6032" font-family="Inconsolata" font-size="14.00" fill="#000000">local long_str = (_open * L.C((P(1) &#45; _closeeq)^0) * _close) / 0 * L.Cp()</text>
<text text-anchor="middle" x="1537" y="-2100.2032" font-family="Inconsolata" font-size="14.00" fill="#000000">local str_esc = P&quot;\\&quot; * (S&quot;abfnrtv\\\&quot;&#39;[]\n&quot; + (R&quot;09&quot; * R&quot;09&quot;^&#45;2))</text>
<text text-anchor="middle" x="1537" y="-2068.8031" font-family="Inconsolata" font-size="14.00" fill="#000000">local double_str = P&quot;\&quot;&quot; * (P(1) &#45; (P&quot;\&quot;&quot; + P&quot;\\&quot;) + str_esc)^0 * P&quot;\&quot;&quot;</text>
<text text-anchor="middle" x="1537" y="-2053.4031" font-family="Inconsolata" font-size="14.00" fill="#000000">local single_str = P&quot;\&#39;&quot; * (P(1) &#45; (P&quot;\&#39;&quot; + P&quot;\\&quot;) + str_esc)^0 * P&quot;\&#39;&quot;</text>
<text text-anchor="middle" x="1537" y="-2022.0031" font-family="Inconsolata" font-size="14.00" fill="#000000">local string_esc = double_str + single_str</text>
<text text-anchor="middle" x="1537" y="-1990.603" font-family="Inconsolata" font-size="14.00" fill="#000000">local string_long = long_str</text>
<text text-anchor="middle" x="1537" y="-1959.203" font-family="Inconsolata" font-size="14.00" fill="#000000">local digit = R&quot;09&quot;</text>
<text text-anchor="middle" x="1537" y="-1927.803" font-family="Inconsolata" font-size="14.00" fill="#000000">local letter = R&quot;az&quot; + R&quot;AZ&quot;</text>
<text text-anchor="middle" x="1537" y="-1896.4029" font-family="Inconsolata" font-size="14.00" fill="#000000">local symbol = &#160;&#160;(letter^1 + P&quot;_&quot;^1)</text>
<text text-anchor="middle" x="1537" y="-1881.0029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* (letter + digit + P&quot;_&quot;)^0</text>
<text text-anchor="middle" x="1537" y="-1865.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* #terminal</text>
<text text-anchor="middle" x="1537" y="-1834.2028" font-family="Inconsolata" font-size="14.00" fill="#000000">local _decimal = P&quot;&#45;&quot;^0 * ((digit^1 * P&quot;.&quot;^&#45;1 * digit^0</text>
<text text-anchor="middle" x="1537" y="-1818.8028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((P&quot;e&quot; + P&quot;E&quot;)^&#45;1 * P&quot;&#45;&quot;^&#45;1 * digit^1)^&#45;1</text>
<text text-anchor="middle" x="1537" y="-1803.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ digit^1)^1 + digit^1)</text>
<text text-anchor="middle" x="1537" y="-1772.0027" font-family="Inconsolata" font-size="14.00" fill="#000000">local higit = R&quot;09&quot; + R&quot;af&quot; + R&quot;AF&quot;</text>
<text text-anchor="middle" x="1537" y="-1740.6027" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; hexadecimal floats. are a thing. that exists.</text>
<text text-anchor="middle" x="1537" y="-1725.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local _hexadecimal = P&quot;&#45;&quot;^0 * P&quot;0&quot; * (P&quot;x&quot; + P&quot;X&quot;)</text>
<text text-anchor="middle" x="1537" y="-1709.8027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((higit^1 * P&quot;.&quot;^&#45;1 * higit^0</text>
<text text-anchor="middle" x="1537" y="-1694.4026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;* ((P&quot;p&quot; + P&quot;P&quot;)^&#45;1 * P&quot;&#45;&quot;^&#45;1 * higit^1)^&#45;1</text>
<text text-anchor="middle" x="1537" y="-1679.0026" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ higit^1)^1 + higit^1)</text>
<text text-anchor="middle" x="1537" y="-1647.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local number = _hexadecimal + _decimal</text>
<text text-anchor="middle" x="1537" y="-1616.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local comment = P&quot;&#45;&#45;&quot; * long_str</text>
<text text-anchor="middle" x="1537" y="-1600.8025" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;+ P&quot;&#45;&#45;&quot; * (P(1) &#45; NL)^0 * (NL + &#45; P(1))</text>
<text text-anchor="middle" x="1537" y="-1553.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">local ERR = P(1)</text>
<text text-anchor="middle" x="1537" y="-1522.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local lua_toks = {comment, KW, string_long, string_esc, number, OP, symbol,</text>
<text text-anchor="middle" x="1537" y="-1506.6024" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WS, NL, ERR}</text>
<text text-anchor="middle" x="1537" y="-1475.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local lex_kv = { KW = KW,</text>
<text text-anchor="middle" x="1537" y="-1459.8023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;number = number,</text>
<text text-anchor="middle" x="1537" y="-1444.4023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;OP = OP,</text>
<text text-anchor="middle" x="1537" y="-1429.0023" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;symbol = symbol,</text>
<text text-anchor="middle" x="1537" y="-1413.6022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string_long = string_long,</text>
<text text-anchor="middle" x="1537" y="-1398.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;string_esc = string_esc,</text>
<text text-anchor="middle" x="1537" y="-1382.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;comment = comment,</text>
<text text-anchor="middle" x="1537" y="-1367.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WS = WS,</text>
<text text-anchor="middle" x="1537" y="-1352.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;NL = NL,</text>
<text text-anchor="middle" x="1537" y="-1336.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ERR = ERR}</text>
<text text-anchor="middle" x="1537" y="-1305.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local color_map = {</text>
<text text-anchor="middle" x="1537" y="-1289.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;KW = c.color.keyword(),</text>
<text text-anchor="middle" x="1537" y="-1274.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;OP = c.color.operator(),</text>
<text text-anchor="middle" x="1537" y="-1259.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;number = c.color.number(),</text>
<text text-anchor="middle" x="1537" y="-1243.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;symbol = c.color.field(),</text>
<text text-anchor="middle" x="1537" y="-1228.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;string_esc = c.color.string(),</text>
<text text-anchor="middle" x="1537" y="-1212.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;string_long = c.color.string(),</text>
<text text-anchor="middle" x="1537" y="-1197.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;comment = c.color.comment(),</text>
<text text-anchor="middle" x="1537" y="-1182.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ERR = c.color.error(),</text>
<text text-anchor="middle" x="1537" y="-1166.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">}</text>
<text text-anchor="middle" x="1537" y="-1119.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">local lex_map = {}</text>
<text text-anchor="middle" x="1537" y="-1087.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">for k, v in pairs(lex_kv) do</text>
<text text-anchor="middle" x="1537" y="-1072.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;lex_map[v] = k</text>
<text text-anchor="middle" x="1537" y="-1057.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1537" y="-1025.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">lex_kv = nil</text>
<text text-anchor="middle" x="1537" y="-994.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.lex_map = lex_map</text>
<text text-anchor="middle" x="1537" y="-962.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.long_str = long_str</text>
<text text-anchor="middle" x="1537" y="-947.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.string = string_long</text>
</g>
<!-- codeblock_19&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_19&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1494.8784,-2619.2182C1495.631,-2603.4662 1496.8359,-2578.2482 1498.3703,-2546.1316"/>
<polygon fill="#000000" stroke="#000000" points="1501.8757,-2546.1014 1498.857,-2535.9457 1494.8837,-2545.7672 1501.8757,-2546.1014"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1248,-515.3008 1194,-515.3008 1194,-479.3008 1248,-479.3008 1248,-515.3008"/>
</g>
<!-- raw_21&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>raw_21&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1221,-1719.5912C1221,-1581.8573 1221,-696.1565 1221,-525.6696"/>
<polygon fill="#000000" stroke="#000000" points="1224.5001,-525.4897 1221,-515.4897 1217.5001,-525.4898 1224.5001,-525.4897"/>
</g>
<!-- leaf_27 -->
<g id="node28" class="node">
<title>leaf_27</title>
<polygon fill="none" stroke="#c0c0c0" points="2010,-1755.6026 1826,-1755.6026 1826,-1719.6026 2010,-1719.6026 2010,-1755.6026"/>
<text text-anchor="middle" x="1918" y="-1734.1026" font-family="Inconsolata" font-size="14.00" fill="#000000">** Lex.lua_thor(linebuf)</text>
</g>
<!-- header_24&#45;&gt;leaf_27 -->
<g id="edge27" class="edge">
<title>header_24&#45;&gt;leaf_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1914.0817,-2619.2182C1914.5844,-2506.113 1917.2562,-1904.9589 1917.8729,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="1921.3738,-1765.9746 1917.9184,-1755.9591 1914.3739,-1765.9434 1921.3738,-1765.9746"/>
</g>
<!-- raw_28 -->
<g id="node29" class="node">
<title>raw_28</title>
<ellipse fill="none" stroke="#000000" cx="2063" cy="-1737.6026" rx="27" ry="18"/>
<text text-anchor="middle" x="2063" y="-1733.4026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_28 -->
<g id="edge28" class="edge">
<title>prose_25&#45;&gt;raw_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2066.9183,-2619.2182C2066.4156,-2506.113 2063.7438,-1904.9589 2063.1271,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="2066.6261,-1765.9434 2063.0816,-1755.9591 2059.6262,-1765.9746 2066.6261,-1765.9434"/>
</g>
<!-- header_30 -->
<g id="node31" class="node">
<title>header_30</title>
<ellipse fill="none" stroke="#000000" cx="2287" cy="-1737.6026" rx="88.0294" ry="18"/>
<text text-anchor="middle" x="2287" y="-1733.4026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : chomp_token(lb)</text>
</g>
<!-- section_26&#45;&gt;header_30 -->
<g id="edge30" class="edge">
<title>section_26&#45;&gt;header_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2461.4265,-2619.6514C2452.1938,-2599.6554 2437.6669,-2566.168 2429,-2536.0037 2344.2324,-2240.9776 2300.8525,-1869.3483 2289.85,-1765.6083"/>
<polygon fill="#000000" stroke="#000000" points="2293.3262,-1765.1971 2288.8031,-1755.6162 2286.3643,-1765.9265 2293.3262,-1765.1971"/>
</g>
<!-- prose_31 -->
<g id="node32" class="node">
<title>prose_31</title>
<ellipse fill="none" stroke="#000000" cx="2470" cy="-1737.6026" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2470" y="-1733.4026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_26&#45;&gt;prose_31 -->
<g id="edge31" class="edge">
<title>section_26&#45;&gt;prose_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2470,-2619.2182C2470,-2506.113 2470,-1904.9589 2470,-1766.1965"/>
<polygon fill="#000000" stroke="#000000" points="2473.5001,-1765.9591 2470,-1755.9591 2466.5001,-1765.9591 2473.5001,-1765.9591"/>
</g>
<!-- codeblock_32 -->
<g id="node33" class="node">
<title>codeblock_32</title>
<ellipse fill="none" stroke="#000000" cx="2731" cy="-1737.6026" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2731" y="-1733.4026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 136&#45;189</text>
</g>
<!-- section_26&#45;&gt;codeblock_32 -->
<g id="edge32" class="edge">
<title>section_26&#45;&gt;codeblock_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2478.0463,-2619.4866C2486.8174,-2599.3463 2500.9424,-2565.7332 2511,-2536.0037 2611.3483,-2239.382 2700.1849,-1869.5975 2724.4671,-1765.8255"/>
<polygon fill="#000000" stroke="#000000" points="2727.9371,-1766.3564 2726.8001,-1755.8227 2721.1201,-1764.7663 2727.9371,-1766.3564"/>
</g>
<!-- codeblock_33 -->
<g id="node34" class="node">
<title>codeblock_33</title>
<ellipse fill="none" stroke="#000000" cx="3100" cy="-1737.6026" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3100" y="-1733.4026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 192&#45;194</text>
</g>
<!-- section_26&#45;&gt;codeblock_33 -->
<g id="edge33" class="edge">
<title>section_26&#45;&gt;codeblock_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2531.5824,-2627.1629C2621.9711,-2610.6939 2784.4667,-2576.3726 2827,-2536.0037 3061.6857,-2313.2612 3094.6254,-1880.5409 3099.2464,-1765.9897"/>
<polygon fill="#000000" stroke="#000000" points="3102.747,-1766.0351 3099.6111,-1755.9151 3095.7516,-1765.7819 3102.747,-1766.0351"/>
</g>
<!-- leaf_29 -->
<g id="node30" class="node">
<title>leaf_29</title>
<polygon fill="none" stroke="#c0c0c0" points="2093.5,-533.2019 1986.5,-533.2019 1986.5,-461.3996 2093.5,-461.3996 2093.5,-533.2019"/>
<text text-anchor="middle" x="2040" y="-485.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">...it&#39;s late.</text>
</g>
<!-- raw_28&#45;&gt;leaf_29 -->
<g id="edge29" class="edge">
<title>raw_28&#45;&gt;leaf_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2062.666,-1719.5912C2060.19,-1586.0701 2044.6793,-749.6377 2040.8526,-543.2788"/>
<polygon fill="#000000" stroke="#000000" points="2044.3486,-543.0267 2040.6637,-533.0933 2037.3498,-543.1565 2044.3486,-543.0267"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2260.5,-515.3008 2111.5,-515.3008 2111.5,-479.3008 2260.5,-479.3008 2260.5,-515.3008"/>
<text text-anchor="middle" x="2186" y="-493.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">*** chomp_token(lb)</text>
</g>
<!-- header_30&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>header_30&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2285.5333,-1719.5912C2274.3174,-1581.8573 2202.1932,-696.1565 2188.3101,-525.6696"/>
<polygon fill="#000000" stroke="#000000" points="2191.7813,-525.1726 2187.4812,-515.4897 2184.8044,-525.7408 2191.7813,-525.1726"/>
</g>
<!-- raw_35 -->
<g id="node36" class="node">
<title>raw_35</title>
<ellipse fill="none" stroke="#000000" cx="2306" cy="-497.3008" rx="27" ry="18"/>
<text text-anchor="middle" x="2306" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_35 -->
<g id="edge35" class="edge">
<title>prose_31&#45;&gt;raw_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2472.6989,-1719.3704C2485.2331,-1628.5895 2531.1411,-1218.5948 2384,-939.2015 2372.5438,-917.4483 2353.2508,-925.0616 2342,-903.2015 2276.0832,-775.1258 2292.2467,-594.0181 2301.6236,-525.2521"/>
<polygon fill="#000000" stroke="#000000" points="2305.1094,-525.5995 2303.0567,-515.2055 2298.1795,-524.611 2305.1094,-525.5995"/>
</g>
<!-- prespace_36 -->
<g id="node37" class="node">
<title>prespace_36</title>
<ellipse fill="none" stroke="#000000" cx="2397" cy="-497.3008" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2397" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_31&#45;&gt;prespace_36 -->
<g id="edge36" class="edge">
<title>prose_31&#45;&gt;prespace_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2468.9399,-1719.5912C2460.8334,-1581.8573 2408.704,-696.1565 2398.6697,-525.6696"/>
<polygon fill="#000000" stroke="#000000" points="2402.1521,-525.2668 2398.0705,-515.4897 2395.1642,-525.6781 2402.1521,-525.2668"/>
</g>
<!-- literal_37 -->
<g id="node38" class="node">
<title>literal_37</title>
<ellipse fill="none" stroke="#000000" cx="2493" cy="-497.3008" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2493" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_31&#45;&gt;literal_37 -->
<g id="edge37" class="edge">
<title>prose_31&#45;&gt;literal_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2470.334,-1719.5912C2472.8881,-1581.8573 2489.3124,-696.1565 2492.4739,-525.6696"/>
<polygon fill="#000000" stroke="#000000" points="2495.9766,-525.5529 2492.6627,-515.4897 2488.9778,-525.4231 2495.9766,-525.5529"/>
</g>
<!-- raw_38 -->
<g id="node39" class="node">
<title>raw_38</title>
<ellipse fill="none" stroke="#000000" cx="2569" cy="-497.3008" rx="27" ry="18"/>
<text text-anchor="middle" x="2569" y="-493.1008" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_31&#45;&gt;raw_38 -->
<g id="edge38" class="edge">
<title>prose_31&#45;&gt;raw_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2471.4377,-1719.5912C2482.4315,-1581.8573 2553.1275,-696.1565 2566.7356,-525.6696"/>
<polygon fill="#000000" stroke="#000000" points="2570.2413,-525.7365 2567.5482,-515.4897 2563.2635,-525.1795 2570.2413,-525.7365"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3092,-903.1023 2614,-903.1023 2614,-91.4993 3092,-91.4993 3092,-903.1023"/>
<text text-anchor="middle" x="2853" y="-888.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function chomp_token(lb)</text>
<text text-anchor="middle" x="2853" y="-872.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(lua_toks) do</text>
<text text-anchor="middle" x="2853" y="-857.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bite = match(v, lb)</text>
<text text-anchor="middle" x="2853" y="-841.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if bite ~= nil then</text>
<text text-anchor="middle" x="2853" y="-826.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return sub(lb, 1, bite &#45; 1), sub(lb, bite), v</text>
<text text-anchor="middle" x="2853" y="-811.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-795.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-780.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return nil</text>
<text text-anchor="middle" x="2853" y="-764.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2853" y="-733.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">Lex.chomp = chomp_token</text>
<text text-anchor="middle" x="2853" y="-686.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Not using this. Want to replace it with a less&#45;dumb match&#45;based</text>
<text text-anchor="middle" x="2853" y="-670.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; lpeg system but kind over it for now.</text>
<text text-anchor="middle" x="2853" y="-655.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _str_hl(str)</text>
<text text-anchor="middle" x="2853" y="-639.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local mark = sub(str,1,1) == &quot;&#39;&quot; and &quot;&#39;&quot; or &#39;&quot;&#39;</text>
<text text-anchor="middle" x="2853" y="-624.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;mark = c.color.string(mark)</text>
<text text-anchor="middle" x="2853" y="-609.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return mark .. ts(str) .. mark</text>
<text text-anchor="middle" x="2853" y="-593.601" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2853" y="-546.201" font-family="Inconsolata" font-size="14.00" fill="#000000">function Lex.lua_thor(linebuf)</text>
<text text-anchor="middle" x="2853" y="-530.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local toks = {}</text>
<text text-anchor="middle" x="2853" y="-515.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="2853" y="-500.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;while lb ~= &quot;&quot; do</text>
<text text-anchor="middle" x="2853" y="-484.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local len = #lb</text>
<text text-anchor="middle" x="2853" y="-469.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local bite, tok_t</text>
<text text-anchor="middle" x="2853" y="-453.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;bite, lb, tok_t = chomp_token(lb)</text>
<text text-anchor="middle" x="2853" y="-438.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if bite == nil then</text>
<text text-anchor="middle" x="2853" y="-423.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;break</text>
<text text-anchor="middle" x="2853" y="-407.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2853" y="-392.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; #todo add a color</text>
<text text-anchor="middle" x="2853" y="-376.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local col = color_map[lex_map[tok_t]]</text>
<text text-anchor="middle" x="2853" y="-361.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if col then</text>
<text text-anchor="middle" x="2853" y="-346.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = col</text>
<text text-anchor="middle" x="2853" y="-330.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = bite</text>
<text text-anchor="middle" x="2853" y="-315.2005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;elseif tok_t == string_esc then</text>
<text text-anchor="middle" x="2853" y="-299.8005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = _str_hl(bite)</text>
<text text-anchor="middle" x="2853" y="-284.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2853" y="-269.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = bite</text>
<text text-anchor="middle" x="2853" y="-253.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if len == #lb then</text>
<text text-anchor="middle" x="2853" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = a.clear .. color_map.ERR</text>
<text text-anchor="middle" x="2853" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;toks[#toks + 1] = sub(lb, 1, 1)</text>
<text text-anchor="middle" x="2853" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;lb = sub(lb,2)</text>
<text text-anchor="middle" x="2853" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2853" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;toks[#toks + 1] = a.clear()</text>
<text text-anchor="middle" x="2853" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return toks</text>
<text text-anchor="middle" x="2853" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_32&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_32&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2732.7717,-1719.5912C2741.4969,-1630.8864 2780.7382,-1231.9434 2812.0497,-913.6187"/>
<polygon fill="#000000" stroke="#000000" points="2815.571,-913.5724 2813.0668,-903.2778 2808.6046,-912.8871 2815.571,-913.5724"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="3196,-515.3008 3110,-515.3008 3110,-479.3008 3196,-479.3008 3196,-515.3008"/>
<text text-anchor="middle" x="3153" y="-493.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">return Lex</text>
</g>
<!-- codeblock_33&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_33&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3100.7697,-1719.5912C3106.6552,-1581.8573 3144.5026,-696.1565 3151.7878,-525.6696"/>
<polygon fill="#000000" stroke="#000000" points="3155.2925,-525.6301 3152.2228,-515.4897 3148.2989,-525.3311 3155.2925,-525.6301"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2357.5,-55.6015 2082.5,-55.6015 2082.5,.2015 2357.5,.2015 2357.5,-55.6015"/>
<text text-anchor="middle" x="2220" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">This is an almost pessimal way to use</text>
</g>
<!-- raw_35&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>raw_35&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2307.8348,-479.085C2313.028,-420.423 2324.0955,-232.0702 2269,-91.4 2265.2219,-81.7538 2259.5134,-72.3446 2253.3121,-63.8463"/>
<polygon fill="#000000" stroke="#000000" points="2255.8835,-61.4498 2246.9998,-55.6766 2250.3443,-65.7297 2255.8835,-61.4498"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="2430,-45.7 2376,-45.7 2376,-9.7 2430,-9.7 2430,-45.7"/>
<text text-anchor="middle" x="2403" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_36&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>prespace_36&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2397.2315,-479.1796C2398.1475,-407.4902 2401.5221,-143.3669 2402.6387,-55.9809"/>
<polygon fill="#000000" stroke="#000000" points="2406.141,-55.8111 2402.7692,-45.7672 2399.1416,-55.7216 2406.141,-55.8111"/>
</g>
<!-- leaf_41 -->
<g id="node42" class="node">
<title>leaf_41</title>
<polygon fill="none" stroke="#c0c0c0" points="2514,-45.7 2460,-45.7 2460,-9.7 2514,-9.7 2514,-45.7"/>
<text text-anchor="middle" x="2487" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_37&#45;&gt;leaf_41 -->
<g id="edge41" class="edge">
<title>literal_37&#45;&gt;leaf_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2492.7685,-479.1796C2491.8525,-407.4902 2488.4779,-143.3669 2487.3613,-55.9809"/>
<polygon fill="#000000" stroke="#000000" points="2490.8584,-55.7216 2487.2308,-45.7672 2483.859,-55.8111 2490.8584,-55.7216"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="2779.5,-47.0006 2532.5,-47.0006 2532.5,-8.3994 2779.5,-8.3994 2779.5,-47.0006"/>
<text text-anchor="middle" x="2656" y="-31.9" font-family="Inconsolata" font-size="14.00" fill="#000000">, which is quite capable of</text>
<text text-anchor="middle" x="2656" y="-16.5" font-family="Inconsolata" font-size="14.00" fill="#000000">handling a full line in one pass.</text>
</g>
<!-- raw_38&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_38&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2566.9941,-479.0434C2561.2756,-420.2558 2548.7243,-231.5664 2605,-91.4 2610.3418,-78.0951 2619.4305,-65.3545 2628.4688,-54.8115"/>
<polygon fill="#000000" stroke="#000000" points="2631.2247,-56.9811 2635.3076,-47.2045 2626.0192,-52.3011 2631.2247,-56.9811"/>
</g>
</g>
</svg>
