<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="5487pt" height="1880pt"
 viewBox="0.00 0.00 5487.00 1879.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1875.8027)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1875.8027 5483,-1875.8027 5483,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1853.8027" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1389" y="-1849.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 181</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1781.8027" rx="65.0143" ry="18"/>
<text text-anchor="middle" x="1389" y="-1777.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;112</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1389,-1835.6341C1389,-1827.9337 1389,-1818.7771 1389,-1810.2193"/>
<polygon fill="#000000" stroke="#000000" points="1392.5001,-1810.2159 1389,-1800.216 1385.5001,-1810.216 1392.5001,-1810.2159"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1035" cy="-1709.8027" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1035" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1332.9138,-1772.5569C1274.8708,-1762.6832 1181.7084,-1745.9805 1102,-1727.8027 1097.3285,-1726.7374 1092.491,-1725.5685 1087.6518,-1724.3539"/>
<polygon fill="#000000" stroke="#000000" points="1088.3256,-1720.9134 1077.7692,-1721.8153 1086.5839,-1727.6933 1088.3256,-1720.9134"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1143" cy="-1709.8027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1143" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1337.7889,-1770.6584C1295.9119,-1760.9883 1235.4312,-1745.7431 1184,-1727.8027 1181.7705,-1727.025 1179.4928,-1726.1784 1177.2098,-1725.2903"/>
<polygon fill="#000000" stroke="#000000" points="1178.4846,-1722.0302 1167.9043,-1721.4751 1175.8291,-1728.507 1178.4846,-1722.0302"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1225" cy="-1709.8027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1225" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1354.2198,-1766.5334C1326.38,-1754.311 1287.5246,-1737.2525 1259.7047,-1725.0389"/>
<polygon fill="#000000" stroke="#000000" points="1260.9243,-1721.752 1250.3609,-1720.9368 1258.1103,-1728.1615 1260.9243,-1721.752"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1307" cy="-1709.8027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1307" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.1501,-1764.3735C1358.0588,-1754.6348 1344.1239,-1742.3993 1332.2613,-1731.9834"/>
<polygon fill="#000000" stroke="#000000" points="1334.264,-1729.0841 1324.4403,-1725.1161 1329.6454,-1734.3442 1334.264,-1729.0841"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1709.8027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1389" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1389,-1763.6341C1389,-1755.9337 1389,-1746.7771 1389,-1738.2193"/>
<polygon fill="#000000" stroke="#000000" points="1392.5001,-1738.2159 1389,-1728.216 1385.5001,-1738.216 1392.5001,-1738.2159"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1546" cy="-1709.8027" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1546" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;20</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1422.6804,-1766.3569C1445.69,-1755.8047 1476.4257,-1741.7094 1501.456,-1730.2306"/>
<polygon fill="#000000" stroke="#000000" points="1503.111,-1733.3221 1510.7417,-1725.9721 1500.1929,-1726.9593 1503.111,-1733.3221"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="1770" cy="-1709.8027" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1770" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1442.7799,-1771.6396C1510.0744,-1758.9225 1625.4777,-1737.114 1699.7079,-1723.0863"/>
<polygon fill="#000000" stroke="#000000" points="1700.7234,-1726.4564 1709.8996,-1721.1603 1699.4235,-1719.5781 1700.7234,-1726.4564"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2248" cy="-1709.8027" rx="69.851" ry="18"/>
<text text-anchor="middle" x="2248" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 27&#45;112</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1451.4691,-1776.5667C1605.5507,-1763.6518 2003.3947,-1730.3051 2171.3623,-1716.2264"/>
<polygon fill="#000000" stroke="#000000" points="2171.6918,-1719.7111 2181.3645,-1715.388 2171.107,-1712.7356 2171.6918,-1719.7111"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="3413" cy="-1709.8027" rx="74.6878" ry="18"/>
<text text-anchor="middle" x="3413" y="-1705.6027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 113&#45;156</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1453.4823,-1779.5089C1751.1357,-1768.9204 2992.0924,-1724.7757 3328.54,-1712.8072"/>
<polygon fill="#000000" stroke="#000000" points="3328.8344,-1716.2991 3338.7036,-1712.4457 3328.5855,-1709.3035 3328.8344,-1716.2991"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1081.5,-1646.7027 988.5,-1646.7027 988.5,-1610.7027 1081.5,-1610.7027 1081.5,-1646.7027"/>
<text text-anchor="middle" x="1035" y="-1625.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>header_2&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-1691.3999C1035,-1681.271 1035,-1668.4826 1035,-1657.1014"/>
<polygon fill="#000000" stroke="#000000" points="1038.5001,-1656.7533 1035,-1646.7533 1031.5001,-1656.7534 1038.5001,-1656.7533"/>
</g>
<!-- raw_12 -->
<g id="node13" class="node">
<title>raw_12</title>
<ellipse fill="none" stroke="#000000" cx="1135" cy="-1628.7027" rx="27" ry="18"/>
<text text-anchor="middle" x="1135" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_12 -->
<g id="edge12" class="edge">
<title>prose_3&#45;&gt;raw_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1141.2245,-1691.804C1140.2166,-1681.5857 1138.9323,-1668.5661 1137.7924,-1657.0102"/>
<polygon fill="#000000" stroke="#000000" points="1141.263,-1656.5396 1136.7982,-1646.9315 1134.2968,-1657.2268 1141.263,-1656.5396"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="1216" cy="-1628.7027" rx="27" ry="18"/>
<text text-anchor="middle" x="1216" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_4&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1223.0026,-1691.804C1221.8686,-1681.5857 1220.4238,-1668.5661 1219.1414,-1657.0102"/>
<polygon fill="#000000" stroke="#000000" points="1222.6046,-1656.4844 1218.0229,-1646.9315 1215.6473,-1657.2566 1222.6046,-1656.4844"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="1297" cy="-1628.7027" rx="27" ry="18"/>
<text text-anchor="middle" x="1297" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_5&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1304.7807,-1691.804C1303.5119,-1681.5142 1301.8929,-1668.3838 1300.4606,-1656.768"/>
<polygon fill="#000000" stroke="#000000" points="1303.9107,-1656.1476 1299.2131,-1646.6511 1296.9633,-1657.0043 1303.9107,-1656.1476"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1379" cy="-1628.7027" rx="27" ry="18"/>
<text text-anchor="middle" x="1379" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_6&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1386.7807,-1691.804C1385.5119,-1681.5142 1383.8929,-1668.3838 1382.4606,-1656.768"/>
<polygon fill="#000000" stroke="#000000" points="1385.9107,-1656.1476 1381.2131,-1646.6511 1378.9633,-1657.0043 1385.9107,-1656.1476"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1706,-1655.9031 1424,-1655.9031 1424,-1601.5022 1706,-1601.5022 1706,-1655.9031"/>
<text text-anchor="middle" x="1565" y="-1640.6027" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = require &quot;linebuf&quot;</text>
<text text-anchor="middle" x="1565" y="-1625.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1565" y="-1609.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>codeblock_7&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1550.2167,-1691.804C1552.0119,-1684.1414 1554.1762,-1674.9034 1556.2881,-1665.8888"/>
<polygon fill="#000000" stroke="#000000" points="1559.7545,-1666.4364 1558.6279,-1655.9017 1552.939,-1664.8397 1559.7545,-1666.4364"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1915.5,-1646.7027 1724.5,-1646.7027 1724.5,-1610.7027 1915.5,-1610.7027 1915.5,-1646.7027"/>
<text text-anchor="middle" x="1820" y="-1625.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_8&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1781.0966,-1691.804C1787.6536,-1681.1686 1796.0814,-1667.4986 1803.4155,-1655.6028"/>
<polygon fill="#000000" stroke="#000000" points="1806.4928,-1657.2806 1808.7615,-1646.9315 1800.5342,-1653.607 1806.4928,-1657.2806"/>
</g>
<!-- header_22 -->
<g id="node23" class="node">
<title>header_22</title>
<ellipse fill="none" stroke="#000000" cx="2162" cy="-1628.7027" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2162" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:load()</text>
</g>
<!-- section_9&#45;&gt;header_22 -->
<g id="edge22" class="edge">
<title>section_9&#45;&gt;header_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2229.3393,-1692.2052C2217.2808,-1680.8338 2201.4147,-1665.8717 2188.1122,-1653.3271"/>
<polygon fill="#000000" stroke="#000000" points="2190.3009,-1650.5803 2180.6243,-1646.2658 2185.4983,-1655.673 2190.3009,-1650.5803"/>
</g>
<!-- prose_23 -->
<g id="node24" class="node">
<title>prose_23</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-1628.7027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2334" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_23 -->
<g id="edge23" class="edge">
<title>section_9&#45;&gt;prose_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2266.6607,-1692.2052C2279.2973,-1680.2886 2296.1155,-1664.4287 2309.7828,-1651.5401"/>
<polygon fill="#000000" stroke="#000000" points="2312.5363,-1653.7542 2317.4104,-1644.3471 2307.7338,-1648.6615 2312.5363,-1653.7542"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="2635" cy="-1628.7027" rx="81.1496" ry="18"/>
<text text-anchor="middle" x="2635" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 32&#45;111</text>
</g>
<!-- section_9&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2302.6268,-1698.3551C2371.7191,-1683.876 2490.7385,-1658.9342 2566.0283,-1643.1564"/>
<polygon fill="#000000" stroke="#000000" points="2566.827,-1646.5652 2575.8965,-1641.0885 2565.3912,-1639.714 2566.827,-1646.5652"/>
</g>
<!-- header_35 -->
<g id="node36" class="node">
<title>header_35</title>
<ellipse fill="none" stroke="#000000" cx="3160" cy="-1628.7027" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="3160" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_10&#45;&gt;header_35 -->
<g id="edge35" class="edge">
<title>section_10&#45;&gt;header_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3368.0602,-1695.3971C3325.7276,-1681.8272 3262.1517,-1661.4478 3216.4241,-1646.7896"/>
<polygon fill="#000000" stroke="#000000" points="3217.2532,-1643.38 3206.662,-1643.6604 3215.1164,-1650.0459 3217.2532,-1643.38"/>
</g>
<!-- prose_36 -->
<g id="node37" class="node">
<title>prose_36</title>
<ellipse fill="none" stroke="#000000" cx="3334" cy="-1628.7027" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3334" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_36 -->
<g id="edge36" class="edge">
<title>section_10&#45;&gt;prose_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3395.8582,-1692.2052C3384.326,-1680.3665 3369.0027,-1664.6358 3356.4926,-1651.7932"/>
<polygon fill="#000000" stroke="#000000" points="3358.9867,-1649.3376 3349.5018,-1644.6166 3353.9724,-1654.222 3358.9867,-1649.3376"/>
</g>
<!-- codeblock_37 -->
<g id="node38" class="node">
<title>codeblock_37</title>
<ellipse fill="none" stroke="#000000" cx="3482" cy="-1628.7027" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="3482" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 115&#45;131</text>
</g>
<!-- section_10&#45;&gt;codeblock_37 -->
<g id="edge37" class="edge">
<title>section_10&#45;&gt;codeblock_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3428.3133,-1691.804C3437.6932,-1680.7793 3449.8475,-1666.4936 3460.2187,-1654.3036"/>
<polygon fill="#000000" stroke="#000000" points="3462.9152,-1656.5355 3466.7295,-1646.6511 3457.5837,-1651.9995 3462.9152,-1656.5355"/>
</g>
<!-- section_38 -->
<g id="node39" class="node">
<title>section_38</title>
<ellipse fill="none" stroke="#000000" cx="3856" cy="-1628.7027" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="3856" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 134&#45;156</text>
</g>
<!-- section_10&#45;&gt;section_38 -->
<g id="edge38" class="edge">
<title>section_10&#45;&gt;section_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3472.745,-1698.8652C3554.0744,-1683.9762 3699.3764,-1657.3758 3785.8051,-1641.5532"/>
<polygon fill="#000000" stroke="#000000" points="3786.5806,-1644.9695 3795.7868,-1639.7259 3785.32,-1638.084 3786.5806,-1644.9695"/>
</g>
<!-- section_39 -->
<g id="node40" class="node">
<title>section_39</title>
<ellipse fill="none" stroke="#000000" cx="4811" cy="-1628.7027" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4811" y="-1624.5027" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 157&#45;181</text>
</g>
<!-- section_10&#45;&gt;section_39 -->
<g id="edge39" class="edge">
<title>section_10&#45;&gt;section_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3486.1942,-1705.5566C3724.0559,-1691.7579 4474.4246,-1648.2279 4727.0513,-1633.5727"/>
<polygon fill="#000000" stroke="#000000" points="4727.4865,-1637.0534 4737.267,-1632.98 4727.081,-1630.0651 4727.4865,-1637.0534"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-994.2027 0,-994.2027 0,-922.4004 324,-922.4004 324,-994.2027"/>
<text text-anchor="middle" x="162" y="-930.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_12&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>raw_12&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.1517,-1615.1572C1109.2573,-1609.9306 1099.5991,-1604.5172 1090,-1601.6026 1009.4261,-1577.1377 398.9019,-1618.0204 333,-1565.6026 157.39,-1425.9239 153.3326,-1120.9104 158.7208,-1004.6106"/>
<polygon fill="#000000" stroke="#000000" points="162.2336,-1004.4465 159.2481,-994.281 155.2427,-1004.0896 162.2336,-1004.4465"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-985.602 342.5,-985.602 342.5,-931.0011 897.5,-931.0011 897.5,-985.602"/>
<text text-anchor="middle" x="620" y="-954.5016" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-939.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1197.584,-1615.2849C1189.7501,-1610.2107 1180.2895,-1604.876 1171,-1601.6026 1059.312,-1562.2464 1002.5165,-1635.6005 907,-1565.6026 709.4651,-1420.842 642.8829,-1104.8999 625.3346,-996.0476"/>
<polygon fill="#000000" stroke="#000000" points="628.7468,-995.2142 623.7416,-985.8762 621.8311,-996.2974 628.7468,-995.2142"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-985.602 916,-985.602 916,-931.0011 1464,-931.0011 1464,-985.602"/>
<text text-anchor="middle" x="1190" y="-954.5016" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-939.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1294.138,-1610.7711C1279.8321,-1521.1385 1215.9734,-1121.0359 1195.9948,-995.8614"/>
<polygon fill="#000000" stroke="#000000" points="1199.3945,-994.955 1194.362,-985.6316 1192.482,-996.0583 1199.3945,-994.955"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-993.6019 1482,-993.6019 1482,-923.0012 2030,-923.0012 2030,-993.6019"/>
<text text-anchor="middle" x="1756" y="-962.5016" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new linebuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-947.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1396.7139,-1614.8718C1402.467,-1610.5144 1408.9324,-1605.7571 1415,-1601.6026 1440.0338,-1584.4619 1452.8651,-1588.2979 1473,-1565.6026 1629.2975,-1389.4302 1715.3857,-1112.0505 1744.5547,-1003.75"/>
<polygon fill="#000000" stroke="#000000" points="1748.0115,-1004.37 1747.2003,-993.8062 1741.2468,-1002.5702 1748.0115,-1004.37"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2197.5,-976.3015 2048.5,-976.3015 2048.5,-940.3015 2197.5,-940.3015 2197.5,-976.3015"/>
<text text-anchor="middle" x="2123" y="-954.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:load()</text>
</g>
<!-- header_22&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>header_22&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2160.9366,-1610.4234C2155.5491,-1517.8133 2131.2653,-1100.3799 2124.6619,-986.8698"/>
<polygon fill="#000000" stroke="#000000" points="2128.1374,-986.3443 2124.0624,-976.5645 2121.1492,-986.7509 2128.1374,-986.3443"/>
</g>
<!-- raw_26 -->
<g id="node27" class="node">
<title>raw_26</title>
<ellipse fill="none" stroke="#000000" cx="2243" cy="-958.3015" rx="27" ry="18"/>
<text text-anchor="middle" x="2243" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_23&#45;&gt;raw_26 -->
<g id="edge26" class="edge">
<title>prose_23&#45;&gt;raw_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2315.6391,-1613.6717C2302.8768,-1602.0293 2286.8085,-1584.704 2279,-1565.6026 2193.9237,-1357.4873 2225.4423,-1075.5675 2238.477,-986.4835"/>
<polygon fill="#000000" stroke="#000000" points="2241.9729,-986.7723 2240.0017,-976.3624 2235.051,-985.7294 2241.9729,-986.7723"/>
</g>
<!-- prespace_27 -->
<g id="node28" class="node">
<title>prespace_27</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-958.3015" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2334" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_23&#45;&gt;prespace_27 -->
<g id="edge27" class="edge">
<title>prose_23&#45;&gt;prespace_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334,-1610.4234C2334,-1517.8133 2334,-1100.3799 2334,-986.8698"/>
<polygon fill="#000000" stroke="#000000" points="2337.5001,-986.5644 2334,-976.5645 2330.5001,-986.5645 2337.5001,-986.5644"/>
</g>
<!-- literal_28 -->
<g id="node29" class="node">
<title>literal_28</title>
<ellipse fill="none" stroke="#000000" cx="2430" cy="-958.3015" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2430" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_23&#45;&gt;literal_28 -->
<g id="edge28" class="edge">
<title>prose_23&#45;&gt;literal_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2352.3144,-1613.6526C2365.0536,-1602.0006 2381.1132,-1584.6718 2389,-1565.6026 2474.9735,-1357.7298 2446.3172,-1075.6492 2434.2215,-986.5042"/>
<polygon fill="#000000" stroke="#000000" points="2437.6563,-985.7943 2432.8039,-976.376 2430.7239,-986.7646 2437.6563,-985.7943"/>
</g>
<!-- raw_29 -->
<g id="node30" class="node">
<title>raw_29</title>
<ellipse fill="none" stroke="#000000" cx="2506" cy="-958.3015" rx="27" ry="18"/>
<text text-anchor="middle" x="2506" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_23&#45;&gt;raw_29 -->
<g id="edge29" class="edge">
<title>prose_23&#45;&gt;raw_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2365.0549,-1623.7192C2397.2163,-1616.7618 2446.048,-1600.7792 2470,-1565.6026 2535.158,-1469.9098 2515.1211,-1092.7694 2508.019,-986.379"/>
<polygon fill="#000000" stroke="#000000" points="2511.5106,-986.1361 2507.337,-976.398 2504.5269,-986.6134 2511.5106,-986.1361"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3057,-1565.4038 2551,-1565.4038 2551,-351.1993 3057,-351.1993 3057,-1565.4038"/>
<text text-anchor="middle" x="2804" y="-1550.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 50</text>
<text text-anchor="middle" x="2804" y="-1519.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2804" y="-1503.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE repl (</text>
<text text-anchor="middle" x="2804" y="-1488.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2804" y="-1472.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">project TEXT,</text>
<text text-anchor="middle" x="2804" y="-1457.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2804" y="-1442.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP);</text>
<text text-anchor="middle" x="2804" y="-1426.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1395.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line_stmt = [[</text>
<text text-anchor="middle" x="2804" y="-1379.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES(?, ?);</text>
<text text-anchor="middle" x="2804" y="-1364.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1333.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2804" y="-1317.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2804" y="-1302.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1270.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2804" y="-1255.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT line FROM repl</text>
<text text-anchor="middle" x="2804" y="-1240.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = &#39;%s&#39;</text>
<text text-anchor="middle" x="2804" y="-1224.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2804" y="-1209.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2804" y="-1193.802" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1162.402" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-1147.002" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-1115.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2804" y="-1100.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2804" y="-1084.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2804" y="-1069.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-1054.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-1038.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-1023.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2804" y="-1007.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2804" y="-976.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="2804" y="-961.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.home_dir .. &quot;/.bridge&quot;)</text>
<text text-anchor="middle" x="2804" y="-945.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="2804" y="-930.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local table_names = conn:exec(get_tables)</text>
<text text-anchor="middle" x="2804" y="-914.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not table_names or not has(table_names.name, &quot;repl&quot;) then</text>
<text text-anchor="middle" x="2804" y="-899.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local success, err = sql.pexec(conn, create_repl_table)</text>
<text text-anchor="middle" x="2804" y="-884.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; success is nil for creation, false for error</text>
<text text-anchor="middle" x="2804" y="-868.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if success == false then</text>
<text text-anchor="middle" x="2804" y="-853.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="2804" y="-837.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-822.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-807.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt = conn:prepare(insert_line_stmt)</text>
<text text-anchor="middle" x="2804" y="-791.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_stmt = format(get_recent,</text>
<text text-anchor="middle" x="2804" y="-776.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.san(historian.project),</text>
<text text-anchor="middle" x="2804" y="-760.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="2804" y="-745.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local values, err = sql.pexec(conn, pop_stmt)</text>
<text text-anchor="middle" x="2804" y="-730.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if values then</text>
<text text-anchor="middle" x="2804" y="-714.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.values = values</text>
<text text-anchor="middle" x="2804" y="-699.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return values</text>
<text text-anchor="middle" x="2804" y="-683.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="2804" y="-652.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if values then</text>
<text text-anchor="middle" x="2804" y="-637.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return values</text>
<text text-anchor="middle" x="2804" y="-621.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2804" y="-606.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return false, err</text>
<text text-anchor="middle" x="2804" y="-590.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-575.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-560.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;]]</text>
<text text-anchor="middle" x="2804" y="-544.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2804" y="-513.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, linebuf)</text>
<text text-anchor="middle" x="2804" y="-497.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="2804" y="-482.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt:bind(historian.project, lb)</text>
<text text-anchor="middle" x="2804" y="-467.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local err = historian.insert_stmt:step()</text>
<text text-anchor="middle" x="2804" y="-451.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not err then</text>
<text text-anchor="middle" x="2804" y="-436.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_stmt:clearbind():reset()</text>
<text text-anchor="middle" x="2804" y="-420.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="2804" y="-405.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;error(error)</text>
<text text-anchor="middle" x="2804" y="-390.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-374.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-359.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>codeblock_24&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2639.608,-1610.4234C2641.8537,-1601.5148 2644.8572,-1589.6004 2648.4773,-1575.2401"/>
<polygon fill="#000000" stroke="#000000" points="2651.8928,-1576.0092 2650.9435,-1565.457 2645.1052,-1574.2981 2651.8928,-1576.0092"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2292,-231.1017 1926,-231.1017 1926,-175.2988 2292,-175.2988 2292,-231.1017"/>
<text text-anchor="middle" x="2109" y="-183.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">This is where we either create query or create our</text>
</g>
<!-- raw_26&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>raw_26&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2245.1851,-940.2829C2253.5855,-865.4892 2279.7807,-573.0327 2206,-351.0005 2192.0377,-308.9829 2163.0091,-267.3866 2140.328,-239.0794"/>
<polygon fill="#000000" stroke="#000000" points="2142.8504,-236.6343 2133.8175,-231.0974 2137.426,-241.0588 2142.8504,-236.6343"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2364,-221.2002 2310,-221.2002 2310,-185.2002 2364,-185.2002 2364,-221.2002"/>
<text text-anchor="middle" x="2337" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>prespace_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334.0727,-940.0102C2334.4722,-839.441 2336.4014,-353.8802 2336.8882,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="2340.3884,-231.2648 2336.9283,-221.2509 2333.3885,-231.2369 2340.3884,-231.2648"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2466.5,-221.2002 2387.5,-221.2002 2387.5,-185.2002 2466.5,-185.2002 2466.5,-221.2002"/>
<text text-anchor="middle" x="2427" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">~/.bridge</text>
</g>
<!-- literal_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>literal_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2429.9273,-940.0102C2429.5278,-839.441 2427.5986,-353.8802 2427.1118,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="2430.6115,-231.2369 2427.0717,-221.2509 2423.6116,-231.2648 2430.6115,-231.2369"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2571,-223.1023 2485,-223.1023 2485,-183.2982 2571,-183.2982 2571,-223.1023"/>
<text text-anchor="middle" x="2528" y="-207.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> database.</text>
</g>
<!-- raw_29&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>raw_29&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2506.5329,-940.0102C2509.45,-839.887 2523.4847,-358.1788 2527.1322,-232.9856"/>
<polygon fill="#000000" stroke="#000000" points="2530.6313,-233.0636 2527.4241,-222.9659 2523.6343,-232.8597 2530.6313,-233.0636"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3224.5,-976.3015 3075.5,-976.3015 3075.5,-940.3015 3224.5,-940.3015 3224.5,-976.3015"/>
<text text-anchor="middle" x="3150" y="-954.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_35&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>header_35&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3159.7273,-1610.4234C3158.3459,-1517.8133 3152.1193,-1100.3799 3150.4261,-986.8698"/>
<polygon fill="#000000" stroke="#000000" points="3153.9213,-986.5111 3150.2724,-976.5645 3146.9221,-986.6156 3153.9213,-986.5111"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="3270" cy="-958.3015" rx="27" ry="18"/>
<text text-anchor="middle" x="3270" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_36&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_36&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3324.2657,-1611.3535C3317.8511,-1599.0022 3309.9344,-1581.7905 3306,-1565.6026 3253.1345,-1348.09 3263.1274,-1074.4947 3268.1338,-986.7529"/>
<polygon fill="#000000" stroke="#000000" points="3271.6416,-986.7244 3268.7435,-976.5337 3264.654,-986.3075 3271.6416,-986.7244"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3688.5,-1077.802 3315.5,-1077.802 3315.5,-838.8011 3688.5,-838.8011 3688.5,-1077.802"/>
<text text-anchor="middle" x="3502" y="-1062.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="3502" y="-1047.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="3502" y="-1031.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf(1)</text>
<text text-anchor="middle" x="3502" y="-1016.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3502" y="-1001.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local minus = historian.cursor &gt; 1 and 1 or 0</text>
<text text-anchor="middle" x="3502" y="-985.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf</text>
<text text-anchor="middle" x="3502" y="-970.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == #historian then</text>
<text text-anchor="middle" x="3502" y="-954.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf = historian[#historian]:clone()</text>
<text text-anchor="middle" x="3502" y="-939.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="3502" y="-924.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf = historian[historian.cursor]:clone()</text>
<text text-anchor="middle" x="3502" y="-908.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3502" y="-893.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor &#45; minus</text>
<text text-anchor="middle" x="3502" y="-877.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="3502" y="-862.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="3502" y="-847.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_37&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_37&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3482.5453,-1610.4234C3484.7479,-1536.5936 3493.1091,-1256.3238 3498.1254,-1088.1772"/>
<polygon fill="#000000" stroke="#000000" points="3501.6287,-1088.1153 3498.4286,-1078.0154 3494.6319,-1087.9065 3501.6287,-1088.1153"/>
</g>
<!-- header_44 -->
<g id="node45" class="node">
<title>header_44</title>
<ellipse fill="none" stroke="#000000" cx="3789" cy="-958.3015" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="3789" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_38&#45;&gt;header_44 -->
<g id="edge44" class="edge">
<title>section_38&#45;&gt;header_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3854.1732,-1610.4234C3844.9084,-1517.7198 3803.1151,-1099.5371 3791.8209,-986.5271"/>
<polygon fill="#000000" stroke="#000000" points="3795.3024,-986.1668 3790.8252,-976.5645 3788.3371,-986.863 3795.3024,-986.1668"/>
</g>
<!-- prose_45 -->
<g id="node46" class="node">
<title>prose_45</title>
<ellipse fill="none" stroke="#000000" cx="3922" cy="-958.3015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3922" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_38&#45;&gt;prose_45 -->
<g id="edge45" class="edge">
<title>section_38&#45;&gt;prose_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3864.5031,-1610.6411C3869.9235,-1598.2544 3876.5547,-1581.2857 3880,-1565.6026 3928.0604,-1346.8332 3925.3307,-1074.062 3922.967,-986.6412"/>
<polygon fill="#000000" stroke="#000000" points="3926.4602,-986.3538 3922.6698,-976.4602 3919.4632,-986.5581 3926.4602,-986.3538"/>
</g>
<!-- codeblock_46 -->
<g id="node47" class="node">
<title>codeblock_46</title>
<ellipse fill="none" stroke="#000000" cx="4153" cy="-958.3015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4153" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 139&#45;154</text>
</g>
<!-- section_38&#45;&gt;codeblock_46 -->
<g id="edge46" class="edge">
<title>section_38&#45;&gt;codeblock_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3896.6339,-1613.3728C3919.0952,-1603.0045 3945.8452,-1587.2295 3963,-1565.6026 4110.2672,-1379.9444 4144.139,-1079.0293 4151.2502,-986.3604"/>
<polygon fill="#000000" stroke="#000000" points="4154.7434,-986.5791 4151.9744,-976.3525 4147.7617,-986.0738 4154.7434,-986.5791"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="4561" cy="-958.3015" rx="95.2951" ry="18"/>
<text text-anchor="middle" x="4561" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append()</text>
</g>
<!-- section_39&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_39&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4764.6696,-1614.3775C4740.1194,-1604.4724 4711.5028,-1588.8237 4694,-1565.6026 4554.6428,-1380.7168 4555.4452,-1079.2796 4559.3663,-986.4213"/>
<polygon fill="#000000" stroke="#000000" points="4562.8642,-986.546 4559.8383,-976.3925 4555.872,-986.2169 4562.8642,-986.546"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4735" cy="-958.3015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4735" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_39&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_39&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4804.1722,-1610.7503C4799.7084,-1598.2689 4794.1421,-1581.1472 4791,-1565.6026 4746.5404,-1345.6504 4737.3137,-1073.6549 4735.4546,-986.5361"/>
<polygon fill="#000000" stroke="#000000" points="4738.9511,-986.32 4735.2543,-976.391 4731.9525,-986.4582 4738.9511,-986.32"/>
</g>
<!-- codeblock_59 -->
<g id="node60" class="node">
<title>codeblock_59</title>
<ellipse fill="none" stroke="#000000" cx="4887" cy="-958.3015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4887" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 159&#45;166</text>
</g>
<!-- section_39&#45;&gt;codeblock_59 -->
<g id="edge59" class="edge">
<title>section_39&#45;&gt;codeblock_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4813.0722,-1610.4234C4823.5816,-1517.7198 4870.9888,-1099.5371 4883.8002,-986.5271"/>
<polygon fill="#000000" stroke="#000000" points="4887.2808,-986.8951 4884.9296,-976.5645 4880.3254,-986.1065 4887.2808,-986.8951"/>
</g>
<!-- codeblock_60 -->
<g id="node61" class="node">
<title>codeblock_60</title>
<ellipse fill="none" stroke="#000000" cx="5157" cy="-958.3015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5157" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 168&#45;177</text>
</g>
<!-- section_39&#45;&gt;codeblock_60 -->
<g id="edge60" class="edge">
<title>section_39&#45;&gt;codeblock_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4876.2062,-1619.5132C4912.2749,-1611.1917 4955.2749,-1595.4167 4983,-1565.6026 5143.5705,-1392.934 5157.1629,-1081.9746 5157.3969,-986.7724"/>
<polygon fill="#000000" stroke="#000000" points="5160.8962,-986.4916 5157.3701,-976.5008 5153.8963,-986.5099 5160.8962,-986.4916"/>
</g>
<!-- codeblock_61 -->
<g id="node62" class="node">
<title>codeblock_61</title>
<ellipse fill="none" stroke="#000000" cx="5390" cy="-958.3015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5390" y="-954.1015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 179&#45;181</text>
</g>
<!-- section_39&#45;&gt;codeblock_61 -->
<g id="edge61" class="edge">
<title>section_39&#45;&gt;codeblock_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4882.7954,-1622.901C5001.0043,-1612.7 5226.2641,-1590.2791 5253,-1565.6026 5424.4999,-1407.3133 5404.1573,-1083.9896 5393.5868,-986.648"/>
<polygon fill="#000000" stroke="#000000" points="5397.0312,-985.9613 5392.4197,-976.4228 5390.0764,-986.7552 5397.0312,-985.9613"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="3297,-221.2002 3243,-221.2002 3243,-185.2002 3297,-185.2002 3297,-221.2002"/>
</g>
<!-- raw_41&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_41&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3270,-940.0102C3270,-839.441 3270,-353.8802 3270,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="3273.5001,-231.2509 3270,-221.2509 3266.5001,-231.2509 3273.5001,-231.2509"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="3690,-221.2002 3534,-221.2002 3534,-185.2002 3690,-185.2002 3690,-221.2002"/>
<text text-anchor="middle" x="3612" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_44&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>header_44&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3788.6763,-940.0813C3786.8454,-865.087 3774.8194,-573.732 3697,-351.0005 3681.0737,-305.4168 3650.9313,-257.9138 3631.1566,-229.446"/>
<polygon fill="#000000" stroke="#000000" points="3634.0001,-227.405 3625.3797,-221.2455 3628.2775,-231.4364 3634.0001,-227.405"/>
</g>
<!-- raw_48 -->
<g id="node49" class="node">
<title>raw_48</title>
<ellipse fill="none" stroke="#000000" cx="3735" cy="-203.2002" rx="27" ry="18"/>
<text text-anchor="middle" x="3735" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_45&#45;&gt;raw_48 -->
<g id="edge48" class="edge">
<title>prose_45&#45;&gt;raw_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3927.1473,-940.4425C3948.8045,-861.2559 4024.9025,-537.5417 3880,-351.0005 3848.7027,-310.7097 3806.9402,-351.2104 3771,-315.0005 3748.7526,-292.5861 3740.2476,-256.3732 3736.9999,-231.2612"/>
<polygon fill="#000000" stroke="#000000" points="3740.4716,-230.8113 3735.9051,-221.2511 3733.5131,-231.5724 3740.4716,-230.8113"/>
</g>
<!-- prespace_49 -->
<g id="node50" class="node">
<title>prespace_49</title>
<ellipse fill="none" stroke="#000000" cx="3826" cy="-203.2002" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="3826" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_45&#45;&gt;prespace_49 -->
<g id="edge49" class="edge">
<title>prose_45&#45;&gt;prespace_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3922.5855,-940.1611C3924.5935,-866.0614 3928.6137,-579.4515 3880,-351.0005 3870.7429,-307.4983 3851.4202,-259.5508 3838.5785,-230.406"/>
<polygon fill="#000000" stroke="#000000" points="3841.6128,-228.6177 3834.3336,-220.9194 3835.2233,-231.4768 3841.6128,-228.6177"/>
</g>
<!-- literal_50 -->
<g id="node51" class="node">
<title>literal_50</title>
<ellipse fill="none" stroke="#000000" cx="3922" cy="-203.2002" rx="31.481" ry="18"/>
<text text-anchor="middle" x="3922" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_45&#45;&gt;literal_50 -->
<g id="edge50" class="edge">
<title>prose_45&#45;&gt;literal_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3922,-940.0102C3922,-839.441 3922,-353.8802 3922,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="3925.5001,-231.2509 3922,-221.2509 3918.5001,-231.2509 3925.5001,-231.2509"/>
</g>
<!-- raw_51 -->
<g id="node52" class="node">
<title>raw_51</title>
<ellipse fill="none" stroke="#000000" cx="3998" cy="-203.2002" rx="27" ry="18"/>
<text text-anchor="middle" x="3998" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_45&#45;&gt;raw_51 -->
<g id="edge51" class="edge">
<title>prose_45&#45;&gt;raw_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3923.841,-940.0102C3933.9632,-839.441 3982.8343,-353.8802 3995.1684,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="3998.6641,-231.5512 3996.1832,-221.2509 3991.6993,-230.8501 3998.6641,-231.5512"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="4451,-314.801 4043,-314.801 4043,-91.5995 4451,-91.5995 4451,-314.801"/>
<text text-anchor="middle" x="4247" y="-299.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="4247" y="-284.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local plus = historian.cursor &lt; #historian and 1 or 0</text>
<text text-anchor="middle" x="4247" y="-269.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="4247" y="-253.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf(1)</text>
<text text-anchor="middle" x="4247" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4247" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor + plus</text>
<text text-anchor="middle" x="4247" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = historian[historian.cursor]:clone()</text>
<text text-anchor="middle" x="4247" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="4247" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not (plus &gt; 0) and #linebuf.line &gt; 0 then</text>
<text text-anchor="middle" x="4247" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf, true</text>
<text text-anchor="middle" x="4247" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="4247" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf, false</text>
<text text-anchor="middle" x="4247" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4247" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_46&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_46&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4155.277,-940.0102C4165.6012,-857.0759 4208.5175,-512.3296 4231.8061,-325.2527"/>
<polygon fill="#000000" stroke="#000000" points="4235.3091,-325.4453 4233.0713,-315.0895 4228.3627,-324.5805 4235.3091,-325.4453"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="3782,-55.6015 3304,-55.6015 3304,.2015 3782,.2015 3782,-55.6015"/>
<text text-anchor="middle" x="3543" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next linebuf in history, and a second flag to tell the</text>
</g>
<!-- raw_48&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>raw_48&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3733.7967,-184.9823C3731.261,-160.696 3723.3926,-117.7247 3699,-91.4 3687.1989,-78.6642 3672.4846,-68.4098 3656.8423,-60.1709"/>
<polygon fill="#000000" stroke="#000000" points="3658.0531,-56.8643 3647.5402,-55.5493 3654.9385,-63.1332 3658.0531,-56.8643"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3854,-45.7 3800,-45.7 3800,-9.7 3854,-9.7 3854,-45.7"/>
</g>
<!-- prespace_49&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>prespace_49&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3826.1033,-185.0797C3826.2774,-154.5231 3826.6306,-92.5279 3826.838,-56.1322"/>
<polygon fill="#000000" stroke="#000000" points="3830.3402,-55.7418 3826.8973,-45.722 3823.3403,-55.7019 3830.3402,-55.7418"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="3972,-45.7 3872,-45.7 3872,-9.7 3972,-9.7 3972,-45.7"/>
<text text-anchor="middle" x="3922" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_50&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>literal_50&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3922,-185.0797C3922,-154.5231 3922,-92.5279 3922,-56.1322"/>
<polygon fill="#000000" stroke="#000000" points="3925.5001,-55.722 3922,-45.722 3918.5001,-55.7221 3925.5001,-55.722"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="4230,-45.7 3990,-45.7 3990,-9.7 4230,-9.7 4230,-45.7"/>
<text text-anchor="middle" x="4110" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_51&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>raw_51&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4000.6171,-185.1968C4004.6782,-161.9061 4014.1902,-120.8356 4034,-91.4 4044.2851,-76.1174 4059.2495,-62.4818 4073.1849,-51.7863"/>
<polygon fill="#000000" stroke="#000000" points="4075.2685,-54.5985 4081.2278,-45.8385 4071.1064,-48.9703 4075.2685,-54.5985"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="4639,-221.2002 4469,-221.2002 4469,-185.2002 4639,-185.2002 4639,-221.2002"/>
<text text-anchor="middle" x="4554" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append()</text>
</g>
<!-- header_57&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>header_57&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4560.8304,-940.0102C4559.8981,-839.441 4555.3968,-353.8802 4554.2608,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="4557.76,-231.218 4554.1673,-221.2509 4550.7603,-231.283 4557.76,-231.218"/>
</g>
<!-- raw_63 -->
<g id="node64" class="node">
<title>raw_63</title>
<ellipse fill="none" stroke="#000000" cx="4684" cy="-203.2002" rx="27" ry="18"/>
<text text-anchor="middle" x="4684" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_63 -->
<g id="edge63" class="edge">
<title>prose_58&#45;&gt;raw_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4733.7646,-940.0102C4726.9721,-839.441 4694.177,-353.8802 4685.9002,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="4689.3852,-230.9923 4685.2192,-221.2509 4682.4011,-231.4641 4689.3852,-230.9923"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="5060.5,-253.6012 4729.5,-253.6012 4729.5,-152.7993 5060.5,-152.7993 5060.5,-253.6012"/>
<text text-anchor="middle" x="4895" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, linebuf)</text>
<text text-anchor="middle" x="4895" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = linebuf</text>
<text text-anchor="middle" x="4895" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="4895" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:persist(linebuf)</text>
<text text-anchor="middle" x="4895" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="4895" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_59&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>codeblock_59&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4887.1938,-940.0102C4888.1815,-846.786 4892.6739,-422.7514 4894.359,-263.7016"/>
<polygon fill="#000000" stroke="#000000" points="4897.8596,-263.6514 4894.4659,-253.6148 4890.86,-263.5771 4897.8596,-263.6514"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="5375,-268.9007 5079,-268.9007 5079,-137.4998 5375,-137.4998 5375,-268.9007"/>
<text text-anchor="middle" x="5227" y="-253.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(linebuf)</text>
<text text-anchor="middle" x="5227" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="5227" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[1] = linebuf</text>
<text text-anchor="middle" x="5227" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = linebuf and 1 or 0</text>
<text text-anchor="middle" x="5227" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="5227" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="5227" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5227" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_60&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_60&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5158.6957,-940.0102C5167.0745,-849.6261 5204.2803,-448.2814 5219.9769,-278.9593"/>
<polygon fill="#000000" stroke="#000000" points="5223.4734,-279.1578 5220.9115,-268.8774 5216.5033,-278.5116 5223.4734,-279.1578"/>
</g>
<!-- leaf_67 -->
<g id="node68" class="node">
<title>leaf_67</title>
<polygon fill="none" stroke="#c0c0c0" points="5479,-221.2002 5393,-221.2002 5393,-185.2002 5479,-185.2002 5479,-221.2002"/>
<text text-anchor="middle" x="5436" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_61&#45;&gt;leaf_67 -->
<g id="edge67" class="edge">
<title>codeblock_61&#45;&gt;leaf_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5391.1143,-940.0102C5397.2409,-839.441 5426.8207,-353.8802 5434.2861,-231.3341"/>
<polygon fill="#000000" stroke="#000000" points="5437.7857,-231.4453 5434.9004,-221.2509 5430.7987,-231.0195 5437.7857,-231.4453"/>
</g>
<!-- leaf_64 -->
<g id="node65" class="node">
<title>leaf_64</title>
<polygon fill="none" stroke="#c0c0c0" points="4711,-45.7 4657,-45.7 4657,-9.7 4711,-9.7 4711,-45.7"/>
</g>
<!-- raw_63&#45;&gt;leaf_64 -->
<g id="edge64" class="edge">
<title>raw_63&#45;&gt;leaf_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4684,-185.0797C4684,-154.5231 4684,-92.5279 4684,-56.1322"/>
<polygon fill="#000000" stroke="#000000" points="4687.5001,-55.722 4684,-45.722 4680.5001,-55.7221 4687.5001,-55.722"/>
</g>
</g>
</svg>
