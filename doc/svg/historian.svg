<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="5487pt" height="1787pt"
 viewBox="0.00 0.00 5487.30 1786.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1782.8026)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1782.8026 5483.2972,-1782.8026 5483.2972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1760.8026" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1389" y="-1756.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 169</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1688.8026" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1389" y="-1684.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;106</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1389,-1742.6339C1389,-1734.9335 1389,-1725.7769 1389,-1717.2192"/>
<polygon fill="#000000" stroke="#000000" points="1392.5001,-1717.2158 1389,-1707.2158 1385.5001,-1717.2159 1392.5001,-1717.2158"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1035" cy="-1616.8026" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1035" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1332.6436,-1679.5108C1274.582,-1669.6312 1181.5848,-1652.9522 1102,-1634.8026 1097.3285,-1633.7372 1092.491,-1632.5683 1087.6518,-1631.3537"/>
<polygon fill="#000000" stroke="#000000" points="1088.3256,-1627.9132 1077.7692,-1628.8152 1086.5839,-1634.6931 1088.3256,-1627.9132"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1143" cy="-1616.8026" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1143" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1337.3638,-1677.56C1295.5034,-1667.8851 1235.2574,-1652.6824 1184,-1634.8026 1181.7705,-1634.0248 1179.4928,-1633.1783 1177.2098,-1632.2901"/>
<polygon fill="#000000" stroke="#000000" points="1178.4846,-1629.0301 1167.9043,-1628.4749 1175.8291,-1635.5069 1178.4846,-1629.0301"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1225" cy="-1616.8026" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1225" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1354.2198,-1673.5332C1326.38,-1661.3109 1287.5246,-1644.2524 1259.7047,-1632.0388"/>
<polygon fill="#000000" stroke="#000000" points="1260.9243,-1628.7518 1250.3609,-1627.9366 1258.1103,-1635.1613 1260.9243,-1628.7518"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1307" cy="-1616.8026" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1307" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.1501,-1671.3734C1358.0588,-1661.6347 1344.1239,-1649.3991 1332.2613,-1638.9832"/>
<polygon fill="#000000" stroke="#000000" points="1334.264,-1636.084 1324.4403,-1632.116 1329.6454,-1641.3441 1334.264,-1636.084"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1616.8026" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1389" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1389,-1670.6339C1389,-1662.9335 1389,-1653.7769 1389,-1645.2192"/>
<polygon fill="#000000" stroke="#000000" points="1392.5001,-1645.2158 1389,-1635.2158 1385.5001,-1645.2159 1392.5001,-1645.2158"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1546" cy="-1616.8026" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1546" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;20</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1423.0667,-1673.1796C1446.0978,-1662.6176 1476.7375,-1648.5663 1501.666,-1637.1341"/>
<polygon fill="#000000" stroke="#000000" points="1503.282,-1640.2435 1510.9127,-1632.8935 1500.364,-1633.8807 1503.282,-1640.2435"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="1770" cy="-1616.8026" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1770" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1443.1834,-1678.5632C1510.4852,-1665.8447 1625.4559,-1644.118 1699.5438,-1630.1171"/>
<polygon fill="#000000" stroke="#000000" points="1700.5412,-1633.4907 1709.7173,-1628.1946 1699.2413,-1626.6124 1700.5412,-1633.4907"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2248" cy="-1616.8026" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2248" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 27&#45;106</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1451.8163,-1683.5374C1605.9836,-1670.6153 2002.6767,-1637.3652 2170.8266,-1623.2711"/>
<polygon fill="#000000" stroke="#000000" points="2171.1689,-1626.7548 2180.8416,-1622.4317 2170.5842,-1619.7792 2171.1689,-1626.7548"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="3419" cy="-1616.8026" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="3419" y="-1612.6026" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 107&#45;145</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1454.2426,-1686.4885C1753.7297,-1675.8663 2996.5792,-1631.785 3334.0945,-1619.814"/>
<polygon fill="#000000" stroke="#000000" points="3334.4214,-1623.3047 3344.291,-1619.4523 3334.1732,-1616.3091 3334.4214,-1623.3047"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1081.5,-1553.7025 988.5,-1553.7025 988.5,-1517.7025 1081.5,-1517.7025 1081.5,-1553.7025"/>
<text text-anchor="middle" x="1035" y="-1532.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>header_2&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-1598.3997C1035,-1588.2708 1035,-1575.4824 1035,-1564.1012"/>
<polygon fill="#000000" stroke="#000000" points="1038.5001,-1563.7531 1035,-1553.7532 1031.5001,-1563.7532 1038.5001,-1563.7531"/>
</g>
<!-- raw_12 -->
<g id="node13" class="node">
<title>raw_12</title>
<ellipse fill="none" stroke="#000000" cx="1135" cy="-1535.7025" rx="27" ry="18"/>
<text text-anchor="middle" x="1135" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_12 -->
<g id="edge12" class="edge">
<title>prose_3&#45;&gt;raw_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1141.2245,-1598.8038C1140.2166,-1588.5855 1138.9323,-1575.5659 1137.7924,-1564.01"/>
<polygon fill="#000000" stroke="#000000" points="1141.263,-1563.5395 1136.7982,-1553.9314 1134.2968,-1564.2267 1141.263,-1563.5395"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="1216" cy="-1535.7025" rx="27" ry="18"/>
<text text-anchor="middle" x="1216" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_4&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1223.0026,-1598.8038C1221.8686,-1588.5855 1220.4238,-1575.5659 1219.1414,-1564.01"/>
<polygon fill="#000000" stroke="#000000" points="1222.6046,-1563.4843 1218.0229,-1553.9314 1215.6473,-1564.2564 1222.6046,-1563.4843"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="1297" cy="-1535.7025" rx="27" ry="18"/>
<text text-anchor="middle" x="1297" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_5&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1304.7807,-1598.8038C1303.5119,-1588.5141 1301.8929,-1575.3837 1300.4606,-1563.7678"/>
<polygon fill="#000000" stroke="#000000" points="1303.9107,-1563.1474 1299.2131,-1553.6509 1296.9633,-1564.0041 1303.9107,-1563.1474"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1379" cy="-1535.7025" rx="27" ry="18"/>
<text text-anchor="middle" x="1379" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_6&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1386.7807,-1598.8038C1385.5119,-1588.5141 1383.8929,-1575.3837 1382.4606,-1563.7678"/>
<polygon fill="#000000" stroke="#000000" points="1385.9107,-1563.1474 1381.2131,-1553.6509 1378.9633,-1564.0041 1385.9107,-1563.1474"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1706,-1562.903 1424,-1562.903 1424,-1508.502 1706,-1508.502 1706,-1562.903"/>
<text text-anchor="middle" x="1565" y="-1547.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = require &quot;linebuf&quot;</text>
<text text-anchor="middle" x="1565" y="-1532.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1565" y="-1516.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>codeblock_7&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1550.2167,-1598.8038C1552.0119,-1591.1412 1554.1762,-1581.9033 1556.2881,-1572.8886"/>
<polygon fill="#000000" stroke="#000000" points="1559.7545,-1573.4363 1558.6279,-1562.9015 1552.939,-1571.8395 1559.7545,-1573.4363"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1915.5,-1553.7025 1724.5,-1553.7025 1724.5,-1517.7025 1915.5,-1517.7025 1915.5,-1553.7025"/>
<text text-anchor="middle" x="1820" y="-1532.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_8&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1781.0966,-1598.8038C1787.6536,-1588.1685 1796.0814,-1574.4984 1803.4155,-1562.6026"/>
<polygon fill="#000000" stroke="#000000" points="1806.4928,-1564.2805 1808.7615,-1553.9314 1800.5342,-1560.6068 1806.4928,-1564.2805"/>
</g>
<!-- header_22 -->
<g id="node23" class="node">
<title>header_22</title>
<ellipse fill="none" stroke="#000000" cx="2162" cy="-1535.7025" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2162" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:load()</text>
</g>
<!-- section_9&#45;&gt;header_22 -->
<g id="edge22" class="edge">
<title>section_9&#45;&gt;header_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2229.3393,-1599.2051C2217.2808,-1587.8336 2201.4147,-1572.8715 2188.1122,-1560.3269"/>
<polygon fill="#000000" stroke="#000000" points="2190.3009,-1557.5801 2180.6243,-1553.2657 2185.4983,-1562.6728 2190.3009,-1557.5801"/>
</g>
<!-- prose_23 -->
<g id="node24" class="node">
<title>prose_23</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-1535.7025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2334" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_23 -->
<g id="edge23" class="edge">
<title>section_9&#45;&gt;prose_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2266.6607,-1599.2051C2279.2973,-1587.2884 2296.1155,-1571.4285 2309.7828,-1558.5399"/>
<polygon fill="#000000" stroke="#000000" points="2312.5363,-1560.7541 2317.4104,-1551.3469 2307.7338,-1555.6614 2312.5363,-1560.7541"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="2636" cy="-1535.7025" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2636" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 32&#45;105</text>
</g>
<!-- section_9&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2302.768,-1605.3549C2371.9388,-1590.8968 2491.0215,-1566.006 2566.5231,-1550.2246"/>
<polygon fill="#000000" stroke="#000000" points="2567.3483,-1553.6279 2576.4207,-1548.1558 2565.9161,-1546.7759 2567.3483,-1553.6279"/>
</g>
<!-- header_35 -->
<g id="node36" class="node">
<title>header_35</title>
<ellipse fill="none" stroke="#000000" cx="3161" cy="-1535.7025" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="3161" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_10&#45;&gt;header_35 -->
<g id="edge35" class="edge">
<title>section_10&#45;&gt;header_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3373.1721,-1602.3969C3329.7771,-1588.7561 3264.4921,-1568.2343 3217.8094,-1553.56"/>
<polygon fill="#000000" stroke="#000000" points="3218.7341,-1550.1819 3208.1447,-1550.522 3216.6349,-1556.8598 3218.7341,-1550.1819"/>
</g>
<!-- prose_36 -->
<g id="node37" class="node">
<title>prose_36</title>
<ellipse fill="none" stroke="#000000" cx="3339" cy="-1535.7025" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3339" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_36 -->
<g id="edge36" class="edge">
<title>section_10&#45;&gt;prose_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3401.6412,-1599.2051C3389.963,-1587.3663 3374.4458,-1571.6357 3361.7773,-1558.793"/>
<polygon fill="#000000" stroke="#000000" points="3364.2124,-1556.2777 3354.6981,-1551.6164 3359.229,-1561.1936 3364.2124,-1556.2777"/>
</g>
<!-- codeblock_37 -->
<g id="node38" class="node">
<title>codeblock_37</title>
<ellipse fill="none" stroke="#000000" cx="3489" cy="-1535.7025" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3489" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 109&#45;120</text>
</g>
<!-- section_10&#45;&gt;codeblock_37 -->
<g id="edge37" class="edge">
<title>section_10&#45;&gt;codeblock_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3434.5353,-1598.8038C3444.0511,-1587.7791 3456.3815,-1573.4934 3466.903,-1561.3035"/>
<polygon fill="#000000" stroke="#000000" points="3469.6237,-1563.508 3473.5082,-1553.6509 3464.3246,-1558.9342 3469.6237,-1563.508"/>
</g>
<!-- section_38 -->
<g id="node39" class="node">
<title>section_38</title>
<ellipse fill="none" stroke="#000000" cx="3876" cy="-1535.7025" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="3876" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 123&#45;145</text>
</g>
<!-- section_10&#45;&gt;section_38 -->
<g id="edge38" class="edge">
<title>section_10&#45;&gt;section_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3479.6861,-1606.0331C3563.9669,-1591.0765 3716.132,-1564.073 3805.3946,-1548.2323"/>
<polygon fill="#000000" stroke="#000000" points="3806.1927,-1551.6454 3815.4273,-1546.4519 3804.9695,-1544.7531 3806.1927,-1551.6454"/>
</g>
<!-- section_39 -->
<g id="node40" class="node">
<title>section_39</title>
<ellipse fill="none" stroke="#000000" cx="4831" cy="-1535.7025" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4831" y="-1531.5025" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 146&#45;169</text>
</g>
<!-- section_10&#45;&gt;section_39 -->
<g id="edge39" class="edge">
<title>section_10&#45;&gt;section_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3492.4338,-1612.5848C3732.3823,-1598.803 4492.4671,-1555.1466 4747.0103,-1540.5266"/>
<polygon fill="#000000" stroke="#000000" points="4747.5183,-1544.0033 4757.3011,-1539.9355 4747.1168,-1537.0148 4747.5183,-1544.0033"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-947.7026 0,-947.7026 0,-875.9003 324,-875.9003 324,-947.7026"/>
<text text-anchor="middle" x="162" y="-884.3015" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_12&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>raw_12&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.1517,-1522.1571C1109.2573,-1516.9304 1099.5991,-1511.5171 1090,-1508.6025 1009.4261,-1484.1376 399.4615,-1524.3089 333,-1472.6025 169.9527,-1345.7532 157.9535,-1067.564 159.9815,-957.721"/>
<polygon fill="#000000" stroke="#000000" points="163.4827,-957.7062 160.217,-947.6273 156.4846,-957.5429 163.4827,-957.7062"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-939.1019 342.5,-939.1019 342.5,-884.501 897.5,-884.501 897.5,-939.1019"/>
<text text-anchor="middle" x="620" y="-908.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-892.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1197.584,-1522.2847C1189.7501,-1517.2106 1180.2895,-1511.8759 1171,-1508.6025 1059.312,-1469.2463 1003.6086,-1541.0853 907,-1472.6025 721.1015,-1340.8249 647.6953,-1052.0963 626.8077,-949.1672"/>
<polygon fill="#000000" stroke="#000000" points="630.2164,-948.3625 624.839,-939.2337 623.3499,-949.7234 630.2164,-948.3625"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-939.1019 916,-939.1019 916,-884.501 1464,-884.501 1464,-939.1019"/>
<text text-anchor="middle" x="1190" y="-908.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-892.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1293.9131,-1517.7032C1279.2781,-1432.3688 1216.7484,-1067.7673 1196.4156,-949.2098"/>
<polygon fill="#000000" stroke="#000000" points="1199.8324,-948.4265 1194.6924,-939.162 1192.9332,-949.6098 1199.8324,-948.4265"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-947.1018 1482,-947.1018 1482,-876.5011 2030,-876.5011 2030,-947.1018"/>
<text text-anchor="middle" x="1756" y="-916.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new linebuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-900.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1396.7139,-1521.8716C1402.467,-1517.5143 1408.9324,-1512.7569 1415,-1508.6025 1440.0338,-1491.4618 1452.5127,-1494.9802 1473,-1472.6025 1620.5258,-1311.4643 1710.4616,-1059.1057 1742.6007,-956.9679"/>
<polygon fill="#000000" stroke="#000000" points="1745.9882,-957.8615 1745.6191,-947.2731 1739.3046,-955.7806 1745.9882,-957.8615"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2197.5,-929.8015 2048.5,-929.8015 2048.5,-893.8015 2197.5,-893.8015 2197.5,-929.8015"/>
<text text-anchor="middle" x="2123" y="-908.3015" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:load()</text>
</g>
<!-- header_22&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>header_22&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2160.8749,-1517.7032C2155.393,-1430.008 2131.475,-1047.3794 2124.7593,-939.9459"/>
<polygon fill="#000000" stroke="#000000" points="2128.2469,-939.6359 2124.1297,-929.8738 2121.2605,-940.0727 2128.2469,-939.6359"/>
</g>
<!-- raw_26 -->
<g id="node27" class="node">
<title>raw_26</title>
<ellipse fill="none" stroke="#000000" cx="2243" cy="-911.8015" rx="27" ry="18"/>
<text text-anchor="middle" x="2243" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_23&#45;&gt;raw_26 -->
<g id="edge26" class="edge">
<title>prose_23&#45;&gt;raw_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2315.6669,-1520.6602C2302.9184,-1509.012 2286.8552,-1491.6846 2279,-1472.6025 2200.7272,-1282.4603 2226.9356,-1025.289 2238.6425,-940.3361"/>
<polygon fill="#000000" stroke="#000000" points="2242.1442,-940.5711 2240.0883,-930.1777 2235.2141,-939.5847 2242.1442,-940.5711"/>
</g>
<!-- prespace_27 -->
<g id="node28" class="node">
<title>prespace_27</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-911.8015" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2334" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_23&#45;&gt;prespace_27 -->
<g id="edge27" class="edge">
<title>prose_23&#45;&gt;prespace_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334,-1517.3682C2334,-1429.0221 2334,-1047.1048 2334,-939.8876"/>
<polygon fill="#000000" stroke="#000000" points="2337.5001,-939.8359 2334,-929.836 2330.5001,-939.836 2337.5001,-939.8359"/>
</g>
<!-- literal_28 -->
<g id="node29" class="node">
<title>literal_28</title>
<ellipse fill="none" stroke="#000000" cx="2430" cy="-911.8015" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2430" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_23&#45;&gt;literal_28 -->
<g id="edge28" class="edge">
<title>prose_23&#45;&gt;literal_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2352.2828,-1520.6393C2365.0063,-1508.9808 2381.0602,-1491.6496 2389,-1472.6025 2468.1639,-1282.6938 2444.7684,-1025.3715 2434.0277,-940.358"/>
<polygon fill="#000000" stroke="#000000" points="2437.4655,-939.6537 2432.698,-930.1922 2430.5247,-940.5617 2437.4655,-939.6537"/>
</g>
<!-- raw_29 -->
<g id="node30" class="node">
<title>raw_29</title>
<ellipse fill="none" stroke="#000000" cx="2506" cy="-911.8015" rx="27" ry="18"/>
<text text-anchor="middle" x="2506" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_23&#45;&gt;raw_29 -->
<g id="edge29" class="edge">
<title>prose_23&#45;&gt;raw_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2365.0212,-1530.696C2397.1541,-1523.7192 2445.9619,-1507.7203 2470,-1472.6025 2529.949,-1385.0214 2514.0011,-1041.2337 2507.8624,-939.9964"/>
<polygon fill="#000000" stroke="#000000" points="2511.3498,-939.6831 2507.2346,-929.9201 2504.3633,-940.1185 2511.3498,-939.6831"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3057,-1472.4035 2551,-1472.4035 2551,-351.1994 3057,-351.1994 3057,-1472.4035"/>
<text text-anchor="middle" x="2804" y="-1457.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 50</text>
<text text-anchor="middle" x="2804" y="-1426.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2804" y="-1410.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE repl (</text>
<text text-anchor="middle" x="2804" y="-1395.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2804" y="-1379.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">project TEXT,</text>
<text text-anchor="middle" x="2804" y="-1364.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2804" y="-1349.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP);</text>
<text text-anchor="middle" x="2804" y="-1333.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1302.2022" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line_stmt = [[</text>
<text text-anchor="middle" x="2804" y="-1286.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES(?, ?);</text>
<text text-anchor="middle" x="2804" y="-1271.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1240.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2804" y="-1224.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2804" y="-1209.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1177.802" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2804" y="-1162.402" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT line FROM repl</text>
<text text-anchor="middle" x="2804" y="-1147.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %s</text>
<text text-anchor="middle" x="2804" y="-1131.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2804" y="-1116.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2804" y="-1100.8019" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1069.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-1054.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-1022.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2804" y="-1007.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2804" y="-991.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2804" y="-976.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-961.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-945.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-930.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2804" y="-914.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2804" y="-883.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="2804" y="-868.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.home_dir .. &quot;/.bridge&quot;)</text>
<text text-anchor="middle" x="2804" y="-852.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="2804" y="-837.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local table_names = conn:exec(get_tables)</text>
<text text-anchor="middle" x="2804" y="-821.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not table_names or not has(table_names.name, &quot;repl&quot;) then</text>
<text text-anchor="middle" x="2804" y="-806.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local success, err = sql.pexec(conn, create_repl_table)</text>
<text text-anchor="middle" x="2804" y="-791.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; success is nil for creation, false for error</text>
<text text-anchor="middle" x="2804" y="-775.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if success == false then</text>
<text text-anchor="middle" x="2804" y="-760.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="2804" y="-744.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-729.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-714.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt = conn:prepare(insert_line_stmt)</text>
<text text-anchor="middle" x="2804" y="-698.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_stmt = sql.format(get_recent, historian.project,</text>
<text text-anchor="middle" x="2804" y="-683.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="2804" y="-667.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local values, err = sql.pexec(conn, pop_stmt)</text>
<text text-anchor="middle" x="2804" y="-652.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if values then</text>
<text text-anchor="middle" x="2804" y="-637.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.values = values</text>
<text text-anchor="middle" x="2804" y="-621.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i,v in ipairs(values[1]) do</text>
<text text-anchor="middle" x="2804" y="-606.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = Linebuf(v)</text>
<text text-anchor="middle" x="2804" y="-590.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-575.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return values</text>
<text text-anchor="middle" x="2804" y="-560.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-544.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2804" y="-513.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, linebuf)</text>
<text text-anchor="middle" x="2804" y="-497.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="2804" y="-482.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt:bind(historian.project, lb)</text>
<text text-anchor="middle" x="2804" y="-467.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local err = historian.insert_stmt:step()</text>
<text text-anchor="middle" x="2804" y="-451.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not err then</text>
<text text-anchor="middle" x="2804" y="-436.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_stmt:clearbind():reset()</text>
<text text-anchor="middle" x="2804" y="-420.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="2804" y="-405.4006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;error(error)</text>
<text text-anchor="middle" x="2804" y="-390.0006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-374.6005" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-359.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>codeblock_24&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2640.8467,-1517.7032C2643.252,-1508.771 2646.4811,-1496.7789 2650.3719,-1482.3295"/>
<polygon fill="#000000" stroke="#000000" points="2653.8017,-1483.0529 2653.0223,-1472.4868 2647.0425,-1481.2328 2653.8017,-1483.0529"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2292,-231.1017 1926,-231.1017 1926,-175.2988 2292,-175.2988 2292,-231.1017"/>
<text text-anchor="middle" x="2109" y="-183.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">This is where we either create query or create our</text>
</g>
<!-- raw_26&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>raw_26&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2245.057,-893.7254C2252.5078,-822.4111 2274.2039,-554.5376 2206,-351.0005 2191.932,-309.0182 2162.9168,-267.4174 2140.2676,-239.0995"/>
<polygon fill="#000000" stroke="#000000" points="2142.7946,-236.6597 2133.767,-231.1143 2137.366,-241.0791 2142.7946,-236.6597"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2364,-221.2002 2310,-221.2002 2310,-185.2002 2364,-185.2002 2364,-221.2002"/>
<text text-anchor="middle" x="2337" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>prespace_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334.0772,-893.5733C2334.4841,-797.4592 2336.3807,-349.4859 2336.8795,-231.6572"/>
<polygon fill="#000000" stroke="#000000" points="2340.3809,-231.3227 2336.9233,-221.3079 2333.3809,-231.293 2340.3809,-231.3227"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2466.5,-221.2002 2387.5,-221.2002 2387.5,-185.2002 2466.5,-185.2002 2466.5,-221.2002"/>
<text text-anchor="middle" x="2427" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">~/.bridge</text>
</g>
<!-- literal_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>literal_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2429.9228,-893.5733C2429.5159,-797.4592 2427.6193,-349.4859 2427.1205,-231.6572"/>
<polygon fill="#000000" stroke="#000000" points="2430.6191,-231.293 2427.0767,-221.3079 2423.6191,-231.3227 2430.6191,-231.293"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2571,-223.1023 2485,-223.1023 2485,-183.2982 2571,-183.2982 2571,-223.1023"/>
<text text-anchor="middle" x="2528" y="-207.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> database.</text>
</g>
<!-- raw_29&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>raw_29&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2506.5659,-893.5733C2509.5367,-797.8874 2523.3345,-353.4712 2527.067,-233.2519"/>
<polygon fill="#000000" stroke="#000000" points="2530.5744,-233.0649 2527.3865,-222.961 2523.5778,-232.8476 2530.5744,-233.0649"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3224.5,-929.8015 3075.5,-929.8015 3075.5,-893.8015 3224.5,-893.8015 3224.5,-929.8015"/>
<text text-anchor="middle" x="3150" y="-908.3015" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_35&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>header_35&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3160.6767,-1517.3682C3159.1191,-1429.0221 3152.3855,-1047.1048 3150.4952,-939.8876"/>
<polygon fill="#000000" stroke="#000000" points="3153.9938,-939.7727 3150.318,-929.836 3146.9949,-939.8961 3153.9938,-939.7727"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="3270" cy="-911.8015" rx="27" ry="18"/>
<text text-anchor="middle" x="3270" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_36&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_36&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3327.6878,-1518.8423C3320.0981,-1506.5781 3310.6662,-1489.2691 3306,-1472.6025 3250.6889,-1275.0439 3261.9546,-1023.6544 3267.7423,-940.167"/>
<polygon fill="#000000" stroke="#000000" points="3271.2344,-940.4017 3268.4658,-930.175 3264.2527,-939.8962 3271.2344,-940.4017"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3709,-992.8018 3315,-992.8018 3315,-830.8012 3709,-830.8012 3709,-992.8018"/>
<text text-anchor="middle" x="3512" y="-977.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="3512" y="-962.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="3512" y="-946.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="3512" y="-931.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3512" y="-916.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local minus = historian.cursor &gt; 1 and 1 or 0</text>
<text text-anchor="middle" x="3512" y="-900.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = historian[historian.cursor]:clone()</text>
<text text-anchor="middle" x="3512" y="-885.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor &#45; minus</text>
<text text-anchor="middle" x="3512" y="-869.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="3512" y="-854.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="3512" y="-839.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_37&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_37&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3489.6759,-1517.3682C3492.4539,-1442.0103 3503.1063,-1153.0543 3508.6313,-1003.1807"/>
<polygon fill="#000000" stroke="#000000" points="3512.133,-1003.1965 3509.0039,-993.0743 3505.1378,-1002.9386 3512.133,-1003.1965"/>
</g>
<!-- header_44 -->
<g id="node45" class="node">
<title>header_44</title>
<ellipse fill="none" stroke="#000000" cx="3809" cy="-911.8015" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="3809" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_38&#45;&gt;header_44 -->
<g id="edge44" class="edge">
<title>section_38&#45;&gt;header_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3874.0671,-1517.7032C3864.6496,-1430.008 3823.5596,-1047.3794 3812.0224,-939.9459"/>
<polygon fill="#000000" stroke="#000000" points="3815.4886,-939.4429 3810.9408,-929.8738 3808.5286,-940.1904 3815.4886,-939.4429"/>
</g>
<!-- prose_45 -->
<g id="node46" class="node">
<title>prose_45</title>
<ellipse fill="none" stroke="#000000" cx="3942" cy="-911.8015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3942" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_38&#45;&gt;prose_45 -->
<g id="edge45" class="edge">
<title>section_38&#45;&gt;prose_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3884.4741,-1517.6345C3889.8819,-1505.245 3896.5099,-1488.2757 3900,-1472.6025 3944.5788,-1272.4077 3944.2774,-1023.1486 3942.7342,-940.1489"/>
<polygon fill="#000000" stroke="#000000" points="3946.2303,-939.9192 3942.5228,-929.9942 3939.2318,-940.065 3946.2303,-939.9192"/>
</g>
<!-- codeblock_46 -->
<g id="node47" class="node">
<title>codeblock_46</title>
<ellipse fill="none" stroke="#000000" cx="4173" cy="-911.8015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4173" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 128&#45;143</text>
</g>
<!-- section_38&#45;&gt;codeblock_46 -->
<g id="edge46" class="edge">
<title>section_38&#45;&gt;codeblock_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3916.1823,-1520.3425C3938.6337,-1509.9248 3965.5248,-1494.1104 3983,-1472.6025 4120.8346,-1302.9599 4160.7783,-1028.2382 4170.3562,-940.0263"/>
<polygon fill="#000000" stroke="#000000" points="4173.8474,-940.2917 4171.4011,-929.9831 4166.885,-939.5672 4173.8474,-940.2917"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="4581" cy="-911.8015" rx="95.2951" ry="18"/>
<text text-anchor="middle" x="4581" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append()</text>
</g>
<!-- section_39&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_39&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4785.1156,-1521.378C4760.5496,-1511.442 4731.7728,-1495.7632 4714,-1472.6025 4584.4736,-1303.8098 4578.3599,-1028.5262 4580.0058,-940.0995"/>
<polygon fill="#000000" stroke="#000000" points="4583.5064,-940.1113 4580.2438,-930.0314 4576.5084,-939.9458 4583.5064,-940.1113"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4755" cy="-911.8015" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4755" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_39&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_39&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4824.2097,-1517.7425C4819.7626,-1505.2577 4814.2009,-1488.135 4811,-1472.6025 4769.5138,-1271.2903 4758.4054,-1022.7476 4755.7548,-940.0409"/>
<polygon fill="#000000" stroke="#000000" points="4759.2495,-939.8119 4755.4469,-929.923 4752.2528,-940.0249 4759.2495,-939.8119"/>
</g>
<!-- codeblock_59 -->
<g id="node60" class="node">
<title>codeblock_59</title>
<ellipse fill="none" stroke="#000000" cx="4907" cy="-911.8015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4907" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 148&#45;155</text>
</g>
<!-- section_39&#45;&gt;codeblock_59 -->
<g id="edge59" class="edge">
<title>section_39&#45;&gt;codeblock_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4833.1926,-1517.7032C4843.8751,-1430.008 4890.4847,-1047.3794 4903.5716,-939.9459"/>
<polygon fill="#000000" stroke="#000000" points="4907.0636,-940.2237 4904.7985,-929.8738 4900.1149,-939.3772 4907.0636,-940.2237"/>
</g>
<!-- codeblock_60 -->
<g id="node61" class="node">
<title>codeblock_60</title>
<ellipse fill="none" stroke="#000000" cx="5170" cy="-911.8015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5170" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 157&#45;165</text>
</g>
<!-- section_39&#45;&gt;codeblock_60 -->
<g id="edge60" class="edge">
<title>section_39&#45;&gt;codeblock_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4896.0903,-1526.4047C4932.1204,-1518.0471 4975.1204,-1502.2721 5003,-1472.6025 5151.4168,-1314.6563 5168.4432,-1030.4651 5169.9971,-940.1584"/>
<polygon fill="#000000" stroke="#000000" points="5173.4999,-939.9346 5170.1191,-929.8936 5166.5004,-939.8513 5173.4999,-939.9346"/>
</g>
<!-- codeblock_61 -->
<g id="node62" class="node">
<title>codeblock_61</title>
<ellipse fill="none" stroke="#000000" cx="5392" cy="-911.8015" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5392" y="-907.6015" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 167&#45;169</text>
</g>
<!-- section_39&#45;&gt;codeblock_61 -->
<g id="edge61" class="edge">
<title>section_39&#45;&gt;codeblock_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4902.5964,-1529.7453C5019.1904,-1519.3972 5239.7869,-1496.8722 5266,-1472.6025 5423.0688,-1327.1786 5405.3816,-1031.7197 5395.5216,-939.7625"/>
<polygon fill="#000000" stroke="#000000" points="5398.9988,-939.3627 5394.3986,-929.8187 5392.043,-940.1483 5398.9988,-939.3627"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="3297,-221.2002 3243,-221.2002 3243,-185.2002 3297,-185.2002 3297,-221.2002"/>
</g>
<!-- raw_41&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_41&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3270,-893.5733C3270,-797.4592 3270,-349.4859 3270,-231.6572"/>
<polygon fill="#000000" stroke="#000000" points="3273.5001,-231.3079 3270,-221.3079 3266.5001,-231.3079 3273.5001,-231.3079"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="3710,-221.2002 3554,-221.2002 3554,-185.2002 3710,-185.2002 3710,-221.2002"/>
<text text-anchor="middle" x="3632" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_44&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>header_44&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3808.4482,-893.7701C3805.7841,-822.6225 3791.1674,-555.2895 3718,-351.0005 3701.671,-305.4088 3671.2331,-257.908 3651.297,-229.4429"/>
<polygon fill="#000000" stroke="#000000" points="3654.1179,-227.3702 3645.4743,-221.2432 3648.4105,-231.4231 3654.1179,-227.3702"/>
</g>
<!-- raw_48 -->
<g id="node49" class="node">
<title>raw_48</title>
<ellipse fill="none" stroke="#000000" cx="3755" cy="-203.2002" rx="27" ry="18"/>
<text text-anchor="middle" x="3755" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_45&#45;&gt;raw_48 -->
<g id="edge48" class="edge">
<title>prose_45&#45;&gt;raw_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3947.0362,-893.7908C3967.0327,-818.0975 4033.4519,-521.7928 3900,-351.0005 3868.5879,-310.7991 3826.9402,-351.2104 3791,-315.0005 3768.7526,-292.5861 3760.2476,-256.3732 3756.9999,-231.2612"/>
<polygon fill="#000000" stroke="#000000" points="3760.4716,-230.8113 3755.9051,-221.2511 3753.5131,-231.5724 3760.4716,-230.8113"/>
</g>
<!-- prespace_49 -->
<g id="node50" class="node">
<title>prespace_49</title>
<ellipse fill="none" stroke="#000000" cx="3846" cy="-203.2002" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="3846" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_45&#45;&gt;prespace_49 -->
<g id="edge49" class="edge">
<title>prose_45&#45;&gt;prespace_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3942.4388,-893.6271C3943.7671,-823.0218 3945.2028,-560.4855 3900,-351.0005 3890.6188,-307.5249 3871.3299,-259.5701 3858.5292,-230.4165"/>
<polygon fill="#000000" stroke="#000000" points="3861.5672,-228.6353 3854.2988,-220.9268 3855.1737,-231.4855 3861.5672,-228.6353"/>
</g>
<!-- literal_50 -->
<g id="node51" class="node">
<title>literal_50</title>
<ellipse fill="none" stroke="#000000" cx="3942" cy="-203.2002" rx="31.481" ry="18"/>
<text text-anchor="middle" x="3942" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_45&#45;&gt;literal_50 -->
<g id="edge50" class="edge">
<title>prose_45&#45;&gt;literal_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3942,-893.5733C3942,-797.4592 3942,-349.4859 3942,-231.6572"/>
<polygon fill="#000000" stroke="#000000" points="3945.5001,-231.3079 3942,-221.3079 3938.5001,-231.3079 3945.5001,-231.3079"/>
</g>
<!-- raw_51 -->
<g id="node52" class="node">
<title>raw_51</title>
<ellipse fill="none" stroke="#000000" cx="4018" cy="-203.2002" rx="27" ry="18"/>
<text text-anchor="middle" x="4018" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_45&#45;&gt;raw_51 -->
<g id="edge51" class="edge">
<title>prose_45&#45;&gt;raw_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3943.955,-893.5733C3954.274,-797.3623 4002.4073,-348.5824 4014.986,-231.3018"/>
<polygon fill="#000000" stroke="#000000" points="4018.4714,-231.6241 4016.0579,-221.3079 4011.5113,-230.8776 4018.4714,-231.6241"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="4471,-314.801 4063,-314.801 4063,-91.5995 4471,-91.5995 4471,-314.801"/>
<text text-anchor="middle" x="4267" y="-299.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="4267" y="-284.4004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local plus = historian.cursor &lt; #historian and 1 or 0</text>
<text text-anchor="middle" x="4267" y="-269.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="4267" y="-253.6004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="4267" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4267" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor + plus</text>
<text text-anchor="middle" x="4267" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = historian[historian.cursor]:clone()</text>
<text text-anchor="middle" x="4267" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="4267" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not (plus &gt; 0) and #linebuf.line &gt; 0 then</text>
<text text-anchor="middle" x="4267" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf, true</text>
<text text-anchor="middle" x="4267" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="4267" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf, false</text>
<text text-anchor="middle" x="4267" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4267" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_46&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_46&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4175.4181,-893.5733C4185.8411,-815.0012 4227.4571,-501.2868 4250.8401,-325.0188"/>
<polygon fill="#000000" stroke="#000000" points="4254.3354,-325.2849 4252.1809,-314.9114 4247.3961,-324.3643 4254.3354,-325.2849"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="3802,-55.6015 3324,-55.6015 3324,.2015 3802,.2015 3802,-55.6015"/>
<text text-anchor="middle" x="3563" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next linebuf in history, and a second flag to tell the</text>
</g>
<!-- raw_48&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>raw_48&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3753.7967,-184.9823C3751.261,-160.696 3743.3926,-117.7247 3719,-91.4 3707.1989,-78.6642 3692.4846,-68.4098 3676.8423,-60.1709"/>
<polygon fill="#000000" stroke="#000000" points="3678.0531,-56.8643 3667.5402,-55.5493 3674.9385,-63.1332 3678.0531,-56.8643"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3874,-45.7 3820,-45.7 3820,-9.7 3874,-9.7 3874,-45.7"/>
</g>
<!-- prespace_49&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>prespace_49&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3846.1033,-185.0797C3846.2774,-154.5231 3846.6306,-92.5279 3846.838,-56.1322"/>
<polygon fill="#000000" stroke="#000000" points="3850.3402,-55.7418 3846.8973,-45.722 3843.3403,-55.7019 3850.3402,-55.7418"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="3992,-45.7 3892,-45.7 3892,-9.7 3992,-9.7 3992,-45.7"/>
<text text-anchor="middle" x="3942" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_50&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>literal_50&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3942,-185.0797C3942,-154.5231 3942,-92.5279 3942,-56.1322"/>
<polygon fill="#000000" stroke="#000000" points="3945.5001,-55.722 3942,-45.722 3938.5001,-55.7221 3945.5001,-55.722"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="4250,-45.7 4010,-45.7 4010,-9.7 4250,-9.7 4250,-45.7"/>
<text text-anchor="middle" x="4130" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_51&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>raw_51&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4020.6171,-185.1968C4024.6782,-161.9061 4034.1902,-120.8356 4054,-91.4 4064.2851,-76.1174 4079.2495,-62.4818 4093.1849,-51.7863"/>
<polygon fill="#000000" stroke="#000000" points="4095.2685,-54.5985 4101.2278,-45.8385 4091.1064,-48.9703 4095.2685,-54.5985"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="4659,-221.2002 4489,-221.2002 4489,-185.2002 4659,-185.2002 4659,-221.2002"/>
<text text-anchor="middle" x="4574" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append()</text>
</g>
<!-- header_57&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>header_57&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4580.8199,-893.5733C4579.8705,-797.4592 4575.4451,-349.4859 4574.2811,-231.6572"/>
<polygon fill="#000000" stroke="#000000" points="4577.7776,-231.2728 4574.1789,-221.3079 4570.7779,-231.342 4577.7776,-231.2728"/>
</g>
<!-- raw_63 -->
<g id="node64" class="node">
<title>raw_63</title>
<ellipse fill="none" stroke="#000000" cx="4704" cy="-203.2002" rx="27" ry="18"/>
<text text-anchor="middle" x="4704" y="-199.0002" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_63 -->
<g id="edge63" class="edge">
<title>prose_58&#45;&gt;raw_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4753.6881,-893.5733C4746.7635,-797.3623 4714.4636,-348.5824 4706.0225,-231.3018"/>
<polygon fill="#000000" stroke="#000000" points="4709.5122,-231.0308 4705.3033,-221.3079 4702.5303,-231.5334 4709.5122,-231.0308"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="5080.5,-253.6012 4749.5,-253.6012 4749.5,-152.7993 5080.5,-152.7993 5080.5,-253.6012"/>
<text text-anchor="middle" x="4915" y="-238.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, linebuf)</text>
<text text-anchor="middle" x="4915" y="-222.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = linebuf</text>
<text text-anchor="middle" x="4915" y="-207.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="4915" y="-192.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:persist(linebuf)</text>
<text text-anchor="middle" x="4915" y="-176.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="4915" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_59&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>codeblock_59&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4907.2058,-893.5733C4908.2093,-804.687 4912.6103,-414.8716 4914.3187,-263.5504"/>
<polygon fill="#000000" stroke="#000000" points="4917.8189,-263.5429 4914.4321,-253.504 4910.8193,-263.4638 4917.8189,-263.5429"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="5367,-261.0006 5099,-261.0006 5099,-145.3999 5367,-145.3999 5367,-261.0006"/>
<text text-anchor="middle" x="5233" y="-245.9004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(linebuf)</text>
<text text-anchor="middle" x="5233" y="-230.5003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="5233" y="-215.1003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="5233" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="5233" y="-184.3002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="5233" y="-168.9002" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5233" y="-153.5002" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_60&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_60&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5171.6206,-893.5733C5179.3945,-806.135 5213.0587,-427.4923 5226.9602,-271.1332"/>
<polygon fill="#000000" stroke="#000000" points="5230.4474,-271.4317 5227.8468,-261.161 5223.4749,-270.8118 5230.4474,-271.4317"/>
</g>
<!-- leaf_67 -->
<g id="node68" class="node">
<title>leaf_67</title>
<polygon fill="none" stroke="#c0c0c0" points="5471,-221.2002 5385,-221.2002 5385,-185.2002 5471,-185.2002 5471,-221.2002"/>
<text text-anchor="middle" x="5428" y="-199.7003" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_61&#45;&gt;leaf_67 -->
<g id="edge67" class="edge">
<title>codeblock_61&#45;&gt;leaf_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5392.9261,-893.5733C5397.814,-797.3623 5420.614,-348.5824 5426.5723,-231.3018"/>
<polygon fill="#000000" stroke="#000000" points="5430.0681,-231.4726 5427.0801,-221.3079 5423.0771,-231.1174 5430.0681,-231.4726"/>
</g>
<!-- leaf_64 -->
<g id="node65" class="node">
<title>leaf_64</title>
<polygon fill="none" stroke="#c0c0c0" points="4731,-45.7 4677,-45.7 4677,-9.7 4731,-9.7 4731,-45.7"/>
</g>
<!-- raw_63&#45;&gt;leaf_64 -->
<g id="edge64" class="edge">
<title>raw_63&#45;&gt;leaf_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4704,-185.0797C4704,-154.5231 4704,-92.5279 4704,-56.1322"/>
<polygon fill="#000000" stroke="#000000" points="4707.5001,-55.722 4704,-45.722 4700.5001,-55.7221 4707.5001,-55.722"/>
</g>
</g>
</svg>
