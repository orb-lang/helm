<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="18468pt" height="2818pt"
 viewBox="0.00 0.00 18468.00 2817.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2813.8043)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2813.8043 18464,-2813.8043 18464,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2791.8043" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1787" y="-2787.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 575</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2719.8043" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1787" y="-2715.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;469</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2773.6356C1787,-2765.9352 1787,-2756.7786 1787,-2748.2209"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2748.2175 1787,-2738.2175 1783.5001,-2748.2176 1790.5001,-2748.2175"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1168" cy="-2647.8043" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1168" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1723.9539,-2714.6645C1626.4015,-2706.3859 1433.1005,-2688.6842 1270,-2665.8043 1256.1003,-2663.8544 1241.1943,-2661.4202 1227.1878,-2658.9783"/>
<polygon fill="#000000" stroke="#000000" points="1227.6322,-2655.5026 1217.1751,-2657.2057 1226.4118,-2662.3954 1227.6322,-2655.5026"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1311" cy="-2647.8043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1311" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1723.5646,-2714.915C1641.3362,-2707.8204 1493.8081,-2692.51 1370,-2665.8043 1363.0369,-2664.3023 1355.7091,-2662.3657 1348.6762,-2660.3216"/>
<polygon fill="#000000" stroke="#000000" points="1349.2453,-2656.837 1338.6601,-2657.2882 1347.2162,-2663.5365 1349.2453,-2656.837"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1411" cy="-2647.8043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1411" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1725.926,-2713.0476C1659.8995,-2704.9667 1551.9065,-2689.4872 1461,-2665.8043 1456.3882,-2664.6028 1451.6017,-2663.1533 1446.8989,-2661.6048"/>
<polygon fill="#000000" stroke="#000000" points="1448.0406,-2658.2963 1437.4458,-2658.335 1445.7523,-2664.9117 1448.0406,-2658.2963"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1502" cy="-2647.8043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1502" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1731.5351,-2709.9276C1682.4645,-2700.5759 1609.2037,-2685.1082 1547,-2665.8043 1543.8659,-2664.8316 1540.6423,-2663.7376 1537.4292,-2662.5817"/>
<polygon fill="#000000" stroke="#000000" points="1538.5133,-2659.2499 1527.9217,-2658.9881 1536.0383,-2665.7977 1538.5133,-2659.2499"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1588" cy="-2647.8043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1588" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1747.2077,-2705.407C1711.592,-2692.521 1659.78,-2673.7749 1625.0336,-2661.2034"/>
<polygon fill="#000000" stroke="#000000" points="1625.869,-2657.7836 1615.2748,-2657.6725 1623.4874,-2664.3661 1625.869,-2657.7836"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2647.8043" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1787" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;27</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2701.6356C1787,-2693.9352 1787,-2684.7786 1787,-2676.2209"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2676.2175 1787,-2666.2175 1783.5001,-2676.2176 1790.5001,-2676.2175"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="2066" cy="-2647.8043" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2066" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 29&#45;31</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1834.9618,-2707.427C1881.7022,-2695.365 1952.9893,-2676.9683 2004.0105,-2663.8016"/>
<polygon fill="#000000" stroke="#000000" points="2005.1231,-2667.1292 2013.9312,-2661.2414 2003.3739,-2660.3513 2005.1231,-2667.1292"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2647.8043" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2593" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 34&#45;222</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1849.5748,-2714.2145C1995.3393,-2701.1933 2357.1653,-2668.8714 2516.0774,-2654.6758"/>
<polygon fill="#000000" stroke="#000000" points="2516.5979,-2658.1433 2526.2468,-2653.7673 2515.975,-2651.1711 2516.5979,-2658.1433"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="7314" cy="-2647.8043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7314" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 280&#45;315</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.9212,-2718.9455C2427.2737,-2711.4635 6576.4398,-2657.4124 7227.9999,-2648.9246"/>
<polygon fill="#000000" stroke="#000000" points="7228.2947,-2652.4211 7238.2482,-2648.7911 7228.2034,-2645.4217 7228.2947,-2652.4211"/>
</g>
<!-- section_11 -->
<g id="node12" class="node">
<title>section_11</title>
<ellipse fill="none" stroke="#000000" cx="11897" cy="-2647.8043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="11897" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 382&#45;449</text>
</g>
<!-- section_1&#45;&gt;section_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;section_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.8903,-2719.335C2672.5298,-2713.4978 10879.3063,-2655.0519 11811.025,-2648.4166"/>
<polygon fill="#000000" stroke="#000000" points="11811.3521,-2651.9144 11821.3269,-2648.3432 11811.3022,-2644.9146 11811.3521,-2651.9144"/>
</g>
<!-- section_12 -->
<g id="node13" class="node">
<title>section_12</title>
<ellipse fill="none" stroke="#000000" cx="15225" cy="-2647.8043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="15225" y="-2643.6043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 470&#45;540</text>
</g>
<!-- section_1&#45;&gt;section_12 -->
<g id="edge12" class="edge">
<title>section_1&#45;&gt;section_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.7099,-2719.4625C2495.9537,-2716.116 7735.7151,-2688.8263 11981,-2665.8043 13236.0835,-2658.998 14764.3061,-2650.4014 15139.0392,-2648.2892"/>
<polygon fill="#000000" stroke="#000000" points="15139.2817,-2651.788 15149.2618,-2648.2316 15139.2422,-2644.7881 15139.2817,-2651.788"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1209.5,-2530.8041 1116.5,-2530.8041 1116.5,-2494.8041 1209.5,-2494.8041 1209.5,-2530.8041"/>
<text text-anchor="middle" x="1163" y="-2509.3041" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>header_2&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1167.3257,-2629.5976C1166.487,-2606.9519 1165.0454,-2568.0307 1164.0588,-2541.3907"/>
<polygon fill="#000000" stroke="#000000" points="1167.5474,-2541.0171 1163.6796,-2531.1535 1160.5522,-2541.2763 1167.5474,-2541.0171"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="1255" cy="-2512.8041" rx="27" ry="18"/>
<text text-anchor="middle" x="1255" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_3&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1303.679,-2630.1554C1294.1624,-2607.2136 1277.4451,-2566.9129 1266.2964,-2540.0365"/>
<polygon fill="#000000" stroke="#000000" points="1269.3873,-2538.3531 1262.3228,-2530.4574 1262.9216,-2541.0353 1269.3873,-2538.3531"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="1327" cy="-2512.8041" rx="27" ry="18"/>
<text text-anchor="middle" x="1327" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_4&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1394.4373,-2631.8656C1384.4501,-2621.644 1371.9687,-2607.722 1363,-2593.8043 1352.1621,-2576.9859 1343.0471,-2556.3579 1336.7004,-2540.128"/>
<polygon fill="#000000" stroke="#000000" points="1339.9311,-2538.7762 1333.1158,-2530.6643 1333.385,-2541.2557 1339.9311,-2538.7762"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1399" cy="-2512.8041" rx="27" ry="18"/>
<text text-anchor="middle" x="1399" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_5&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1480.4261,-2634.3806C1466.052,-2624.565 1447.5642,-2610.1502 1435,-2593.8043 1422.6515,-2577.7389 1413.482,-2556.7713 1407.488,-2540.1943"/>
<polygon fill="#000000" stroke="#000000" points="1410.725,-2538.844 1404.1663,-2530.5233 1404.1046,-2541.118 1410.725,-2538.844"/>
</g>
<!-- raw_20 -->
<g id="node21" class="node">
<title>raw_20</title>
<ellipse fill="none" stroke="#000000" cx="1471" cy="-2512.8041" rx="27" ry="18"/>
<text text-anchor="middle" x="1471" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_20 -->
<g id="edge20" class="edge">
<title>prose_6&#45;&gt;raw_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1563.3214,-2636.1317C1545.7001,-2626.76 1522.4702,-2612.1522 1507,-2593.8043 1493.9385,-2578.3131 1484.7894,-2557.3289 1478.9835,-2540.6006"/>
<polygon fill="#000000" stroke="#000000" points="1482.2228,-2539.2445 1475.7954,-2530.8219 1475.5675,-2541.4143 1482.2228,-2539.2445"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2057.5,-2593.8044 1516.5,-2593.8044 1516.5,-2431.8038 2057.5,-2431.8038 2057.5,-2593.8044"/>
<text text-anchor="middle" x="1787" y="-2578.6043" font-family="Inconsolata" font-size="14.00" fill="#000000">local Txtbuf &#160;= require &quot;txtbuf&quot;</text>
<text text-anchor="middle" x="1787" y="-2563.2042" font-family="Inconsolata" font-size="14.00" fill="#000000">local Rainbuf = require &quot;rainbuf&quot;</text>
<text text-anchor="middle" x="1787" y="-2547.8042" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1787" y="-2532.4042" font-family="Inconsolata" font-size="14.00" fill="#000000">local color &#160;&#160;= require &quot;color&quot;</text>
<text text-anchor="middle" x="1787" y="-2517.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">local L &#160;&#160;&#160;&#160;&#160;&#160;= require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1787" y="-2501.6041" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
<text text-anchor="middle" x="1787" y="-2486.2041" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub &#160;&#160;&#160;&#160;= assert (string.sub)</text>
<text text-anchor="middle" x="1787" y="-2470.8041" font-family="Inconsolata" font-size="14.00" fill="#000000">local codepoints = assert(string.codepoints, &quot;must have string.codepoints&quot;)</text>
<text text-anchor="middle" x="1787" y="-2455.404" font-family="Inconsolata" font-size="14.00" fill="#000000">local reverse = assert (table.reverse)</text>
<text text-anchor="middle" x="1787" y="-2440.004" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(meta)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_7&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2629.5976C1787,-2622.4398 1787,-2613.656 1787,-2604.148"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2604.0152 1787,-2594.0153 1783.5001,-2604.0153 1790.5001,-2604.0152"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2266.5,-2530.8041 2075.5,-2530.8041 2075.5,-2494.8041 2266.5,-2494.8041 2266.5,-2530.8041"/>
<text text-anchor="middle" x="2171" y="-2509.3041" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_8&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2079.9432,-2629.8773C2098.0647,-2606.5782 2129.8454,-2565.7172 2150.6583,-2538.9577"/>
<polygon fill="#000000" stroke="#000000" points="2153.6224,-2540.8476 2156.9991,-2530.8052 2148.097,-2536.55 2153.6224,-2540.8476"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="2353" cy="-2512.8041" rx="68.6997" ry="18"/>
<text text-anchor="middle" x="2353" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Persistence</text>
</g>
<!-- section_9&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2537.9614,-2636.4831C2505.1755,-2628.0828 2463.7171,-2614.4536 2431,-2593.8043 2408.0159,-2579.2979 2386.9624,-2556.6141 2372.537,-2538.9371"/>
<polygon fill="#000000" stroke="#000000" points="2374.9694,-2536.3721 2366.0085,-2530.7193 2369.4884,-2540.7263 2374.9694,-2536.3721"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2472" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2472" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_9&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2561.3051,-2631.5091C2545.326,-2622.1185 2526.5232,-2609.1358 2513,-2593.8043 2499.2718,-2578.2403 2488.8191,-2557.2583 2481.9042,-2540.5491"/>
<polygon fill="#000000" stroke="#000000" points="2484.9794,-2538.8059 2478.0583,-2530.7841 2478.4663,-2541.3711 2484.9794,-2538.8059"/>
</g>
<!-- section_26 -->
<g id="node27" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2512.8041" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2593" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 38&#45;140</text>
</g>
<!-- section_9&#45;&gt;section_26 -->
<g id="edge26" class="edge">
<title>section_9&#45;&gt;section_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593,-2629.5976C2593,-2606.9519 2593,-2568.0307 2593,-2541.3907"/>
<polygon fill="#000000" stroke="#000000" points="2596.5001,-2541.1535 2593,-2531.1535 2589.5001,-2541.1536 2596.5001,-2541.1535"/>
</g>
<!-- section_27 -->
<g id="node28" class="node">
<title>section_27</title>
<ellipse fill="none" stroke="#000000" cx="2991" cy="-2512.8041" rx="74.6878" ry="18"/>
<text text-anchor="middle" x="2991" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 141&#45;211</text>
</g>
<!-- section_9&#45;&gt;section_27 -->
<g id="edge27" class="edge">
<title>section_9&#45;&gt;section_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2635.593,-2633.3569C2708.6702,-2608.5694 2857.7656,-2557.9967 2937.6482,-2530.9009"/>
<polygon fill="#000000" stroke="#000000" points="2939.161,-2534.0837 2947.5067,-2527.5569 2936.9124,-2527.4546 2939.161,-2534.0837"/>
</g>
<!-- section_28 -->
<g id="node29" class="node">
<title>section_28</title>
<ellipse fill="none" stroke="#000000" cx="4150" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4150" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 212&#45;222</text>
</g>
<!-- section_9&#45;&gt;section_28 -->
<g id="edge28" class="edge">
<title>section_9&#45;&gt;section_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2659.9023,-2642.0035C2910.7501,-2620.2537 3795.0254,-2543.5823 4068.6743,-2519.8555"/>
<polygon fill="#000000" stroke="#000000" points="4069.2647,-2523.3175 4078.9249,-2518.9667 4068.66,-2516.3437 4069.2647,-2523.3175"/>
</g>
<!-- section_29 -->
<g id="node30" class="node">
<title>section_29</title>
<ellipse fill="none" stroke="#000000" cx="4967" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4967" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 223&#45;279</text>
</g>
<!-- section_9&#45;&gt;section_29 -->
<g id="edge29" class="edge">
<title>section_9&#45;&gt;section_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2663.8757,-2647.4243C2891.9448,-2645.7838 3627.3275,-2637.2412 4234,-2593.8043 4474.8343,-2576.5609 4758.6228,-2540.7657 4891.3838,-2523.1093"/>
<polygon fill="#000000" stroke="#000000" points="4891.9994,-2526.5583 4901.4489,-2521.767 4891.074,-2519.6198 4891.9994,-2526.5583"/>
</g>
<!-- header_99 -->
<g id="node100" class="node">
<title>header_99</title>
<ellipse fill="none" stroke="#000000" cx="7115" cy="-2512.8041" rx="107.339" ry="18"/>
<text text-anchor="middle" x="7115" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_10&#45;&gt;header_99 -->
<g id="edge99" class="edge">
<title>section_10&#45;&gt;header_99</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7287.6774,-2630.6916C7271.5441,-2620.1483 7250.5056,-2606.301 7232,-2593.8043 7203.6784,-2574.679 7171.8029,-2552.5724 7148.4833,-2536.2904"/>
<polygon fill="#000000" stroke="#000000" points="7150.1914,-2533.2141 7139.99,-2530.3537 7146.1811,-2538.9515 7150.1914,-2533.2141"/>
</g>
<!-- prose_100 -->
<g id="node101" class="node">
<title>prose_100</title>
<ellipse fill="none" stroke="#000000" cx="7273" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7273" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_100 -->
<g id="edge100" class="edge">
<title>section_10&#45;&gt;prose_100</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7308.4706,-2629.5976C7301.5238,-2606.7242 7289.5343,-2567.2463 7281.4389,-2540.5908"/>
<polygon fill="#000000" stroke="#000000" points="7284.6968,-2539.2737 7278.4418,-2530.7224 7277.9989,-2541.308 7284.6968,-2539.2737"/>
</g>
<!-- prose_101 -->
<g id="node102" class="node">
<title>prose_101</title>
<ellipse fill="none" stroke="#000000" cx="7355" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7355" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_101 -->
<g id="edge101" class="edge">
<title>section_10&#45;&gt;prose_101</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7319.5294,-2629.5976C7326.4762,-2606.7242 7338.4657,-2567.2463 7346.5611,-2540.5908"/>
<polygon fill="#000000" stroke="#000000" points="7350.0011,-2541.308 7349.5582,-2530.7224 7343.3032,-2539.2737 7350.0011,-2541.308"/>
</g>
<!-- section_102 -->
<g id="node103" class="node">
<title>section_102</title>
<ellipse fill="none" stroke="#000000" cx="7942" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7942" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 290&#45;315</text>
</g>
<!-- section_10&#45;&gt;section_102 -->
<g id="edge102" class="edge">
<title>section_10&#45;&gt;section_102</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7370.2835,-2635.7051C7486.2437,-2610.7773 7751.2892,-2553.8009 7875.4832,-2527.1031"/>
<polygon fill="#000000" stroke="#000000" points="7876.5759,-2530.4483 7885.617,-2524.9247 7875.1047,-2523.6046 7876.5759,-2530.4483"/>
</g>
<!-- section_103 -->
<g id="node104" class="node">
<title>section_103</title>
<ellipse fill="none" stroke="#000000" cx="9478" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="9478" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 316&#45;381</text>
</g>
<!-- section_10&#45;&gt;section_103 -->
<g id="edge103" class="edge">
<title>section_10&#45;&gt;section_103</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7387.2401,-2643.2352C7715.1338,-2622.7797 9047.3149,-2539.6722 9394.7871,-2517.9953"/>
<polygon fill="#000000" stroke="#000000" points="9395.0155,-2521.488 9404.7781,-2517.372 9394.5795,-2514.5016 9395.0155,-2521.488"/>
</g>
<!-- header_151 -->
<g id="node152" class="node">
<title>header_151</title>
<ellipse fill="none" stroke="#000000" cx="10555" cy="-2512.8041" rx="107.339" ry="18"/>
<text text-anchor="middle" x="10555" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_11&#45;&gt;header_151 -->
<g id="edge151" class="edge">
<title>section_11&#45;&gt;header_151</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11821.4689,-2647.4995C11600.9706,-2646.0923 10960.8895,-2638.1892 10757,-2593.8043 10699.4082,-2581.2671 10636.9992,-2553.9328 10597.0281,-2534.49"/>
<polygon fill="#000000" stroke="#000000" points="10598.3791,-2531.254 10587.8614,-2529.9777 10595.2876,-2537.5343 10598.3791,-2531.254"/>
</g>
<!-- prose_152 -->
<g id="node153" class="node">
<title>prose_152</title>
<ellipse fill="none" stroke="#000000" cx="10798" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="10798" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_152 -->
<g id="edge152" class="edge">
<title>section_11&#45;&gt;prose_152</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11825.4204,-2641.9414C11720.043,-2633.052 11517.0296,-2614.9428 11345,-2593.8043 11155.3105,-2570.4958 10929.854,-2534.4552 10838.9705,-2519.5802"/>
<polygon fill="#000000" stroke="#000000" points="10839.5068,-2516.1214 10829.0721,-2517.9566 10838.3737,-2523.0291 10839.5068,-2516.1214"/>
</g>
<!-- prose_153 -->
<g id="node154" class="node">
<title>prose_153</title>
<ellipse fill="none" stroke="#000000" cx="11386" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11386" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_153 -->
<g id="edge153" class="edge">
<title>section_11&#45;&gt;prose_153</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11846.1352,-2634.3664C11744.0613,-2607.3997 11516.2344,-2547.2105 11424.9375,-2523.091"/>
<polygon fill="#000000" stroke="#000000" points="11425.8218,-2519.7046 11415.2595,-2520.5341 11424.0338,-2526.4724 11425.8218,-2519.7046"/>
</g>
<!-- prose_154 -->
<g id="node155" class="node">
<title>prose_154</title>
<ellipse fill="none" stroke="#000000" cx="11745" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11745" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_154 -->
<g id="edge154" class="edge">
<title>section_11&#45;&gt;prose_154</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11877.1287,-2630.1554C11849.6489,-2605.749 11800.0492,-2561.6966 11770.0599,-2535.0613"/>
<polygon fill="#000000" stroke="#000000" points="11772.3208,-2532.3882 11762.5198,-2528.3645 11767.6724,-2537.622 11772.3208,-2532.3882"/>
</g>
<!-- prose_155 -->
<g id="node156" class="node">
<title>prose_155</title>
<ellipse fill="none" stroke="#000000" cx="11897" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11897" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_155 -->
<g id="edge155" class="edge">
<title>section_11&#45;&gt;prose_155</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11897,-2629.5976C11897,-2606.9519 11897,-2568.0307 11897,-2541.3907"/>
<polygon fill="#000000" stroke="#000000" points="11900.5001,-2541.1535 11897,-2531.1535 11893.5001,-2541.1536 11900.5001,-2541.1535"/>
</g>
<!-- prose_156 -->
<g id="node157" class="node">
<title>prose_156</title>
<ellipse fill="none" stroke="#000000" cx="12097" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="12097" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_156 -->
<g id="edge156" class="edge">
<title>section_11&#45;&gt;prose_156</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11922.3301,-2630.7064C11959.5619,-2605.575 12028.8776,-2558.7868 12068.0652,-2532.3352"/>
<polygon fill="#000000" stroke="#000000" points="12070.0822,-2535.1964 12076.4125,-2526.7007 12066.1659,-2529.3945 12070.0822,-2535.1964"/>
</g>
<!-- prose_157 -->
<g id="node158" class="node">
<title>prose_157</title>
<ellipse fill="none" stroke="#000000" cx="13102" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="13102" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_157 -->
<g id="edge157" class="edge">
<title>section_11&#45;&gt;prose_157</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.6757,-2640.1103C12187.7895,-2615.2262 12882.5898,-2537.3854 13060.2832,-2517.4778"/>
<polygon fill="#000000" stroke="#000000" points="13060.7308,-2520.9496 13070.2789,-2516.3579 13059.9513,-2513.9932 13060.7308,-2520.9496"/>
</g>
<!-- prose_158 -->
<g id="node159" class="node">
<title>prose_158</title>
<ellipse fill="none" stroke="#000000" cx="13265" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="13265" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_158 -->
<g id="edge158" class="edge">
<title>section_11&#45;&gt;prose_158</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11972.7999,-2646.8826C12225.8966,-2643.479 13032.1421,-2629.8918 13143,-2593.8043 13180.412,-2581.6256 13217.1747,-2554.5713 13240.4017,-2535.0767"/>
<polygon fill="#000000" stroke="#000000" points="13242.7193,-2537.6999 13248.0317,-2528.5332 13238.1623,-2532.3863 13242.7193,-2537.6999"/>
</g>
<!-- codeblock_159 -->
<g id="node160" class="node">
<title>codeblock_159</title>
<ellipse fill="none" stroke="#000000" cx="13536" cy="-2512.8041" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="13536" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 403&#45;447</text>
</g>
<!-- section_11&#45;&gt;codeblock_159 -->
<g id="edge159" class="edge">
<title>section_11&#45;&gt;codeblock_159</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11972.2571,-2646.2402C12245.3452,-2640.3831 13174.9475,-2618.7988 13306,-2593.8043 13372.1938,-2581.1797 13444.9933,-2552.9384 13490.5919,-2533.3819"/>
<polygon fill="#000000" stroke="#000000" points="13492.1134,-2536.5372 13499.8971,-2529.3493 13489.3299,-2530.1143 13492.1134,-2536.5372"/>
</g>
<!-- section_160 -->
<g id="node161" class="node">
<title>section_160</title>
<ellipse fill="none" stroke="#000000" cx="14363" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="14363" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 450&#45;469</text>
</g>
<!-- section_11&#45;&gt;section_160 -->
<g id="edge160" class="edge">
<title>section_11&#45;&gt;section_160</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11972.6323,-2646.2497C12262.3983,-2640.1693 13302.0832,-2617.1801 13632,-2593.8043 13871.8875,-2576.8074 14154.471,-2540.9767 14287.0805,-2523.2249"/>
<polygon fill="#000000" stroke="#000000" points="14287.6906,-2526.6744 14297.136,-2521.8749 14286.7592,-2519.7367 14287.6906,-2526.6744"/>
</g>
<!-- header_196 -->
<g id="node197" class="node">
<title>header_196</title>
<ellipse fill="none" stroke="#000000" cx="14822" cy="-2512.8041" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="14822" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_12&#45;&gt;header_196 -->
<g id="edge196" class="edge">
<title>section_12&#45;&gt;header_196</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15155.999,-2640.3486C15101,-2632.8791 15022.7464,-2618.7951 14958,-2593.8043 14920.2239,-2579.2234 14880.8798,-2554.5939 14854.2869,-2536.3132"/>
<polygon fill="#000000" stroke="#000000" points="14855.9828,-2533.2289 14845.7779,-2530.3807 14851.9793,-2538.9711 14855.9828,-2533.2289"/>
</g>
<!-- prose_197 -->
<g id="node198" class="node">
<title>prose_197</title>
<ellipse fill="none" stroke="#000000" cx="14999" cy="-2512.8041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="14999" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_197 -->
<g id="edge197" class="edge">
<title>section_12&#45;&gt;prose_197</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15194.535,-2631.1246C15175.5619,-2620.6241 15150.7171,-2606.6692 15129,-2593.8043 15094.4126,-2573.3151 15055.3406,-2548.7781 15029.1422,-2532.119"/>
<polygon fill="#000000" stroke="#000000" points="15030.7551,-2528.9966 15020.4408,-2526.5746 15026.9934,-2534.9 15030.7551,-2528.9966"/>
</g>
<!-- codeblock_198 -->
<g id="node199" class="node">
<title>codeblock_198</title>
<ellipse fill="none" stroke="#000000" cx="15225" cy="-2512.8041" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15225" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 472&#45;486</text>
</g>
<!-- section_12&#45;&gt;codeblock_198 -->
<g id="edge198" class="edge">
<title>section_12&#45;&gt;codeblock_198</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15225,-2629.5976C15225,-2606.9519 15225,-2568.0307 15225,-2541.3907"/>
<polygon fill="#000000" stroke="#000000" points="15228.5001,-2541.1535 15225,-2531.1535 15221.5001,-2541.1536 15228.5001,-2541.1535"/>
</g>
<!-- section_199 -->
<g id="node200" class="node">
<title>section_199</title>
<ellipse fill="none" stroke="#000000" cx="15674" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="15674" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 489&#45;521</text>
</g>
<!-- section_12&#45;&gt;section_199 -->
<g id="edge199" class="edge">
<title>section_12&#45;&gt;section_199</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15272.2022,-2633.6121C15355.3205,-2608.621 15527.4605,-2556.8639 15617.0394,-2529.9304"/>
<polygon fill="#000000" stroke="#000000" points="15618.1878,-2533.24 15626.7565,-2527.0088 15616.1722,-2526.5364 15618.1878,-2533.24"/>
</g>
<!-- section_200 -->
<g id="node201" class="node">
<title>section_200</title>
<ellipse fill="none" stroke="#000000" cx="16483" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="16483" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 522&#45;540</text>
</g>
<!-- section_12&#45;&gt;section_200 -->
<g id="edge200" class="edge">
<title>section_12&#45;&gt;section_200</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15294.8684,-2640.9571C15396.7373,-2630.9212 15591.989,-2611.4871 15758,-2593.8043 15993.5095,-2568.7188 16271.8105,-2537.0603 16404.7177,-2521.8175"/>
<polygon fill="#000000" stroke="#000000" points="16405.27,-2525.2771 16414.8058,-2520.66 16404.472,-2518.3228 16405.27,-2525.2771"/>
</g>
<!-- section_201 -->
<g id="node202" class="node">
<title>section_201</title>
<ellipse fill="none" stroke="#000000" cx="17606" cy="-2512.8041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="17606" y="-2508.6041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 541&#45;575</text>
</g>
<!-- section_12&#45;&gt;section_201 -->
<g id="edge201" class="edge">
<title>section_12&#45;&gt;section_201</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15300.3491,-2645.7656C15504.4167,-2640.0292 16084.8776,-2622.2872 16567,-2593.8043 16924.4938,-2572.6842 17350.2885,-2535.8015 17525.0592,-2520.1561"/>
<polygon fill="#000000" stroke="#000000" points="17525.5548,-2523.6258 17535.2023,-2519.2467 17524.9296,-2516.6538 17525.5548,-2523.6258"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-2096.3045 0,-2096.3045 0,-2024.5022 324,-2024.5022 324,-2096.3045"/>
<text text-anchor="middle" x="162" y="-2032.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1252.3252,-2494.7674C1248.4251,-2475.5653 1239.1757,-2446.0278 1218,-2431.804 1136.3046,-2376.9287 415.8563,-2448.9102 333,-2395.804 230.2535,-2329.9492 186.4189,-2181.7341 170.2181,-2106.3335"/>
<polygon fill="#000000" stroke="#000000" points="173.5726,-2105.2729 168.1122,-2096.1935 166.7188,-2106.6963 173.5726,-2105.2729"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-2087.7037 342.5,-2087.7037 342.5,-2033.1029 897.5,-2033.1029 897.5,-2087.7037"/>
<text text-anchor="middle" x="620" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1324.3347,-2494.6451C1320.5059,-2475.6308 1311.496,-2446.53 1291,-2431.804 1221.3955,-2381.7941 983.0916,-2435.2482 907,-2395.804 774.4895,-2327.1135 677.4926,-2168.82 638.6665,-2097.0127"/>
<polygon fill="#000000" stroke="#000000" points="641.5879,-2095.0529 633.7907,-2087.8797 635.4127,-2098.3496 641.5879,-2095.0529"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-2087.7037 916,-2087.7037 916,-2033.1029 1464,-2033.1029 1464,-2087.7037"/>
<text text-anchor="middle" x="1190" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1391.3639,-2495.3835C1384.1367,-2478.953 1372.9437,-2453.6544 1363,-2431.804 1306.9764,-2308.6971 1238.7331,-2163.5668 1207.3313,-2097.0481"/>
<polygon fill="#000000" stroke="#000000" points="1210.4067,-2095.3639 1202.9715,-2087.8162 1204.0771,-2098.3532 1210.4067,-2095.3639"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-2095.7037 1482,-2095.7037 1482,-2025.103 2030,-2025.103 2030,-2095.7037"/>
<text text-anchor="middle" x="1756" y="-2064.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new txtbuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-2049.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_20&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>raw_20&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1477.7487,-2495.3219C1484.4287,-2478.6286 1495.3233,-2452.9555 1507,-2431.804 1575.4504,-2307.8108 1672.8052,-2171.9126 1723.098,-2104.0566"/>
<polygon fill="#000000" stroke="#000000" points="1726.1307,-2105.8435 1729.2868,-2095.7297 1720.5125,-2101.6679 1726.1307,-2105.8435"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2162,-2078.4033 2048,-2078.4033 2048,-2042.4033 2162,-2042.4033 2162,-2078.4033"/>
<text text-anchor="middle" x="2105" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Persistence</text>
</g>
<!-- header_24&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>header_24&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2339.9521,-2494.951C2325.8046,-2476.7496 2301.6477,-2448.8375 2275,-2431.804 2233.7872,-2405.4602 2203.1024,-2432.7083 2171,-2395.804 2093.1266,-2306.2822 2096.6335,-2152.0154 2101.9048,-2088.7375"/>
<polygon fill="#000000" stroke="#000000" points="2105.3975,-2088.9761 2102.822,-2078.6991 2098.4266,-2088.3391 2105.3975,-2088.9761"/>
</g>
<!-- raw_31 -->
<g id="node32" class="node">
<title>raw_31</title>
<ellipse fill="none" stroke="#000000" cx="2207" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="2207" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_31 -->
<g id="edge31" class="edge">
<title>prose_25&#45;&gt;raw_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2467.8224,-2494.6223C2462.53,-2475.875 2451.5187,-2447.264 2431,-2431.804 2363.054,-2380.6095 2300.6313,-2458.3832 2243,-2395.804 2163.3058,-2309.2677 2186.5148,-2152.023 2200.2041,-2088.3202"/>
<polygon fill="#000000" stroke="#000000" points="2203.6926,-2088.7585 2202.4626,-2078.2353 2196.8618,-2087.2287 2203.6926,-2088.7585"/>
</g>
<!-- header_33 -->
<g id="node34" class="node">
<title>header_33</title>
<ellipse fill="none" stroke="#000000" cx="2331" cy="-2060.4033" rx="78.8488" ry="18"/>
<text text-anchor="middle" x="2331" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : SQLite battery</text>
</g>
<!-- section_26&#45;&gt;header_33 -->
<g id="edge33" class="edge">
<title>section_26&#45;&gt;header_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2579.1321,-2494.8093C2564.4142,-2476.7583 2539.6407,-2449.2078 2513,-2431.804 2475.547,-2407.3366 2448.8609,-2429.1162 2419,-2395.804 2338.6619,-2306.1803 2330.1351,-2151.9707 2330.2537,-2088.7228"/>
<polygon fill="#000000" stroke="#000000" points="2333.7537,-2088.7221 2330.3488,-2078.6893 2326.754,-2088.6557 2333.7537,-2088.7221"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="2460" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2460" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_26&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_26&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2574.3815,-2495.3707C2552.9731,-2474.101 2518.6469,-2435.9808 2502,-2395.804 2457.8025,-2289.1348 2456.7333,-2148.31 2458.6057,-2088.841"/>
<polygon fill="#000000" stroke="#000000" points="2462.1083,-2088.8325 2458.9798,-2078.7101 2455.1131,-2088.5741 2462.1083,-2088.8325"/>
</g>
<!-- codeblock_35 -->
<g id="node36" class="node">
<title>codeblock_35</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2060.4033" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2593" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 40&#45;138</text>
</g>
<!-- section_26&#45;&gt;codeblock_35 -->
<g id="edge35" class="edge">
<title>section_26&#45;&gt;codeblock_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593,-2494.7903C2593,-2425.2031 2593,-2173.6058 2593,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="2596.5001,-2088.4686 2593,-2078.4686 2589.5001,-2088.4686 2596.5001,-2088.4686"/>
</g>
<!-- header_40 -->
<g id="node41" class="node">
<title>header_40</title>
<ellipse fill="none" stroke="#000000" cx="2776" cy="-2060.4033" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2776" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:load()</text>
</g>
<!-- section_27&#45;&gt;header_40 -->
<g id="edge40" class="edge">
<title>section_27&#45;&gt;header_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2966.1495,-2495.7129C2938.1774,-2475.1839 2893.3405,-2438.1693 2868,-2395.804 2806.7252,-2293.3623 2785.2233,-2149.1197 2778.6075,-2088.7302"/>
<polygon fill="#000000" stroke="#000000" points="2782.055,-2088.0432 2777.5392,-2078.459 2775.0926,-2088.7675 2782.055,-2088.0432"/>
</g>
<!-- prose_41 -->
<g id="node42" class="node">
<title>prose_41</title>
<ellipse fill="none" stroke="#000000" cx="2909" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2909" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_41 -->
<g id="edge41" class="edge">
<title>section_27&#45;&gt;prose_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2983.2089,-2494.5277C2973.8499,-2471.8084 2958.3674,-2431.6456 2950,-2395.804 2923.8771,-2283.9066 2913.7265,-2146.8867 2910.3995,-2088.698"/>
<polygon fill="#000000" stroke="#000000" points="2913.8804,-2088.2512 2909.8388,-2078.4575 2906.8909,-2088.6339 2913.8804,-2088.2512"/>
</g>
<!-- prose_42 -->
<g id="node43" class="node">
<title>prose_42</title>
<ellipse fill="none" stroke="#000000" cx="2991" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2991" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_42 -->
<g id="edge42" class="edge">
<title>section_27&#45;&gt;prose_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2991,-2494.7903C2991,-2425.2031 2991,-2173.6058 2991,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="2994.5001,-2088.4686 2991,-2078.4686 2987.5001,-2088.4686 2994.5001,-2088.4686"/>
</g>
<!-- structure_43 -->
<g id="node44" class="node">
<title>structure_43</title>
<ellipse fill="none" stroke="#000000" cx="3086" cy="-2060.4033" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3086" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_27&#45;&gt;structure_43 -->
<g id="edge43" class="edge">
<title>section_27&#45;&gt;structure_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2998.4069,-2494.8708C3007.5203,-2472.1691 3022.9004,-2431.6888 3032,-2395.804 3060.3961,-2283.8222 3076.952,-2146.847 3083.1622,-2088.684"/>
<polygon fill="#000000" stroke="#000000" points="3086.6735,-2088.7585 3084.2345,-2078.4482 3079.7116,-2088.0291 3086.6735,-2088.7585"/>
</g>
<!-- prose_44 -->
<g id="node45" class="node">
<title>prose_44</title>
<ellipse fill="none" stroke="#000000" cx="3181" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3181" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_44 -->
<g id="edge44" class="edge">
<title>section_27&#45;&gt;prose_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3024.635,-2496.5379C3059.8099,-2477.5923 3113.5089,-2442.7902 3140,-2395.804 3197.0756,-2294.5711 3190.3679,-2149.1639 3184.415,-2088.5735"/>
<polygon fill="#000000" stroke="#000000" points="3187.8933,-2088.1832 3183.3648,-2078.6049 3180.9318,-2088.9166 3187.8933,-2088.1832"/>
</g>
<!-- codeblock_45 -->
<g id="node46" class="node">
<title>codeblock_45</title>
<ellipse fill="none" stroke="#000000" cx="3400" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3400" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 155&#45;209</text>
</g>
<!-- section_27&#45;&gt;codeblock_45 -->
<g id="edge45" class="edge">
<title>section_27&#45;&gt;codeblock_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3037.7435,-2498.6547C3088.3951,-2481.3395 3169.0519,-2447.7512 3222,-2395.804 3316.0809,-2303.5014 3371.7797,-2150.7973 3391.6641,-2088.3374"/>
<polygon fill="#000000" stroke="#000000" points="3395.1172,-2089.0211 3394.7561,-2078.4324 3388.4352,-2086.9352 3395.1172,-2089.0211"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="3909" cy="-2060.4033" rx="190.9667" ry="18"/>
<text text-anchor="middle" x="3909" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:restore_session(modeS, session)</text>
</g>
<!-- section_28&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_28&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4140.4038,-2494.7903C4103.1448,-2424.8484 3967.9357,-2171.0363 3923.3625,-2087.3643"/>
<polygon fill="#000000" stroke="#000000" points="3926.4143,-2085.6488 3918.6236,-2078.4686 3920.2363,-2088.94 3926.4143,-2085.6488"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4150" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4150" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_28&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_28&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4150,-2494.7903C4150,-2425.2031 4150,-2173.6058 4150,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="4153.5001,-2088.4686 4150,-2078.4686 4146.5001,-2088.4686 4153.5001,-2088.4686"/>
</g>
<!-- prose_59 -->
<g id="node60" class="node">
<title>prose_59</title>
<ellipse fill="none" stroke="#000000" cx="4232" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4232" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_28&#45;&gt;prose_59 -->
<g id="edge59" class="edge">
<title>section_28&#45;&gt;prose_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4157.7911,-2494.5277C4167.1501,-2471.8084 4182.6326,-2431.6456 4191,-2395.804 4217.1229,-2283.9066 4227.2735,-2146.8867 4230.6005,-2088.698"/>
<polygon fill="#000000" stroke="#000000" points="4234.1091,-2088.6339 4231.1612,-2078.4575 4227.1196,-2088.2512 4234.1091,-2088.6339"/>
</g>
<!-- codeblock_60 -->
<g id="node61" class="node">
<title>codeblock_60</title>
<ellipse fill="none" stroke="#000000" cx="4370" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4370" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 218&#45;220</text>
</g>
<!-- section_28&#45;&gt;codeblock_60 -->
<g id="edge60" class="edge">
<title>section_28&#45;&gt;codeblock_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4174.7458,-2495.6498C4202.6207,-2475.0622 4247.3675,-2437.9933 4273,-2395.804 4335.2224,-2293.3902 4359.1901,-2149.1324 4366.88,-2088.7346"/>
<polygon fill="#000000" stroke="#000000" points="4370.3964,-2088.8119 4368.132,-2078.4619 4363.4478,-2087.9649 4370.3964,-2088.8119"/>
</g>
<!-- header_67 -->
<g id="node68" class="node">
<title>header_67</title>
<ellipse fill="none" stroke="#000000" cx="4674" cy="-2060.4033" rx="113.1277" ry="18"/>
<text text-anchor="middle" x="4674" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:persist(txtbuf)</text>
</g>
<!-- section_29&#45;&gt;header_67 -->
<g id="edge67" class="edge">
<title>section_29&#45;&gt;header_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4931.9108,-2496.8424C4893.7463,-2477.8293 4833.3437,-2442.6562 4797,-2395.804 4721.5124,-2298.4897 4689.1262,-2150.3373 4678.3953,-2088.77"/>
<polygon fill="#000000" stroke="#000000" points="4681.8028,-2087.9271 4676.692,-2078.6464 4674.8998,-2089.0886 4681.8028,-2087.9271"/>
</g>
<!-- prose_68 -->
<g id="node69" class="node">
<title>prose_68</title>
<ellipse fill="none" stroke="#000000" cx="4838" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4838" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_68 -->
<g id="edge68" class="edge">
<title>section_29&#45;&gt;prose_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4948.9829,-2495.2534C4928.2683,-2473.8708 4895.0623,-2435.642 4879,-2395.804 4835.8395,-2288.7562 4834.804,-2148.1347 4836.6364,-2088.7801"/>
<polygon fill="#000000" stroke="#000000" points="4840.1383,-2088.7896 4837.0024,-2078.6695 4833.1429,-2088.5363 4840.1383,-2088.7896"/>
</g>
<!-- prose_69 -->
<g id="node70" class="node">
<title>prose_69</title>
<ellipse fill="none" stroke="#000000" cx="4920" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4920" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_69 -->
<g id="edge69" class="edge">
<title>section_29&#45;&gt;prose_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4965.1285,-2494.7903C4957.8991,-2425.2031 4931.7606,-2173.6058 4922.9346,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="4926.3915,-2088.0534 4921.8768,-2078.4686 4919.429,-2088.7768 4926.3915,-2088.0534"/>
</g>
<!-- structure_70 -->
<g id="node71" class="node">
<title>structure_70</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-2060.4033" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="5015" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_29&#45;&gt;structure_70 -->
<g id="edge70" class="edge">
<title>section_29&#45;&gt;structure_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4968.9113,-2494.7903C4976.2945,-2425.2031 5002.9892,-2173.6058 5012.003,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="5015.5086,-2088.7821 5013.0833,-2078.4686 5008.5476,-2088.0435 5015.5086,-2088.7821"/>
</g>
<!-- prose_71 -->
<g id="node72" class="node">
<title>prose_71</title>
<ellipse fill="none" stroke="#000000" cx="5590" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5590" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_71 -->
<g id="edge71" class="edge">
<title>section_29&#45;&gt;prose_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4990.6616,-2495.6219C5087.9449,-2424.9782 5456.9002,-2157.0557 5561.9415,-2080.7784"/>
<polygon fill="#000000" stroke="#000000" points="5564.1277,-2083.5163 5570.1628,-2074.8084 5560.0146,-2077.8522 5564.1277,-2083.5163"/>
</g>
<!-- prose_72 -->
<g id="node73" class="node">
<title>prose_72</title>
<ellipse fill="none" stroke="#000000" cx="5818" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5818" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_72 -->
<g id="edge72" class="edge">
<title>section_29&#45;&gt;prose_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5039.8408,-2507.8081C5191.8755,-2496.1472 5536.69,-2462.8907 5631,-2395.804 5740.6115,-2317.8326 5793.6035,-2154.4215 5811.1365,-2088.6849"/>
<polygon fill="#000000" stroke="#000000" points="5814.6175,-2089.2043 5813.7387,-2078.6459 5807.8414,-2087.4478 5814.6175,-2089.2043"/>
</g>
<!-- codeblock_73 -->
<g id="node74" class="node">
<title>codeblock_73</title>
<ellipse fill="none" stroke="#000000" cx="6112" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6112" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 242&#45;277</text>
</g>
<!-- section_29&#45;&gt;codeblock_73 -->
<g id="edge73" class="edge">
<title>section_29&#45;&gt;codeblock_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5041.9385,-2510.3453C5230.695,-2503.0025 5720.4989,-2476.4856 5859,-2395.804 5986.9863,-2321.2475 6071.1233,-2153.9207 6100.4416,-2087.9218"/>
<polygon fill="#000000" stroke="#000000" points="6103.7245,-2089.1499 6104.5219,-2078.5851 6097.3103,-2086.3467 6103.7245,-2089.1499"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="1892,-961.5029 1554,-961.5029 1554,-905.6999 1892,-905.6999 1892,-961.5029"/>
<text text-anchor="middle" x="1723" y="-914.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">This defines the persistence model for bridge.</text>
</g>
<!-- raw_31&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>raw_31&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2211.759,-2042.3614C2225.325,-1986.39 2257.8633,-1814.1209 2171,-1725.0027 2086.5001,-1638.3091 1990.729,-1770.272 1901,-1689.0027 1687.0333,-1495.2087 1706.5371,-1096.6721 1718.5873,-971.8504"/>
<polygon fill="#000000" stroke="#000000" points="1722.0953,-971.9463 1719.616,-961.6457 1715.1306,-971.2442 1722.0953,-971.9463"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2052,-951.6014 1910,-951.6014 1910,-915.6014 2052,-915.6014 2052,-951.6014"/>
<text text-anchor="middle" x="1981" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** SQLite battery</text>
</g>
<!-- header_33&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>header_33&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2332.3128,-2042.2335C2335.3036,-1985.8882 2336.1868,-1812.6446 2243,-1725.0027 2182.9351,-1668.5118 2116.6304,-1749.8654 2061,-1689.0027 1865.3212,-1474.9191 1946.8104,-1071.1584 1973.6615,-961.6197"/>
<polygon fill="#000000" stroke="#000000" points="1977.1181,-962.224 1976.1499,-951.6736 1970.3274,-960.5251 1977.1181,-962.224"/>
</g>
<!-- raw_37 -->
<g id="node38" class="node">
<title>raw_37</title>
<ellipse fill="none" stroke="#000000" cx="2097" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2097" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_37 -->
<g id="edge37" class="edge">
<title>prose_34&#45;&gt;raw_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2464.4725,-2042.2908C2477.1527,-1986.1133 2506.9889,-1813.3069 2419,-1725.0027 2328.5718,-1634.2504 2220.0084,-1783.0387 2133,-1689.0027 2033.3521,-1581.3063 2080.2615,-1085.8639 2093.7761,-961.8202"/>
<polygon fill="#000000" stroke="#000000" points="2097.2831,-961.9489 2094.9036,-951.6247 2090.3256,-961.1794 2097.2831,-961.9489"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2690,-1688.9039 2142,-1688.9039 2142,-178.2988 2690,-178.2988 2690,-1688.9039"/>
<text text-anchor="middle" x="2416" y="-1673.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 2000</text>
<text text-anchor="middle" x="2416" y="-1642.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_project_table = [[</text>
<text text-anchor="middle" x="2416" y="-1627.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS project (</text>
<text text-anchor="middle" x="2416" y="-1611.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">project_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1596.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">directory TEXT UNIQUE,</text>
<text text-anchor="middle" x="2416" y="-1580.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP );</text>
<text text-anchor="middle" x="2416" y="-1565.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1534.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2416" y="-1518.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS repl (</text>
<text text-anchor="middle" x="2416" y="-1503.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1487.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">project INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1472.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2416" y="-1457.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP,</text>
<text text-anchor="middle" x="2416" y="-1441.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (project)</text>
<text text-anchor="middle" x="2416" y="-1426.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES project (project_id)</text>
<text text-anchor="middle" x="2416" y="-1410.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-1395.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1364.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_result_table = [[</text>
<text text-anchor="middle" x="2416" y="-1348.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS result (</text>
<text text-anchor="middle" x="2416" y="-1333.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">result_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1317.802" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1302.402" font-family="Inconsolata" font-size="14.00" fill="#000000">repr text NOT NULL,</text>
<text text-anchor="middle" x="2416" y="-1287.002" font-family="Inconsolata" font-size="14.00" fill="#000000">value blob,</text>
<text text-anchor="middle" x="2416" y="-1271.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (line_id)</text>
<text text-anchor="middle" x="2416" y="-1256.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES repl (line_id)</text>
<text text-anchor="middle" x="2416" y="-1240.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-1225.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1194.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_session_table = [[</text>
<text text-anchor="middle" x="2416" y="-1178.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS session (</text>
<text text-anchor="middle" x="2416" y="-1163.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">session_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1147.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">name TEXT,</text>
<text text-anchor="middle" x="2416" y="-1132.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">project INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1117.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; These two are line_ids</text>
<text text-anchor="middle" x="2416" y="-1101.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">start INTEGER NOT NULL,</text>
<text text-anchor="middle" x="2416" y="-1086.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">end INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1070.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">test BOOLEAN,</text>
<text text-anchor="middle" x="2416" y="-1055.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">sha TEXT,</text>
<text text-anchor="middle" x="2416" y="-1040.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (project)</text>
<text text-anchor="middle" x="2416" y="-1024.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES project (project_id)</text>
<text text-anchor="middle" x="2416" y="-1009.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-993.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-962.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line = [[</text>
<text text-anchor="middle" x="2416" y="-947.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES (:project, :line);</text>
<text text-anchor="middle" x="2416" y="-931.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-900.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_result = [[</text>
<text text-anchor="middle" x="2416" y="-884.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO result (line_id, repr) VALUES (:line_id, :repr);</text>
<text text-anchor="middle" x="2416" y="-869.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-838.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_project = [[</text>
<text text-anchor="middle" x="2416" y="-822.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO project (directory) VALUES (:dir);</text>
<text text-anchor="middle" x="2416" y="-807.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2416" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2416" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-713.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2416" y="-698.201" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT CAST (line_id AS REAL), line FROM repl</text>
<text text-anchor="middle" x="2416" y="-682.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %d</text>
<text text-anchor="middle" x="2416" y="-667.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2416" y="-652.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2416" y="-636.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-605.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_project = [[</text>
<text text-anchor="middle" x="2416" y="-589.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT project_id FROM project</text>
<text text-anchor="middle" x="2416" y="-574.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE directory = %s;</text>
<text text-anchor="middle" x="2416" y="-559.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-527.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_results = [[</text>
<text text-anchor="middle" x="2416" y="-512.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT result.repr</text>
<text text-anchor="middle" x="2416" y="-496.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">FROM result</text>
<text text-anchor="middle" x="2416" y="-481.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">WHERE result.line_id = :line_id</text>
<text text-anchor="middle" x="2416" y="-466.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">ORDER BY result.result_id;</text>
<text text-anchor="middle" x="2416" y="-450.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-419.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-387.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local bridge_home = io.popen(&quot;echo $BRIDGE_HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-372.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.bridge_home = bridge_home ~= &quot;&quot; and bridge_home</text>
<text text-anchor="middle" x="2416" y="-357.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or home_dir .. &quot;/.bridge&quot;</text>
<text text-anchor="middle" x="2416" y="-325.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-294.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2416" y="-278.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2416" y="-263.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2416" y="-248.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2416" y="-232.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2416" y="-217.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2416" y="-201.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2416" y="-186.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_35&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>codeblock_35&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2590.1481,-2042.2475C2582.6949,-1994.8001 2561.4576,-1859.6009 2536.26,-1699.1904"/>
<polygon fill="#000000" stroke="#000000" points="2539.6817,-1698.4178 2534.6722,-1689.0821 2532.7665,-1699.5042 2539.6817,-1698.4178"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="1954,-125.1 1900,-125.1 1900,-89.1 1954,-89.1 1954,-125.1"/>
</g>
<!-- raw_37&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>raw_37&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2098.7261,-915.5749C2108.2066,-812.6766 2150.3428,-299.9194 2061,-178.2001 2033.5436,-140.7938 2002.2547,-166.9419 1963,-142.2001 1958.5,-139.3638 1954.1025,-135.889 1950.0137,-132.2403"/>
<polygon fill="#000000" stroke="#000000" points="1952.2302,-129.517 1942.5855,-125.1317 1947.3904,-134.5743 1952.2302,-129.517"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="2864,-951.6014 2708,-951.6014 2708,-915.6014 2864,-915.6014 2864,-951.6014"/>
<text text-anchor="middle" x="2786" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:load()</text>
</g>
<!-- header_40&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>header_40&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2776.1611,-2042.2475C2777.3154,-1912.1832 2784.3216,-1122.7229 2785.747,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="2789.2509,-961.6772 2785.8399,-951.6465 2782.2512,-961.6151 2789.2509,-961.6772"/>
</g>
<!-- raw_47 -->
<g id="node48" class="node">
<title>raw_47</title>
<ellipse fill="none" stroke="#000000" cx="2909" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2909" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_41&#45;&gt;raw_47 -->
<g id="edge47" class="edge">
<title>prose_41&#45;&gt;raw_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2909,-2042.2475C2909,-1912.1832 2909,-1122.7229 2909,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="2912.5001,-961.6465 2909,-951.6465 2905.5001,-961.6466 2912.5001,-961.6465"/>
</g>
<!-- raw_49 -->
<g id="node50" class="node">
<title>raw_49</title>
<ellipse fill="none" stroke="#000000" cx="2981" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2981" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_42&#45;&gt;raw_49 -->
<g id="edge49" class="edge">
<title>prose_42&#45;&gt;raw_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2990.8389,-2042.2475C2989.6846,-1912.1832 2982.6784,-1122.7229 2981.253,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="2984.7488,-961.6151 2981.1601,-951.6465 2977.7491,-961.6772 2984.7488,-961.6151"/>
</g>
<!-- hashline_51 -->
<g id="node52" class="node">
<title>hashline_51</title>
<ellipse fill="none" stroke="#000000" cx="3069" cy="-933.6014" rx="43.0992" ry="18"/>
<text text-anchor="middle" x="3069" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashline</text>
</g>
<!-- structure_43&#45;&gt;hashline_51 -->
<g id="edge51" class="edge">
<title>structure_43&#45;&gt;hashline_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3085.7261,-2042.2475C3083.7638,-1912.1832 3071.8533,-1122.7229 3069.4301,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="3072.9228,-961.5926 3069.2722,-951.6465 3065.9236,-961.6982 3072.9228,-961.5926"/>
</g>
<!-- raw_54 -->
<g id="node55" class="node">
<title>raw_54</title>
<ellipse fill="none" stroke="#000000" cx="3157" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="3157" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_44&#45;&gt;raw_54 -->
<g id="edge54" class="edge">
<title>prose_44&#45;&gt;raw_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3180.6133,-2042.2475C3177.843,-1912.1832 3161.0281,-1122.7229 3157.6071,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="3161.0966,-961.5697 3157.3843,-951.6465 3154.0982,-961.7188 3161.0966,-961.5697"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="3757.5,-1345.903 3202.5,-1345.903 3202.5,-521.2997 3757.5,-521.2997 3757.5,-1345.903"/>
<text text-anchor="middle" x="3480" y="-1330.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="3480" y="-1315.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.bridge_home)</text>
<text text-anchor="middle" x="3480" y="-1300.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="3480" y="-1284.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Set up bridge tables</text>
<text text-anchor="middle" x="3480" y="-1269.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn.pragma.foreign_keys(true)</text>
<text text-anchor="middle" x="3480" y="-1253.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_project_table)</text>
<text text-anchor="middle" x="3480" y="-1238.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_result_table)</text>
<text text-anchor="middle" x="3480" y="-1223.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_repl_table)</text>
<text text-anchor="middle" x="3480" y="-1207.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_session_table)</text>
<text text-anchor="middle" x="3480" y="-1192.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Retrive project id</text>
<text text-anchor="middle" x="3480" y="-1176.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local proj_val, proj_row = sql.pexec(conn,</text>
<text text-anchor="middle" x="3480" y="-1161.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.format(get_project, historian.project),</text>
<text text-anchor="middle" x="3480" y="-1146.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-1130.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not proj_val then</text>
<text text-anchor="middle" x="3480" y="-1115.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local ins_proj_stmt = conn:prepare(insert_project)</text>
<text text-anchor="middle" x="3480" y="-1099.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;ins_proj_stmt:bindkv {dir = historian.project}</text>
<text text-anchor="middle" x="3480" y="-1084.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;proj_val, proj_row = ins_proj_stmt:step()</text>
<text text-anchor="middle" x="3480" y="-1069.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; retry</text>
<text text-anchor="middle" x="3480" y="-1053.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;proj_val, proj_row = sql.pexec(conn,</text>
<text text-anchor="middle" x="3480" y="-1038.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.format(get_project, historian.project),</text>
<text text-anchor="middle" x="3480" y="-1022.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-1007.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not proj_val then</text>
<text text-anchor="middle" x="3480" y="-992.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error &quot;Could not create project in .bridge&quot;</text>
<text text-anchor="middle" x="3480" y="-976.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-961.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local project_id = proj_val[1][1]</text>
<text text-anchor="middle" x="3480" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.project_id = project_id</text>
<text text-anchor="middle" x="3480" y="-899.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Create insert prepared statements</text>
<text text-anchor="middle" x="3480" y="-883.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_line = conn:prepare(insert_line)</text>
<text text-anchor="middle" x="3480" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_result = conn:prepare(insert_result)</text>
<text text-anchor="middle" x="3480" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Create result retrieval prepared statement</text>
<text text-anchor="middle" x="3480" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.get_results = conn:prepare(get_results)</text>
<text text-anchor="middle" x="3480" y="-822.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Retrieve history</text>
<text text-anchor="middle" x="3480" y="-806.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_str = sql.format(get_recent, project_id,</text>
<text text-anchor="middle" x="3480" y="-791.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="3480" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local repl_val &#160;= sql.pexec(conn, pop_str, &quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if repl_val then</text>
<text text-anchor="middle" x="3480" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local lines = reverse(repl_val[2])</text>
<text text-anchor="middle" x="3480" y="-729.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local line_ids = reverse(repl_val[1])</text>
<text text-anchor="middle" x="3480" y="-714.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.line_ids = line_ids</text>
<text text-anchor="middle" x="3480" y="-698.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local repl_map = {}</text>
<text text-anchor="middle" x="3480" y="-683.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i, v in ipairs(lines) do</text>
<text text-anchor="middle" x="3480" y="-668.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local buf = Txtbuf(v)</text>
<text text-anchor="middle" x="3480" y="-652.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = buf</text>
<text text-anchor="middle" x="3480" y="-637.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repl_map[line_ids[i]] = buf</text>
<text text-anchor="middle" x="3480" y="-621.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-606.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="3480" y="-591.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="3480" y="-575.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.results = {}</text>
<text text-anchor="middle" x="3480" y="-560.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = 0</text>
<text text-anchor="middle" x="3480" y="-544.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-529.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_45&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_45&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3401.289,-2042.2475C3406.9493,-1962.5216 3430.1999,-1635.0367 3449.9756,-1356.4954"/>
<polygon fill="#000000" stroke="#000000" points="3453.4901,-1356.4146 3450.7072,-1346.1918 3446.5077,-1355.9188 3453.4901,-1356.4146"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="2492,-135.0015 1972,-135.0015 1972,-79.1986 2492,-79.1986 2492,-135.0015"/>
<text text-anchor="middle" x="2232" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Brings up the project history and results, and (eventually) user config.</text>
</g>
<!-- raw_47&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>raw_47&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2911.1445,-915.5329C2923.092,-811.299 2977.2391,-287.6602 2873,-178.2001 2844.3623,-148.1281 2542.2611,-146.8872 2501,-142.2001 2484.1789,-140.2893 2466.7782,-138.223 2449.2921,-136.0827"/>
<polygon fill="#000000" stroke="#000000" points="2449.3432,-132.5627 2438.9905,-134.8146 2448.4879,-139.5102 2449.3432,-132.5627"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="3009.5,-134.4005 2510.5,-134.4005 2510.5,-79.7996 3009.5,-79.7996 3009.5,-134.4005"/>
<text text-anchor="middle" x="2760" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">Most of the complexity serves to make a simple key/value relationship</text>
<text text-anchor="middle" x="2760" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">between the regenerated txtbufs and their associated result history.</text>
</g>
<!-- raw_49&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>raw_49&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2982.698,-915.5954C2992.0222,-812.8109 3033.4349,-300.5806 2945,-178.2001 2934.6841,-163.9245 2903.0334,-149.6961 2868.7612,-137.7602"/>
<polygon fill="#000000" stroke="#000000" points="2869.6352,-134.3606 2859.0408,-134.4563 2867.3825,-140.9883 2869.6352,-134.3606"/>
</g>
<!-- hashtag_52 -->
<g id="node53" class="node">
<title>hashtag_52</title>
<ellipse fill="none" stroke="#000000" cx="3069" cy="-107.1" rx="41.6544" ry="18"/>
<text text-anchor="middle" x="3069" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashtag</text>
</g>
<!-- hashline_51&#45;&gt;hashtag_52 -->
<g id="edge52" class="edge">
<title>hashline_51&#45;&gt;hashtag_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3069,-915.5701C3069,-809.3734 3069,-265.6725 3069,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="3072.5001,-135.2475 3069,-125.2475 3065.5001,-135.2476 3072.5001,-135.2475"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3096,-36 3042,-36 3042,0 3096,0 3096,-36"/>
<text text-anchor="middle" x="3069" y="-14.5" font-family="Inconsolata" font-size="14.00" fill="#000000">todo</text>
</g>
<!-- hashtag_52&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>hashtag_52&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3069,-89.0693C3069,-76.7509 3069,-60.1792 3069,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="3072.5001,-46.0039 3069,-36.0039 3065.5001,-46.0039 3072.5001,-46.0039"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="3333.5,-127.0021 3128.5,-127.0021 3128.5,-87.198 3333.5,-87.198 3333.5,-127.0021"/>
<text text-anchor="middle" x="3231" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">the results never get used.</text>
</g>
<!-- raw_54&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>raw_54&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3154.9992,-915.5806C3146.1608,-830.6978 3114.4241,-462.9719 3193,-178.2001 3197.1041,-163.3263 3204.7204,-148.0776 3212.0628,-135.5352"/>
<polygon fill="#000000" stroke="#000000" points="3215.0945,-137.2861 3217.3068,-126.9248 3209.116,-133.645 3215.0945,-137.2861"/>
</g>
<!-- leaf_61 -->
<g id="node62" class="node">
<title>leaf_61</title>
<polygon fill="none" stroke="#c0c0c0" points="4106.5,-951.6014 3775.5,-951.6014 3775.5,-915.6014 4106.5,-915.6014 4106.5,-951.6014"/>
<text text-anchor="middle" x="3941" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:restore_session(modeS, session)</text>
</g>
<!-- header_57&#45;&gt;leaf_61 -->
<g id="edge61" class="edge">
<title>header_57&#45;&gt;leaf_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3909.5156,-2042.2475C3913.2093,-1912.1832 3935.6291,-1122.7229 3940.1905,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="3943.7022,-961.7419 3940.4875,-951.6465 3936.705,-961.5431 3943.7022,-961.7419"/>
</g>
<!-- raw_62 -->
<g id="node63" class="node">
<title>raw_62</title>
<ellipse fill="none" stroke="#000000" cx="4152" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4152" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_62 -->
<g id="edge62" class="edge">
<title>prose_58&#45;&gt;raw_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4150.0322,-2042.2475C4150.2631,-1912.1832 4151.6643,-1122.7229 4151.9494,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4155.4501,-961.6528 4151.968,-951.6465 4148.4501,-961.6403 4155.4501,-961.6528"/>
</g>
<!-- raw_64 -->
<g id="node65" class="node">
<title>raw_64</title>
<ellipse fill="none" stroke="#000000" cx="4227" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4227" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_59&#45;&gt;raw_64 -->
<g id="edge64" class="edge">
<title>prose_59&#45;&gt;raw_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4231.9194,-2042.2475C4231.3423,-1912.1832 4227.8392,-1122.7229 4227.1265,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4230.6245,-961.6309 4227.0801,-951.6465 4223.6246,-961.662 4230.6245,-961.6309"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="4397,-951.6014 4343,-951.6014 4343,-915.6014 4397,-915.6014 4397,-951.6014"/>
</g>
<!-- codeblock_60&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_60&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4370,-2042.2475C4370,-1912.1832 4370,-1122.7229 4370,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4373.5001,-961.6465 4370,-951.6465 4366.5001,-961.6466 4373.5001,-961.6465"/>
</g>
<!-- leaf_63 -->
<g id="node64" class="node">
<title>leaf_63</title>
<polygon fill="none" stroke="#c0c0c0" points="3718,-135.0015 3352,-135.0015 3352,-79.1986 3718,-79.1986 3718,-135.0015"/>
<text text-anchor="middle" x="3535" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">If there is an open session, we want to replay it.</text>
</g>
<!-- raw_62&#45;&gt;leaf_63 -->
<g id="edge63" class="edge">
<title>raw_62&#45;&gt;leaf_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4154.1251,-915.5248C4165.9603,-811.245 4219.5342,-287.3918 4115,-178.2001 4085.0592,-146.9253 3769.8926,-148.0989 3727,-142.2001 3714.6828,-140.5062 3701.9522,-138.5768 3689.1797,-136.5142"/>
<polygon fill="#000000" stroke="#000000" points="3689.3693,-132.9986 3678.9346,-134.8335 3688.2361,-139.9063 3689.3693,-132.9986"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="4081.5,-127.0021 3736.5,-127.0021 3736.5,-87.198 4081.5,-87.198 4081.5,-127.0021"/>
<text text-anchor="middle" x="3909" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">To do this, we need to borrow the modeselektor.</text>
</g>
<!-- raw_64&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>raw_64&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4232.7912,-915.8934C4261.2137,-825.3068 4377.1355,-409.0378 4188,-178.2001 4176.824,-164.5599 4093.196,-144.3538 4020.386,-128.9649"/>
<polygon fill="#000000" stroke="#000000" points="4020.6983,-125.4543 4010.1927,-126.8266 4019.2611,-132.3052 4020.6983,-125.4543"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="4783.5,-951.6014 4564.5,-951.6014 4564.5,-915.6014 4783.5,-915.6014 4783.5,-951.6014"/>
<text text-anchor="middle" x="4674" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:persist(txtbuf)</text>
</g>
<!-- header_67&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>header_67&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4674,-2042.2475C4674,-1912.1832 4674,-1122.7229 4674,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4677.5001,-961.6465 4674,-951.6465 4670.5001,-961.6466 4677.5001,-961.6465"/>
</g>
<!-- raw_75 -->
<g id="node76" class="node">
<title>raw_75</title>
<ellipse fill="none" stroke="#000000" cx="4834" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4834" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_68&#45;&gt;raw_75 -->
<g id="edge75" class="edge">
<title>prose_68&#45;&gt;raw_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4837.9355,-2042.2475C4837.4738,-1912.1832 4834.6714,-1122.7229 4834.1012,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4837.5996,-961.634 4834.0641,-951.6465 4830.5997,-961.6589 4837.5996,-961.634"/>
</g>
<!-- raw_77 -->
<g id="node78" class="node">
<title>raw_77</title>
<ellipse fill="none" stroke="#000000" cx="4913" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4913" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_69&#45;&gt;raw_77 -->
<g id="edge77" class="edge">
<title>prose_69&#45;&gt;raw_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4919.8872,-2042.2475C4919.0792,-1912.1832 4914.1749,-1122.7229 4913.1771,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4916.6743,-961.6246 4913.1121,-951.6465 4909.6744,-961.6681 4916.6743,-961.6246"/>
</g>
<!-- hashline_79 -->
<g id="node80" class="node">
<title>hashline_79</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-933.6014" rx="43.0992" ry="18"/>
<text text-anchor="middle" x="5015" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashline</text>
</g>
<!-- structure_70&#45;&gt;hashline_79 -->
<g id="edge79" class="edge">
<title>structure_70&#45;&gt;hashline_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-2042.2475C5015,-1912.1832 5015,-1122.7229 5015,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-961.6465 5015,-951.6465 5011.5001,-961.6466 5018.5001,-961.6465"/>
</g>
<!-- raw_82 -->
<g id="node83" class="node">
<title>raw_82</title>
<ellipse fill="none" stroke="#000000" cx="5300" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5300" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_82 -->
<g id="edge82" class="edge">
<title>prose_71&#45;&gt;raw_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5578.7398,-2043.521C5545.3479,-1992.5503 5446.3782,-1834.7565 5401,-1689.0027 5315.7017,-1415.0262 5302.4403,-1063.1252 5300.3792,-961.9493"/>
<polygon fill="#000000" stroke="#000000" points="5303.8731,-961.5798 5300.1914,-951.6453 5296.8743,-961.7074 5303.8731,-961.5798"/>
</g>
<!-- prespace_83 -->
<g id="node84" class="node">
<title>prespace_83</title>
<ellipse fill="none" stroke="#000000" cx="5456" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5456" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_71&#45;&gt;prespace_83 -->
<g id="edge83" class="edge">
<title>prose_71&#45;&gt;prespace_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5585.3245,-2042.3906C5571.6414,-1988.9284 5531.4222,-1826.3258 5512,-1689.0027 5472.1496,-1407.2435 5459.657,-1062.0919 5456.7451,-962.0248"/>
<polygon fill="#000000" stroke="#000000" points="5460.2379,-961.7178 5456.457,-951.8206 5453.2407,-961.9154 5460.2379,-961.7178"/>
</g>
<!-- literal_84 -->
<g id="node85" class="node">
<title>literal_84</title>
<ellipse fill="none" stroke="#000000" cx="5552" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5552" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_71&#45;&gt;literal_84 -->
<g id="edge84" class="edge">
<title>prose_71&#45;&gt;literal_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5589.3877,-2042.2475C5585.0015,-1912.1832 5558.3779,-1122.7229 5552.9613,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="5556.4437,-961.5229 5552.6086,-951.6465 5549.4477,-961.7589 5556.4437,-961.5229"/>
</g>
<!-- raw_85 -->
<g id="node86" class="node">
<title>raw_85</title>
<ellipse fill="none" stroke="#000000" cx="5628" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5628" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_85 -->
<g id="edge85" class="edge">
<title>prose_71&#45;&gt;raw_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5590.6123,-2042.2475C5594.9985,-1912.1832 5621.6221,-1122.7229 5627.0387,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="5630.5523,-961.7589 5627.3914,-951.6465 5623.5563,-961.5229 5630.5523,-961.7589"/>
</g>
<!-- prespace_86 -->
<g id="node87" class="node">
<title>prespace_86</title>
<ellipse fill="none" stroke="#000000" cx="5719" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5719" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_71&#45;&gt;prespace_86 -->
<g id="edge86" class="edge">
<title>prose_71&#45;&gt;prespace_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5594.4209,-2042.3736C5607.3616,-1988.8646 5645.4176,-1826.1463 5664,-1689.0027 5702.2043,-1407.0434 5715.1191,-1062.03 5718.2011,-962.0104"/>
<polygon fill="#000000" stroke="#000000" points="5721.7056,-961.9116 5718.5071,-951.8111 5714.7087,-961.7017 5721.7056,-961.9116"/>
</g>
<!-- literal_87 -->
<g id="node88" class="node">
<title>literal_87</title>
<ellipse fill="none" stroke="#000000" cx="5815" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5815" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_71&#45;&gt;literal_87 -->
<g id="edge87" class="edge">
<title>prose_71&#45;&gt;literal_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5601.7211,-2043.2597C5635.9025,-1992.1884 5735.4839,-1835.4966 5774,-1689.0027 5846.4272,-1413.5296 5825.5653,-1062.6677 5817.4956,-961.8445"/>
<polygon fill="#000000" stroke="#000000" points="5820.9589,-961.2549 5816.6476,-951.5769 5813.9826,-961.8311 5820.9589,-961.2549"/>
</g>
<!-- raw_88 -->
<g id="node89" class="node">
<title>raw_88</title>
<ellipse fill="none" stroke="#000000" cx="5891" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5891" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_88 -->
<g id="edge88" class="edge">
<title>prose_71&#45;&gt;raw_88</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5595.4856,-2042.5981C5613.1189,-1988.0381 5673.3254,-1821.0629 5777,-1725.0027 5805.0068,-1699.0528 5833.6624,-1720.6647 5855,-1689.0027 5936.8199,-1567.593 5903.4036,-1084.4201 5893.4355,-961.9391"/>
<polygon fill="#000000" stroke="#000000" points="5896.9138,-961.532 5892.6008,-951.8548 5889.9377,-962.1095 5896.9138,-961.532"/>
</g>
<!-- raw_96 -->
<g id="node97" class="node">
<title>raw_96</title>
<ellipse fill="none" stroke="#000000" cx="5963" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5963" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_72&#45;&gt;raw_96 -->
<g id="edge96" class="edge">
<title>prose_72&#45;&gt;raw_96</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5824.8835,-2042.5966C5844.9673,-1989.7009 5903.5505,-1828.4989 5927,-1689.0027 5974.1503,-1408.515 5967.2812,-1061.8108 5964.0531,-961.8039"/>
<polygon fill="#000000" stroke="#000000" points="5967.5445,-961.4894 5963.7084,-951.6135 5960.5485,-961.7261 5967.5445,-961.4894"/>
</g>
<!-- leaf_98 -->
<g id="node99" class="node">
<title>leaf_98</title>
<polygon fill="none" stroke="#c0c0c0" points="6528,-1199.8024 6008,-1199.8024 6008,-667.4003 6528,-667.4003 6528,-1199.8024"/>
<text text-anchor="middle" x="6268" y="-1184.5019" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = table.concat</text>
<text text-anchor="middle" x="6268" y="-1169.1019" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, txtbuf, results)</text>
<text text-anchor="middle" x="6268" y="-1153.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(txtbuf)</text>
<text text-anchor="middle" x="6268" y="-1138.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if lb ~= &quot;&quot; then</text>
<text text-anchor="middle" x="6268" y="-1122.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_line:bindkv { project = historian.project_id,</text>
<text text-anchor="middle" x="6268" y="-1107.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;line &#160;&#160;&#160;= lb }</text>
<text text-anchor="middle" x="6268" y="-1092.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local err = historian.insert_line:step()</text>
<text text-anchor="middle" x="6268" y="-1076.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not err then</text>
<text text-anchor="middle" x="6268" y="-1061.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_line:clearbind():reset()</text>
<text text-anchor="middle" x="6268" y="-1045.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6268" y="-1030.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="6268" y="-1015.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6268" y="-999.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local line_id = sql.lastRowId(historian.conn)</text>
<text text-anchor="middle" x="6268" y="-984.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;table.insert(historian.line_ids, line_id)</text>
<text text-anchor="middle" x="6268" y="-968.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if results and type(results) == &quot;table&quot; then</text>
<text text-anchor="middle" x="6268" y="-953.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="6268" y="-938.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; insert result repr</text>
<text text-anchor="middle" x="6268" y="-922.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local res = results[i]</text>
<text text-anchor="middle" x="6268" y="-907.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_result:bindkv { line_id = line_id,</text>
<text text-anchor="middle" x="6268" y="-891.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repr = color.ts(res) }</text>
<text text-anchor="middle" x="6268" y="-876.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;err = historian.insert_result:step()</text>
<text text-anchor="middle" x="6268" y="-861.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if not err then</text>
<text text-anchor="middle" x="6268" y="-845.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_result:clearbind():reset()</text>
<text text-anchor="middle" x="6268" y="-830.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6268" y="-814.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6268" y="-799.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6268" y="-768.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="6268" y="-752.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6268" y="-737.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; A blank line can have no results and is uninteresting.</text>
<text text-anchor="middle" x="6268" y="-721.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="6268" y="-706.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6268" y="-691.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;]]</text>
<text text-anchor="middle" x="6268" y="-675.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_73&#45;&gt;leaf_98 -->
<g id="edge98" class="edge">
<title>codeblock_73&#45;&gt;leaf_98</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6114.5136,-2042.2475C6127.5771,-1947.8883 6188.6888,-1506.4734 6229.7476,-1209.9019"/>
<polygon fill="#000000" stroke="#000000" points="6233.2343,-1210.2388 6231.1388,-1199.8533 6226.3004,-1209.2788 6233.2343,-1210.2388"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="4374.5,-135.0015 4099.5,-135.0015 4099.5,-79.1986 4374.5,-79.1986 4374.5,-135.0015"/>
<text text-anchor="middle" x="4237" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Persists a line and results to store.</text>
</g>
<!-- raw_75&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>raw_75&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4836.003,-915.5082C4847.1341,-811.1353 4897.1755,-286.8468 4792,-178.2001 4760.3465,-145.5019 4428.9195,-149.5044 4384,-142.2001 4374.6777,-140.6842 4365.0706,-138.9007 4355.4432,-136.9547"/>
<polygon fill="#000000" stroke="#000000" points="4355.9169,-133.4785 4345.4142,-134.8724 4354.4938,-140.3323 4355.9169,-133.4785"/>
</g>
<!-- leaf_78 -->
<g id="node79" class="node">
<title>leaf_78</title>
<polygon fill="none" stroke="#c0c0c0" points="4955,-142.3004 4393,-142.3004 4393,-71.8997 4955,-71.8997 4955,-142.3004"/>
<text text-anchor="middle" x="4674" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">The hooks are in place to persist the results. I&#39;m starting with a string</text>
<text text-anchor="middle" x="4674" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">representation; the goal is to provide the sense of persistence across</text>
<text text-anchor="middle" x="4674" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">sessions, and supplement that over time with better and better approximations.</text>
</g>
<!-- raw_77&#45;&gt;leaf_78 -->
<g id="edge78" class="edge">
<title>raw_77&#45;&gt;leaf_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4914.5505,-915.5583C4923.0297,-812.5674 4960.1934,-299.3815 4870,-178.2001 4861.4936,-166.7711 4839.6861,-155.6481 4813.5619,-145.7236"/>
<polygon fill="#000000" stroke="#000000" points="4814.7497,-142.4313 4804.1562,-142.2646 4812.3336,-149.0011 4814.7497,-142.4313"/>
</g>
<!-- hashtag_80 -->
<g id="node81" class="node">
<title>hashtag_80</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-107.1" rx="41.6544" ry="18"/>
<text text-anchor="middle" x="5015" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashtag</text>
</g>
<!-- hashline_79&#45;&gt;hashtag_80 -->
<g id="edge80" class="edge">
<title>hashline_79&#45;&gt;hashtag_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-915.5701C5015,-809.3734 5015,-265.6725 5015,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-135.2475 5015,-125.2475 5011.5001,-135.2476 5018.5001,-135.2475"/>
</g>
<!-- leaf_81 -->
<g id="node82" class="node">
<title>leaf_81</title>
<polygon fill="none" stroke="#c0c0c0" points="5042,-36 4988,-36 4988,0 5042,0 5042,-36"/>
<text text-anchor="middle" x="5015" y="-14.5" font-family="Inconsolata" font-size="14.00" fill="#000000">todo</text>
</g>
<!-- hashtag_80&#45;&gt;leaf_81 -->
<g id="edge81" class="edge">
<title>hashtag_80&#45;&gt;leaf_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-89.0693C5015,-76.7509 5015,-60.1792 5015,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-46.0039 5015,-36.0039 5011.5001,-46.0039 5018.5001,-46.0039"/>
</g>
<!-- leaf_89 -->
<g id="node90" class="node">
<title>leaf_89</title>
<polygon fill="none" stroke="#c0c0c0" points="5461.5,-127.0021 5074.5,-127.0021 5074.5,-87.198 5461.5,-87.198 5461.5,-127.0021"/>
<text text-anchor="middle" x="5268" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">parsing. &#160;General&#45;purpose persistence tools belong in</text>
</g>
<!-- raw_82&#45;&gt;leaf_89 -->
<g id="edge89" class="edge">
<title>raw_82&#45;&gt;leaf_89</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5299.3019,-915.5701C5295.2124,-809.9474 5274.3666,-271.5375 5269.1731,-137.3995"/>
<polygon fill="#000000" stroke="#000000" points="5272.6573,-136.9208 5268.7729,-127.0637 5265.6625,-137.1917 5272.6573,-136.9208"/>
</g>
<!-- leaf_90 -->
<g id="node91" class="node">
<title>leaf_90</title>
<polygon fill="none" stroke="#c0c0c0" points="5534,-125.1 5480,-125.1 5480,-89.1 5534,-89.1 5534,-125.1"/>
<text text-anchor="middle" x="5507" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_83&#45;&gt;leaf_90 -->
<g id="edge90" class="edge">
<title>prespace_83&#45;&gt;leaf_90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5457.1126,-915.5701C5463.6656,-809.3734 5497.2151,-265.6725 5505.2631,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5508.7576,-135.4441 5505.8802,-125.2475 5501.7709,-135.013 5508.7576,-135.4441"/>
</g>
<!-- leaf_91 -->
<g id="node92" class="node">
<title>leaf_91</title>
<polygon fill="none" stroke="#c0c0c0" points="5617.5,-125.1 5552.5,-125.1 5552.5,-89.1 5617.5,-89.1 5617.5,-125.1"/>
<text text-anchor="middle" x="5585" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">sqlayer</text>
</g>
<!-- literal_84&#45;&gt;leaf_91 -->
<g id="edge91" class="edge">
<title>literal_84&#45;&gt;leaf_91</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5552.7199,-915.5701C5556.9601,-809.3734 5578.6686,-265.6725 5583.8761,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5587.3736,-135.3792 5584.2754,-125.2475 5580.3792,-135.0999 5587.3736,-135.3792"/>
</g>
<!-- leaf_92 -->
<g id="node93" class="node">
<title>leaf_92</title>
<polygon fill="none" stroke="#c0c0c0" points="5904,-126.4006 5636,-126.4006 5636,-87.7995 5904,-87.7995 5904,-126.4006"/>
<text text-anchor="middle" x="5770" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">, which will</text>
<text text-anchor="middle" x="5770" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">merge with our increasingly&#45;modified</text>
</g>
<!-- raw_85&#45;&gt;leaf_92 -->
<g id="edge92" class="edge">
<title>raw_85&#45;&gt;leaf_92</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5626.7197,-915.5459C5619.8022,-813.5649 5589.8717,-309.5515 5664,-178.2001 5675.2862,-158.2016 5694.8045,-142.7433 5714.041,-131.4263"/>
<polygon fill="#000000" stroke="#000000" points="5715.806,-134.4495 5722.8289,-126.5166 5712.3919,-128.3385 5715.806,-134.4495"/>
</g>
<!-- leaf_93 -->
<g id="node94" class="node">
<title>leaf_93</title>
<polygon fill="none" stroke="#c0c0c0" points="5976,-125.1 5922,-125.1 5922,-89.1 5976,-89.1 5976,-125.1"/>
<text text-anchor="middle" x="5949" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_86&#45;&gt;leaf_93 -->
<g id="edge93" class="edge">
<title>prespace_86&#45;&gt;leaf_93</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5717.6194,-915.4033C5710.13,-811.55 5678.1759,-294.3731 5775,-178.2001 5815.582,-129.5084 5857.8033,-173.3626 5913,-142.2001 5917.8458,-139.4643 5922.5107,-135.9144 5926.7841,-132.1255"/>
<polygon fill="#000000" stroke="#000000" points="5929.231,-134.6283 5934.0083,-125.1717 5924.3764,-129.5851 5929.231,-134.6283"/>
</g>
<!-- leaf_94 -->
<g id="node95" class="node">
<title>leaf_94</title>
<polygon fill="none" stroke="#c0c0c0" points="6052,-125.1 5994,-125.1 5994,-89.1 6052,-89.1 6052,-125.1"/>
<text text-anchor="middle" x="6023" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">sqlite</text>
</g>
<!-- literal_87&#45;&gt;leaf_94 -->
<g id="edge94" class="edge">
<title>literal_87&#45;&gt;leaf_94</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5813.227,-915.4519C5803.4995,-811.8688 5760.4133,-295.9422 5855,-178.2001 5892.5469,-131.4615 5932.6171,-171.3601 5985,-142.2001 5989.9044,-139.47 5994.679,-135.9808 5999.095,-132.2659"/>
<polygon fill="#000000" stroke="#000000" points="6001.5525,-134.7621 6006.6068,-125.4506 5996.8489,-129.5779 6001.5525,-134.7621"/>
</g>
<!-- leaf_95 -->
<g id="node96" class="node">
<title>leaf_95</title>
<polygon fill="none" stroke="#c0c0c0" points="6156,-125.1 6070,-125.1 6070,-89.1 6156,-89.1 6156,-125.1"/>
<text text-anchor="middle" x="6113" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> bindings.</text>
</g>
<!-- raw_88&#45;&gt;leaf_95 -->
<g id="edge95" class="edge">
<title>raw_88&#45;&gt;leaf_95</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5889.108,-915.4474C5878.7045,-811.8392 5832.2966,-295.7968 5927,-178.2001 5965.679,-130.171 6004.8979,-167.8011 6061,-142.2001 6067.8124,-139.0914 6074.7162,-135.1209 6081.1709,-130.9758"/>
<polygon fill="#000000" stroke="#000000" points="6083.2975,-133.7635 6089.6436,-125.2795 6079.3919,-127.9543 6083.2975,-133.7635"/>
</g>
<!-- leaf_97 -->
<g id="node98" class="node">
<title>leaf_97</title>
<polygon fill="none" stroke="#c0c0c0" points="6708,-134.4005 6174,-134.4005 6174,-79.7996 6708,-79.7996 6708,-134.4005"/>
<text text-anchor="middle" x="6441" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">Medium&#45;term goal is to hash any Lua object in a way that will resolve to a</text>
<text text-anchor="middle" x="6441" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">common value for any identical semantics.</text>
</g>
<!-- raw_96&#45;&gt;leaf_97 -->
<g id="edge97" class="edge">
<title>raw_96&#45;&gt;leaf_97</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5960.9617,-915.6309C5949.6121,-811.9487 5898.2611,-290.8899 5999,-178.2001 6007.2568,-168.9638 6116.959,-151.2874 6224.9936,-135.871"/>
<polygon fill="#000000" stroke="#000000" points="6225.6957,-139.3065 6235.1037,-134.4341 6224.7106,-132.3762 6225.6957,-139.3065"/>
</g>
<!-- leaf_104 -->
<g id="node105" class="node">
<title>leaf_104</title>
<polygon fill="none" stroke="#c0c0c0" points="7210.5,-2078.4033 7019.5,-2078.4033 7019.5,-2042.4033 7210.5,-2042.4033 7210.5,-2078.4033"/>
<text text-anchor="middle" x="7115" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_99&#45;&gt;leaf_104 -->
<g id="edge104" class="edge">
<title>header_99&#45;&gt;leaf_104</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7115,-2494.7903C7115,-2425.2031 7115,-2173.6058 7115,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="7118.5001,-2088.4686 7115,-2078.4686 7111.5001,-2088.4686 7118.5001,-2088.4686"/>
</g>
<!-- raw_105 -->
<g id="node106" class="node">
<title>raw_105</title>
<ellipse fill="none" stroke="#000000" cx="7265" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="7265" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_100&#45;&gt;raw_105 -->
<g id="edge105" class="edge">
<title>prose_100&#45;&gt;raw_105</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7272.6815,-2494.7903C7271.4509,-2425.2031 7267.0018,-2173.6058 7265.4995,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="7268.9958,-2088.4051 7265.3195,-2078.4686 7261.9969,-2088.529 7268.9958,-2088.4051"/>
</g>
<!-- raw_107 -->
<g id="node108" class="node">
<title>raw_107</title>
<ellipse fill="none" stroke="#000000" cx="7355" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="7355" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_101&#45;&gt;raw_107 -->
<g id="edge107" class="edge">
<title>prose_101&#45;&gt;raw_107</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7355,-2494.7903C7355,-2425.2031 7355,-2173.6058 7355,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="7358.5001,-2088.4686 7355,-2078.4686 7351.5001,-2088.4686 7358.5001,-2088.4686"/>
</g>
<!-- header_109 -->
<g id="node110" class="node">
<title>header_109</title>
<ellipse fill="none" stroke="#000000" cx="7793" cy="-2060.4033" rx="58.0685" ry="18"/>
<text text-anchor="middle" x="7793" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : fuzz_patt</text>
</g>
<!-- section_102&#45;&gt;header_109 -->
<g id="edge109" class="edge">
<title>section_102&#45;&gt;header_109</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7935.464,-2494.6144C7927.2492,-2471.6482 7912.796,-2430.895 7901,-2395.804 7862.8324,-2282.2618 7819.8665,-2146.185 7801.773,-2088.4758"/>
<polygon fill="#000000" stroke="#000000" points="7805.0198,-2087.132 7798.6908,-2078.6353 7798.3398,-2089.2243 7805.0198,-2087.132"/>
</g>
<!-- prose_110 -->
<g id="node111" class="node">
<title>prose_110</title>
<ellipse fill="none" stroke="#000000" cx="7942" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7942" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_102&#45;&gt;prose_110 -->
<g id="edge110" class="edge">
<title>section_102&#45;&gt;prose_110</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7942,-2494.7903C7942,-2425.2031 7942,-2173.6058 7942,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="7945.5001,-2088.4686 7942,-2078.4686 7938.5001,-2088.4686 7945.5001,-2088.4686"/>
</g>
<!-- prose_111 -->
<g id="node112" class="node">
<title>prose_111</title>
<ellipse fill="none" stroke="#000000" cx="8329" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="8329" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_102&#45;&gt;prose_111 -->
<g id="edge111" class="edge">
<title>section_102&#45;&gt;prose_111</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7957.1709,-2495.0695C8017.2937,-2424.7862 8238.9153,-2165.7118 8308.1753,-2084.7472"/>
<polygon fill="#000000" stroke="#000000" points="8310.9185,-2086.9247 8314.7594,-2077.0505 8305.5992,-2082.3744 8310.9185,-2086.9247"/>
</g>
<!-- codeblock_112 -->
<g id="node113" class="node">
<title>codeblock_112</title>
<ellipse fill="none" stroke="#000000" cx="8663" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="8663" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 299&#45;313</text>
</g>
<!-- section_102&#45;&gt;codeblock_112 -->
<g id="edge112" class="edge">
<title>section_102&#45;&gt;codeblock_112</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8012.5739,-2506.1512C8101.7673,-2495.0409 8257.24,-2466.4686 8370,-2395.804 8502.6969,-2312.6452 8608.8252,-2151.1285 8647.3641,-2087.2955"/>
<polygon fill="#000000" stroke="#000000" points="8650.4306,-2088.9869 8652.5548,-2078.6072 8644.4214,-2085.3967 8650.4306,-2088.9869"/>
</g>
<!-- header_135 -->
<g id="node136" class="node">
<title>header_135</title>
<ellipse fill="none" stroke="#000000" cx="9239" cy="-2060.4033" rx="100.1229" ry="18"/>
<text text-anchor="middle" x="9239" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : __repr for collection</text>
</g>
<!-- section_103&#45;&gt;header_135 -->
<g id="edge135" class="edge">
<title>section_103&#45;&gt;header_135</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9468.4834,-2494.7903C9431.5336,-2424.8484 9297.4466,-2171.0363 9253.2433,-2087.3643"/>
<polygon fill="#000000" stroke="#000000" points="9256.3097,-2085.6757 9248.5438,-2078.4686 9250.1203,-2088.9455 9256.3097,-2085.6757"/>
</g>
<!-- prose_136 -->
<g id="node137" class="node">
<title>prose_136</title>
<ellipse fill="none" stroke="#000000" cx="9478" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="9478" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_103&#45;&gt;prose_136 -->
<g id="edge136" class="edge">
<title>section_103&#45;&gt;prose_136</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9478,-2494.7903C9478,-2425.2031 9478,-2173.6058 9478,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="9481.5001,-2088.4686 9478,-2078.4686 9474.5001,-2088.4686 9481.5001,-2088.4686"/>
</g>
<!-- prose_137 -->
<g id="node138" class="node">
<title>prose_137</title>
<ellipse fill="none" stroke="#000000" cx="9615" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="9615" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_103&#45;&gt;prose_137 -->
<g id="edge137" class="edge">
<title>section_103&#45;&gt;prose_137</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9484.722,-2494.6752C9493.1289,-2471.7718 9507.7801,-2431.0834 9519,-2395.804 9555.0302,-2282.5114 9592.2456,-2145.7745 9607.6474,-2088.1463"/>
<polygon fill="#000000" stroke="#000000" points="9611.0703,-2088.8941 9610.2642,-2078.33 9604.3065,-2087.091 9611.0703,-2088.8941"/>
</g>
<!-- codeblock_138 -->
<g id="node139" class="node">
<title>codeblock_138</title>
<ellipse fill="none" stroke="#000000" cx="9873" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="9873" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 325&#45;379</text>
</g>
<!-- section_103&#45;&gt;codeblock_138 -->
<g id="edge138" class="edge">
<title>section_103&#45;&gt;codeblock_138</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9511.1226,-2496.4628C9549.2488,-2476.5034 9612.2283,-2439.8936 9656,-2395.804 9753.432,-2297.6641 9830.7357,-2148.9226 9860.156,-2087.9477"/>
<polygon fill="#000000" stroke="#000000" points="9863.4671,-2089.1361 9864.6195,-2078.6042 9857.1507,-2086.1188 9863.4671,-2089.1361"/>
</g>
<!-- leaf_106 -->
<g id="node107" class="node">
<title>leaf_106</title>
<polygon fill="none" stroke="#c0c0c0" points="7059.5,-968.9017 6546.5,-968.9017 6546.5,-898.301 7059.5,-898.301 7059.5,-968.9017"/>
<text text-anchor="middle" x="6803" y="-921.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">This is a &#39;fuzzy search&#39;, that attempts to find a string containing the</text>
<text text-anchor="middle" x="6803" y="-906.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">letters of the fragment in order.</text>
</g>
<!-- raw_105&#45;&gt;leaf_106 -->
<g id="edge106" class="edge">
<title>raw_105&#45;&gt;leaf_106</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7268.808,-2042.2654C7279.3173,-1986.7475 7302.6973,-1817.3083 7219,-1725.0027 7172.6567,-1673.8929 7119.2395,-1735.2024 7068,-1689.0027 6851.4261,-1493.7303 6811.8479,-1111.1111 6804.6163,-979.4178"/>
<polygon fill="#000000" stroke="#000000" points="6808.1041,-979.0872 6804.0971,-969.2793 6801.1133,-979.4453 6808.1041,-979.0872"/>
</g>
<!-- leaf_108 -->
<g id="node109" class="node">
<title>leaf_108</title>
<polygon fill="none" stroke="#c0c0c0" points="7632.5,-976.8017 7077.5,-976.8017 7077.5,-890.401 7632.5,-890.401 7632.5,-976.8017"/>
<text text-anchor="middle" x="7355" y="-945.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">If it finds nothing, it switches the last two letters and tries again. This</text>
<text text-anchor="middle" x="7355" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">is an affordance for incremental searches, it&#39;s easy to make this mistake and</text>
<text text-anchor="middle" x="7355" y="-914.7014" font-family="Inconsolata" font-size="14.00" fill="#000000">harmless to suggest the alternative.</text>
</g>
<!-- raw_107&#45;&gt;leaf_108 -->
<g id="edge108" class="edge">
<title>raw_107&#45;&gt;leaf_108</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7355,-2042.2475C7355,-1917.9459 7355,-1191.3846 7355,-987.0468"/>
<polygon fill="#000000" stroke="#000000" points="7358.5001,-986.8678 7355,-976.8678 7351.5001,-986.8679 7358.5001,-986.8678"/>
</g>
<!-- leaf_113 -->
<g id="node114" class="node">
<title>leaf_113</title>
<polygon fill="none" stroke="#c0c0c0" points="7757.5,-951.6014 7650.5,-951.6014 7650.5,-915.6014 7757.5,-915.6014 7757.5,-951.6014"/>
<text text-anchor="middle" x="7704" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** fuzz_patt</text>
</g>
<!-- header_109&#45;&gt;leaf_113 -->
<g id="edge113" class="edge">
<title>header_109&#45;&gt;leaf_113</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7791.566,-2042.2475C7781.2826,-1912.0532 7718.8129,-1121.1433 7706.2136,-961.6265"/>
<polygon fill="#000000" stroke="#000000" points="7709.7019,-961.3399 7705.4253,-951.6465 7702.7236,-961.8911 7709.7019,-961.3399"/>
</g>
<!-- raw_114 -->
<g id="node115" class="node">
<title>raw_114</title>
<ellipse fill="none" stroke="#000000" cx="7803" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="7803" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_110&#45;&gt;raw_114 -->
<g id="edge114" class="edge">
<title>prose_110&#45;&gt;raw_114</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7939.4683,-2042.3851C7931.8855,-1991.2072 7906.9268,-1841.1656 7860,-1725.0027 7853.0618,-1707.8279 7844.2586,-1706.7638 7839,-1689.0027 7758.0837,-1415.7016 7788.5144,-1062.7018 7799.6342,-961.7086"/>
<polygon fill="#000000" stroke="#000000" points="7803.1214,-962.0185 7800.7665,-951.6887 7796.1657,-961.2324 7803.1214,-962.0185"/>
</g>
<!-- prespace_115 -->
<g id="node116" class="node">
<title>prespace_115</title>
<ellipse fill="none" stroke="#000000" cx="7894" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="7894" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_110&#45;&gt;prespace_115 -->
<g id="edge115" class="edge">
<title>prose_110&#45;&gt;prespace_115</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7941.2266,-2042.2475C7935.6861,-1912.1832 7902.0563,-1122.7229 7895.2143,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="7898.6912,-961.4885 7894.7687,-951.6465 7891.6976,-961.7865 7898.6912,-961.4885"/>
</g>
<!-- literal_116 -->
<g id="node117" class="node">
<title>literal_116</title>
<ellipse fill="none" stroke="#000000" cx="7990" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="7990" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_110&#45;&gt;literal_116 -->
<g id="edge116" class="edge">
<title>prose_110&#45;&gt;literal_116</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7942.7734,-2042.2475C7948.3139,-1912.1832 7981.9437,-1122.7229 7988.7857,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="7992.3024,-961.7865 7989.2313,-951.6465 7985.3088,-961.4885 7992.3024,-961.7865"/>
</g>
<!-- raw_117 -->
<g id="node118" class="node">
<title>raw_117</title>
<ellipse fill="none" stroke="#000000" cx="8066" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8066" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_110&#45;&gt;raw_117 -->
<g id="edge117" class="edge">
<title>prose_110&#45;&gt;raw_117</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7947.5051,-2042.4661C7963.5757,-1989.2115 8010.5168,-1827.1221 8030,-1689.0027 8069.6833,-1407.6811 8068.0018,-1062.2274 8066.5313,-962.0563"/>
<polygon fill="#000000" stroke="#000000" points="8070.0275,-961.7843 8066.369,-951.8412 8063.0284,-961.8956 8070.0275,-961.7843"/>
</g>
<!-- prespace_122 -->
<g id="node123" class="node">
<title>prespace_122</title>
<ellipse fill="none" stroke="#000000" cx="8157" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="8157" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_111&#45;&gt;prespace_122 -->
<g id="edge122" class="edge">
<title>prose_111&#45;&gt;prespace_122</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8321.8328,-2042.614C8300.8948,-1989.7662 8239.6264,-1828.6826 8213,-1689.0027 8159.6555,-1409.1615 8156.4923,-1062.0096 8156.781,-961.8498"/>
<polygon fill="#000000" stroke="#000000" points="8160.2818,-961.6587 8156.8256,-951.6435 8153.2819,-961.6281 8160.2818,-961.6587"/>
</g>
<!-- literal_123 -->
<g id="node124" class="node">
<title>literal_123</title>
<ellipse fill="none" stroke="#000000" cx="8253" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="8253" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_111&#45;&gt;literal_123 -->
<g id="edge123" class="edge">
<title>prose_111&#45;&gt;literal_123</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8326.9579,-2042.2637C8320.9611,-1988.4524 8303.1859,-1824.9867 8293,-1689.0027 8271.7728,-1405.6144 8257.8519,-1061.5878 8254.052,-961.9078"/>
<polygon fill="#000000" stroke="#000000" points="8257.5431,-961.6043 8253.6675,-951.7438 8250.5481,-961.869 8257.5431,-961.6043"/>
</g>
<!-- raw_124 -->
<g id="node125" class="node">
<title>raw_124</title>
<ellipse fill="none" stroke="#000000" cx="8329" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8329" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_111&#45;&gt;raw_124 -->
<g id="edge124" class="edge">
<title>prose_111&#45;&gt;raw_124</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8329,-2042.2475C8329,-1912.1832 8329,-1122.7229 8329,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="8332.5001,-961.6465 8329,-951.6465 8325.5001,-961.6466 8332.5001,-961.6465"/>
</g>
<!-- prespace_125 -->
<g id="node126" class="node">
<title>prespace_125</title>
<ellipse fill="none" stroke="#000000" cx="8420" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="8420" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_111&#45;&gt;prespace_125 -->
<g id="edge125" class="edge">
<title>prose_111&#45;&gt;prespace_125</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8330.9147,-2042.2535C8336.561,-1988.4143 8353.4699,-1824.8793 8365,-1689.0027 8389.0585,-1405.4858 8411.7415,-1061.548 8418.1851,-961.8986"/>
<polygon fill="#000000" stroke="#000000" points="8421.6894,-961.9423 8418.8405,-951.7377 8414.7039,-961.4917 8421.6894,-961.9423"/>
</g>
<!-- literal_126 -->
<g id="node127" class="node">
<title>literal_126</title>
<ellipse fill="none" stroke="#000000" cx="8516" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="8516" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_111&#45;&gt;literal_126 -->
<g id="edge126" class="edge">
<title>prose_111&#45;&gt;literal_126</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8338.2564,-2042.8813C8365.2572,-1990.769 8443.973,-1831.5036 8475,-1689.0027 8535.5307,-1410.9973 8522.9771,-1062.5743 8517.6841,-961.9801"/>
<polygon fill="#000000" stroke="#000000" points="8521.1644,-961.5226 8517.1237,-951.7286 8514.1749,-961.9048 8521.1644,-961.5226"/>
</g>
<!-- raw_127 -->
<g id="node128" class="node">
<title>raw_127</title>
<ellipse fill="none" stroke="#000000" cx="8592" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8592" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_111&#45;&gt;raw_127 -->
<g id="edge127" class="edge">
<title>prose_111&#45;&gt;raw_127</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8343.235,-2044.1387C8385.3255,-1994.8931 8509.1659,-1841.4205 8556,-1689.0027 8639.7187,-1416.547 8607.3375,-1062.9588 8595.56,-961.7672"/>
<polygon fill="#000000" stroke="#000000" points="8599.0222,-961.2418 8594.3612,-951.7272 8592.0716,-962.0717 8599.0222,-961.2418"/>
</g>
<!-- leaf_134 -->
<g id="node135" class="node">
<title>leaf_134</title>
<polygon fill="none" stroke="#c0c0c0" points="9080.5,-1030.5021 8637.5,-1030.5021 8637.5,-836.7006 9080.5,-836.7006 9080.5,-1030.5021"/>
<text text-anchor="middle" x="8859" y="-1015.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, match = L.P, L.match</text>
<text text-anchor="middle" x="8859" y="-983.7015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function fuzz_patt(frag)</text>
<text text-anchor="middle" x="8859" y="-968.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;frag = type(frag) == &quot;string&quot; and codepoints(frag) or frag</text>
<text text-anchor="middle" x="8859" y="-952.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = &#160;(P(1) &#45; P(frag[1]))^0</text>
<text text-anchor="middle" x="8859" y="-937.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1 , #frag &#45; 1 do</text>
<text text-anchor="middle" x="8859" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local v = frag[i]</text>
<text text-anchor="middle" x="8859" y="-906.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = patt * (P(v) * (P(1) &#45; P(frag[i + 1]))^0)</text>
<text text-anchor="middle" x="8859" y="-891.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="8859" y="-875.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;patt = patt * P(frag[#frag])</text>
<text text-anchor="middle" x="8859" y="-860.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return patt</text>
<text text-anchor="middle" x="8859" y="-845.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_112&#45;&gt;leaf_134 -->
<g id="edge134" class="edge">
<title>codeblock_112&#45;&gt;leaf_134</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8666.1581,-2042.2475C8686.177,-1927.159 8796.0013,-1295.78 8840.3828,-1040.6315"/>
<polygon fill="#000000" stroke="#000000" points="8843.8606,-1041.0608 8842.1262,-1030.6089 8836.9641,-1039.8612 8843.8606,-1041.0608"/>
</g>
<!-- leaf_118 -->
<g id="node119" class="node">
<title>leaf_118</title>
<polygon fill="none" stroke="#c0c0c0" points="7539.5,-135.0015 7250.5,-135.0015 7250.5,-79.1986 7539.5,-79.1986 7539.5,-135.0015"/>
<text text-anchor="middle" x="7395" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Here we incrementally build up a single</text>
</g>
<!-- raw_114&#45;&gt;leaf_118 -->
<g id="edge118" class="edge">
<title>raw_114&#45;&gt;leaf_118</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7805.004,-915.6366C7816.1574,-811.9864 7866.543,-291.0776 7766,-178.2001 7733.4876,-141.6991 7596.962,-151.6356 7549,-142.2001 7540.594,-140.5464 7531.946,-138.7735 7523.2405,-136.9353"/>
<polygon fill="#000000" stroke="#000000" points="7523.9071,-133.4988 7513.3969,-134.8349 7522.4463,-140.3447 7523.9071,-133.4988"/>
</g>
<!-- leaf_119 -->
<g id="node120" class="node">
<title>leaf_119</title>
<polygon fill="none" stroke="#c0c0c0" points="7612,-125.1 7558,-125.1 7558,-89.1 7612,-89.1 7612,-125.1"/>
<text text-anchor="middle" x="7585" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_115&#45;&gt;leaf_119 -->
<g id="edge119" class="edge">
<title>prespace_115&#45;&gt;leaf_119</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7895.5405,-915.6039C7904.0245,-811.7697 7941.0645,-290 7839,-178.2001 7772.7908,-105.6756 7708.6329,-186.5164 7621,-142.2001 7615.9367,-139.6396 7611.1238,-136.1165 7606.7605,-132.2847"/>
<polygon fill="#000000" stroke="#000000" points="7609.0551,-129.6347 7599.4352,-125.1953 7604.187,-134.6648 7609.0551,-129.6347"/>
</g>
<!-- leaf_120 -->
<g id="node121" class="node">
<title>leaf_120</title>
<polygon fill="none" stroke="#c0c0c0" points="7684,-125.1 7630,-125.1 7630,-89.1 7684,-89.1 7684,-125.1"/>
<text text-anchor="middle" x="7657" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_116&#45;&gt;leaf_120 -->
<g id="edge120" class="edge">
<title>literal_116&#45;&gt;leaf_120</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7991.9426,-915.5914C8002.7368,-811.6869 8051.2512,-289.5885 7949,-178.2001 7871.3012,-93.5581 7796.1458,-192.8195 7693,-142.2001 7687.9064,-139.7004 7683.0786,-136.2072 7678.7099,-132.3862"/>
<polygon fill="#000000" stroke="#000000" points="7681.0044,-129.7362 7671.3839,-125.2982 7676.137,-134.767 7681.0044,-129.7362"/>
</g>
<!-- leaf_121 -->
<g id="node122" class="node">
<title>leaf_121</title>
<polygon fill="none" stroke="#c0c0c0" points="7921.5,-126.4006 7702.5,-126.4006 7702.5,-87.7995 7921.5,-87.7995 7921.5,-126.4006"/>
<text text-anchor="middle" x="7812" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> pattern which will recognize</text>
<text text-anchor="middle" x="7812" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">our desired lines.</text>
</g>
<!-- raw_117&#45;&gt;leaf_121 -->
<g id="edge121" class="edge">
<title>raw_117&#45;&gt;leaf_121</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8067.7949,-915.5235C8077.6581,-812.3388 8121.5657,-298.2561 8030,-178.2001 8025.381,-172.1439 7948.3547,-147.9128 7887.1564,-129.4052"/>
<polygon fill="#000000" stroke="#000000" points="7888.0686,-126.0246 7877.4838,-126.4876 7886.047,-132.7264 7888.0686,-126.0246"/>
</g>
<!-- leaf_128 -->
<g id="node129" class="node">
<title>leaf_128</title>
<polygon fill="none" stroke="#c0c0c0" points="7994,-125.1 7940,-125.1 7940,-89.1 7994,-89.1 7994,-125.1"/>
</g>
<!-- prespace_122&#45;&gt;leaf_128 -->
<g id="edge128" class="edge">
<title>prespace_122&#45;&gt;leaf_128</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8162.0524,-915.5848C8186.24,-825.1917 8281.814,-416.0379 8102,-178.2001 8073.7647,-140.8535 8042.6487,-167.0996 8003,-142.2001 7998.4954,-139.3712 7994.0954,-135.9002 7990.0056,-132.2531"/>
<polygon fill="#000000" stroke="#000000" points="7992.222,-129.5297 7982.577,-125.1452 7987.3826,-134.5875 7992.222,-129.5297"/>
</g>
<!-- leaf_129 -->
<g id="node130" class="node">
<title>leaf_129</title>
<polygon fill="none" stroke="#c0c0c0" points="8175.5,-125.1 8012.5,-125.1 8012.5,-89.1 8175.5,-89.1 8175.5,-125.1"/>
<text text-anchor="middle" x="8094" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">(P(1) &#45; P(frag[n]))^0</text>
</g>
<!-- literal_123&#45;&gt;leaf_129 -->
<g id="edge129" class="edge">
<title>literal_123&#45;&gt;leaf_129</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8254.2475,-915.4813C8260.9672,-813.1445 8289.7474,-307.5015 8212,-178.2001 8199.0589,-156.6777 8176.8826,-140.8494 8155.2239,-129.6649"/>
<polygon fill="#000000" stroke="#000000" points="8156.5225,-126.4038 8146.0018,-125.1528 8153.4461,-132.6916 8156.5225,-126.4038"/>
</g>
<!-- leaf_130 -->
<g id="node131" class="node">
<title>leaf_130</title>
<polygon fill="none" stroke="#c0c0c0" points="8538.5,-126.4006 8193.5,-126.4006 8193.5,-87.7995 8538.5,-87.7995 8538.5,-126.4006"/>
<text text-anchor="middle" x="8366" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> matches anything that isn&#39;t the next fragment,</text>
<text text-anchor="middle" x="8366" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">including</text>
</g>
<!-- raw_124&#45;&gt;leaf_130 -->
<g id="edge130" class="edge">
<title>raw_124&#45;&gt;leaf_130</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8329.8072,-915.5701C8334.5408,-809.8326 8358.691,-270.3666 8364.6631,-136.9635"/>
<polygon fill="#000000" stroke="#000000" points="8368.172,-136.8406 8365.1228,-126.694 8361.179,-136.5275 8368.172,-136.8406"/>
</g>
<!-- leaf_131 -->
<g id="node132" class="node">
<title>leaf_131</title>
<polygon fill="none" stroke="#c0c0c0" points="8611,-125.1 8557,-125.1 8557,-89.1 8611,-89.1 8611,-125.1"/>
<text text-anchor="middle" x="8584" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_125&#45;&gt;leaf_131 -->
<g id="edge131" class="edge">
<title>prespace_125&#45;&gt;leaf_131</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8415.4088,-915.399C8393.9139,-825.7792 8311.0179,-425.8012 8476,-178.2001 8495.6183,-148.7574 8518.0853,-162.5886 8547,-142.2001 8551.2332,-139.2152 8555.4637,-135.7616 8559.4719,-132.2093"/>
<polygon fill="#000000" stroke="#000000" points="8561.9057,-134.7256 8566.8477,-125.354 8557.1401,-129.5982 8561.9057,-134.7256"/>
</g>
<!-- leaf_132 -->
<g id="node133" class="node">
<title>leaf_132</title>
<polygon fill="none" stroke="#c0c0c0" points="8683,-125.1 8629,-125.1 8629,-89.1 8683,-89.1 8683,-125.1"/>
<text text-anchor="middle" x="8656" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">&quot;&quot;</text>
</g>
<!-- literal_126&#45;&gt;leaf_132 -->
<g id="edge132" class="edge">
<title>literal_126&#45;&gt;leaf_132</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8514.6652,-915.4455C8507.4622,-812.9121 8476.4187,-306.3683 8556,-178.2001 8573.2153,-150.4743 8593.8732,-161.7571 8620,-142.2001 8623.9832,-139.2185 8627.9774,-135.8245 8631.7802,-132.3496"/>
<polygon fill="#000000" stroke="#000000" points="8634.4405,-134.6486 8639.2523,-125.2095 8629.6044,-129.5877 8634.4405,-134.6486"/>
</g>
<!-- leaf_133 -->
<g id="node134" class="node">
<title>leaf_133</title>
<polygon fill="none" stroke="#c0c0c0" points="9137,-126.4006 8701,-126.4006 8701,-87.7995 9137,-87.7995 9137,-126.4006"/>
<text text-anchor="middle" x="8919" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">. &#160;We then require this to be followed by the next fragment,</text>
<text text-anchor="middle" x="8919" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">and so on.</text>
</g>
<!-- raw_127&#45;&gt;leaf_133 -->
<g id="edge133" class="edge">
<title>raw_127&#45;&gt;leaf_133</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8590.0667,-915.4137C8579.4332,-811.6182 8531.9607,-294.7084 8628,-178.2001 8646.2935,-156.0077 8703.097,-139.7199 8761.7204,-128.3771"/>
<polygon fill="#000000" stroke="#000000" points="8762.7269,-131.7491 8771.9059,-126.458 8761.4307,-124.8702 8762.7269,-131.7491"/>
</g>
<!-- leaf_139 -->
<g id="node140" class="node">
<title>leaf_139</title>
<polygon fill="none" stroke="#c0c0c0" points="9289.5,-951.6014 9098.5,-951.6014 9098.5,-915.6014 9289.5,-915.6014 9289.5,-951.6014"/>
<text text-anchor="middle" x="9194" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** __repr for collection</text>
</g>
<!-- header_135&#45;&gt;leaf_139 -->
<g id="edge139" class="edge">
<title>header_135&#45;&gt;leaf_139</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9238.2749,-2042.2475C9233.0807,-1912.1832 9201.5528,-1122.7229 9195.1384,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="9198.617,-961.4989 9194.7207,-951.6465 9191.6226,-961.7783 9198.617,-961.4989"/>
</g>
<!-- raw_140 -->
<g id="node141" class="node">
<title>raw_140</title>
<ellipse fill="none" stroke="#000000" cx="9335" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9335" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_136&#45;&gt;raw_140 -->
<g id="edge140" class="edge">
<title>prose_136&#45;&gt;raw_140</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9471.2476,-2042.583C9451.5455,-1989.6499 9394.0698,-1828.3554 9371,-1689.0027 9324.5461,-1408.3989 9330.9331,-1061.775 9333.9963,-961.7957"/>
<polygon fill="#000000" stroke="#000000" points="9337.5006,-961.7154 9334.3239,-951.6081 9330.5042,-961.4904 9337.5006,-961.7154"/>
</g>
<!-- prespace_141 -->
<g id="node142" class="node">
<title>prespace_141</title>
<ellipse fill="none" stroke="#000000" cx="9426" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="9426" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_136&#45;&gt;prespace_141 -->
<g id="edge141" class="edge">
<title>prose_136&#45;&gt;prespace_141</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9477.1621,-2042.2475C9471.1599,-1912.1832 9434.7276,-1122.7229 9427.3155,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="9430.7901,-961.4745 9426.8328,-951.6465 9423.7976,-961.7973 9430.7901,-961.4745"/>
</g>
<!-- literal_142 -->
<g id="node143" class="node">
<title>literal_142</title>
<ellipse fill="none" stroke="#000000" cx="9522" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="9522" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_136&#45;&gt;literal_142 -->
<g id="edge142" class="edge">
<title>prose_136&#45;&gt;literal_142</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9478.709,-2042.2475C9483.7878,-1912.1832 9514.6151,-1122.7229 9520.8869,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="9524.4024,-961.7755 9521.2954,-951.6465 9517.4077,-961.5023 9524.4024,-961.7755"/>
</g>
<!-- raw_143 -->
<g id="node144" class="node">
<title>raw_143</title>
<ellipse fill="none" stroke="#000000" cx="9598" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9598" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_136&#45;&gt;raw_143 -->
<g id="edge143" class="edge">
<title>prose_136&#45;&gt;raw_143</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9483.2421,-2042.4444C9498.547,-1989.1301 9543.2674,-1826.8931 9562,-1689.0027 9600.2449,-1407.4819 9599.5567,-1062.1657 9598.428,-962.0419"/>
<polygon fill="#000000" stroke="#000000" points="9601.9252,-961.7876 9598.3012,-951.8318 9594.9257,-961.8745 9601.9252,-961.7876"/>
</g>
<!-- raw_148 -->
<g id="node149" class="node">
<title>raw_148</title>
<ellipse fill="none" stroke="#000000" cx="9670" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9670" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_137&#45;&gt;raw_148 -->
<g id="edge148" class="edge">
<title>prose_137&#45;&gt;raw_148</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9615.9517,-2042.2407C9618.7697,-1988.366 9627.2934,-1824.7435 9634,-1689.0027 9648.0198,-1405.2421 9664.0598,-1061.4726 9668.688,-961.8811"/>
<polygon fill="#000000" stroke="#000000" points="9672.1918,-961.8779 9669.1596,-951.7263 9665.1993,-961.5531 9672.1918,-961.8779"/>
</g>
<!-- leaf_150 -->
<g id="node151" class="node">
<title>leaf_150</title>
<polygon fill="none" stroke="#c0c0c0" points="10270.5,-1347.3029 9715.5,-1347.3029 9715.5,-519.8999 10270.5,-519.8999 10270.5,-1347.3029"/>
<text text-anchor="middle" x="9993" y="-1332.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat, litpat = assert(table.concat), assert(string.litpat)</text>
<text text-anchor="middle" x="9993" y="-1316.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = assert(string.gsub)</text>
<text text-anchor="middle" x="9993" y="-1285.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _highlight(line, frag, c, best)</text>
<text text-anchor="middle" x="9993" y="-1269.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local hl = {}</text>
<text text-anchor="middle" x="9993" y="-1254.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local og_line = line &#45;&#45; debugging</text>
<text text-anchor="middle" x="9993" y="-1239.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;while #frag &gt; 0 do</text>
<text text-anchor="middle" x="9993" y="-1223.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local char</text>
<text text-anchor="middle" x="9993" y="-1208.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;char, frag = frag:sub(1,1), frag:sub(2)</text>
<text text-anchor="middle" x="9993" y="-1192.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local at = line:find(litpat(char))</text>
<text text-anchor="middle" x="9993" y="-1177.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not at then</text>
<text text-anchor="middle" x="9993" y="-1162.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error (&quot;can&#39;t find &quot; .. char .. &quot; in: &quot; .. line)</text>
<text text-anchor="middle" x="9993" y="-1146.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-1131.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local color</text>
<text text-anchor="middle" x="9993" y="-1115.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; highlight the last two differently if this is a &#39;second best&#39;</text>
<text text-anchor="middle" x="9993" y="-1100.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; search</text>
<text text-anchor="middle" x="9993" y="-1085.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not best and #frag &lt;= 1 then</text>
<text text-anchor="middle" x="9993" y="-1069.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;color = c.alert</text>
<text text-anchor="middle" x="9993" y="-1054.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="9993" y="-1038.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;color = c.search_hl</text>
<text text-anchor="middle" x="9993" y="-1023.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-1008.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;hl[#hl + 1] = c.base(line:sub(1, at &#45;1))</text>
<text text-anchor="middle" x="9993" y="-992.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;hl[#hl + 1] = color(char)</text>
<text text-anchor="middle" x="9993" y="-977.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;line = line:sub(at + 1)</text>
<text text-anchor="middle" x="9993" y="-961.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-946.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;hl[#hl + 1] = c.base(line)</text>
<text text-anchor="middle" x="9993" y="-931.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return concat(hl):gsub(&quot;\n&quot;, c.stresc(&quot;\\n&quot;))</text>
<text text-anchor="middle" x="9993" y="-915.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="9993" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _collect_repr(collection, c)</text>
<text text-anchor="middle" x="9993" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="9993" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return c.alert &quot;No results found&quot;</text>
<text text-anchor="middle" x="9993" y="-822.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-806.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="9993" y="-791.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i,v in ipairs(collection) do</text>
<text text-anchor="middle" x="9993" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local alt_seq = &quot; &#160;&#160;&#160;&quot;</text>
<text text-anchor="middle" x="9993" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if i &lt; 10 then</text>
<text text-anchor="middle" x="9993" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;alt_seq = a.bold(&quot;M&#45;&quot; .. tostring(i) .. &quot; &quot;)</text>
<text text-anchor="middle" x="9993" y="-729.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-714.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local next_line = alt_seq</text>
<text text-anchor="middle" x="9993" y="-698.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. _highlight(v, collection.frag, c, collection.best)</text>
<text text-anchor="middle" x="9993" y="-683.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;\n&quot;</text>
<text text-anchor="middle" x="9993" y="-668.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if i == collection.hl then</text>
<text text-anchor="middle" x="9993" y="-652.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;next_line = c.highlight(next_line)</text>
<text text-anchor="middle" x="9993" y="-637.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-621.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase .. next_line</text>
<text text-anchor="middle" x="9993" y="-606.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9993" y="-575.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="9993" y="-559.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="9993" y="-528.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local collect_M = {__repr = _collect_repr}</text>
</g>
<!-- codeblock_138&#45;&gt;leaf_150 -->
<g id="edge150" class="edge">
<title>codeblock_138&#45;&gt;leaf_150</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9874.9335,-2042.2475C9883.4129,-1962.6265 9918.2082,-1635.8976 9947.8464,-1357.5946"/>
<polygon fill="#000000" stroke="#000000" points="9951.364,-1357.6141 9948.9427,-1347.2997 9944.4034,-1356.8728 9951.364,-1357.6141"/>
</g>
<!-- leaf_144 -->
<g id="node145" class="node">
<title>leaf_144</title>
<polygon fill="none" stroke="#c0c0c0" points="9402.5,-135.0015 9155.5,-135.0015 9155.5,-79.1986 9402.5,-79.1986 9402.5,-135.0015"/>
<text text-anchor="middle" x="9279" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">We use a pseudo&#45;metamethod called</text>
</g>
<!-- raw_140&#45;&gt;leaf_144 -->
<g id="edge144" class="edge">
<title>raw_140&#45;&gt;leaf_144</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9335.5247,-915.3331C9337.6563,-830.8115 9343.5176,-469.4405 9298,-178.2001 9296.2806,-167.1988 9293.53,-155.448 9290.6495,-144.733"/>
<polygon fill="#000000" stroke="#000000" points="9293.9448,-143.5209 9287.8774,-134.8355 9287.2042,-145.4089 9293.9448,-143.5209"/>
</g>
<!-- leaf_145 -->
<g id="node146" class="node">
<title>leaf_145</title>
<polygon fill="none" stroke="#c0c0c0" points="9475,-125.1 9421,-125.1 9421,-89.1 9475,-89.1 9475,-125.1"/>
<text text-anchor="middle" x="9448" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_141&#45;&gt;leaf_145 -->
<g id="edge145" class="edge">
<title>prespace_141&#45;&gt;leaf_145</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9426.48,-915.5701C9429.3067,-809.3734 9443.7791,-265.6725 9447.2507,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="9450.7495,-135.3372 9447.5169,-125.2475 9443.752,-135.1508 9450.7495,-135.3372"/>
</g>
<!-- leaf_146 -->
<g id="node147" class="node">
<title>leaf_146</title>
<polygon fill="none" stroke="#c0c0c0" points="9551,-125.1 9493,-125.1 9493,-89.1 9551,-89.1 9551,-125.1"/>
<text text-anchor="middle" x="9522" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">__repr</text>
</g>
<!-- literal_142&#45;&gt;leaf_146 -->
<g id="edge146" class="edge">
<title>literal_142&#45;&gt;leaf_146</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9522,-915.5701C9522,-809.3734 9522,-265.6725 9522,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="9525.5001,-135.2475 9522,-125.2475 9518.5001,-135.2476 9525.5001,-135.2475"/>
</g>
<!-- leaf_147 -->
<g id="node148" class="node">
<title>leaf_147</title>
<polygon fill="none" stroke="#c0c0c0" points="10096.5,-134.3005 9569.5,-134.3005 9569.5,-79.8996 10096.5,-79.8996 10096.5,-134.3005"/>
<text text-anchor="middle" x="9833" y="-119.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> to specify custom table</text>
<text text-anchor="middle" x="9833" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">representations. &#160;These take the table as the first value and receive the</text>
<text text-anchor="middle" x="9833" y="-88.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local color palette for consistency.</text>
</g>
<!-- raw_143&#45;&gt;leaf_147 -->
<g id="edge147" class="edge">
<title>raw_143&#45;&gt;leaf_147</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9596.2572,-915.5626C9586.6837,-812.5957 9544.1169,-299.5209 9634,-178.2001 9645.0266,-163.3168 9678.3155,-149.1127 9714.5889,-137.3676"/>
<polygon fill="#000000" stroke="#000000" points="9715.8888,-140.6275 9724.371,-134.2791 9713.7812,-133.9523 9715.8888,-140.6275"/>
</g>
<!-- leaf_149 -->
<g id="node150" class="node">
<title>leaf_149</title>
<polygon fill="none" stroke="#c0c0c0" points="10627.5,-134.4005 10114.5,-134.4005 10114.5,-79.7996 10627.5,-79.7996 10627.5,-134.4005"/>
<text text-anchor="middle" x="10371" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">In this case we want to highlight the letters of the fragment, which we</text>
<text text-anchor="middle" x="10371" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">attach to the collection.</text>
</g>
<!-- raw_148&#45;&gt;leaf_149 -->
<g id="edge149" class="edge">
<title>raw_148&#45;&gt;leaf_149</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9667.8447,-915.5226C9655.8366,-811.2308 9601.4061,-287.3213 9706,-178.2001 9736.8021,-146.0648 10060.7585,-147.1128 10105,-142.2001 10123.0519,-140.1956 10141.7758,-137.9874 10160.5481,-135.684"/>
<polygon fill="#000000" stroke="#000000" points="10161.1752,-139.1333 10170.6707,-134.4336 10160.317,-132.1861 10161.1752,-139.1333"/>
</g>
<!-- leaf_161 -->
<g id="node162" class="node">
<title>leaf_161</title>
<polygon fill="none" stroke="#c0c0c0" points="10565.5,-2078.4033 10374.5,-2078.4033 10374.5,-2042.4033 10565.5,-2042.4033 10565.5,-2078.4033"/>
<text text-anchor="middle" x="10470" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_151&#45;&gt;leaf_161 -->
<g id="edge161" class="edge">
<title>header_151&#45;&gt;leaf_161</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10551.6154,-2494.7903C10538.5276,-2425.1321 10491.1728,-2173.0926 10475.2585,-2088.391"/>
<polygon fill="#000000" stroke="#000000" points="10478.6807,-2087.6503 10473.3942,-2078.4686 10471.801,-2088.943 10478.6807,-2087.6503"/>
</g>
<!-- raw_162 -->
<g id="node163" class="node">
<title>raw_162</title>
<ellipse fill="none" stroke="#000000" cx="10611" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="10611" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_152&#45;&gt;raw_162 -->
<g id="edge162" class="edge">
<title>prose_152&#45;&gt;raw_162</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10772.7974,-2501.3386C10737.8872,-2483.9811 10675.8604,-2447.4897 10647,-2395.804 10590.4379,-2294.5079 10599.8586,-2149.1353 10607.0123,-2088.5638"/>
<polygon fill="#000000" stroke="#000000" points="10610.4905,-2088.9562 10608.2616,-2078.5984 10603.5448,-2088.0854 10610.4905,-2088.9562"/>
</g>
<!-- prespace_163 -->
<g id="node164" class="node">
<title>prespace_163</title>
<ellipse fill="none" stroke="#000000" cx="10702" cy="-2060.4033" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="10702" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_152&#45;&gt;prespace_163 -->
<g id="edge163" class="edge">
<title>prose_152&#45;&gt;prespace_163</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10790.8272,-2494.8429C10781.9911,-2472.1124 10767.0429,-2431.6024 10758,-2395.804 10729.6792,-2283.6896 10711.9125,-2146.7848 10705.1293,-2088.6621"/>
<polygon fill="#000000" stroke="#000000" points="10708.5729,-2087.9691 10703.9548,-2078.4336 10701.6186,-2088.7677 10708.5729,-2087.9691"/>
</g>
<!-- literal_164 -->
<g id="node165" class="node">
<title>literal_164</title>
<ellipse fill="none" stroke="#000000" cx="10798" cy="-2060.4033" rx="31.481" ry="18"/>
<text text-anchor="middle" x="10798" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_152&#45;&gt;literal_164 -->
<g id="edge164" class="edge">
<title>prose_152&#45;&gt;literal_164</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10798,-2494.7903C10798,-2425.2031 10798,-2173.6058 10798,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="10801.5001,-2088.4686 10798,-2078.4686 10794.5001,-2088.4686 10801.5001,-2088.4686"/>
</g>
<!-- raw_165 -->
<g id="node166" class="node">
<title>raw_165</title>
<ellipse fill="none" stroke="#000000" cx="10875" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="10875" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_152&#45;&gt;raw_165 -->
<g id="edge165" class="edge">
<title>prose_152&#45;&gt;raw_165</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10805.4952,-2494.9195C10814.6639,-2472.2682 10829.955,-2431.8398 10838,-2395.804 10863.0021,-2283.8118 10871.4053,-2146.8421 10873.9733,-2088.6823"/>
<polygon fill="#000000" stroke="#000000" points="10877.4803,-2088.5842 10874.4,-2078.4471 10870.4864,-2088.2926 10877.4803,-2088.5842"/>
</g>
<!-- raw_170 -->
<g id="node171" class="node">
<title>raw_170</title>
<ellipse fill="none" stroke="#000000" cx="11282" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11282" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_153&#45;&gt;raw_170 -->
<g id="edge170" class="edge">
<title>prose_153&#45;&gt;raw_170</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11381.8589,-2494.7903C11365.8456,-2425.1321 11307.9055,-2173.0926 11288.4339,-2088.391"/>
<polygon fill="#000000" stroke="#000000" points="11291.8044,-2087.4302 11286.1529,-2078.4686 11284.9824,-2088.9986 11291.8044,-2087.4302"/>
</g>
<!-- raw_172 -->
<g id="node173" class="node">
<title>raw_172</title>
<ellipse fill="none" stroke="#000000" cx="11605" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11605" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_154&#45;&gt;raw_172 -->
<g id="edge172" class="edge">
<title>prose_154&#45;&gt;raw_172</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11739.4254,-2494.7903C11717.8471,-2425.0612 11639.7139,-2172.5791 11613.5811,-2088.1327"/>
<polygon fill="#000000" stroke="#000000" points="11616.8904,-2086.9869 11610.5905,-2078.4686 11610.2033,-2089.0564 11616.8904,-2086.9869"/>
</g>
<!-- raw_174 -->
<g id="node175" class="node">
<title>raw_174</title>
<ellipse fill="none" stroke="#000000" cx="11897" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11897" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_155&#45;&gt;raw_174 -->
<g id="edge174" class="edge">
<title>prose_155&#45;&gt;raw_174</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11897,-2494.7903C11897,-2425.2031 11897,-2173.6058 11897,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="11900.5001,-2088.4686 11897,-2078.4686 11893.5001,-2088.4686 11900.5001,-2088.4686"/>
</g>
<!-- raw_176 -->
<g id="node177" class="node">
<title>raw_176</title>
<ellipse fill="none" stroke="#000000" cx="12214" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="12214" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_156&#45;&gt;raw_176 -->
<g id="edge176" class="edge">
<title>prose_156&#45;&gt;raw_176</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12101.6587,-2494.7903C12119.6737,-2425.1321 12184.8563,-2173.0926 12206.7618,-2088.391"/>
<polygon fill="#000000" stroke="#000000" points="12210.2126,-2089.0264 12209.328,-2078.4686 12203.4355,-2087.2737 12210.2126,-2089.0264"/>
</g>
<!-- raw_178 -->
<g id="node179" class="node">
<title>raw_178</title>
<ellipse fill="none" stroke="#000000" cx="12982" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="12982" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_157&#45;&gt;raw_178 -->
<g id="edge178" class="edge">
<title>prose_157&#45;&gt;raw_178</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13092.2032,-2495.5237C13079.9284,-2473.1721 13059.0459,-2432.718 13047,-2395.804 13010.8836,-2285.1269 12991.9383,-2146.9947 12985.0649,-2088.5733"/>
<polygon fill="#000000" stroke="#000000" points="12988.5396,-2088.1518 12983.9206,-2078.6169 12981.5854,-2088.9512 12988.5396,-2088.1518"/>
</g>
<!-- prespace_179 -->
<g id="node180" class="node">
<title>prespace_179</title>
<ellipse fill="none" stroke="#000000" cx="13102" cy="-2060.4033" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="13102" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_157&#45;&gt;prespace_179 -->
<g id="edge179" class="edge">
<title>prose_157&#45;&gt;prespace_179</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13102,-2494.7903C13102,-2425.2031 13102,-2173.6058 13102,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="13105.5001,-2088.4686 13102,-2078.4686 13098.5001,-2088.4686 13105.5001,-2088.4686"/>
</g>
<!-- literal_180 -->
<g id="node181" class="node">
<title>literal_180</title>
<ellipse fill="none" stroke="#000000" cx="13198" cy="-2060.4033" rx="31.481" ry="18"/>
<text text-anchor="middle" x="13198" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_157&#45;&gt;literal_180 -->
<g id="edge180" class="edge">
<title>prose_157&#45;&gt;literal_180</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13112.2052,-2495.6491C13124.9114,-2473.43 13146.2492,-2433.1157 13157,-2395.804 13188.814,-2285.3897 13195.9467,-2147.5833 13197.5422,-2088.9434"/>
<polygon fill="#000000" stroke="#000000" points="13201.0488,-2088.7007 13197.7868,-2078.6206 13194.0508,-2088.5348 13201.0488,-2088.7007"/>
</g>
<!-- raw_181 -->
<g id="node182" class="node">
<title>raw_181</title>
<ellipse fill="none" stroke="#000000" cx="13274" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="13274" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_157&#45;&gt;raw_181 -->
<g id="edge181" class="edge">
<title>prose_157&#45;&gt;raw_181</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13125.5368,-2500.1983C13157.1645,-2481.8574 13212.3649,-2444.6098 13238,-2395.804 13291.8372,-2293.305 13283.9923,-2149.0936 13277.6263,-2088.7213"/>
<polygon fill="#000000" stroke="#000000" points="13281.0671,-2087.9986 13276.4701,-2078.4531 13274.1111,-2088.782 13281.0671,-2087.9986"/>
</g>
<!-- raw_186 -->
<g id="node187" class="node">
<title>raw_186</title>
<ellipse fill="none" stroke="#000000" cx="13346" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="13346" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_158&#45;&gt;raw_186 -->
<g id="edge186" class="edge">
<title>prose_158&#45;&gt;raw_186</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13273.5161,-2495.0326C13283.9175,-2472.4979 13301.2095,-2432.1898 13310,-2395.804 13336.9385,-2284.2996 13343.7294,-2147.0713 13345.4333,-2088.763"/>
<polygon fill="#000000" stroke="#000000" points="13348.939,-2088.5894 13345.7033,-2078.5007 13341.9414,-2088.4051 13348.939,-2088.5894"/>
</g>
<!-- leaf_188 -->
<g id="node189" class="node">
<title>leaf_188</title>
<polygon fill="none" stroke="#c0c0c0" points="13946.5,-2395.7046 13391.5,-2395.7046 13391.5,-1725.102 13946.5,-1725.102 13946.5,-2395.7046"/>
<text text-anchor="middle" x="13669" y="-2380.604" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.search(historian, frag)</text>
<text text-anchor="middle" x="13669" y="-2365.2039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.last_collection</text>
<text text-anchor="middle" x="13669" y="-2349.8039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;and historian.last_collection.lit_frag == frag then</text>
<text text-anchor="middle" x="13669" y="-2334.4039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; don&#39;t repeat a search</text>
<text text-anchor="middle" x="13669" y="-2319.0038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return historian.last_collection</text>
<text text-anchor="middle" x="13669" y="-2303.6038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-2288.2038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local collection = setmeta({}, collect_M)</text>
<text text-anchor="middle" x="13669" y="-2272.8037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.frag = frag</text>
<text text-anchor="middle" x="13669" y="-2257.4037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.lit_frag = frag</text>
<text text-anchor="middle" x="13669" y="-2242.0037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if frag == &quot;&quot; then</text>
<text text-anchor="middle" x="13669" y="-2226.6037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return collection, false</text>
<text text-anchor="middle" x="13669" y="-2211.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-2195.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local cursors = {}</text>
<text text-anchor="middle" x="13669" y="-2180.4036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local best = true</text>
<text text-anchor="middle" x="13669" y="-2165.0035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = fuzz_patt(frag)</text>
<text text-anchor="middle" x="13669" y="-2149.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="13669" y="-2134.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="13669" y="-2118.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="13669" y="-2103.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="13669" y="-2072.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursors[#cursors + 1] = i</text>
<text text-anchor="middle" x="13669" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-2025.8033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="13669" y="-2010.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; try the transpose</text>
<text text-anchor="middle" x="13669" y="-1995.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;best = false</text>
<text text-anchor="middle" x="13669" y="-1979.6032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local slip = sub(frag, 1, &#45;3) .. sub(frag, &#45;1, &#45;1) .. sub(frag, &#45;2, &#45;2)</text>
<text text-anchor="middle" x="13669" y="-1964.2032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;collection.frag = slip</text>
<text text-anchor="middle" x="13669" y="-1948.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = fuzz_patt(slip)</text>
<text text-anchor="middle" x="13669" y="-1933.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="13669" y="-1918.0031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="13669" y="-1902.603" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="13669" y="-1887.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="13669" y="-1871.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursors[#cursors + 1] = i</text>
<text text-anchor="middle" x="13669" y="-1856.4029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-1841.0029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-1825.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13669" y="-1810.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.best = best</text>
<text text-anchor="middle" x="13669" y="-1794.8028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.cursors = cursors</text>
<text text-anchor="middle" x="13669" y="-1779.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.hl = 1</text>
<text text-anchor="middle" x="13669" y="-1764.0027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.last_collection = collection</text>
<text text-anchor="middle" x="13669" y="-1748.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return collection, best</text>
<text text-anchor="middle" x="13669" y="-1733.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_159&#45;&gt;leaf_188 -->
<g id="edge188" class="edge">
<title>codeblock_159&#45;&gt;leaf_188</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13541.2958,-2494.7903C13546.8075,-2476.0423 13556.2032,-2444.0829 13567.4783,-2405.7304"/>
<polygon fill="#000000" stroke="#000000" points="13570.9215,-2406.4273 13570.3841,-2395.8461 13564.2057,-2404.4529 13570.9215,-2406.4273"/>
</g>
<!-- header_189 -->
<g id="node190" class="node">
<title>header_189</title>
<ellipse fill="none" stroke="#000000" cx="14266" cy="-2060.4033" rx="143.582" ry="18"/>
<text text-anchor="middle" x="14266" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : _resultsFrom(historian, line_id)</text>
</g>
<!-- section_160&#45;&gt;header_189 -->
<g id="edge189" class="edge">
<title>section_160&#45;&gt;header_189</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14359.1376,-2494.7903C14344.2021,-2425.1321 14290.1619,-2173.0926 14272.0009,-2088.391"/>
<polygon fill="#000000" stroke="#000000" points="14275.3922,-2087.5126 14269.8734,-2078.4686 14268.5477,-2088.9802 14275.3922,-2087.5126"/>
</g>
<!-- prose_190 -->
<g id="node191" class="node">
<title>prose_190</title>
<ellipse fill="none" stroke="#000000" cx="14460" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="14460" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_160&#45;&gt;prose_190 -->
<g id="edge190" class="edge">
<title>section_160&#45;&gt;prose_190</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14373.8525,-2494.8994C14386.8481,-2472.5546 14408.2093,-2432.7692 14419,-2395.804 14451.199,-2285.5014 14458.1275,-2147.6358 14459.6059,-2088.9619"/>
<polygon fill="#000000" stroke="#000000" points="14463.1122,-2088.7062 14459.8291,-2078.6328 14456.1138,-2088.5548 14463.1122,-2088.7062"/>
</g>
<!-- codeblock_191 -->
<g id="node192" class="node">
<title>codeblock_191</title>
<ellipse fill="none" stroke="#000000" cx="14598" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="14598" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 454&#45;467</text>
</g>
<!-- section_160&#45;&gt;codeblock_191 -->
<g id="edge191" class="edge">
<title>section_160&#45;&gt;codeblock_191</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14391.3863,-2495.9993C14422.7521,-2475.9924 14472.5785,-2439.705 14501,-2395.804 14566.2593,-2295.0018 14588.6046,-2149.3587 14595.3738,-2088.6396"/>
<polygon fill="#000000" stroke="#000000" points="14598.8592,-2088.9619 14596.4306,-2078.6492 14591.898,-2088.2255 14598.8592,-2088.9619"/>
</g>
<!-- leaf_166 -->
<g id="node167" class="node">
<title>leaf_166</title>
<polygon fill="none" stroke="#c0c0c0" points="10655,-961.5029 10289,-961.5029 10289,-905.6999 10655,-905.6999 10655,-961.5029"/>
<text text-anchor="middle" x="10472" y="-914.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">This is an incremental &#39;fuzzy&#39; search, returning a</text>
</g>
<!-- raw_162&#45;&gt;leaf_166 -->
<g id="edge166" class="edge">
<title>raw_162&#45;&gt;leaf_166</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10609.1115,-2042.2114C10603.8517,-1991.7906 10588.4692,-1845.9922 10574,-1725.0027 10539.3045,-1434.8833 10492.5426,-1085.6187 10477.1481,-971.5979"/>
<polygon fill="#000000" stroke="#000000" points="10480.607,-971.0573 10475.7994,-961.616 10473.67,-971.9947 10480.607,-971.0573"/>
</g>
<!-- leaf_167 -->
<g id="node168" class="node">
<title>leaf_167</title>
<polygon fill="none" stroke="#c0c0c0" points="10727,-951.6014 10673,-951.6014 10673,-915.6014 10727,-915.6014 10727,-951.6014"/>
<text text-anchor="middle" x="10700" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_163&#45;&gt;leaf_167 -->
<g id="edge167" class="edge">
<title>prespace_163&#45;&gt;leaf_167</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10701.9678,-2042.2475C10701.7369,-1912.1832 10700.3357,-1122.7229 10700.0506,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="10703.5499,-961.6403 10700.032,-951.6465 10696.5499,-961.6528 10703.5499,-961.6403"/>
</g>
<!-- leaf_168 -->
<g id="node169" class="node">
<title>leaf_168</title>
<polygon fill="none" stroke="#c0c0c0" points="10831,-951.6014 10745,-951.6014 10745,-915.6014 10831,-915.6014 10831,-951.6014"/>
<text text-anchor="middle" x="10788" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">collection</text>
</g>
<!-- literal_164&#45;&gt;leaf_168 -->
<g id="edge168" class="edge">
<title>literal_164&#45;&gt;leaf_168</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10797.8389,-2042.2475C10796.6846,-1912.1832 10789.6784,-1122.7229 10788.253,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="10791.7488,-961.6151 10788.1601,-951.6465 10784.7491,-961.6772 10791.7488,-961.6151"/>
</g>
<!-- leaf_169 -->
<g id="node170" class="node">
<title>leaf_169</title>
<polygon fill="none" stroke="#c0c0c0" points="10903,-951.6014 10849,-951.6014 10849,-915.6014 10903,-915.6014 10903,-951.6014"/>
<text text-anchor="middle" x="10876" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">.</text>
</g>
<!-- raw_165&#45;&gt;leaf_169 -->
<g id="edge169" class="edge">
<title>raw_165&#45;&gt;leaf_169</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10875.0161,-2042.2475C10875.1315,-1912.1832 10875.8322,-1122.7229 10875.9747,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="10879.475,-961.6497 10875.984,-951.6465 10872.475,-961.6434 10879.475,-961.6497"/>
</g>
<!-- leaf_171 -->
<g id="node172" class="node">
<title>leaf_171</title>
<polygon fill="none" stroke="#c0c0c0" points="11434.5,-953.5035 10921.5,-953.5035 10921.5,-913.6993 11434.5,-913.6993 11434.5,-953.5035"/>
<text text-anchor="middle" x="11178" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">The array portion of a collection is any line which matches the search.</text>
</g>
<!-- raw_170&#45;&gt;leaf_171 -->
<g id="edge171" class="edge">
<title>raw_170&#45;&gt;leaf_171</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11280.3243,-2042.2475C11268.3589,-1912.6066 11195.929,-1127.8554 11180.7775,-963.6949"/>
<polygon fill="#000000" stroke="#000000" points="11184.2296,-963.0135 11179.8253,-953.3775 11177.2592,-963.6569 11184.2296,-963.0135"/>
</g>
<!-- leaf_173 -->
<g id="node174" class="node">
<title>leaf_173</title>
<polygon fill="none" stroke="#c0c0c0" points="11615.5,-953.5035 11452.5,-953.5035 11452.5,-913.6993 11615.5,-913.6993 11615.5,-953.5035"/>
<text text-anchor="middle" x="11534" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">The other fields are:</text>
</g>
<!-- raw_172&#45;&gt;leaf_173 -->
<g id="edge173" class="edge">
<title>raw_172&#45;&gt;leaf_173</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11603.856,-2042.2475C11595.6873,-1912.6066 11546.24,-1127.8554 11535.8962,-963.6949"/>
<polygon fill="#000000" stroke="#000000" points="11539.3681,-963.1376 11535.2461,-953.3775 11532.382,-963.5778 11539.3681,-963.1376"/>
</g>
<!-- leaf_175 -->
<g id="node176" class="node">
<title>leaf_175</title>
<polygon fill="none" stroke="#c0c0c0" points="12160.5,-968.8018 11633.5,-968.8018 11633.5,-898.401 12160.5,-898.401 12160.5,-968.8018"/>
<text text-anchor="middle" x="11897" y="-937.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; #fields</text>
<text text-anchor="middle" x="11897" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;best : &#160;Whether this is a best&#45;fit collection, that is, one with all</text>
<text text-anchor="middle" x="11897" y="-906.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;codepoints in order.</text>
</g>
<!-- raw_174&#45;&gt;leaf_175 -->
<g id="edge175" class="edge">
<title>raw_174&#45;&gt;leaf_175</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11897,-2042.2475C11897,-1916.2627 11897,-1171.5967 11897,-979.0357"/>
<polygon fill="#000000" stroke="#000000" points="11900.5001,-978.975 11897,-968.975 11893.5001,-978.975 11900.5001,-978.975"/>
</g>
<!-- leaf_177 -->
<g id="node178" class="node">
<title>leaf_177</title>
<polygon fill="none" stroke="#c0c0c0" points="12719.5,-960.9018 12178.5,-960.9018 12178.5,-906.3009 12719.5,-906.3009 12719.5,-960.9018"/>
<text text-anchor="middle" x="12449" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;frag : &#160;The fragment, used to highlight the collection. &#160;Is transposed</text>
<text text-anchor="middle" x="12449" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in a next&#45;best search.</text>
</g>
<!-- raw_176&#45;&gt;leaf_177 -->
<g id="edge177" class="edge">
<title>raw_176&#45;&gt;leaf_177</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12217.7865,-2042.2475C12244.4417,-1914.4384 12403.8895,-1149.9016 12441.1958,-971.0217"/>
<polygon fill="#000000" stroke="#000000" points="12444.6624,-971.5425 12443.2778,-961.0385 12437.8099,-970.1133 12444.6624,-971.5425"/>
</g>
<!-- leaf_182 -->
<g id="node183" class="node">
<title>leaf_182</title>
<polygon fill="none" stroke="#c0c0c0" points="13110.5,-953.5035 12737.5,-953.5035 12737.5,-913.6993 13110.5,-913.6993 13110.5,-953.5035"/>
<text text-anchor="middle" x="12924" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;lit_frag : &#160;The literal fragment passed as the</text>
</g>
<!-- raw_178&#45;&gt;leaf_182 -->
<g id="edge182" class="edge">
<title>raw_178&#45;&gt;leaf_182</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12981.0655,-2042.2475C12974.3924,-1912.6066 12933.9989,-1127.8554 12925.549,-963.6949"/>
<polygon fill="#000000" stroke="#000000" points="12929.0275,-963.1843 12925.0179,-953.3775 12922.0367,-963.5442 12929.0275,-963.1843"/>
</g>
<!-- leaf_183 -->
<g id="node184" class="node">
<title>leaf_183</title>
<polygon fill="none" stroke="#c0c0c0" points="13183,-951.6014 13129,-951.6014 13129,-915.6014 13183,-915.6014 13183,-951.6014"/>
<text text-anchor="middle" x="13156" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_179&#45;&gt;leaf_183 -->
<g id="edge183" class="edge">
<title>prespace_179&#45;&gt;leaf_183</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13102.8701,-2042.2475C13109.1032,-1912.1832 13146.9367,-1122.7229 13154.6339,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="13158.1524,-961.8027 13155.1352,-951.6465 13151.1605,-961.4675 13158.1524,-961.8027"/>
</g>
<!-- leaf_184 -->
<g id="node185" class="node">
<title>leaf_184</title>
<polygon fill="none" stroke="#c0c0c0" points="13255,-951.6014 13201,-951.6014 13201,-915.6014 13255,-915.6014 13255,-951.6014"/>
<text text-anchor="middle" x="13228" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">frag</text>
</g>
<!-- literal_180&#45;&gt;leaf_184 -->
<g id="edge184" class="edge">
<title>literal_180&#45;&gt;leaf_184</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13198.4834,-2042.2475C13201.9462,-1912.1832 13222.9648,-1122.7229 13227.2411,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="13230.7521,-961.7362 13227.5196,-951.6465 13223.7546,-961.5498 13230.7521,-961.7362"/>
</g>
<!-- leaf_185 -->
<g id="node186" class="node">
<title>leaf_185</title>
<polygon fill="none" stroke="#c0c0c0" points="13597,-952.9019 13273,-952.9019 13273,-914.3008 13597,-914.3008 13597,-952.9019"/>
<text text-anchor="middle" x="13435" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> parameter. &#160;Used to</text>
<text text-anchor="middle" x="13435" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;compare to the last search.</text>
</g>
<!-- raw_181&#45;&gt;leaf_185 -->
<g id="edge185" class="edge">
<title>raw_181&#45;&gt;leaf_185</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13275.634,-2042.1868C13280.2317,-1991.7031 13293.9928,-1845.7589 13310,-1725.0027 13349.545,-1426.6795 13411.5243,-1067.3734 13429.7775,-963.2139"/>
<polygon fill="#000000" stroke="#000000" points="13433.2662,-963.5827 13431.5482,-953.1281 13426.3716,-962.3722 13433.2662,-963.5827"/>
</g>
<!-- leaf_187 -->
<g id="node188" class="node">
<title>leaf_187</title>
<polygon fill="none" stroke="#c0c0c0" points="14121,-960.9018 13615,-960.9018 13615,-906.3009 14121,-906.3009 14121,-960.9018"/>
<text text-anchor="middle" x="13868" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;cursors : &#160;This is an array, each value is the cursor position of</text>
<text text-anchor="middle" x="13868" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;the corresponding line in the history.</text>
</g>
<!-- raw_186&#45;&gt;leaf_187 -->
<g id="edge187" class="edge">
<title>raw_186&#45;&gt;leaf_187</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13341.3451,-2042.4615C13328.0835,-1986.7828 13296.3387,-1815.2769 13382,-1725.0027 13451.4065,-1651.8586 13528.7584,-1753.8181 13606,-1689.0027 13834.3416,-1497.3952 13863.9561,-1095.71 13867.5708,-971.2101"/>
<polygon fill="#000000" stroke="#000000" points="13871.0739,-971.127 13867.8249,-961.0426 13864.0761,-970.952 13871.0739,-971.127"/>
</g>
<!-- leaf_192 -->
<g id="node193" class="node">
<title>leaf_192</title>
<polygon fill="none" stroke="#c0c0c0" points="14414.5,-951.6014 14139.5,-951.6014 14139.5,-915.6014 14414.5,-915.6014 14414.5,-951.6014"/>
<text text-anchor="middle" x="14277" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">**** _resultsFrom(historian, line_id)</text>
</g>
<!-- header_189&#45;&gt;leaf_192 -->
<g id="edge192" class="edge">
<title>header_189&#45;&gt;leaf_192</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14266.1772,-2042.2475C14267.4469,-1912.1832 14275.1538,-1122.7229 14276.7217,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="14280.226,-961.6803 14276.8238,-951.6465 14273.2263,-961.6119 14280.226,-961.6803"/>
</g>
<!-- raw_193 -->
<g id="node194" class="node">
<title>raw_193</title>
<ellipse fill="none" stroke="#000000" cx="14460" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="14460" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_190&#45;&gt;raw_193 -->
<g id="edge193" class="edge">
<title>prose_190&#45;&gt;raw_193</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14460,-2042.2475C14460,-1912.1832 14460,-1122.7229 14460,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="14463.5001,-961.6465 14460,-951.6465 14456.5001,-961.6466 14463.5001,-961.6465"/>
</g>
<!-- leaf_195 -->
<g id="node196" class="node">
<title>leaf_195</title>
<polygon fill="none" stroke="#c0c0c0" points="14850.5,-1029.9019 14505.5,-1029.9019 14505.5,-837.3009 14850.5,-837.3009 14850.5,-1029.9019"/>
<text text-anchor="middle" x="14678" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _resultsFrom(historian, line_id)</text>
<text text-anchor="middle" x="14678" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local stmt = historian.get_results</text>
<text text-anchor="middle" x="14678" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;stmt:bindkv {line_id = line_id}</text>
<text text-anchor="middle" x="14678" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local results = stmt:resultset()</text>
<text text-anchor="middle" x="14678" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if results then</text>
<text text-anchor="middle" x="14678" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results = results[1]</text>
<text text-anchor="middle" x="14678" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results.n = #results</text>
<text text-anchor="middle" x="14678" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results.frozen = true</text>
<text text-anchor="middle" x="14678" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="14678" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.get_results:clearbind():reset()</text>
<text text-anchor="middle" x="14678" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return results</text>
<text text-anchor="middle" x="14678" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_191&#45;&gt;leaf_195 -->
<g id="edge195" class="edge">
<title>codeblock_191&#45;&gt;leaf_195</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14599.289,-2042.2475C14607.465,-1927.0892 14652.3407,-1295.0136 14670.4341,-1040.1675"/>
<polygon fill="#000000" stroke="#000000" points="14673.9277,-1040.3803 14671.1448,-1030.1576 14666.9453,-1039.8845 14673.9277,-1040.3803"/>
</g>
<!-- leaf_194 -->
<g id="node195" class="node">
<title>leaf_194</title>
<polygon fill="none" stroke="#c0c0c0" points="14702.5,-135.0015 14217.5,-135.0015 14217.5,-79.1986 14702.5,-79.1986 14702.5,-135.0015"/>
<text text-anchor="middle" x="14460" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Retrieve a set of results reprs from the database, given a line_id.</text>
</g>
<!-- raw_193&#45;&gt;leaf_194 -->
<g id="edge194" class="edge">
<title>raw_193&#45;&gt;leaf_194</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14460,-915.5701C14460,-811.9323 14460,-291.6209 14460,-145.3846"/>
<polygon fill="#000000" stroke="#000000" points="14463.5001,-145.1211 14460,-135.1211 14456.5001,-145.1212 14463.5001,-145.1211"/>
</g>
<!-- leaf_202 -->
<g id="node203" class="node">
<title>leaf_202</title>
<polygon fill="none" stroke="#c0c0c0" points="14852.5,-2078.4033 14703.5,-2078.4033 14703.5,-2042.4033 14852.5,-2042.4033 14852.5,-2078.4033"/>
<text text-anchor="middle" x="14778" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_196&#45;&gt;leaf_202 -->
<g id="edge202" class="edge">
<title>header_196&#45;&gt;leaf_202</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14820.248,-2494.7903C14813.48,-2425.2031 14789.0099,-2173.6058 14780.7473,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="14784.2087,-2088.0828 14779.757,-2078.4686 14777.2416,-2088.7605 14784.2087,-2088.0828"/>
</g>
<!-- raw_203 -->
<g id="node204" class="node">
<title>raw_203</title>
<ellipse fill="none" stroke="#000000" cx="14898" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="14898" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_197&#45;&gt;raw_203 -->
<g id="edge203" class="edge">
<title>prose_197&#45;&gt;raw_203</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14986.7637,-2495.967C14971.5619,-2474.0836 14946.1487,-2434.1237 14934,-2395.804 14899.2606,-2286.2282 14896.6292,-2147.5085 14897.2919,-2088.753"/>
<polygon fill="#000000" stroke="#000000" points="14900.7916,-2088.7907 14897.4469,-2078.7377 14893.7925,-2088.6823 14900.7916,-2088.7907"/>
</g>
<!-- leaf_205 -->
<g id="node206" class="node">
<title>leaf_205</title>
<polygon fill="none" stroke="#c0c0c0" points="15506.9015,-2171.0439 14943.0985,-2171.0439 14943.0985,-1949.7627 15506.9015,-1949.7627 15506.9015,-2171.0439"/>
<text text-anchor="middle" x="15225" y="-2156.0235" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="15225" y="-2140.6234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 or #historian == 0 then</text>
<text text-anchor="middle" x="15225" y="-2125.2234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="15225" y="-2109.8234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="15225" y="-2094.4233" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local Δ = historian.cursor &gt; 1 and historian.cursor &#45; 1 or historian.cursor</text>
<text text-anchor="middle" x="15225" y="-2075.6633" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[Δ]</text>
<text text-anchor="middle" x="15225" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = 1</text>
<text text-anchor="middle" x="15225" y="-2041.5033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[Δ])</text>
<text text-anchor="middle" x="15225" y="-2022.7433" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;local result = historian.results[txtbuf]</text>
<text text-anchor="middle" x="15225" y="-2007.3433" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = Δ</text>
<text text-anchor="middle" x="15225" y="-1988.5833" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="15225" y="-1973.1832" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return txtbuf:clone(), result</text>
<text text-anchor="middle" x="15225" y="-1957.7832" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_198&#45;&gt;leaf_205 -->
<g id="edge205" class="edge">
<title>codeblock_198&#45;&gt;leaf_205</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15225,-2494.7903C15225,-2443.077 15225,-2290.8464 15225,-2181.1888"/>
<polygon fill="#000000" stroke="#000000" points="15228.5001,-2181.0475 15225,-2171.0476 15221.5001,-2181.0476 15228.5001,-2181.0475"/>
</g>
<!-- header_206 -->
<g id="node207" class="node">
<title>header_206</title>
<ellipse fill="none" stroke="#000000" cx="15607" cy="-2060.4033" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="15607" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_199&#45;&gt;header_206 -->
<g id="edge206" class="edge">
<title>section_199&#45;&gt;header_206</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15671.3322,-2494.7903C15661.0159,-2425.1321 15623.6892,-2173.0926 15611.1449,-2088.391"/>
<polygon fill="#000000" stroke="#000000" points="15614.6028,-2087.8479 15609.6754,-2078.4686 15607.6783,-2088.8735 15614.6028,-2087.8479"/>
</g>
<!-- prose_207 -->
<g id="node208" class="node">
<title>prose_207</title>
<ellipse fill="none" stroke="#000000" cx="15740" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="15740" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_199&#45;&gt;prose_207 -->
<g id="edge207" class="edge">
<title>section_199&#45;&gt;prose_207</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15678.1817,-2494.6462C15683.3575,-2471.7129 15692.1965,-2430.9936 15698,-2395.804 15716.6596,-2282.66 15731.304,-2146.8266 15737.191,-2088.8633"/>
<polygon fill="#000000" stroke="#000000" points="15740.6995,-2088.9539 15738.2189,-2078.6536 15733.7347,-2088.2527 15740.6995,-2088.9539"/>
</g>
<!-- codeblock_208 -->
<g id="node209" class="node">
<title>codeblock_208</title>
<ellipse fill="none" stroke="#000000" cx="15948" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15948" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 495&#45;519</text>
</g>
<!-- section_199&#45;&gt;codeblock_208 -->
<g id="edge208" class="edge">
<title>section_199&#45;&gt;codeblock_208</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15693.1495,-2495.1269C15716.0272,-2473.3225 15754.5247,-2434.3884 15781,-2395.804 15853.8856,-2289.5822 15913.9455,-2146.9823 15937.4043,-2087.8589"/>
<polygon fill="#000000" stroke="#000000" points="15940.6983,-2089.0462 15941.1036,-2078.4591 15934.1845,-2086.4827 15940.6983,-2089.0462"/>
</g>
<!-- header_219 -->
<g id="node220" class="node">
<title>header_219</title>
<ellipse fill="none" stroke="#000000" cx="16402" cy="-2060.4033" rx="111.1981" ry="18"/>
<text text-anchor="middle" x="16402" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:index(cursor)</text>
</g>
<!-- section_200&#45;&gt;header_219 -->
<g id="edge219" class="edge">
<title>section_200&#45;&gt;header_219</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16479.7747,-2494.7903C16467.3028,-2425.1321 16422.1764,-2173.0926 16407.011,-2088.391"/>
<polygon fill="#000000" stroke="#000000" points="16410.4422,-2087.6952 16405.2345,-2078.4686 16403.5518,-2088.9289 16410.4422,-2087.6952"/>
</g>
<!-- prose_220 -->
<g id="node221" class="node">
<title>prose_220</title>
<ellipse fill="none" stroke="#000000" cx="16564" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="16564" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_200&#45;&gt;prose_220 -->
<g id="edge220" class="edge">
<title>section_200&#45;&gt;prose_220</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16490.2088,-2494.8802C16499.046,-2472.1884 16513.8495,-2431.7181 16522,-2395.804 16547.4397,-2283.7064 16558.538,-2146.7927 16562.3478,-2088.6649"/>
<polygon fill="#000000" stroke="#000000" points="16565.8565,-2088.6367 16562.9955,-2078.4355 16558.8705,-2088.1943 16565.8565,-2088.6367"/>
</g>
<!-- codeblock_221 -->
<g id="node222" class="node">
<title>codeblock_221</title>
<ellipse fill="none" stroke="#000000" cx="16773" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="16773" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 526&#45;539</text>
</g>
<!-- section_200&#45;&gt;codeblock_221 -->
<g id="edge221" class="edge">
<title>section_200&#45;&gt;codeblock_221</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16505.496,-2495.2811C16531.8268,-2473.9251 16575.5675,-2435.7219 16605,-2395.804 16681.5412,-2291.9944 16740.1992,-2148.0745 16762.8358,-2088.2298"/>
<polygon fill="#000000" stroke="#000000" points="16766.1708,-2089.3041 16766.3993,-2078.7117 16759.6152,-2086.8497 16766.1708,-2089.3041"/>
</g>
<!-- header_226 -->
<g id="node227" class="node">
<title>header_226</title>
<ellipse fill="none" stroke="#000000" cx="17289" cy="-2060.4033" rx="184.6938" ry="18"/>
<text text-anchor="middle" x="17289" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append(txtbuf, results, success)</text>
</g>
<!-- section_201&#45;&gt;header_226 -->
<g id="edge226" class="edge">
<title>section_201&#45;&gt;header_226</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17584.1822,-2495.3869C17558.0756,-2473.8384 17514.0104,-2435.1563 17483,-2395.804 17400.3742,-2290.9516 17329.2695,-2147.1072 17301.4768,-2087.7344"/>
<polygon fill="#000000" stroke="#000000" points="17304.6319,-2086.2185 17297.2433,-2078.6251 17298.2839,-2089.1688 17304.6319,-2086.2185"/>
</g>
<!-- prose_227 -->
<g id="node228" class="node">
<title>prose_227</title>
<ellipse fill="none" stroke="#000000" cx="17524" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="17524" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_201&#45;&gt;prose_227 -->
<g id="edge227" class="edge">
<title>section_201&#45;&gt;prose_227</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17598.2089,-2494.5277C17588.8499,-2471.8084 17573.3674,-2431.6456 17565,-2395.804 17538.8771,-2283.9066 17528.7265,-2146.8867 17525.3995,-2088.698"/>
<polygon fill="#000000" stroke="#000000" points="17528.8804,-2088.2512 17524.8388,-2078.4575 17521.8909,-2088.6339 17528.8804,-2088.2512"/>
</g>
<!-- prose_228 -->
<g id="node229" class="node">
<title>prose_228</title>
<ellipse fill="none" stroke="#000000" cx="17606" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="17606" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_201&#45;&gt;prose_228 -->
<g id="edge228" class="edge">
<title>section_201&#45;&gt;prose_228</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17606,-2494.7903C17606,-2425.2031 17606,-2173.6058 17606,-2088.6502"/>
<polygon fill="#000000" stroke="#000000" points="17609.5001,-2088.4686 17606,-2078.4686 17602.5001,-2088.4686 17609.5001,-2088.4686"/>
</g>
<!-- codeblock_229 -->
<g id="node230" class="node">
<title>codeblock_229</title>
<ellipse fill="none" stroke="#000000" cx="17794" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="17794" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 547&#45;562</text>
</g>
<!-- section_201&#45;&gt;codeblock_229 -->
<g id="edge229" class="edge">
<title>section_201&#45;&gt;codeblock_229</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17613.4858,-2494.7903C17642.492,-2424.9903 17747.5977,-2172.0652 17782.5836,-2087.8755"/>
<polygon fill="#000000" stroke="#000000" points="17785.8873,-2089.0461 17786.4928,-2078.4686 17779.4232,-2086.3599 17785.8873,-2089.0461"/>
</g>
<!-- codeblock_230 -->
<g id="node231" class="node">
<title>codeblock_230</title>
<ellipse fill="none" stroke="#000000" cx="18104" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="18104" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 564&#45;571</text>
</g>
<!-- section_201&#45;&gt;codeblock_230 -->
<g id="edge230" class="edge">
<title>section_201&#45;&gt;codeblock_230</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17661.7301,-2500.5835C17723.1535,-2484.8474 17822.2173,-2452.53 17890,-2395.804 17996.375,-2306.7807 18067.5462,-2151.0318 18093.2853,-2088.0258"/>
<polygon fill="#000000" stroke="#000000" points="18096.6753,-2088.9767 18097.1599,-2078.3929 18090.181,-2086.3645 18096.6753,-2088.9767"/>
</g>
<!-- codeblock_231 -->
<g id="node232" class="node">
<title>codeblock_231</title>
<ellipse fill="none" stroke="#000000" cx="18357" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="18357" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 573&#45;575</text>
</g>
<!-- section_201&#45;&gt;codeblock_231 -->
<g id="edge231" class="edge">
<title>section_201&#45;&gt;codeblock_231</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17677.356,-2506.7946C17816.8829,-2493.7764 18119.278,-2458.9376 18200,-2395.804 18302.1817,-2315.8865 18340.8199,-2153.5969 18352.6048,-2088.4229"/>
<polygon fill="#000000" stroke="#000000" points="18356.0702,-2088.9229 18354.3297,-2078.472 18349.1731,-2087.7273 18356.0702,-2088.9229"/>
</g>
<!-- leaf_204 -->
<g id="node205" class="node">
<title>leaf_204</title>
<polygon fill="none" stroke="#c0c0c0" points="14925,-951.6014 14871,-951.6014 14871,-915.6014 14925,-915.6014 14925,-951.6014"/>
</g>
<!-- raw_203&#45;&gt;leaf_204 -->
<g id="edge204" class="edge">
<title>raw_203&#45;&gt;leaf_204</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14898,-2042.2475C14898,-1912.1832 14898,-1122.7229 14898,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="14901.5001,-961.6465 14898,-951.6465 14894.5001,-961.6466 14901.5001,-961.6465"/>
</g>
<!-- leaf_209 -->
<g id="node210" class="node">
<title>leaf_209</title>
<polygon fill="none" stroke="#c0c0c0" points="15470,-951.6014 15314,-951.6014 15314,-915.6014 15470,-915.6014 15470,-951.6014"/>
<text text-anchor="middle" x="15392" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_206&#45;&gt;leaf_209 -->
<g id="edge209" class="edge">
<title>header_206&#45;&gt;leaf_209</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15605.467,-2042.3837C15600.333,-1989.9382 15580.2727,-1834.1929 15516,-1725.0027 15504.3612,-1705.23 15489.1217,-1709.5932 15479,-1689.0027 15352.1628,-1430.9778 15378.1708,-1065.2398 15388.7594,-961.8159"/>
<polygon fill="#000000" stroke="#000000" points="15392.2434,-962.1511 15389.8182,-951.8376 15385.2825,-961.4124 15392.2434,-962.1511"/>
</g>
<!-- raw_210 -->
<g id="node211" class="node">
<title>raw_210</title>
<ellipse fill="none" stroke="#000000" cx="15515" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="15515" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_207&#45;&gt;raw_210 -->
<g id="edge210" class="edge">
<title>prose_207&#45;&gt;raw_210</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15744.0372,-2042.3186C15755.246,-1986.9539 15780.7426,-1817.9088 15698,-1725.0027 15653.2641,-1674.7717 15593.7705,-1740.9173 15551,-1689.0027 15457.8047,-1575.8827 15499.7825,-1085.5222 15512.0432,-961.9538"/>
<polygon fill="#000000" stroke="#000000" points="15515.5473,-962.0888 15513.0676,-951.7883 15508.5826,-961.3869 15515.5473,-962.0888"/>
</g>
<!-- prespace_211 -->
<g id="node212" class="node">
<title>prespace_211</title>
<ellipse fill="none" stroke="#000000" cx="15606" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="15606" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_207&#45;&gt;prespace_211 -->
<g id="edge211" class="edge">
<title>prose_207&#45;&gt;prespace_211</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15741.6939,-2042.1564C15745.755,-1989.7437 15752.0274,-1835.4384 15698,-1725.0027 15688.0564,-1704.6772 15671.4265,-1709.573 15662,-1689.0027 15542.6827,-1428.6297 15585.8526,-1064.5389 15601.3965,-961.659"/>
<polygon fill="#000000" stroke="#000000" points="15604.8618,-962.1521 15602.9345,-951.734 15597.9443,-961.0801 15604.8618,-962.1521"/>
</g>
<!-- literal_212 -->
<g id="node213" class="node">
<title>literal_212</title>
<ellipse fill="none" stroke="#000000" cx="15702" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="15702" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_207&#45;&gt;literal_212 -->
<g id="edge212" class="edge">
<title>prose_207&#45;&gt;literal_212</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15739.3877,-2042.2475C15735.0015,-1912.1832 15708.3779,-1122.7229 15702.9613,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="15706.4437,-961.5229 15702.6086,-951.6465 15699.4477,-961.7589 15706.4437,-961.5229"/>
</g>
<!-- raw_213 -->
<g id="node214" class="node">
<title>raw_213</title>
<ellipse fill="none" stroke="#000000" cx="15778" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="15778" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_207&#45;&gt;raw_213 -->
<g id="edge213" class="edge">
<title>prose_207&#45;&gt;raw_213</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15740.6123,-2042.2475C15744.9985,-1912.1832 15771.6221,-1122.7229 15777.0387,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="15780.5523,-961.7589 15777.3914,-951.6465 15773.5563,-961.5229 15780.5523,-961.7589"/>
</g>
<!-- leaf_218 -->
<g id="node219" class="node">
<title>leaf_218</title>
<polygon fill="none" stroke="#c0c0c0" points="16288.9015,-1121.2421 15823.0985,-1121.2421 15823.0985,-745.9606 16288.9015,-745.9606 16288.9015,-1121.2421"/>
<text text-anchor="middle" x="16056" y="-1106.2217" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="16056" y="-1090.8216" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local Δ = historian.cursor &lt; #historian</text>
<text text-anchor="middle" x="16056" y="-1072.0616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and historian.cursor + 1</text>
<text text-anchor="middle" x="16056" y="-1056.6616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or &#160;historian.cursor</text>
<text text-anchor="middle" x="16056" y="-1041.2616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local fwd = historian.cursor &gt;= #historian</text>
<text text-anchor="middle" x="16056" y="-1025.8615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 or #historian == 0 then</text>
<text text-anchor="middle" x="16056" y="-1010.4615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="16056" y="-995.0615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16056" y="-979.6615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[Δ]</text>
<text text-anchor="middle" x="16056" y="-960.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not txtbuf then</text>
<text text-anchor="middle" x="16056" y="-945.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf(), nil, true</text>
<text text-anchor="middle" x="16056" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16056" y="-914.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = #txtbuf.lines</text>
<text text-anchor="middle" x="16056" y="-899.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[Δ])</text>
<text text-anchor="middle" x="16056" y="-880.5413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = Δ</text>
<text text-anchor="middle" x="16056" y="-861.7813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="16056" y="-846.3813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if fwd and #txtbuf.lines &gt; 0 then</text>
<text text-anchor="middle" x="16056" y="-830.9813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian + 1</text>
<text text-anchor="middle" x="16056" y="-815.5812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return txtbuf:clone(), nil, true</text>
<text text-anchor="middle" x="16056" y="-800.1812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="16056" y="-784.7812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return txtbuf:clone(), result, false</text>
<text text-anchor="middle" x="16056" y="-769.3811" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16056" y="-753.9811" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_208&#45;&gt;leaf_218 -->
<g id="edge218" class="edge">
<title>codeblock_208&#45;&gt;leaf_218</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15949.7402,-2042.2475C15959.621,-1939.1576 16009.2062,-1421.817 16037.014,-1131.6894"/>
<polygon fill="#000000" stroke="#000000" points="16040.5237,-1131.7539 16037.9939,-1121.4655 16033.5557,-1131.0859 16040.5237,-1131.7539"/>
</g>
<!-- leaf_214 -->
<g id="node215" class="node">
<title>leaf_214</title>
<polygon fill="none" stroke="#c0c0c0" points="15561.5,-135.0015 15090.5,-135.0015 15090.5,-79.1986 15561.5,-79.1986 15561.5,-135.0015"/>
<text text-anchor="middle" x="15326" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next txtbuf in history, and a second flag to tell the</text>
</g>
<!-- raw_210&#45;&gt;leaf_214 -->
<g id="edge214" class="edge">
<title>raw_210&#45;&gt;leaf_214</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15516.5957,-915.3514C15525.2481,-812.3 15563.1262,-303.3839 15479,-178.2001 15468.1483,-162.0523 15452.6279,-149.4975 15435.592,-139.7583"/>
<polygon fill="#000000" stroke="#000000" points="15437.029,-136.5575 15426.5618,-134.9178 15433.7219,-142.7271 15437.029,-136.5575"/>
</g>
<!-- leaf_215 -->
<g id="node216" class="node">
<title>leaf_215</title>
<polygon fill="none" stroke="#c0c0c0" points="15634,-125.1 15580,-125.1 15580,-89.1 15634,-89.1 15634,-125.1"/>
</g>
<!-- prespace_211&#45;&gt;leaf_215 -->
<g id="edge215" class="edge">
<title>prespace_211&#45;&gt;leaf_215</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15606.0218,-915.5701C15606.1503,-809.3734 15606.8081,-265.6725 15606.9659,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="15610.4658,-135.2518 15606.978,-125.2475 15603.4658,-135.2433 15610.4658,-135.2518"/>
</g>
<!-- leaf_216 -->
<g id="node217" class="node">
<title>leaf_216</title>
<polygon fill="none" stroke="#c0c0c0" points="15752,-125.1 15652,-125.1 15652,-89.1 15752,-89.1 15752,-125.1"/>
<text text-anchor="middle" x="15702" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_212&#45;&gt;leaf_216 -->
<g id="edge216" class="edge">
<title>literal_212&#45;&gt;leaf_216</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15702,-915.5701C15702,-809.3734 15702,-265.6725 15702,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="15705.5001,-135.2475 15702,-125.2475 15698.5001,-135.2476 15705.5001,-135.2475"/>
</g>
<!-- leaf_217 -->
<g id="node218" class="node">
<title>leaf_217</title>
<polygon fill="none" stroke="#c0c0c0" points="16010,-127.0021 15770,-127.0021 15770,-87.198 16010,-87.198 16010,-127.0021"/>
<text text-anchor="middle" x="15890" y="-111.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_213&#45;&gt;leaf_217 -->
<g id="edge217" class="edge">
<title>raw_213&#45;&gt;leaf_217</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15777.0445,-915.3896C15771.9751,-813.615 15750.7616,-314.9466 15814,-178.2001 15822.1907,-160.4886 15836.9968,-145.0669 15851.3789,-133.1552"/>
<polygon fill="#000000" stroke="#000000" points="15853.6079,-135.8547 15859.2806,-126.9065 15849.2658,-130.3641 15853.6079,-135.8547"/>
</g>
<!-- leaf_222 -->
<g id="node223" class="node">
<title>leaf_222</title>
<polygon fill="none" stroke="#c0c0c0" points="16511.5,-951.6014 16306.5,-951.6014 16306.5,-915.6014 16511.5,-915.6014 16511.5,-951.6014"/>
<text text-anchor="middle" x="16409" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:index(cursor)</text>
</g>
<!-- header_219&#45;&gt;leaf_222 -->
<g id="edge222" class="edge">
<title>header_219&#45;&gt;leaf_222</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16402.1128,-2042.2475C16402.9208,-1912.1832 16407.8251,-1122.7229 16408.8229,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="16412.3256,-961.6681 16408.8879,-951.6465 16405.3257,-961.6246 16412.3256,-961.6681"/>
</g>
<!-- raw_223 -->
<g id="node224" class="node">
<title>raw_223</title>
<ellipse fill="none" stroke="#000000" cx="16557" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="16557" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_220&#45;&gt;raw_223 -->
<g id="edge223" class="edge">
<title>prose_220&#45;&gt;raw_223</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16563.8872,-2042.2475C16563.0792,-1912.1832 16558.1749,-1122.7229 16557.1771,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="16560.6743,-961.6246 16557.1121,-951.6465 16553.6744,-961.6681 16560.6743,-961.6246"/>
</g>
<!-- leaf_225 -->
<g id="node226" class="node">
<title>leaf_225</title>
<polygon fill="none" stroke="#c0c0c0" points="17101.5,-1029.9019 16602.5,-1029.9019 16602.5,-837.3009 17101.5,-837.3009 17101.5,-1029.9019"/>
<text text-anchor="middle" x="16852" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.index(historian, cursor)</text>
<text text-anchor="middle" x="16852" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if (not cursor) or cursor &lt; 0 or cursor &gt; #historian + 1 then</text>
<text text-anchor="middle" x="16852" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="16852" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16852" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[cursor]</text>
<text text-anchor="middle" x="16852" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[cursor])</text>
<text text-anchor="middle" x="16852" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf = txtbuf:clone()</text>
<text text-anchor="middle" x="16852" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = cursor</text>
<text text-anchor="middle" x="16852" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = #txtbuf.lines</text>
<text text-anchor="middle" x="16852" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="16852" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return txtbuf, result</text>
<text text-anchor="middle" x="16852" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_221&#45;&gt;leaf_225 -->
<g id="edge225" class="edge">
<title>codeblock_221&#45;&gt;leaf_225</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16774.2729,-2042.2475C16782.3466,-1927.0892 16826.6614,-1295.0136 16844.5287,-1040.1675"/>
<polygon fill="#000000" stroke="#000000" points="16848.0224,-1040.3779 16845.2305,-1030.1576 16841.0395,-1039.8883 16848.0224,-1040.3779"/>
</g>
<!-- leaf_224 -->
<g id="node225" class="node">
<title>leaf_224</title>
<polygon fill="none" stroke="#c0c0c0" points="16691,-135.0015 16423,-135.0015 16423,-79.1986 16691,-79.1986 16691,-135.0015"/>
<text text-anchor="middle" x="16557" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Loads the history to an exact index.</text>
</g>
<!-- raw_223&#45;&gt;leaf_224 -->
<g id="edge224" class="edge">
<title>raw_223&#45;&gt;leaf_224</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16557,-915.5701C16557,-811.9323 16557,-291.6209 16557,-145.3846"/>
<polygon fill="#000000" stroke="#000000" points="16560.5001,-145.1211 16557,-135.1211 16553.5001,-145.1212 16560.5001,-145.1211"/>
</g>
<!-- leaf_232 -->
<g id="node233" class="node">
<title>leaf_232</title>
<polygon fill="none" stroke="#c0c0c0" points="17458,-951.6014 17120,-951.6014 17120,-915.6014 17458,-915.6014 17458,-951.6014"/>
<text text-anchor="middle" x="17289" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append(txtbuf, results, success)</text>
</g>
<!-- header_226&#45;&gt;leaf_232 -->
<g id="edge232" class="edge">
<title>header_226&#45;&gt;leaf_232</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17289,-2042.2475C17289,-1912.1832 17289,-1122.7229 17289,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="17292.5001,-961.6465 17289,-951.6465 17285.5001,-961.6466 17292.5001,-961.6465"/>
</g>
<!-- raw_233 -->
<g id="node234" class="node">
<title>raw_233</title>
<ellipse fill="none" stroke="#000000" cx="17503" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="17503" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_227&#45;&gt;raw_233 -->
<g id="edge233" class="edge">
<title>prose_227&#45;&gt;raw_233</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17523.6616,-2042.2475C17521.2377,-1912.1832 17506.5246,-1122.7229 17503.5312,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="17507.0221,-961.5796 17503.3363,-951.6465 17500.0233,-961.7101 17507.0221,-961.5796"/>
</g>
<!-- raw_235 -->
<g id="node236" class="node">
<title>raw_235</title>
<ellipse fill="none" stroke="#000000" cx="17575" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="17575" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_228&#45;&gt;raw_235 -->
<g id="edge235" class="edge">
<title>prose_228&#45;&gt;raw_235</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17605.5005,-2042.2475C17601.9222,-1912.1832 17580.203,-1122.7229 17575.7842,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="17579.2702,-961.5465 17575.4964,-951.6465 17572.2729,-961.739 17579.2702,-961.5465"/>
</g>
<!-- leaf_237 -->
<g id="node238" class="node">
<title>leaf_237</title>
<polygon fill="none" stroke="#c0c0c0" points="18070,-1045.2022 17620,-1045.2022 17620,-822.0006 18070,-822.0006 18070,-1045.2022"/>
<text text-anchor="middle" x="17845" y="-1030.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, txtbuf, results, success)</text>
<text text-anchor="middle" x="17845" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if tostring(historian[#historian]) == tostring(txtbuf)</text>
<text text-anchor="middle" x="17845" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;or tostring(txtbuf) == &quot;&quot; then</text>
<text text-anchor="middle" x="17845" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; don&#39;t bother</text>
<text text-anchor="middle" x="17845" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="17845" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="17845" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = txtbuf</text>
<text text-anchor="middle" x="17845" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if success then</text>
<text text-anchor="middle" x="17845" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian:persist(txtbuf, results)</text>
<text text-anchor="middle" x="17845" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="17845" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian:persist(txtbuf)</text>
<text text-anchor="middle" x="17845" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="17845" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="17845" y="-830.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_229&#45;&gt;leaf_237 -->
<g id="edge237" class="edge">
<title>codeblock_229&#45;&gt;leaf_237</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17794.8217,-2042.2475C17799.9321,-1929.3379 17827.5338,-1319.5018 17839.4818,-1055.5216"/>
<polygon fill="#000000" stroke="#000000" points="17842.979,-1055.6598 17839.9348,-1045.5118 17835.9862,-1055.3433 17842.979,-1055.6598"/>
</g>
<!-- leaf_238 -->
<g id="node239" class="node">
<title>leaf_238</title>
<polygon fill="none" stroke="#c0c0c0" points="18356,-984.0024 18088,-984.0024 18088,-883.2004 18356,-883.2004 18356,-984.0024"/>
<text text-anchor="middle" x="18222" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new()</text>
<text text-anchor="middle" x="18222" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="18222" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="18222" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="18222" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="18222" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_230&#45;&gt;leaf_238 -->
<g id="edge238" class="edge">
<title>codeblock_230&#45;&gt;leaf_238</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M18105.9013,-2042.2475C18118.7708,-1919.3542 18193.2886,-1207.771 18215.6549,-994.1916"/>
<polygon fill="#000000" stroke="#000000" points="18219.1507,-994.4137 18216.7114,-984.1036 18212.1888,-993.6846 18219.1507,-994.4137"/>
</g>
<!-- leaf_239 -->
<g id="node240" class="node">
<title>leaf_239</title>
<polygon fill="none" stroke="#c0c0c0" points="18460,-951.6014 18374,-951.6014 18374,-915.6014 18460,-915.6014 18460,-951.6014"/>
<text text-anchor="middle" x="18417" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_231&#45;&gt;leaf_239 -->
<g id="edge239" class="edge">
<title>codeblock_231&#45;&gt;leaf_239</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M18357.9668,-2042.2475C18364.8924,-1912.1832 18406.9296,-1122.7229 18415.4822,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="18419.0024,-961.8185 18416.0391,-951.6465 18412.0123,-961.4463 18419.0024,-961.8185"/>
</g>
<!-- leaf_234 -->
<g id="node235" class="node">
<title>leaf_234</title>
<polygon fill="none" stroke="#c0c0c0" points="17561,-135.0015 17237,-135.0015 17237,-79.1986 17561,-79.1986 17561,-135.0015"/>
<text text-anchor="middle" x="17399" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Appends a txtbuf to history and persists it.</text>
</g>
<!-- raw_233&#45;&gt;leaf_234 -->
<g id="edge234" class="edge">
<title>raw_233&#45;&gt;leaf_234</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17506.5607,-915.5747C17522.7539,-829.1565 17583.7573,-450.2758 17467,-178.2001 17461.3088,-164.9381 17451.967,-152.6852 17442.0043,-142.22"/>
<polygon fill="#000000" stroke="#000000" points="17444.2381,-139.505 17434.6835,-134.9268 17439.2977,-144.4641 17444.2381,-139.505"/>
</g>
<!-- leaf_236 -->
<g id="node237" class="node">
<title>leaf_236</title>
<polygon fill="none" stroke="#c0c0c0" points="17777,-127.0021 17579,-127.0021 17579,-87.198 17777,-87.198 17777,-127.0021"/>
<text text-anchor="middle" x="17678" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Doesn&#39;t adjust the cursor.</text>
</g>
<!-- raw_235&#45;&gt;leaf_236 -->
<g id="edge236" class="edge">
<title>raw_235&#45;&gt;leaf_236</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17571.4822,-915.593C17555.486,-829.2589 17495.2498,-450.7058 17611,-178.2001 17618.206,-161.2354 17631.3675,-145.8615 17644.1297,-133.7848"/>
<polygon fill="#000000" stroke="#000000" points="17646.4849,-136.374 17651.5498,-127.0682 17641.7872,-131.1843 17646.4849,-136.374"/>
</g>
</g>
</svg>
