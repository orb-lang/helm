<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="18504pt" height="2833pt"
 viewBox="0.00 0.00 18504.30 2833.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2829.2043)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2829.2043 18500.2972,-2829.2043 18500.2972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2807.2043" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1787" y="-2803.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 576</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2735.2043" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1787" y="-2731.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;470</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2789.0357C1787,-2781.3353 1787,-2772.1787 1787,-2763.6209"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2763.6175 1787,-2753.6176 1783.5001,-2763.6176 1790.5001,-2763.6175"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1168" cy="-2663.2043" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1168" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1725.4565,-2728.6516C1633.9363,-2718.8264 1456.5725,-2699.4749 1306,-2681.2043 1281.4502,-2678.2254 1254.4713,-2674.7512 1230.9302,-2671.6539"/>
<polygon fill="#000000" stroke="#000000" points="1231.0962,-2668.1455 1220.7241,-2670.3064 1230.1799,-2675.0853 1231.0962,-2668.1455"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1347" cy="-2663.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1347" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1726.8328,-2727.8767C1654.436,-2718.6917 1529.3399,-2701.6464 1423,-2681.2043 1411.0534,-2678.9078 1398.1458,-2676.0101 1386.4181,-2673.2147"/>
<polygon fill="#000000" stroke="#000000" points="1387.0127,-2669.7575 1376.4695,-2670.8021 1385.363,-2676.5603 1387.0127,-2669.7575"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1464" cy="-2663.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1464" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1731.5408,-2725.4356C1677.8804,-2715.6137 1594.4109,-2699.3578 1523,-2681.2043 1516.1661,-2679.467 1508.9445,-2677.4327 1501.9868,-2675.369"/>
<polygon fill="#000000" stroke="#000000" points="1502.6431,-2671.9106 1492.0577,-2672.3556 1500.6102,-2678.6089 1502.6431,-2671.9106"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1564" cy="-2663.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1564" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1742.3852,-2721.8546C1707.3486,-2711.2321 1657.3972,-2695.7813 1614,-2681.2043 1609.6517,-2679.7437 1605.1065,-2678.1716 1600.6048,-2676.5862"/>
<polygon fill="#000000" stroke="#000000" points="1601.5075,-2673.1923 1590.9128,-2673.1328 1599.1579,-2679.7863 1601.5075,-2673.1923"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1655" cy="-2663.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1655" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1757.3766,-2719.0461C1736.5856,-2707.7056 1708.7908,-2692.5448 1687.4091,-2680.882"/>
<polygon fill="#000000" stroke="#000000" points="1688.8366,-2677.6738 1678.3816,-2675.9579 1685.4846,-2683.8191 1688.8366,-2677.6738"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2663.2043" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1787" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;28</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2717.0357C1787,-2709.3353 1787,-2700.1787 1787,-2691.6209"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2691.6175 1787,-2681.6176 1783.5001,-2691.6176 1790.5001,-2691.6175"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="2066" cy="-2663.2043" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2066" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 30&#45;32</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1834.9618,-2722.8271C1881.7022,-2710.765 1952.9893,-2692.3683 2004.0105,-2679.2016"/>
<polygon fill="#000000" stroke="#000000" points="2005.1231,-2682.5292 2013.9312,-2676.6414 2003.3739,-2675.7513 2005.1231,-2682.5292"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2663.2043" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2593" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 35&#45;223</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1849.5748,-2729.6145C1995.3393,-2716.5933 2357.1653,-2684.2714 2516.0774,-2670.0758"/>
<polygon fill="#000000" stroke="#000000" points="2516.5979,-2673.5433 2526.2468,-2669.1674 2515.975,-2666.5711 2516.5979,-2673.5433"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="7307" cy="-2663.2043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7307" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 281&#45;316</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.8377,-2734.3456C2426.4627,-2726.8635 6570.374,-2672.8125 7221.1088,-2664.3246"/>
<polygon fill="#000000" stroke="#000000" points="7221.3907,-2667.8213 7231.3442,-2664.1911 7221.2993,-2660.8219 7221.3907,-2667.8213"/>
</g>
<!-- section_11 -->
<g id="node12" class="node">
<title>section_11</title>
<ellipse fill="none" stroke="#000000" cx="11890" cy="-2663.2043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="11890" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 383&#45;450</text>
</g>
<!-- section_1&#45;&gt;section_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;section_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.8447,-2734.7351C2671.9167,-2728.8979 10873.0109,-2670.452 11804.0846,-2663.8166"/>
<polygon fill="#000000" stroke="#000000" points="11804.4045,-2667.3145 11814.3793,-2663.7432 11804.3545,-2660.3147 11804.4045,-2667.3145"/>
</g>
<!-- section_12 -->
<g id="node13" class="node">
<title>section_12</title>
<ellipse fill="none" stroke="#000000" cx="15218" cy="-2663.2043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="15218" y="-2659.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 471&#45;541</text>
</g>
<!-- section_1&#45;&gt;section_12 -->
<g id="edge12" class="edge">
<title>section_1&#45;&gt;section_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.6648,-2734.8625C2495.4669,-2731.515 7731.6302,-2704.2183 11974,-2681.2043 13229.0835,-2674.3957 14757.3061,-2665.8008 15132.0392,-2663.6891"/>
<polygon fill="#000000" stroke="#000000" points="15132.2817,-2667.1879 15142.2618,-2663.6315 15132.2422,-2660.188 15132.2817,-2667.1879"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1209.5,-2538.5041 1116.5,-2538.5041 1116.5,-2502.5041 1209.5,-2502.5041 1209.5,-2538.5041"/>
<text text-anchor="middle" x="1163" y="-2517.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>header_2&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1167.3667,-2645.1312C1166.5186,-2620.9247 1165.0044,-2577.7102 1164.001,-2549.073"/>
<polygon fill="#000000" stroke="#000000" points="1167.492,-2548.7525 1163.6439,-2538.8812 1160.4963,-2548.9977 1167.492,-2548.7525"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="1255" cy="-2520.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1255" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_3&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1328.1396,-2648.5399C1316.2278,-2638.4994 1301.2132,-2624.3085 1291,-2609.2043 1278.2561,-2590.3576 1268.8474,-2566.3033 1262.8511,-2548.0001"/>
<polygon fill="#000000" stroke="#000000" points="1266.1211,-2546.7301 1259.7935,-2538.2324 1259.4408,-2548.8213 1266.1211,-2546.7301"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="1327" cy="-2520.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1327" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_4&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1435.7492,-2654.1614C1413.3647,-2645.7106 1382.6832,-2631.0804 1363,-2609.2043 1347.5243,-2592.0045 1338.2339,-2567.2795 1332.9783,-2548.3007"/>
<polygon fill="#000000" stroke="#000000" points="1336.324,-2547.2564 1330.4599,-2538.4325 1329.5414,-2548.9874 1336.324,-2547.2564"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1399" cy="-2520.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1399" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_5&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1535.8995,-2654.276C1502.5599,-2643.2104 1449.641,-2624.0056 1435,-2609.2043 1418.5545,-2592.5787 1409.3113,-2567.4318 1404.3215,-2548.154"/>
<polygon fill="#000000" stroke="#000000" points="1407.7263,-2547.343 1402.0261,-2538.4123 1400.9129,-2548.9484 1407.7263,-2547.343"/>
</g>
<!-- raw_20 -->
<g id="node21" class="node">
<title>raw_20</title>
<ellipse fill="none" stroke="#000000" cx="1471" cy="-2520.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1471" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_20 -->
<g id="edge20" class="edge">
<title>prose_6&#45;&gt;raw_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1627.639,-2653.2991C1585.0229,-2637.8607 1507.5705,-2609.7548 1507,-2609.2043 1490.1717,-2592.9662 1480.9666,-2567.7808 1476.0886,-2548.3898"/>
<polygon fill="#000000" stroke="#000000" points="1479.4886,-2547.557 1473.8587,-2538.5818 1472.6628,-2549.1089 1479.4886,-2547.557"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2057.5,-2609.4049 1516.5,-2609.4049 1516.5,-2431.6033 2057.5,-2431.6033 2057.5,-2609.4049"/>
<text text-anchor="middle" x="1787" y="-2594.0043" font-family="Inconsolata" font-size="14.00" fill="#000000">local Txtbuf &#160;= require &quot;txtbuf&quot;</text>
<text text-anchor="middle" x="1787" y="-2578.6043" font-family="Inconsolata" font-size="14.00" fill="#000000">local Rainbuf = require &quot;rainbuf&quot;</text>
<text text-anchor="middle" x="1787" y="-2563.2042" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1787" y="-2547.8042" font-family="Inconsolata" font-size="14.00" fill="#000000">local color &#160;&#160;= require &quot;color&quot;</text>
<text text-anchor="middle" x="1787" y="-2532.4042" font-family="Inconsolata" font-size="14.00" fill="#000000">local L &#160;&#160;&#160;&#160;&#160;&#160;= require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1787" y="-2517.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">local repr &#160;&#160;&#160;= require &quot;repr&quot;</text>
<text text-anchor="middle" x="1787" y="-2501.6041" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
<text text-anchor="middle" x="1787" y="-2486.2041" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub &#160;&#160;&#160;&#160;= assert (string.sub)</text>
<text text-anchor="middle" x="1787" y="-2470.8041" font-family="Inconsolata" font-size="14.00" fill="#000000">local codepoints = assert(string.codepoints, &quot;must have string.codepoints&quot;)</text>
<text text-anchor="middle" x="1787" y="-2455.404" font-family="Inconsolata" font-size="14.00" fill="#000000">local reverse = assert (table.reverse)</text>
<text text-anchor="middle" x="1787" y="-2440.004" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(meta)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_7&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2645.1312C1787,-2638.0065 1787,-2629.2351 1787,-2619.6733"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2619.4588 1787,-2609.4588 1783.5001,-2619.4589 1790.5001,-2619.4588"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2266.5,-2538.5041 2075.5,-2538.5041 2075.5,-2502.5041 2266.5,-2502.5041 2266.5,-2538.5041"/>
<text text-anchor="middle" x="2171" y="-2517.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_8&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2079.086,-2645.4198C2097.3205,-2620.6382 2130.5038,-2575.5404 2151.6149,-2546.8495"/>
<polygon fill="#000000" stroke="#000000" points="2154.6415,-2548.6417 2157.7491,-2538.5128 2149.0033,-2544.493 2154.6415,-2548.6417"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="2353" cy="-2520.5041" rx="68.6997" ry="18"/>
<text text-anchor="middle" x="2353" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Persistence</text>
</g>
<!-- section_9&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2536.8606,-2652.2231C2504.0745,-2643.9939 2462.9947,-2630.4243 2431,-2609.2043 2406.1395,-2592.7159 2384.3461,-2566.3244 2370.1616,-2546.609"/>
<polygon fill="#000000" stroke="#000000" points="2372.9813,-2544.5337 2364.3791,-2538.3488 2367.2468,-2548.5481 2372.9813,-2544.5337"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2472" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2472" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_9&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2561.079,-2647.105C2545.0381,-2637.7679 2526.2482,-2624.774 2513,-2609.2043 2497.7871,-2591.3256 2487.0412,-2566.8592 2480.378,-2548.1504"/>
<polygon fill="#000000" stroke="#000000" points="2483.61,-2546.7815 2477.0938,-2538.4274 2476.9781,-2549.0216 2483.61,-2546.7815"/>
</g>
<!-- section_26 -->
<g id="node27" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2520.5041" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2593" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 39&#45;141</text>
</g>
<!-- section_9&#45;&gt;section_26 -->
<g id="edge26" class="edge">
<title>section_9&#45;&gt;section_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593,-2645.1312C2593,-2620.9247 2593,-2577.7102 2593,-2549.073"/>
<polygon fill="#000000" stroke="#000000" points="2596.5001,-2548.8812 2593,-2538.8812 2589.5001,-2548.8812 2596.5001,-2548.8812"/>
</g>
<!-- section_27 -->
<g id="node28" class="node">
<title>section_27</title>
<ellipse fill="none" stroke="#000000" cx="2991" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="2991" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 142&#45;212</text>
</g>
<!-- section_9&#45;&gt;section_27 -->
<g id="edge27" class="edge">
<title>section_9&#45;&gt;section_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2634.0939,-2648.4704C2707.0416,-2622.3155 2858.9975,-2567.8327 2939.0663,-2539.1246"/>
<polygon fill="#000000" stroke="#000000" points="2940.7016,-2542.2565 2948.9336,-2535.5868 2938.339,-2535.6672 2940.7016,-2542.2565"/>
</g>
<!-- section_28 -->
<g id="node29" class="node">
<title>section_28</title>
<ellipse fill="none" stroke="#000000" cx="4150" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4150" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 213&#45;223</text>
</g>
<!-- section_9&#45;&gt;section_28 -->
<g id="edge28" class="edge">
<title>section_9&#45;&gt;section_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2659.9023,-2657.0727C2910.8938,-2634.0691 3796.0385,-2552.945 4069.1439,-2527.9147"/>
<polygon fill="#000000" stroke="#000000" points="4069.7341,-2531.3753 4079.3729,-2526.9772 4069.0951,-2524.4045 4069.7341,-2531.3753"/>
</g>
<!-- section_29 -->
<g id="node30" class="node">
<title>section_29</title>
<ellipse fill="none" stroke="#000000" cx="4967" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4967" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 224&#45;280</text>
</g>
<!-- section_9&#45;&gt;section_29 -->
<g id="edge29" class="edge">
<title>section_9&#45;&gt;section_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2663.6081,-2661.7055C2936.3943,-2655.7871 3921.7211,-2633.1905 4234,-2609.2043 4475.9649,-2590.619 4760.9261,-2551.0126 4892.9608,-2531.6405"/>
<polygon fill="#000000" stroke="#000000" points="4893.5814,-2535.0869 4902.9653,-2530.1683 4892.5623,-2528.1615 4893.5814,-2535.0869"/>
</g>
<!-- header_99 -->
<g id="node100" class="node">
<title>header_99</title>
<ellipse fill="none" stroke="#000000" cx="7108" cy="-2520.5041" rx="107.339" ry="18"/>
<text text-anchor="middle" x="7108" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_10&#45;&gt;header_99 -->
<g id="edge99" class="edge">
<title>section_10&#45;&gt;header_99</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7280.1096,-2646.1354C7263.9556,-2635.724 7243.0927,-2621.9987 7225,-2609.2043 7195.1577,-2588.101 7162.039,-2562.8102 7138.6768,-2544.6437"/>
<polygon fill="#000000" stroke="#000000" points="7140.5732,-2541.6841 7130.5353,-2538.2941 7136.2682,-2547.2038 7140.5732,-2541.6841"/>
</g>
<!-- prose_100 -->
<g id="node101" class="node">
<title>prose_100</title>
<ellipse fill="none" stroke="#000000" cx="7266" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7266" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_100 -->
<g id="edge100" class="edge">
<title>section_10&#45;&gt;prose_100</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7301.8073,-2645.1312C7294.7834,-2620.6845 7282.1892,-2576.8507 7273.9646,-2548.2247"/>
<polygon fill="#000000" stroke="#000000" points="7277.2759,-2547.0751 7271.1505,-2538.4305 7270.5481,-2549.0082 7277.2759,-2547.0751"/>
</g>
<!-- prose_101 -->
<g id="node102" class="node">
<title>prose_101</title>
<ellipse fill="none" stroke="#000000" cx="7348" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7348" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_101 -->
<g id="edge101" class="edge">
<title>section_10&#45;&gt;prose_101</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7312.1927,-2645.1312C7319.2166,-2620.6845 7331.8108,-2576.8507 7340.0354,-2548.2247"/>
<polygon fill="#000000" stroke="#000000" points="7343.4519,-2549.0082 7342.8495,-2538.4305 7336.7241,-2547.0751 7343.4519,-2549.0082"/>
</g>
<!-- section_102 -->
<g id="node103" class="node">
<title>section_102</title>
<ellipse fill="none" stroke="#000000" cx="7939" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7939" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 291&#45;316</text>
</g>
<!-- section_10&#45;&gt;section_102 -->
<g id="edge102" class="edge">
<title>section_10&#45;&gt;section_102</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7361.9803,-2650.7902C7478.5006,-2624.4809 7749.7814,-2563.2281 7874.3555,-2535.1003"/>
<polygon fill="#000000" stroke="#000000" points="7875.1641,-2538.5059 7884.1476,-2532.8893 7873.6223,-2531.6778 7875.1641,-2538.5059"/>
</g>
<!-- section_103 -->
<g id="node104" class="node">
<title>section_103</title>
<ellipse fill="none" stroke="#000000" cx="9471" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="9471" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 317&#45;382</text>
</g>
<!-- section_10&#45;&gt;section_103 -->
<g id="edge103" class="edge">
<title>section_10&#45;&gt;section_103</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7379.9292,-2658.3952C7707.3683,-2636.8029 9040.8362,-2548.8703 9388.0338,-2525.9752"/>
<polygon fill="#000000" stroke="#000000" points="9388.2682,-2529.4674 9398.0162,-2525.3169 9387.8076,-2522.4826 9388.2682,-2529.4674"/>
</g>
<!-- header_151 -->
<g id="node152" class="node">
<title>header_151</title>
<ellipse fill="none" stroke="#000000" cx="10547" cy="-2520.5041" rx="107.339" ry="18"/>
<text text-anchor="middle" x="10547" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_11&#45;&gt;header_151 -->
<g id="edge151" class="edge">
<title>section_11&#45;&gt;header_151</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11814.62,-2661.2333C11576.8151,-2654.7932 10852.0489,-2633.3897 10749,-2609.2043 10689.326,-2595.1989 10625.3205,-2564.0407 10585.7191,-2542.6484"/>
<polygon fill="#000000" stroke="#000000" points="10587.3761,-2539.5655 10576.9227,-2537.8399 10584.0184,-2545.7076 10587.3761,-2539.5655"/>
</g>
<!-- prose_152 -->
<g id="node153" class="node">
<title>prose_152</title>
<ellipse fill="none" stroke="#000000" cx="10790" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="10790" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_152 -->
<g id="edge152" class="edge">
<title>section_11&#45;&gt;prose_152</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11823.6673,-2654.5991C11618.6809,-2628.0068 10999.1204,-2547.6328 10831.9482,-2525.946"/>
<polygon fill="#000000" stroke="#000000" points="10831.9675,-2522.4192 10821.6003,-2524.6036 10831.0669,-2529.3611 10831.9675,-2522.4192"/>
</g>
<!-- prose_153 -->
<g id="node154" class="node">
<title>prose_153</title>
<ellipse fill="none" stroke="#000000" cx="11517" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11517" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_153 -->
<g id="edge153" class="edge">
<title>section_11&#45;&gt;prose_153</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11818.1995,-2657.5531C11763.8736,-2651.1476 11688.5431,-2637.6127 11628,-2609.2043 11593.5918,-2593.0591 11560.3928,-2564.2173 11539.4116,-2543.8107"/>
<polygon fill="#000000" stroke="#000000" points="11541.8199,-2541.2698 11532.2549,-2536.7133 11536.8908,-2546.2401 11541.8199,-2541.2698"/>
</g>
<!-- prose_154 -->
<g id="node155" class="node">
<title>prose_154</title>
<ellipse fill="none" stroke="#000000" cx="11669" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11669" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_154 -->
<g id="edge154" class="edge">
<title>section_11&#45;&gt;prose_154</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11863.7805,-2646.2743C11822.384,-2619.5445 11742.134,-2567.7269 11698.6807,-2539.669"/>
<polygon fill="#000000" stroke="#000000" points="11700.5479,-2536.7085 11690.2484,-2534.2243 11696.7507,-2542.5891 11700.5479,-2536.7085"/>
</g>
<!-- prose_155 -->
<g id="node156" class="node">
<title>prose_155</title>
<ellipse fill="none" stroke="#000000" cx="11890" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11890" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_155 -->
<g id="edge155" class="edge">
<title>section_11&#45;&gt;prose_155</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11890,-2645.1312C11890,-2620.9247 11890,-2577.7102 11890,-2549.073"/>
<polygon fill="#000000" stroke="#000000" points="11893.5001,-2548.8812 11890,-2538.8812 11886.5001,-2548.8812 11893.5001,-2548.8812"/>
</g>
<!-- prose_156 -->
<g id="node157" class="node">
<title>prose_156</title>
<ellipse fill="none" stroke="#000000" cx="12090" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="12090" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_156 -->
<g id="edge156" class="edge">
<title>section_11&#45;&gt;prose_156</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11914.1247,-2645.9913C11951.215,-2619.5274 12022.0886,-2568.959 12061.6012,-2540.7667"/>
<polygon fill="#000000" stroke="#000000" points="12063.8924,-2543.4316 12069.9999,-2534.7742 12059.8266,-2537.7333 12063.8924,-2543.4316"/>
</g>
<!-- prose_157 -->
<g id="node158" class="node">
<title>prose_157</title>
<ellipse fill="none" stroke="#000000" cx="13095" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="13095" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_157 -->
<g id="edge157" class="edge">
<title>section_11&#45;&gt;prose_157</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11957.8027,-2655.1749C12178.9251,-2628.9888 12875.1177,-2546.5433 13053.1917,-2525.4552"/>
<polygon fill="#000000" stroke="#000000" points="13053.6899,-2528.9208 13063.2089,-2524.2689 13052.8666,-2521.9693 13053.6899,-2528.9208"/>
</g>
<!-- prose_158 -->
<g id="node159" class="node">
<title>prose_158</title>
<ellipse fill="none" stroke="#000000" cx="13258" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="13258" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_158 -->
<g id="edge158" class="edge">
<title>section_11&#45;&gt;prose_158</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.8598,-2662.4602C12219.1482,-2659.6248 13025.9347,-2647.6415 13136,-2609.2043 13174.9229,-2595.6116 13212.1134,-2565.1901 13234.9811,-2543.7798"/>
<polygon fill="#000000" stroke="#000000" points="13237.6506,-2546.0695 13242.4518,-2536.6249 13232.8088,-2541.014 13237.6506,-2546.0695"/>
</g>
<!-- codeblock_159 -->
<g id="node160" class="node">
<title>codeblock_159</title>
<ellipse fill="none" stroke="#000000" cx="13529" cy="-2520.5041" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="13529" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 404&#45;448</text>
</g>
<!-- section_11&#45;&gt;codeblock_159 -->
<g id="edge159" class="edge">
<title>section_11&#45;&gt;codeblock_159</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.2824,-2661.7677C12238.4587,-2656.3555 13168.33,-2636.1269 13299,-2609.2043 13367.0916,-2595.175 13441.3788,-2563.2347 13486.5812,-2541.7633"/>
<polygon fill="#000000" stroke="#000000" points="13488.2726,-2544.8338 13495.7728,-2537.3506 13485.2431,-2538.5233 13488.2726,-2544.8338"/>
</g>
<!-- section_160 -->
<g id="node161" class="node">
<title>section_160</title>
<ellipse fill="none" stroke="#000000" cx="14356" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="14356" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 451&#45;470</text>
</g>
<!-- section_11&#45;&gt;section_160 -->
<g id="edge160" class="edge">
<title>section_11&#45;&gt;section_160</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.64,-2661.7542C12255.4342,-2656.0582 13295.2092,-2634.2943 13625,-2609.2043 13866.3277,-2590.8445 14150.5003,-2551.1301 14282.1675,-2531.6864"/>
<polygon fill="#000000" stroke="#000000" points="14282.7649,-2535.1362 14292.1442,-2530.2087 14281.7393,-2528.2117 14282.7649,-2535.1362"/>
</g>
<!-- header_196 -->
<g id="node197" class="node">
<title>header_196</title>
<ellipse fill="none" stroke="#000000" cx="14815" cy="-2520.5041" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="14815" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_12&#45;&gt;header_196 -->
<g id="edge196" class="edge">
<title>section_12&#45;&gt;header_196</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15147.8659,-2656.3578C15092.7537,-2649.2585 15014.8955,-2635.3748 14951,-2609.2043 14911.2202,-2592.9112 14870.5743,-2564.5545 14844.2098,-2544.2881"/>
<polygon fill="#000000" stroke="#000000" points="14846.2086,-2541.4084 14836.1709,-2538.0179 14841.9034,-2546.928 14846.2086,-2541.4084"/>
</g>
<!-- prose_197 -->
<g id="node198" class="node">
<title>prose_197</title>
<ellipse fill="none" stroke="#000000" cx="14992" cy="-2520.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="14992" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_197 -->
<g id="edge197" class="edge">
<title>section_12&#45;&gt;prose_197</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15186.9098,-2646.6035C15167.9222,-2636.2472 15143.2828,-2622.4166 15122,-2609.2043 15086.1284,-2586.9353 15046.1945,-2559.2307 15020.1734,-2540.7671"/>
<polygon fill="#000000" stroke="#000000" points="15022.0841,-2537.831 15011.9083,-2534.881 15018.0235,-2543.5329 15022.0841,-2537.831"/>
</g>
<!-- codeblock_198 -->
<g id="node199" class="node">
<title>codeblock_198</title>
<ellipse fill="none" stroke="#000000" cx="15218" cy="-2520.5041" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15218" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 473&#45;487</text>
</g>
<!-- section_12&#45;&gt;codeblock_198 -->
<g id="edge198" class="edge">
<title>section_12&#45;&gt;codeblock_198</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15218,-2645.1312C15218,-2620.9247 15218,-2577.7102 15218,-2549.073"/>
<polygon fill="#000000" stroke="#000000" points="15221.5001,-2548.8812 15218,-2538.8812 15214.5001,-2548.8812 15221.5001,-2548.8812"/>
</g>
<!-- section_199 -->
<g id="node200" class="node">
<title>section_199</title>
<ellipse fill="none" stroke="#000000" cx="15667" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="15667" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 490&#45;522</text>
</g>
<!-- section_12&#45;&gt;section_199 -->
<g id="edge199" class="edge">
<title>section_12&#45;&gt;section_199</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15263.5234,-2648.7362C15346.5789,-2622.3396 15522.3761,-2566.4682 15611.9855,-2537.9887"/>
<polygon fill="#000000" stroke="#000000" points="15613.2202,-2541.2689 15621.6904,-2534.9043 15611.1,-2534.5977 15613.2202,-2541.2689"/>
</g>
<!-- section_200 -->
<g id="node201" class="node">
<title>section_200</title>
<ellipse fill="none" stroke="#000000" cx="16476" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="16476" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 523&#45;541</text>
</g>
<!-- section_12&#45;&gt;section_200 -->
<g id="edge200" class="edge">
<title>section_12&#45;&gt;section_200</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15288.3201,-2656.5492C15390.3379,-2646.7877 15585.315,-2627.7307 15751,-2609.2043 15987.7383,-2582.7329 16267.432,-2547.3483 16399.5598,-2530.386"/>
<polygon fill="#000000" stroke="#000000" points="16400.1101,-2533.8442 16409.5826,-2529.0983 16399.218,-2526.9012 16400.1101,-2533.8442"/>
</g>
<!-- section_201 -->
<g id="node202" class="node">
<title>section_201</title>
<ellipse fill="none" stroke="#000000" cx="17599" cy="-2520.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="17599" y="-2516.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 542&#45;576</text>
</g>
<!-- section_12&#45;&gt;section_201 -->
<g id="edge201" class="edge">
<title>section_12&#45;&gt;section_201</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15293.3609,-2661.3596C15497.458,-2656.1068 16077.9857,-2639.4617 16560,-2609.2043 16918.5144,-2586.6994 17345.4589,-2545.7935 17519.3736,-2528.5314"/>
<polygon fill="#000000" stroke="#000000" points="17519.8585,-2532.0005 17529.4632,-2527.5283 17519.166,-2525.0349 17519.8585,-2532.0005"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-2096.3045 0,-2096.3045 0,-2024.5022 324,-2024.5022 324,-2096.3045"/>
<text text-anchor="middle" x="162" y="-2032.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1253.1032,-2502.3162C1249.8547,-2481.4103 1241.1428,-2447.9146 1218,-2431.804 1137.2294,-2375.5763 415.8563,-2448.9102 333,-2395.804 230.2535,-2329.9492 186.4189,-2181.7341 170.2181,-2106.3335"/>
<polygon fill="#000000" stroke="#000000" points="173.5726,-2105.2729 168.1122,-2096.1935 166.7188,-2106.6963 173.5726,-2105.2729"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-2087.7037 342.5,-2087.7037 342.5,-2033.1029 897.5,-2033.1029 897.5,-2087.7037"/>
<text text-anchor="middle" x="620" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1325.162,-2502.5407C1322.0084,-2481.8508 1313.5389,-2448.5628 1291,-2431.804 1222.2217,-2380.6637 983.0916,-2435.2482 907,-2395.804 774.4895,-2327.1135 677.4926,-2168.82 638.6665,-2097.0127"/>
<polygon fill="#000000" stroke="#000000" points="641.5879,-2095.0529 633.7907,-2087.8797 635.4127,-2098.3496 641.5879,-2095.0529"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-2087.7037 916,-2087.7037 916,-2033.1029 1464,-2033.1029 1464,-2087.7037"/>
<text text-anchor="middle" x="1190" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1392.2205,-2503.0599C1385.1681,-2485.094 1373.6836,-2456.3356 1363,-2431.804 1309.1304,-2308.1091 1240.1185,-2163.8295 1207.9736,-2097.3691"/>
<polygon fill="#000000" stroke="#000000" points="1211.013,-2095.6149 1203.5047,-2088.1399 1204.7127,-2098.6656 1211.013,-2095.6149"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-2095.7037 1482,-2095.7037 1482,-2025.103 2030,-2025.103 2030,-2095.7037"/>
<text text-anchor="middle" x="1756" y="-2064.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new txtbuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-2049.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_20&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>raw_20&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1477.0096,-2502.6885C1483.4488,-2484.4269 1494.4528,-2455.4368 1507,-2431.804 1573.3284,-2306.8735 1671.3779,-2171.6354 1722.3929,-2104.0502"/>
<polygon fill="#000000" stroke="#000000" points="1725.4273,-2105.8408 1728.6744,-2095.7557 1719.8469,-2101.6147 1725.4273,-2105.8408"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2162,-2078.4033 2048,-2078.4033 2048,-2042.4033 2162,-2042.4033 2162,-2078.4033"/>
<text text-anchor="middle" x="2105" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Persistence</text>
</g>
<!-- header_24&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>header_24&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2341.5813,-2502.7189C2327.9609,-2482.8255 2303.4301,-2450.896 2275,-2431.804 2234.3935,-2404.5349 2203.1024,-2432.7083 2171,-2395.804 2093.1266,-2306.2822 2096.6335,-2152.0154 2101.9048,-2088.7375"/>
<polygon fill="#000000" stroke="#000000" points="2105.3975,-2088.9761 2102.822,-2078.6991 2098.4266,-2088.3391 2105.3975,-2088.9761"/>
</g>
<!-- raw_31 -->
<g id="node32" class="node">
<title>raw_31</title>
<ellipse fill="none" stroke="#000000" cx="2207" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="2207" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_31 -->
<g id="edge31" class="edge">
<title>prose_25&#45;&gt;raw_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2468.7564,-2502.4889C2464.0944,-2482.0718 2453.4541,-2449.3573 2431,-2431.804 2363.9759,-2379.4084 2300.6313,-2458.3832 2243,-2395.804 2163.3058,-2309.2677 2186.5148,-2152.023 2200.2041,-2088.3202"/>
<polygon fill="#000000" stroke="#000000" points="2203.6926,-2088.7585 2202.4626,-2078.2353 2196.8618,-2087.2287 2203.6926,-2088.7585"/>
</g>
<!-- header_33 -->
<g id="node34" class="node">
<title>header_33</title>
<ellipse fill="none" stroke="#000000" cx="2331" cy="-2060.4033" rx="78.8488" ry="18"/>
<text text-anchor="middle" x="2331" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : SQLite battery</text>
</g>
<!-- section_26&#45;&gt;header_33 -->
<g id="edge33" class="edge">
<title>section_26&#45;&gt;header_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2580.8142,-2502.5447C2566.5962,-2482.7934 2541.3855,-2451.2792 2513,-2431.804 2476.1109,-2406.4944 2448.8609,-2429.1162 2419,-2395.804 2338.6619,-2306.1803 2330.1351,-2151.9707 2330.2537,-2088.7228"/>
<polygon fill="#000000" stroke="#000000" points="2333.7537,-2088.7221 2330.3488,-2078.6893 2326.754,-2088.6557 2333.7537,-2088.7221"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="2460" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2460" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_26&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_26&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2575.525,-2502.8781C2554.2294,-2480.2172 2518.9912,-2438.6559 2502,-2395.804 2459.4411,-2288.4705 2457.4918,-2148.0025 2458.869,-2088.7342"/>
<polygon fill="#000000" stroke="#000000" points="2462.3703,-2088.7342 2459.1558,-2078.6388 2455.3731,-2088.5353 2462.3703,-2088.7342"/>
</g>
<!-- codeblock_35 -->
<g id="node36" class="node">
<title>codeblock_35</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2060.4033" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2593" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 41&#45;139</text>
</g>
<!-- section_26&#45;&gt;codeblock_35 -->
<g id="edge35" class="edge">
<title>section_26&#45;&gt;codeblock_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593,-2502.4676C2593,-2432.0438 2593,-2175.2445 2593,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="2596.5001,-2088.8151 2593,-2078.8151 2589.5001,-2088.8151 2596.5001,-2088.8151"/>
</g>
<!-- header_40 -->
<g id="node41" class="node">
<title>header_40</title>
<ellipse fill="none" stroke="#000000" cx="2776" cy="-2060.4033" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2776" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:load()</text>
</g>
<!-- section_27&#45;&gt;header_40 -->
<g id="edge40" class="edge">
<title>section_27&#45;&gt;header_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2967.9163,-2503.2886C2940.1315,-2481.3555 2893.9781,-2440.8488 2868,-2395.804 2808.5067,-2292.6455 2786.077,-2149.3652 2778.9137,-2089.0111"/>
<polygon fill="#000000" stroke="#000000" points="2782.3529,-2088.2769 2777.7483,-2078.7351 2775.3975,-2089.0658 2782.3529,-2088.2769"/>
</g>
<!-- prose_41 -->
<g id="node42" class="node">
<title>prose_41</title>
<ellipse fill="none" stroke="#000000" cx="2909" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2909" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_41 -->
<g id="edge41" class="edge">
<title>section_27&#45;&gt;prose_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2983.7344,-2502.2299C2974.4759,-2478.2052 2958.6399,-2434.505 2950,-2395.804 2924.9637,-2283.6584 2914.2369,-2146.7701 2910.5793,-2088.6569"/>
<polygon fill="#000000" stroke="#000000" points="2914.0581,-2088.1996 2909.9583,-2078.4302 2907.071,-2088.624 2914.0581,-2088.1996"/>
</g>
<!-- prose_42 -->
<g id="node43" class="node">
<title>prose_42</title>
<ellipse fill="none" stroke="#000000" cx="2991" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2991" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_42 -->
<g id="edge42" class="edge">
<title>section_27&#45;&gt;prose_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2991,-2502.4676C2991,-2432.0438 2991,-2175.2445 2991,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="2994.5001,-2088.8151 2991,-2078.8151 2987.5001,-2088.8151 2994.5001,-2088.8151"/>
</g>
<!-- structure_43 -->
<g id="node44" class="node">
<title>structure_43</title>
<ellipse fill="none" stroke="#000000" cx="3086" cy="-2060.4033" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3086" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_27&#45;&gt;structure_43 -->
<g id="edge43" class="edge">
<title>section_27&#45;&gt;structure_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2998.0398,-2502.1772C3007.0541,-2478.0956 3022.6265,-2434.3339 3032,-2395.804 3059.3085,-2283.552 3076.4411,-2146.7201 3082.9823,-2088.6393"/>
<polygon fill="#000000" stroke="#000000" points="3086.4921,-2088.7432 3084.1149,-2078.4185 3079.5347,-2087.9722 3086.4921,-2088.7432"/>
</g>
<!-- prose_44 -->
<g id="node45" class="node">
<title>prose_44</title>
<ellipse fill="none" stroke="#000000" cx="3181" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3181" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_44 -->
<g id="edge44" class="edge">
<title>section_27&#45;&gt;prose_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3022.1226,-2504.0802C3057.2279,-2483.74 3112.9408,-2445.5962 3140,-2395.804 3195.3759,-2293.9052 3189.675,-2149.367 3184.2058,-2088.8147"/>
<polygon fill="#000000" stroke="#000000" points="3187.6556,-2088.1282 3183.2021,-2078.5149 3180.6886,-2088.8072 3187.6556,-2088.1282"/>
</g>
<!-- codeblock_45 -->
<g id="node46" class="node">
<title>codeblock_45</title>
<ellipse fill="none" stroke="#000000" cx="3400" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3400" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 156&#45;210</text>
</g>
<!-- section_27&#45;&gt;codeblock_45 -->
<g id="edge45" class="edge">
<title>section_27&#45;&gt;codeblock_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3034.9978,-2505.6893C3085.4277,-2486.8606 3168.0524,-2450.1353 3222,-2395.804 3314.6456,-2302.4994 3370.9803,-2150.98 3391.345,-2088.6033"/>
<polygon fill="#000000" stroke="#000000" points="3394.7995,-2089.2922 3394.5183,-2078.7011 3388.1334,-2087.1559 3394.7995,-2089.2922"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="3909" cy="-2060.4033" rx="190.9667" ry="18"/>
<text text-anchor="middle" x="3909" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:restore_session(modeS, session)</text>
</g>
<!-- section_28&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_28&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4140.5525,-2502.4676C4103.5144,-2431.7569 3968.0562,-2173.1494 3923.3926,-2087.8807"/>
<polygon fill="#000000" stroke="#000000" points="3926.3845,-2086.0495 3918.6441,-2078.8151 3920.1837,-2089.2975 3926.3845,-2086.0495"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4150" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4150" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_28&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_28&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4150,-2502.4676C4150,-2432.0438 4150,-2175.2445 4150,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="4153.5001,-2088.8151 4150,-2078.8151 4146.5001,-2088.8151 4153.5001,-2088.8151"/>
</g>
<!-- prose_59 -->
<g id="node60" class="node">
<title>prose_59</title>
<ellipse fill="none" stroke="#000000" cx="4232" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4232" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_28&#45;&gt;prose_59 -->
<g id="edge59" class="edge">
<title>section_28&#45;&gt;prose_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4157.2656,-2502.2299C4166.5241,-2478.2052 4182.3601,-2434.505 4191,-2395.804 4216.0363,-2283.6584 4226.7631,-2146.7701 4230.4207,-2088.6569"/>
<polygon fill="#000000" stroke="#000000" points="4233.929,-2088.624 4231.0417,-2078.4302 4226.9419,-2088.1996 4233.929,-2088.624"/>
</g>
<!-- codeblock_60 -->
<g id="node61" class="node">
<title>codeblock_60</title>
<ellipse fill="none" stroke="#000000" cx="4370" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4370" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 219&#45;221</text>
</g>
<!-- section_28&#45;&gt;codeblock_60 -->
<g id="edge60" class="edge">
<title>section_28&#45;&gt;codeblock_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4172.981,-2503.2289C4200.6623,-2481.2357 4246.7114,-2440.6683 4273,-2395.804 4333.439,-2292.6582 4358.3249,-2149.3711 4366.5662,-2089.0131"/>
<polygon fill="#000000" stroke="#000000" points="4370.0838,-2089.1071 4367.9162,-2078.7364 4363.1435,-2088.1953 4370.0838,-2089.1071"/>
</g>
<!-- header_67 -->
<g id="node68" class="node">
<title>header_67</title>
<ellipse fill="none" stroke="#000000" cx="4674" cy="-2060.4033" rx="113.1277" ry="18"/>
<text text-anchor="middle" x="4674" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:persist(txtbuf)</text>
</g>
<!-- section_29&#45;&gt;header_67 -->
<g id="edge67" class="edge">
<title>section_29&#45;&gt;header_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4934.3235,-2504.2176C4896.3544,-2483.7543 4834.1749,-2445.2461 4797,-2395.804 4722.985,-2297.365 4689.7868,-2149.8328 4678.6176,-2088.6003"/>
<polygon fill="#000000" stroke="#000000" points="4682.0256,-2087.7724 4676.8399,-2078.5335 4675.1323,-2088.9898 4682.0256,-2087.7724"/>
</g>
<!-- prose_68 -->
<g id="node69" class="node">
<title>prose_68</title>
<ellipse fill="none" stroke="#000000" cx="4838" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4838" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_68 -->
<g id="edge68" class="edge">
<title>section_29&#45;&gt;prose_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4950.0909,-2502.7717C4929.4867,-2480.001 4895.3994,-2438.3265 4879,-2395.804 4837.4678,-2288.114 4835.5577,-2147.8375 4836.8981,-2088.6769"/>
<polygon fill="#000000" stroke="#000000" points="4840.3989,-2088.6937 4837.1773,-2078.6005 4833.4015,-2088.4997 4840.3989,-2088.6937"/>
</g>
<!-- prose_69 -->
<g id="node70" class="node">
<title>prose_69</title>
<ellipse fill="none" stroke="#000000" cx="4920" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4920" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_69 -->
<g id="edge69" class="edge">
<title>section_29&#45;&gt;prose_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4965.1575,-2502.4676C4957.9636,-2432.0438 4931.7312,-2175.2445 4922.9137,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="4926.379,-2088.4076 4921.8808,-2078.8151 4919.4152,-2089.119 4926.379,-2088.4076"/>
</g>
<!-- structure_70 -->
<g id="node71" class="node">
<title>structure_70</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-2060.4033" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="5015" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_29&#45;&gt;structure_70 -->
<g id="edge70" class="edge">
<title>section_29&#45;&gt;structure_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4968.8817,-2502.4676C4976.2286,-2432.0438 5003.0192,-2175.2445 5012.0243,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="5015.5226,-2089.1243 5013.0792,-2078.8151 5008.5604,-2088.3979 5015.5226,-2089.1243"/>
</g>
<!-- prose_71 -->
<g id="node72" class="node">
<title>prose_71</title>
<ellipse fill="none" stroke="#000000" cx="5590" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5590" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_71 -->
<g id="edge71" class="edge">
<title>section_29&#45;&gt;prose_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4990.2853,-2503.3074C5087.0789,-2431.8229 5457.4474,-2158.2967 5562.2322,-2080.9105"/>
<polygon fill="#000000" stroke="#000000" points="5564.463,-2083.6141 5570.4278,-2074.8578 5560.3044,-2077.9832 5564.463,-2083.6141"/>
</g>
<!-- prose_72 -->
<g id="node73" class="node">
<title>prose_72</title>
<ellipse fill="none" stroke="#000000" cx="5818" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5818" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_72 -->
<g id="edge72" class="edge">
<title>section_29&#45;&gt;prose_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5038.7197,-2514.6994C5190.2143,-2501.2344 5536.6379,-2463.7285 5631,-2395.804 5740.1722,-2317.2187 5793.4174,-2154.1614 5811.0774,-2088.6022"/>
<polygon fill="#000000" stroke="#000000" points="5814.5515,-2089.1516 5813.6994,-2078.5911 5807.7799,-2087.378 5814.5515,-2089.1516"/>
</g>
<!-- codeblock_73 -->
<g id="node74" class="node">
<title>codeblock_73</title>
<ellipse fill="none" stroke="#000000" cx="6111" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6111" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 243&#45;278</text>
</g>
<!-- section_29&#45;&gt;codeblock_73 -->
<g id="edge73" class="edge">
<title>section_29&#45;&gt;codeblock_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5041.6247,-2517.3696C5230.2019,-2508.3116 5720.6766,-2477.3465 5859,-2395.804 5986.415,-2320.692 6070.2578,-2153.691 6099.4789,-2087.8506"/>
<polygon fill="#000000" stroke="#000000" points="6102.7517,-2089.1018 6103.5458,-2078.5368 6096.3365,-2086.3006 6102.7517,-2089.1018"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="1892,-961.5029 1554,-961.5029 1554,-905.6999 1892,-905.6999 1892,-961.5029"/>
<text text-anchor="middle" x="1723" y="-914.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">This defines the persistence model for bridge.</text>
</g>
<!-- raw_31&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>raw_31&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2211.759,-2042.3614C2225.325,-1986.39 2257.8633,-1814.1209 2171,-1725.0027 2086.5001,-1638.3091 1990.729,-1770.272 1901,-1689.0027 1687.0333,-1495.2087 1706.5371,-1096.6721 1718.5873,-971.8504"/>
<polygon fill="#000000" stroke="#000000" points="1722.0953,-971.9463 1719.616,-961.6457 1715.1306,-971.2442 1722.0953,-971.9463"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2052,-951.6014 1910,-951.6014 1910,-915.6014 2052,-915.6014 2052,-951.6014"/>
<text text-anchor="middle" x="1981" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** SQLite battery</text>
</g>
<!-- header_33&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>header_33&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2332.3128,-2042.2335C2335.3036,-1985.8882 2336.1868,-1812.6446 2243,-1725.0027 2182.9351,-1668.5118 2116.6304,-1749.8654 2061,-1689.0027 1865.3212,-1474.9191 1946.8104,-1071.1584 1973.6615,-961.6197"/>
<polygon fill="#000000" stroke="#000000" points="1977.1181,-962.224 1976.1499,-951.6736 1970.3274,-960.5251 1977.1181,-962.224"/>
</g>
<!-- raw_37 -->
<g id="node38" class="node">
<title>raw_37</title>
<ellipse fill="none" stroke="#000000" cx="2097" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2097" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_37 -->
<g id="edge37" class="edge">
<title>prose_34&#45;&gt;raw_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2464.4725,-2042.2908C2477.1527,-1986.1133 2506.9889,-1813.3069 2419,-1725.0027 2328.5718,-1634.2504 2220.0084,-1783.0387 2133,-1689.0027 2033.3521,-1581.3063 2080.2615,-1085.8639 2093.7761,-961.8202"/>
<polygon fill="#000000" stroke="#000000" points="2097.2831,-961.9489 2094.9036,-951.6247 2090.3256,-961.1794 2097.2831,-961.9489"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2690,-1688.9039 2142,-1688.9039 2142,-178.2988 2690,-178.2988 2690,-1688.9039"/>
<text text-anchor="middle" x="2416" y="-1673.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 2000</text>
<text text-anchor="middle" x="2416" y="-1642.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_project_table = [[</text>
<text text-anchor="middle" x="2416" y="-1627.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS project (</text>
<text text-anchor="middle" x="2416" y="-1611.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">project_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1596.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">directory TEXT UNIQUE,</text>
<text text-anchor="middle" x="2416" y="-1580.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP );</text>
<text text-anchor="middle" x="2416" y="-1565.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1534.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2416" y="-1518.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS repl (</text>
<text text-anchor="middle" x="2416" y="-1503.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1487.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">project INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1472.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2416" y="-1457.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP,</text>
<text text-anchor="middle" x="2416" y="-1441.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (project)</text>
<text text-anchor="middle" x="2416" y="-1426.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES project (project_id)</text>
<text text-anchor="middle" x="2416" y="-1410.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-1395.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1364.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_result_table = [[</text>
<text text-anchor="middle" x="2416" y="-1348.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS result (</text>
<text text-anchor="middle" x="2416" y="-1333.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">result_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1317.802" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1302.402" font-family="Inconsolata" font-size="14.00" fill="#000000">repr text NOT NULL,</text>
<text text-anchor="middle" x="2416" y="-1287.002" font-family="Inconsolata" font-size="14.00" fill="#000000">value blob,</text>
<text text-anchor="middle" x="2416" y="-1271.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (line_id)</text>
<text text-anchor="middle" x="2416" y="-1256.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES repl (line_id)</text>
<text text-anchor="middle" x="2416" y="-1240.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-1225.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1194.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_session_table = [[</text>
<text text-anchor="middle" x="2416" y="-1178.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS session (</text>
<text text-anchor="middle" x="2416" y="-1163.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">session_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1147.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">name TEXT,</text>
<text text-anchor="middle" x="2416" y="-1132.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">project INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1117.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; These two are line_ids</text>
<text text-anchor="middle" x="2416" y="-1101.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">start INTEGER NOT NULL,</text>
<text text-anchor="middle" x="2416" y="-1086.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">end INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1070.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">test BOOLEAN,</text>
<text text-anchor="middle" x="2416" y="-1055.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">sha TEXT,</text>
<text text-anchor="middle" x="2416" y="-1040.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (project)</text>
<text text-anchor="middle" x="2416" y="-1024.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES project (project_id)</text>
<text text-anchor="middle" x="2416" y="-1009.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-993.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-962.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line = [[</text>
<text text-anchor="middle" x="2416" y="-947.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES (:project, :line);</text>
<text text-anchor="middle" x="2416" y="-931.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-900.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_result = [[</text>
<text text-anchor="middle" x="2416" y="-884.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO result (line_id, repr) VALUES (:line_id, :repr);</text>
<text text-anchor="middle" x="2416" y="-869.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-838.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_project = [[</text>
<text text-anchor="middle" x="2416" y="-822.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO project (directory) VALUES (:dir);</text>
<text text-anchor="middle" x="2416" y="-807.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2416" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2416" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-713.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2416" y="-698.201" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT CAST (line_id AS REAL), line FROM repl</text>
<text text-anchor="middle" x="2416" y="-682.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %d</text>
<text text-anchor="middle" x="2416" y="-667.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2416" y="-652.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2416" y="-636.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-605.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_project = [[</text>
<text text-anchor="middle" x="2416" y="-589.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT project_id FROM project</text>
<text text-anchor="middle" x="2416" y="-574.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE directory = %s;</text>
<text text-anchor="middle" x="2416" y="-559.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-527.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_results = [[</text>
<text text-anchor="middle" x="2416" y="-512.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT result.repr</text>
<text text-anchor="middle" x="2416" y="-496.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">FROM result</text>
<text text-anchor="middle" x="2416" y="-481.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">WHERE result.line_id = :line_id</text>
<text text-anchor="middle" x="2416" y="-466.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">ORDER BY result.result_id;</text>
<text text-anchor="middle" x="2416" y="-450.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-419.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-387.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local bridge_home = io.popen(&quot;echo $BRIDGE_HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-372.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.bridge_home = bridge_home ~= &quot;&quot; and bridge_home</text>
<text text-anchor="middle" x="2416" y="-357.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or home_dir .. &quot;/.bridge&quot;</text>
<text text-anchor="middle" x="2416" y="-325.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-294.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2416" y="-278.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2416" y="-263.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2416" y="-248.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2416" y="-232.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2416" y="-217.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2416" y="-201.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2416" y="-186.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_35&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>codeblock_35&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2590.1481,-2042.2475C2582.6949,-1994.8001 2561.4576,-1859.6009 2536.26,-1699.1904"/>
<polygon fill="#000000" stroke="#000000" points="2539.6817,-1698.4178 2534.6722,-1689.0821 2532.7665,-1699.5042 2539.6817,-1698.4178"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="1954,-125.1 1900,-125.1 1900,-89.1 1954,-89.1 1954,-125.1"/>
</g>
<!-- raw_37&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>raw_37&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2098.7261,-915.5749C2108.2066,-812.6766 2150.3428,-299.9194 2061,-178.2001 2033.5436,-140.7938 2002.2547,-166.9419 1963,-142.2001 1958.5,-139.3638 1954.1025,-135.889 1950.0137,-132.2403"/>
<polygon fill="#000000" stroke="#000000" points="1952.2302,-129.517 1942.5855,-125.1317 1947.3904,-134.5743 1952.2302,-129.517"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="2864,-951.6014 2708,-951.6014 2708,-915.6014 2864,-915.6014 2864,-951.6014"/>
<text text-anchor="middle" x="2786" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:load()</text>
</g>
<!-- header_40&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>header_40&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2776.1611,-2042.2475C2777.3154,-1912.1832 2784.3216,-1122.7229 2785.747,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="2789.2509,-961.6772 2785.8399,-951.6465 2782.2512,-961.6151 2789.2509,-961.6772"/>
</g>
<!-- raw_47 -->
<g id="node48" class="node">
<title>raw_47</title>
<ellipse fill="none" stroke="#000000" cx="2909" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2909" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_41&#45;&gt;raw_47 -->
<g id="edge47" class="edge">
<title>prose_41&#45;&gt;raw_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2909,-2042.2475C2909,-1912.1832 2909,-1122.7229 2909,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="2912.5001,-961.6465 2909,-951.6465 2905.5001,-961.6466 2912.5001,-961.6465"/>
</g>
<!-- raw_49 -->
<g id="node50" class="node">
<title>raw_49</title>
<ellipse fill="none" stroke="#000000" cx="2981" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2981" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_42&#45;&gt;raw_49 -->
<g id="edge49" class="edge">
<title>prose_42&#45;&gt;raw_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2990.8389,-2042.2475C2989.6846,-1912.1832 2982.6784,-1122.7229 2981.253,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="2984.7488,-961.6151 2981.1601,-951.6465 2977.7491,-961.6772 2984.7488,-961.6151"/>
</g>
<!-- hashline_51 -->
<g id="node52" class="node">
<title>hashline_51</title>
<ellipse fill="none" stroke="#000000" cx="3069" cy="-933.6014" rx="43.0992" ry="18"/>
<text text-anchor="middle" x="3069" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashline</text>
</g>
<!-- structure_43&#45;&gt;hashline_51 -->
<g id="edge51" class="edge">
<title>structure_43&#45;&gt;hashline_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3085.7261,-2042.2475C3083.7638,-1912.1832 3071.8533,-1122.7229 3069.4301,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="3072.9228,-961.5926 3069.2722,-951.6465 3065.9236,-961.6982 3072.9228,-961.5926"/>
</g>
<!-- raw_54 -->
<g id="node55" class="node">
<title>raw_54</title>
<ellipse fill="none" stroke="#000000" cx="3157" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="3157" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_44&#45;&gt;raw_54 -->
<g id="edge54" class="edge">
<title>prose_44&#45;&gt;raw_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3180.6133,-2042.2475C3177.843,-1912.1832 3161.0281,-1122.7229 3157.6071,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="3161.0966,-961.5697 3157.3843,-951.6465 3154.0982,-961.7188 3161.0966,-961.5697"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="3757.5,-1345.903 3202.5,-1345.903 3202.5,-521.2997 3757.5,-521.2997 3757.5,-1345.903"/>
<text text-anchor="middle" x="3480" y="-1330.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="3480" y="-1315.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.bridge_home)</text>
<text text-anchor="middle" x="3480" y="-1300.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="3480" y="-1284.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Set up bridge tables</text>
<text text-anchor="middle" x="3480" y="-1269.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn.pragma.foreign_keys(true)</text>
<text text-anchor="middle" x="3480" y="-1253.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_project_table)</text>
<text text-anchor="middle" x="3480" y="-1238.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_result_table)</text>
<text text-anchor="middle" x="3480" y="-1223.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_repl_table)</text>
<text text-anchor="middle" x="3480" y="-1207.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_session_table)</text>
<text text-anchor="middle" x="3480" y="-1192.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Retrive project id</text>
<text text-anchor="middle" x="3480" y="-1176.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local proj_val, proj_row = sql.pexec(conn,</text>
<text text-anchor="middle" x="3480" y="-1161.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.format(get_project, historian.project),</text>
<text text-anchor="middle" x="3480" y="-1146.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-1130.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not proj_val then</text>
<text text-anchor="middle" x="3480" y="-1115.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local ins_proj_stmt = conn:prepare(insert_project)</text>
<text text-anchor="middle" x="3480" y="-1099.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;ins_proj_stmt:bindkv {dir = historian.project}</text>
<text text-anchor="middle" x="3480" y="-1084.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;proj_val, proj_row = ins_proj_stmt:step()</text>
<text text-anchor="middle" x="3480" y="-1069.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; retry</text>
<text text-anchor="middle" x="3480" y="-1053.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;proj_val, proj_row = sql.pexec(conn,</text>
<text text-anchor="middle" x="3480" y="-1038.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.format(get_project, historian.project),</text>
<text text-anchor="middle" x="3480" y="-1022.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-1007.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not proj_val then</text>
<text text-anchor="middle" x="3480" y="-992.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error &quot;Could not create project in .bridge&quot;</text>
<text text-anchor="middle" x="3480" y="-976.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-961.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local project_id = proj_val[1][1]</text>
<text text-anchor="middle" x="3480" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.project_id = project_id</text>
<text text-anchor="middle" x="3480" y="-899.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Create insert prepared statements</text>
<text text-anchor="middle" x="3480" y="-883.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_line = conn:prepare(insert_line)</text>
<text text-anchor="middle" x="3480" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_result = conn:prepare(insert_result)</text>
<text text-anchor="middle" x="3480" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Create result retrieval prepared statement</text>
<text text-anchor="middle" x="3480" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.get_results = conn:prepare(get_results)</text>
<text text-anchor="middle" x="3480" y="-822.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Retrieve history</text>
<text text-anchor="middle" x="3480" y="-806.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_str = sql.format(get_recent, project_id,</text>
<text text-anchor="middle" x="3480" y="-791.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="3480" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local repl_val &#160;= sql.pexec(conn, pop_str, &quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if repl_val then</text>
<text text-anchor="middle" x="3480" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local lines = reverse(repl_val[2])</text>
<text text-anchor="middle" x="3480" y="-729.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local line_ids = reverse(repl_val[1])</text>
<text text-anchor="middle" x="3480" y="-714.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.line_ids = line_ids</text>
<text text-anchor="middle" x="3480" y="-698.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local repl_map = {}</text>
<text text-anchor="middle" x="3480" y="-683.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i, v in ipairs(lines) do</text>
<text text-anchor="middle" x="3480" y="-668.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local buf = Txtbuf(v)</text>
<text text-anchor="middle" x="3480" y="-652.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = buf</text>
<text text-anchor="middle" x="3480" y="-637.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repl_map[line_ids[i]] = buf</text>
<text text-anchor="middle" x="3480" y="-621.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-606.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="3480" y="-591.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="3480" y="-575.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.results = {}</text>
<text text-anchor="middle" x="3480" y="-560.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = 0</text>
<text text-anchor="middle" x="3480" y="-544.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-529.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_45&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_45&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3401.289,-2042.2475C3406.9493,-1962.5216 3430.1999,-1635.0367 3449.9756,-1356.4954"/>
<polygon fill="#000000" stroke="#000000" points="3453.4901,-1356.4146 3450.7072,-1346.1918 3446.5077,-1355.9188 3453.4901,-1356.4146"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="2492,-135.0015 1972,-135.0015 1972,-79.1986 2492,-79.1986 2492,-135.0015"/>
<text text-anchor="middle" x="2232" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Brings up the project history and results, and (eventually) user config.</text>
</g>
<!-- raw_47&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>raw_47&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2911.1445,-915.5329C2923.092,-811.299 2977.2391,-287.6602 2873,-178.2001 2844.3623,-148.1281 2542.2611,-146.8872 2501,-142.2001 2484.1789,-140.2893 2466.7782,-138.223 2449.2921,-136.0827"/>
<polygon fill="#000000" stroke="#000000" points="2449.3432,-132.5627 2438.9905,-134.8146 2448.4879,-139.5102 2449.3432,-132.5627"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="3009.5,-134.4005 2510.5,-134.4005 2510.5,-79.7996 3009.5,-79.7996 3009.5,-134.4005"/>
<text text-anchor="middle" x="2760" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">Most of the complexity serves to make a simple key/value relationship</text>
<text text-anchor="middle" x="2760" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">between the regenerated txtbufs and their associated result history.</text>
</g>
<!-- raw_49&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>raw_49&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2982.698,-915.5954C2992.0222,-812.8109 3033.4349,-300.5806 2945,-178.2001 2934.6841,-163.9245 2903.0334,-149.6961 2868.7612,-137.7602"/>
<polygon fill="#000000" stroke="#000000" points="2869.6352,-134.3606 2859.0408,-134.4563 2867.3825,-140.9883 2869.6352,-134.3606"/>
</g>
<!-- hashtag_52 -->
<g id="node53" class="node">
<title>hashtag_52</title>
<ellipse fill="none" stroke="#000000" cx="3069" cy="-107.1" rx="41.6544" ry="18"/>
<text text-anchor="middle" x="3069" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashtag</text>
</g>
<!-- hashline_51&#45;&gt;hashtag_52 -->
<g id="edge52" class="edge">
<title>hashline_51&#45;&gt;hashtag_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3069,-915.5701C3069,-809.3734 3069,-265.6725 3069,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="3072.5001,-135.2475 3069,-125.2475 3065.5001,-135.2476 3072.5001,-135.2475"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3096,-36 3042,-36 3042,0 3096,0 3096,-36"/>
<text text-anchor="middle" x="3069" y="-14.5" font-family="Inconsolata" font-size="14.00" fill="#000000">todo</text>
</g>
<!-- hashtag_52&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>hashtag_52&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3069,-89.0693C3069,-76.7509 3069,-60.1792 3069,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="3072.5001,-46.0039 3069,-36.0039 3065.5001,-46.0039 3072.5001,-46.0039"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="3333.5,-127.0021 3128.5,-127.0021 3128.5,-87.198 3333.5,-87.198 3333.5,-127.0021"/>
<text text-anchor="middle" x="3231" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">the results never get used.</text>
</g>
<!-- raw_54&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>raw_54&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3154.9992,-915.5806C3146.1608,-830.6978 3114.4241,-462.9719 3193,-178.2001 3197.1041,-163.3263 3204.7204,-148.0776 3212.0628,-135.5352"/>
<polygon fill="#000000" stroke="#000000" points="3215.0945,-137.2861 3217.3068,-126.9248 3209.116,-133.645 3215.0945,-137.2861"/>
</g>
<!-- leaf_61 -->
<g id="node62" class="node">
<title>leaf_61</title>
<polygon fill="none" stroke="#c0c0c0" points="4106.5,-951.6014 3775.5,-951.6014 3775.5,-915.6014 4106.5,-915.6014 4106.5,-951.6014"/>
<text text-anchor="middle" x="3941" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:restore_session(modeS, session)</text>
</g>
<!-- header_57&#45;&gt;leaf_61 -->
<g id="edge61" class="edge">
<title>header_57&#45;&gt;leaf_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3909.5156,-2042.2475C3913.2093,-1912.1832 3935.6291,-1122.7229 3940.1905,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="3943.7022,-961.7419 3940.4875,-951.6465 3936.705,-961.5431 3943.7022,-961.7419"/>
</g>
<!-- raw_62 -->
<g id="node63" class="node">
<title>raw_62</title>
<ellipse fill="none" stroke="#000000" cx="4152" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4152" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_62 -->
<g id="edge62" class="edge">
<title>prose_58&#45;&gt;raw_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4150.0322,-2042.2475C4150.2631,-1912.1832 4151.6643,-1122.7229 4151.9494,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4155.4501,-961.6528 4151.968,-951.6465 4148.4501,-961.6403 4155.4501,-961.6528"/>
</g>
<!-- raw_64 -->
<g id="node65" class="node">
<title>raw_64</title>
<ellipse fill="none" stroke="#000000" cx="4229" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4229" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_59&#45;&gt;raw_64 -->
<g id="edge64" class="edge">
<title>prose_59&#45;&gt;raw_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4231.9517,-2042.2475C4231.6054,-1912.1832 4229.5035,-1122.7229 4229.0759,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4232.5748,-961.6372 4229.048,-951.6465 4225.5748,-961.6559 4232.5748,-961.6372"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="4397,-951.6014 4343,-951.6014 4343,-915.6014 4397,-915.6014 4397,-951.6014"/>
</g>
<!-- codeblock_60&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_60&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4370,-2042.2475C4370,-1912.1832 4370,-1122.7229 4370,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4373.5001,-961.6465 4370,-951.6465 4366.5001,-961.6466 4373.5001,-961.6465"/>
</g>
<!-- leaf_63 -->
<g id="node64" class="node">
<title>leaf_63</title>
<polygon fill="none" stroke="#c0c0c0" points="3718,-135.0015 3352,-135.0015 3352,-79.1986 3718,-79.1986 3718,-135.0015"/>
<text text-anchor="middle" x="3535" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">If there is an open session, we want to replay it.</text>
</g>
<!-- raw_62&#45;&gt;leaf_63 -->
<g id="edge63" class="edge">
<title>raw_62&#45;&gt;leaf_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4154.1251,-915.5248C4165.9603,-811.245 4219.5342,-287.3918 4115,-178.2001 4085.0592,-146.9253 3769.8926,-148.0989 3727,-142.2001 3714.6828,-140.5062 3701.9522,-138.5768 3689.1797,-136.5142"/>
<polygon fill="#000000" stroke="#000000" points="3689.3693,-132.9986 3678.9346,-134.8335 3688.2361,-139.9063 3689.3693,-132.9986"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="4081.5,-127.0021 3736.5,-127.0021 3736.5,-87.198 4081.5,-87.198 4081.5,-127.0021"/>
<text text-anchor="middle" x="3909" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">To do this, we need to borrow the modeselektor.</text>
</g>
<!-- raw_64&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>raw_64&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4234.7337,-915.8851C4262.8641,-825.258 4377.4666,-408.8201 4188,-178.2001 4176.806,-164.5747 4093.1798,-144.3671 4020.3752,-128.9738"/>
<polygon fill="#000000" stroke="#000000" points="4020.6883,-125.4633 4010.1826,-126.8349 4019.2506,-132.3141 4020.6883,-125.4633"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="4783.5,-951.6014 4564.5,-951.6014 4564.5,-915.6014 4783.5,-915.6014 4783.5,-951.6014"/>
<text text-anchor="middle" x="4674" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:persist(txtbuf)</text>
</g>
<!-- header_67&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>header_67&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4674,-2042.2475C4674,-1912.1832 4674,-1122.7229 4674,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4677.5001,-961.6465 4674,-951.6465 4670.5001,-961.6466 4677.5001,-961.6465"/>
</g>
<!-- raw_75 -->
<g id="node76" class="node">
<title>raw_75</title>
<ellipse fill="none" stroke="#000000" cx="4834" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4834" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_68&#45;&gt;raw_75 -->
<g id="edge75" class="edge">
<title>prose_68&#45;&gt;raw_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4837.9355,-2042.2475C4837.4738,-1912.1832 4834.6714,-1122.7229 4834.1012,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4837.5996,-961.634 4834.0641,-951.6465 4830.5997,-961.6589 4837.5996,-961.634"/>
</g>
<!-- raw_77 -->
<g id="node78" class="node">
<title>raw_77</title>
<ellipse fill="none" stroke="#000000" cx="4913" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4913" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_69&#45;&gt;raw_77 -->
<g id="edge77" class="edge">
<title>prose_69&#45;&gt;raw_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4919.8872,-2042.2475C4919.0792,-1912.1832 4914.1749,-1122.7229 4913.1771,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="4916.6743,-961.6246 4913.1121,-951.6465 4909.6744,-961.6681 4916.6743,-961.6246"/>
</g>
<!-- hashline_79 -->
<g id="node80" class="node">
<title>hashline_79</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-933.6014" rx="43.0992" ry="18"/>
<text text-anchor="middle" x="5015" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashline</text>
</g>
<!-- structure_70&#45;&gt;hashline_79 -->
<g id="edge79" class="edge">
<title>structure_70&#45;&gt;hashline_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-2042.2475C5015,-1912.1832 5015,-1122.7229 5015,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-961.6465 5015,-951.6465 5011.5001,-961.6466 5018.5001,-961.6465"/>
</g>
<!-- raw_82 -->
<g id="node83" class="node">
<title>raw_82</title>
<ellipse fill="none" stroke="#000000" cx="5300" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5300" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_82 -->
<g id="edge82" class="edge">
<title>prose_71&#45;&gt;raw_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5578.7398,-2043.521C5545.3479,-1992.5503 5446.3782,-1834.7565 5401,-1689.0027 5315.7017,-1415.0262 5302.4403,-1063.1252 5300.3792,-961.9493"/>
<polygon fill="#000000" stroke="#000000" points="5303.8731,-961.5798 5300.1914,-951.6453 5296.8743,-961.7074 5303.8731,-961.5798"/>
</g>
<!-- prespace_83 -->
<g id="node84" class="node">
<title>prespace_83</title>
<ellipse fill="none" stroke="#000000" cx="5456" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5456" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_71&#45;&gt;prespace_83 -->
<g id="edge83" class="edge">
<title>prose_71&#45;&gt;prespace_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5585.3245,-2042.3906C5571.6414,-1988.9284 5531.4222,-1826.3258 5512,-1689.0027 5472.1496,-1407.2435 5459.657,-1062.0919 5456.7451,-962.0248"/>
<polygon fill="#000000" stroke="#000000" points="5460.2379,-961.7178 5456.457,-951.8206 5453.2407,-961.9154 5460.2379,-961.7178"/>
</g>
<!-- literal_84 -->
<g id="node85" class="node">
<title>literal_84</title>
<ellipse fill="none" stroke="#000000" cx="5552" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5552" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_71&#45;&gt;literal_84 -->
<g id="edge84" class="edge">
<title>prose_71&#45;&gt;literal_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5589.3877,-2042.2475C5585.0015,-1912.1832 5558.3779,-1122.7229 5552.9613,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="5556.4437,-961.5229 5552.6086,-951.6465 5549.4477,-961.7589 5556.4437,-961.5229"/>
</g>
<!-- raw_85 -->
<g id="node86" class="node">
<title>raw_85</title>
<ellipse fill="none" stroke="#000000" cx="5628" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5628" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_85 -->
<g id="edge85" class="edge">
<title>prose_71&#45;&gt;raw_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5590.6123,-2042.2475C5594.9985,-1912.1832 5621.6221,-1122.7229 5627.0387,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="5630.5523,-961.7589 5627.3914,-951.6465 5623.5563,-961.5229 5630.5523,-961.7589"/>
</g>
<!-- prespace_86 -->
<g id="node87" class="node">
<title>prespace_86</title>
<ellipse fill="none" stroke="#000000" cx="5719" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5719" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_71&#45;&gt;prespace_86 -->
<g id="edge86" class="edge">
<title>prose_71&#45;&gt;prespace_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5594.4209,-2042.3736C5607.3616,-1988.8646 5645.4176,-1826.1463 5664,-1689.0027 5702.2043,-1407.0434 5715.1191,-1062.03 5718.2011,-962.0104"/>
<polygon fill="#000000" stroke="#000000" points="5721.7056,-961.9116 5718.5071,-951.8111 5714.7087,-961.7017 5721.7056,-961.9116"/>
</g>
<!-- literal_87 -->
<g id="node88" class="node">
<title>literal_87</title>
<ellipse fill="none" stroke="#000000" cx="5815" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5815" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_71&#45;&gt;literal_87 -->
<g id="edge87" class="edge">
<title>prose_71&#45;&gt;literal_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5601.7211,-2043.2597C5635.9025,-1992.1884 5735.4839,-1835.4966 5774,-1689.0027 5846.4272,-1413.5296 5825.5653,-1062.6677 5817.4956,-961.8445"/>
<polygon fill="#000000" stroke="#000000" points="5820.9589,-961.2549 5816.6476,-951.5769 5813.9826,-961.8311 5820.9589,-961.2549"/>
</g>
<!-- raw_88 -->
<g id="node89" class="node">
<title>raw_88</title>
<ellipse fill="none" stroke="#000000" cx="5891" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5891" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_88 -->
<g id="edge88" class="edge">
<title>prose_71&#45;&gt;raw_88</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5595.4856,-2042.5981C5613.1189,-1988.0381 5673.3254,-1821.0629 5777,-1725.0027 5805.0068,-1699.0528 5833.6624,-1720.6647 5855,-1689.0027 5936.8199,-1567.593 5903.4036,-1084.4201 5893.4355,-961.9391"/>
<polygon fill="#000000" stroke="#000000" points="5896.9138,-961.532 5892.6008,-951.8548 5889.9377,-962.1095 5896.9138,-961.532"/>
</g>
<!-- raw_96 -->
<g id="node97" class="node">
<title>raw_96</title>
<ellipse fill="none" stroke="#000000" cx="5963" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5963" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_72&#45;&gt;raw_96 -->
<g id="edge96" class="edge">
<title>prose_72&#45;&gt;raw_96</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5824.8835,-2042.5966C5844.9673,-1989.7009 5903.5505,-1828.4989 5927,-1689.0027 5974.1503,-1408.515 5967.2812,-1061.8108 5964.0531,-961.8039"/>
<polygon fill="#000000" stroke="#000000" points="5967.5445,-961.4894 5963.7084,-951.6135 5960.5485,-961.7261 5967.5445,-961.4894"/>
</g>
<!-- leaf_98 -->
<g id="node99" class="node">
<title>leaf_98</title>
<polygon fill="none" stroke="#c0c0c0" points="6521.5,-1199.8024 6008.5,-1199.8024 6008.5,-667.4003 6521.5,-667.4003 6521.5,-1199.8024"/>
<text text-anchor="middle" x="6265" y="-1184.5019" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = table.concat</text>
<text text-anchor="middle" x="6265" y="-1169.1019" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, txtbuf, results)</text>
<text text-anchor="middle" x="6265" y="-1153.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(txtbuf)</text>
<text text-anchor="middle" x="6265" y="-1138.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if lb ~= &quot;&quot; then</text>
<text text-anchor="middle" x="6265" y="-1122.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_line:bindkv { project = historian.project_id,</text>
<text text-anchor="middle" x="6265" y="-1107.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;line &#160;&#160;&#160;= lb }</text>
<text text-anchor="middle" x="6265" y="-1092.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local err = historian.insert_line:step()</text>
<text text-anchor="middle" x="6265" y="-1076.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not err then</text>
<text text-anchor="middle" x="6265" y="-1061.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_line:clearbind():reset()</text>
<text text-anchor="middle" x="6265" y="-1045.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6265" y="-1030.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="6265" y="-1015.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-999.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local line_id = sql.lastRowId(historian.conn)</text>
<text text-anchor="middle" x="6265" y="-984.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;table.insert(historian.line_ids, line_id)</text>
<text text-anchor="middle" x="6265" y="-968.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if results and type(results) == &quot;table&quot; then</text>
<text text-anchor="middle" x="6265" y="-953.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="6265" y="-938.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; insert result repr</text>
<text text-anchor="middle" x="6265" y="-922.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local res = results[i]</text>
<text text-anchor="middle" x="6265" y="-907.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_result:bindkv { line_id = line_id,</text>
<text text-anchor="middle" x="6265" y="-891.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repr = repr.ts(res) }</text>
<text text-anchor="middle" x="6265" y="-876.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;err = historian.insert_result:step()</text>
<text text-anchor="middle" x="6265" y="-861.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if not err then</text>
<text text-anchor="middle" x="6265" y="-845.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_result:clearbind():reset()</text>
<text text-anchor="middle" x="6265" y="-830.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-814.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-799.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-768.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="6265" y="-752.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6265" y="-737.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; A blank line can have no results and is uninteresting.</text>
<text text-anchor="middle" x="6265" y="-721.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="6265" y="-706.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-691.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;]]</text>
<text text-anchor="middle" x="6265" y="-675.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_73&#45;&gt;leaf_98 -->
<g id="edge98" class="edge">
<title>codeblock_73&#45;&gt;leaf_98</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6113.4813,-2042.2475C6126.3774,-1947.8883 6186.7056,-1506.4734 6227.238,-1209.9019"/>
<polygon fill="#000000" stroke="#000000" points="6230.7249,-1210.2351 6228.6114,-1199.8533 6223.7894,-1209.2872 6230.7249,-1210.2351"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="4374.5,-135.0015 4099.5,-135.0015 4099.5,-79.1986 4374.5,-79.1986 4374.5,-135.0015"/>
<text text-anchor="middle" x="4237" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Persists a line and results to store.</text>
</g>
<!-- raw_75&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>raw_75&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4836.003,-915.5082C4847.1341,-811.1353 4897.1755,-286.8468 4792,-178.2001 4760.3465,-145.5019 4428.9195,-149.5044 4384,-142.2001 4374.6777,-140.6842 4365.0706,-138.9007 4355.4432,-136.9547"/>
<polygon fill="#000000" stroke="#000000" points="4355.9169,-133.4785 4345.4142,-134.8724 4354.4938,-140.3323 4355.9169,-133.4785"/>
</g>
<!-- leaf_78 -->
<g id="node79" class="node">
<title>leaf_78</title>
<polygon fill="none" stroke="#c0c0c0" points="4955,-142.3004 4393,-142.3004 4393,-71.8997 4955,-71.8997 4955,-142.3004"/>
<text text-anchor="middle" x="4674" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">The hooks are in place to persist the results. I&#39;m starting with a string</text>
<text text-anchor="middle" x="4674" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">representation; the goal is to provide the sense of persistence across</text>
<text text-anchor="middle" x="4674" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">sessions, and supplement that over time with better and better approximations.</text>
</g>
<!-- raw_77&#45;&gt;leaf_78 -->
<g id="edge78" class="edge">
<title>raw_77&#45;&gt;leaf_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4914.5505,-915.5583C4923.0297,-812.5674 4960.1934,-299.3815 4870,-178.2001 4861.4936,-166.7711 4839.6861,-155.6481 4813.5619,-145.7236"/>
<polygon fill="#000000" stroke="#000000" points="4814.7497,-142.4313 4804.1562,-142.2646 4812.3336,-149.0011 4814.7497,-142.4313"/>
</g>
<!-- hashtag_80 -->
<g id="node81" class="node">
<title>hashtag_80</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-107.1" rx="41.6544" ry="18"/>
<text text-anchor="middle" x="5015" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashtag</text>
</g>
<!-- hashline_79&#45;&gt;hashtag_80 -->
<g id="edge80" class="edge">
<title>hashline_79&#45;&gt;hashtag_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-915.5701C5015,-809.3734 5015,-265.6725 5015,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-135.2475 5015,-125.2475 5011.5001,-135.2476 5018.5001,-135.2475"/>
</g>
<!-- leaf_81 -->
<g id="node82" class="node">
<title>leaf_81</title>
<polygon fill="none" stroke="#c0c0c0" points="5042,-36 4988,-36 4988,0 5042,0 5042,-36"/>
<text text-anchor="middle" x="5015" y="-14.5" font-family="Inconsolata" font-size="14.00" fill="#000000">todo</text>
</g>
<!-- hashtag_80&#45;&gt;leaf_81 -->
<g id="edge81" class="edge">
<title>hashtag_80&#45;&gt;leaf_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-89.0693C5015,-76.7509 5015,-60.1792 5015,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-46.0039 5015,-36.0039 5011.5001,-46.0039 5018.5001,-46.0039"/>
</g>
<!-- leaf_89 -->
<g id="node90" class="node">
<title>leaf_89</title>
<polygon fill="none" stroke="#c0c0c0" points="5461.5,-127.0021 5074.5,-127.0021 5074.5,-87.198 5461.5,-87.198 5461.5,-127.0021"/>
<text text-anchor="middle" x="5268" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">parsing. &#160;General&#45;purpose persistence tools belong in</text>
</g>
<!-- raw_82&#45;&gt;leaf_89 -->
<g id="edge89" class="edge">
<title>raw_82&#45;&gt;leaf_89</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5299.3019,-915.5701C5295.2124,-809.9474 5274.3666,-271.5375 5269.1731,-137.3995"/>
<polygon fill="#000000" stroke="#000000" points="5272.6573,-136.9208 5268.7729,-127.0637 5265.6625,-137.1917 5272.6573,-136.9208"/>
</g>
<!-- leaf_90 -->
<g id="node91" class="node">
<title>leaf_90</title>
<polygon fill="none" stroke="#c0c0c0" points="5534,-125.1 5480,-125.1 5480,-89.1 5534,-89.1 5534,-125.1"/>
<text text-anchor="middle" x="5507" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_83&#45;&gt;leaf_90 -->
<g id="edge90" class="edge">
<title>prespace_83&#45;&gt;leaf_90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5457.1126,-915.5701C5463.6656,-809.3734 5497.2151,-265.6725 5505.2631,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5508.7576,-135.4441 5505.8802,-125.2475 5501.7709,-135.013 5508.7576,-135.4441"/>
</g>
<!-- leaf_91 -->
<g id="node92" class="node">
<title>leaf_91</title>
<polygon fill="none" stroke="#c0c0c0" points="5617.5,-125.1 5552.5,-125.1 5552.5,-89.1 5617.5,-89.1 5617.5,-125.1"/>
<text text-anchor="middle" x="5585" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">sqlayer</text>
</g>
<!-- literal_84&#45;&gt;leaf_91 -->
<g id="edge91" class="edge">
<title>literal_84&#45;&gt;leaf_91</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5552.7199,-915.5701C5556.9601,-809.3734 5578.6686,-265.6725 5583.8761,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5587.3736,-135.3792 5584.2754,-125.2475 5580.3792,-135.0999 5587.3736,-135.3792"/>
</g>
<!-- leaf_92 -->
<g id="node93" class="node">
<title>leaf_92</title>
<polygon fill="none" stroke="#c0c0c0" points="5904,-126.4006 5636,-126.4006 5636,-87.7995 5904,-87.7995 5904,-126.4006"/>
<text text-anchor="middle" x="5770" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">, which will</text>
<text text-anchor="middle" x="5770" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">merge with our increasingly&#45;modified</text>
</g>
<!-- raw_85&#45;&gt;leaf_92 -->
<g id="edge92" class="edge">
<title>raw_85&#45;&gt;leaf_92</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5626.7197,-915.5459C5619.8022,-813.5649 5589.8717,-309.5515 5664,-178.2001 5675.2862,-158.2016 5694.8045,-142.7433 5714.041,-131.4263"/>
<polygon fill="#000000" stroke="#000000" points="5715.806,-134.4495 5722.8289,-126.5166 5712.3919,-128.3385 5715.806,-134.4495"/>
</g>
<!-- leaf_93 -->
<g id="node94" class="node">
<title>leaf_93</title>
<polygon fill="none" stroke="#c0c0c0" points="5976,-125.1 5922,-125.1 5922,-89.1 5976,-89.1 5976,-125.1"/>
<text text-anchor="middle" x="5949" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_86&#45;&gt;leaf_93 -->
<g id="edge93" class="edge">
<title>prespace_86&#45;&gt;leaf_93</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5717.6194,-915.4033C5710.13,-811.55 5678.1759,-294.3731 5775,-178.2001 5815.582,-129.5084 5857.8033,-173.3626 5913,-142.2001 5917.8458,-139.4643 5922.5107,-135.9144 5926.7841,-132.1255"/>
<polygon fill="#000000" stroke="#000000" points="5929.231,-134.6283 5934.0083,-125.1717 5924.3764,-129.5851 5929.231,-134.6283"/>
</g>
<!-- leaf_94 -->
<g id="node95" class="node">
<title>leaf_94</title>
<polygon fill="none" stroke="#c0c0c0" points="6052,-125.1 5994,-125.1 5994,-89.1 6052,-89.1 6052,-125.1"/>
<text text-anchor="middle" x="6023" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">sqlite</text>
</g>
<!-- literal_87&#45;&gt;leaf_94 -->
<g id="edge94" class="edge">
<title>literal_87&#45;&gt;leaf_94</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5813.227,-915.4519C5803.4995,-811.8688 5760.4133,-295.9422 5855,-178.2001 5892.5469,-131.4615 5932.6171,-171.3601 5985,-142.2001 5989.9044,-139.47 5994.679,-135.9808 5999.095,-132.2659"/>
<polygon fill="#000000" stroke="#000000" points="6001.5525,-134.7621 6006.6068,-125.4506 5996.8489,-129.5779 6001.5525,-134.7621"/>
</g>
<!-- leaf_95 -->
<g id="node96" class="node">
<title>leaf_95</title>
<polygon fill="none" stroke="#c0c0c0" points="6156,-125.1 6070,-125.1 6070,-89.1 6156,-89.1 6156,-125.1"/>
<text text-anchor="middle" x="6113" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> bindings.</text>
</g>
<!-- raw_88&#45;&gt;leaf_95 -->
<g id="edge95" class="edge">
<title>raw_88&#45;&gt;leaf_95</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5889.108,-915.4474C5878.7045,-811.8392 5832.2966,-295.7968 5927,-178.2001 5965.679,-130.171 6004.8979,-167.8011 6061,-142.2001 6067.8124,-139.0914 6074.7162,-135.1209 6081.1709,-130.9758"/>
<polygon fill="#000000" stroke="#000000" points="6083.2975,-133.7635 6089.6436,-125.2795 6079.3919,-127.9543 6083.2975,-133.7635"/>
</g>
<!-- leaf_97 -->
<g id="node98" class="node">
<title>leaf_97</title>
<polygon fill="none" stroke="#c0c0c0" points="6708,-134.4005 6174,-134.4005 6174,-79.7996 6708,-79.7996 6708,-134.4005"/>
<text text-anchor="middle" x="6441" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">Medium&#45;term goal is to hash any Lua object in a way that will resolve to a</text>
<text text-anchor="middle" x="6441" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">common value for any identical semantics.</text>
</g>
<!-- raw_96&#45;&gt;leaf_97 -->
<g id="edge97" class="edge">
<title>raw_96&#45;&gt;leaf_97</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5960.9617,-915.6309C5949.6121,-811.9487 5898.2611,-290.8899 5999,-178.2001 6007.2568,-168.9638 6116.959,-151.2874 6224.9936,-135.871"/>
<polygon fill="#000000" stroke="#000000" points="6225.6957,-139.3065 6235.1037,-134.4341 6224.7106,-132.3762 6225.6957,-139.3065"/>
</g>
<!-- leaf_104 -->
<g id="node105" class="node">
<title>leaf_104</title>
<polygon fill="none" stroke="#c0c0c0" points="7203.5,-2078.4033 7012.5,-2078.4033 7012.5,-2042.4033 7203.5,-2042.4033 7203.5,-2078.4033"/>
<text text-anchor="middle" x="7108" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_99&#45;&gt;leaf_104 -->
<g id="edge104" class="edge">
<title>header_99&#45;&gt;leaf_104</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7108,-2502.4676C7108,-2432.0438 7108,-2175.2445 7108,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="7111.5001,-2088.8151 7108,-2078.8151 7104.5001,-2088.8151 7111.5001,-2088.8151"/>
</g>
<!-- raw_105 -->
<g id="node106" class="node">
<title>raw_105</title>
<ellipse fill="none" stroke="#000000" cx="7257" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="7257" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_100&#45;&gt;raw_105 -->
<g id="edge105" class="edge">
<title>prose_100&#45;&gt;raw_105</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7265.6472,-2502.4676C7264.2696,-2432.0438 7259.2464,-2175.2445 7257.5579,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="7261.0552,-2088.7447 7257.3602,-2078.8151 7254.0565,-2088.8817 7261.0552,-2088.7447"/>
</g>
<!-- raw_107 -->
<g id="node108" class="node">
<title>raw_107</title>
<ellipse fill="none" stroke="#000000" cx="7348" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="7348" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_101&#45;&gt;raw_107 -->
<g id="edge107" class="edge">
<title>prose_101&#45;&gt;raw_107</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7348,-2502.4676C7348,-2432.0438 7348,-2175.2445 7348,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="7351.5001,-2088.8151 7348,-2078.8151 7344.5001,-2088.8151 7351.5001,-2088.8151"/>
</g>
<!-- header_109 -->
<g id="node110" class="node">
<title>header_109</title>
<ellipse fill="none" stroke="#000000" cx="7742" cy="-2060.4033" rx="58.0685" ry="18"/>
<text text-anchor="middle" x="7742" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : fuzz_patt</text>
</g>
<!-- section_102&#45;&gt;header_109 -->
<g id="edge109" class="edge">
<title>section_102&#45;&gt;header_109</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7931.2774,-2502.4676C7900.9636,-2431.6688 7789.9981,-2172.5047 7753.6288,-2087.5628"/>
<polygon fill="#000000" stroke="#000000" points="7756.8228,-2086.1303 7749.6692,-2078.3151 7750.3879,-2088.8856 7756.8228,-2086.1303"/>
</g>
<!-- prose_110 -->
<g id="node111" class="node">
<title>prose_110</title>
<ellipse fill="none" stroke="#000000" cx="7939" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7939" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_102&#45;&gt;prose_110 -->
<g id="edge110" class="edge">
<title>section_102&#45;&gt;prose_110</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7939,-2502.4676C7939,-2432.0438 7939,-2175.2445 7939,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="7942.5001,-2088.8151 7939,-2078.8151 7935.5001,-2088.8151 7942.5001,-2088.8151"/>
</g>
<!-- prose_111 -->
<g id="node112" class="node">
<title>prose_111</title>
<ellipse fill="none" stroke="#000000" cx="8322" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="8322" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_102&#45;&gt;prose_111 -->
<g id="edge111" class="edge">
<title>section_102&#45;&gt;prose_111</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7953.7794,-2502.7496C8013.0569,-2431.539 8233.6519,-2166.5366 8301.808,-2084.6602"/>
<polygon fill="#000000" stroke="#000000" points="8304.5702,-2086.8125 8308.278,-2076.8877 8299.1902,-2082.3341 8304.5702,-2086.8125"/>
</g>
<!-- codeblock_112 -->
<g id="node113" class="node">
<title>codeblock_112</title>
<ellipse fill="none" stroke="#000000" cx="8656" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="8656" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 300&#45;314</text>
</g>
<!-- section_102&#45;&gt;codeblock_112 -->
<g id="edge112" class="edge">
<title>section_102&#45;&gt;codeblock_112</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8007.0285,-2512.4726C8095.0886,-2499.5234 8250.5567,-2467.7822 8363,-2395.804 8494.8928,-2311.3756 8601.4893,-2150.5982 8640.2589,-2087.1294"/>
<polygon fill="#000000" stroke="#000000" points="8643.3024,-2088.8601 8645.4818,-2078.4918 8637.3123,-2085.2381 8643.3024,-2088.8601"/>
</g>
<!-- header_135 -->
<g id="node136" class="node">
<title>header_135</title>
<ellipse fill="none" stroke="#000000" cx="9232" cy="-2060.4033" rx="100.1229" ry="18"/>
<text text-anchor="middle" x="9232" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : __repr for collection</text>
</g>
<!-- section_103&#45;&gt;header_135 -->
<g id="edge135" class="edge">
<title>section_103&#45;&gt;header_135</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9461.6309,-2502.4676C9424.9001,-2431.7569 9290.5661,-2173.1494 9246.2732,-2087.8807"/>
<polygon fill="#000000" stroke="#000000" points="9249.2797,-2086.0759 9241.564,-2078.8151 9243.0678,-2089.3027 9249.2797,-2086.0759"/>
</g>
<!-- prose_136 -->
<g id="node137" class="node">
<title>prose_136</title>
<ellipse fill="none" stroke="#000000" cx="9471" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="9471" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_103&#45;&gt;prose_136 -->
<g id="edge136" class="edge">
<title>section_103&#45;&gt;prose_136</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9471,-2502.4676C9471,-2432.0438 9471,-2175.2445 9471,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="9474.5001,-2088.8151 9471,-2078.8151 9467.5001,-2088.8151 9474.5001,-2088.8151"/>
</g>
<!-- prose_137 -->
<g id="node138" class="node">
<title>prose_137</title>
<ellipse fill="none" stroke="#000000" cx="9586" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="9586" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_103&#45;&gt;prose_137 -->
<g id="edge137" class="edge">
<title>section_103&#45;&gt;prose_137</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9477.5515,-2502.5042C9486.1722,-2478.417 9501.4622,-2434.2682 9512,-2395.804 9542.9261,-2282.9206 9569.9311,-2145.9654 9580.8471,-2088.2131"/>
<polygon fill="#000000" stroke="#000000" points="9584.2887,-2088.8492 9582.6954,-2078.3748 9577.4091,-2087.5566 9584.2887,-2088.8492"/>
</g>
<!-- codeblock_138 -->
<g id="node139" class="node">
<title>codeblock_138</title>
<ellipse fill="none" stroke="#000000" cx="9855" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="9855" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 326&#45;380</text>
</g>
<!-- section_103&#45;&gt;codeblock_138 -->
<g id="edge138" class="edge">
<title>section_103&#45;&gt;codeblock_138</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9496.7131,-2503.5621C9529.338,-2481.2981 9586.2561,-2439.8267 9627,-2395.804 9722.3333,-2292.7989 9807.4405,-2146.8497 9840.4457,-2087.2863"/>
<polygon fill="#000000" stroke="#000000" points="9843.5326,-2088.9365 9845.2891,-2078.4883 9837.4004,-2085.5606 9843.5326,-2088.9365"/>
</g>
<!-- leaf_106 -->
<g id="node107" class="node">
<title>leaf_106</title>
<polygon fill="none" stroke="#c0c0c0" points="7052.5,-968.9017 6539.5,-968.9017 6539.5,-898.301 7052.5,-898.301 7052.5,-968.9017"/>
<text text-anchor="middle" x="6796" y="-921.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">This is a &#39;fuzzy search&#39;, that attempts to find a string containing the</text>
<text text-anchor="middle" x="6796" y="-906.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">letters of the fragment in order.</text>
</g>
<!-- raw_105&#45;&gt;leaf_106 -->
<g id="edge106" class="edge">
<title>raw_105&#45;&gt;leaf_106</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7260.8715,-2042.273C7271.5737,-1986.7769 7295.5289,-1817.394 7212,-1725.0027 7165.7316,-1673.8252 7112.2395,-1735.2024 7061,-1689.0027 6844.4261,-1493.7303 6804.8479,-1111.1111 6797.6163,-979.4178"/>
<polygon fill="#000000" stroke="#000000" points="6801.1041,-979.0872 6797.0971,-969.2793 6794.1133,-979.4453 6801.1041,-979.0872"/>
</g>
<!-- leaf_108 -->
<g id="node109" class="node">
<title>leaf_108</title>
<polygon fill="none" stroke="#c0c0c0" points="7625.5,-976.8017 7070.5,-976.8017 7070.5,-890.401 7625.5,-890.401 7625.5,-976.8017"/>
<text text-anchor="middle" x="7348" y="-945.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">If it finds nothing, it switches the last two letters and tries again. This</text>
<text text-anchor="middle" x="7348" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">is an affordance for incremental searches, it&#39;s easy to make this mistake and</text>
<text text-anchor="middle" x="7348" y="-914.7014" font-family="Inconsolata" font-size="14.00" fill="#000000">harmless to suggest the alternative.</text>
</g>
<!-- raw_107&#45;&gt;leaf_108 -->
<g id="edge108" class="edge">
<title>raw_107&#45;&gt;leaf_108</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7348,-2042.2475C7348,-1917.9459 7348,-1191.3846 7348,-987.0468"/>
<polygon fill="#000000" stroke="#000000" points="7351.5001,-986.8678 7348,-976.8678 7344.5001,-986.8679 7351.5001,-986.8678"/>
</g>
<!-- leaf_113 -->
<g id="node114" class="node">
<title>leaf_113</title>
<polygon fill="none" stroke="#c0c0c0" points="7750.5,-951.6014 7643.5,-951.6014 7643.5,-915.6014 7750.5,-915.6014 7750.5,-951.6014"/>
<text text-anchor="middle" x="7697" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** fuzz_patt</text>
</g>
<!-- header_109&#45;&gt;leaf_113 -->
<g id="edge113" class="edge">
<title>header_109&#45;&gt;leaf_113</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7741.2749,-2042.2475C7736.0807,-1912.1832 7704.5528,-1122.7229 7698.1384,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="7701.617,-961.4989 7697.7207,-951.6465 7694.6226,-961.7783 7701.617,-961.4989"/>
</g>
<!-- raw_114 -->
<g id="node115" class="node">
<title>raw_114</title>
<ellipse fill="none" stroke="#000000" cx="7796" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="7796" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_110&#45;&gt;raw_114 -->
<g id="edge114" class="edge">
<title>prose_110&#45;&gt;raw_114</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7932.2476,-2042.583C7912.5455,-1989.6499 7855.0698,-1828.3554 7832,-1689.0027 7785.5461,-1408.3989 7791.9331,-1061.775 7794.9963,-961.7957"/>
<polygon fill="#000000" stroke="#000000" points="7798.5006,-961.7154 7795.3239,-951.6081 7791.5042,-961.4904 7798.5006,-961.7154"/>
</g>
<!-- prespace_115 -->
<g id="node116" class="node">
<title>prespace_115</title>
<ellipse fill="none" stroke="#000000" cx="7887" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="7887" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_110&#45;&gt;prespace_115 -->
<g id="edge115" class="edge">
<title>prose_110&#45;&gt;prespace_115</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7938.1621,-2042.2475C7932.1599,-1912.1832 7895.7276,-1122.7229 7888.3155,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="7891.7901,-961.4745 7887.8328,-951.6465 7884.7976,-961.7973 7891.7901,-961.4745"/>
</g>
<!-- literal_116 -->
<g id="node117" class="node">
<title>literal_116</title>
<ellipse fill="none" stroke="#000000" cx="7983" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="7983" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_110&#45;&gt;literal_116 -->
<g id="edge116" class="edge">
<title>prose_110&#45;&gt;literal_116</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7939.709,-2042.2475C7944.7878,-1912.1832 7975.6151,-1122.7229 7981.8869,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="7985.4024,-961.7755 7982.2954,-951.6465 7978.4077,-961.5023 7985.4024,-961.7755"/>
</g>
<!-- raw_117 -->
<g id="node118" class="node">
<title>raw_117</title>
<ellipse fill="none" stroke="#000000" cx="8059" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8059" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_110&#45;&gt;raw_117 -->
<g id="edge117" class="edge">
<title>prose_110&#45;&gt;raw_117</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7944.2421,-2042.4444C7959.547,-1989.1301 8004.2674,-1826.8931 8023,-1689.0027 8061.2449,-1407.4819 8060.5567,-1062.1657 8059.428,-962.0419"/>
<polygon fill="#000000" stroke="#000000" points="8062.9252,-961.7876 8059.3012,-951.8318 8055.9257,-961.8745 8062.9252,-961.7876"/>
</g>
<!-- prespace_122 -->
<g id="node123" class="node">
<title>prespace_122</title>
<ellipse fill="none" stroke="#000000" cx="8150" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="8150" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_111&#45;&gt;prespace_122 -->
<g id="edge122" class="edge">
<title>prose_111&#45;&gt;prespace_122</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8314.8328,-2042.614C8293.8948,-1989.7662 8232.6264,-1828.6826 8206,-1689.0027 8152.6555,-1409.1615 8149.4923,-1062.0096 8149.781,-961.8498"/>
<polygon fill="#000000" stroke="#000000" points="8153.2818,-961.6587 8149.8256,-951.6435 8146.2819,-961.6281 8153.2818,-961.6587"/>
</g>
<!-- literal_123 -->
<g id="node124" class="node">
<title>literal_123</title>
<ellipse fill="none" stroke="#000000" cx="8246" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="8246" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_111&#45;&gt;literal_123 -->
<g id="edge123" class="edge">
<title>prose_111&#45;&gt;literal_123</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8319.9579,-2042.2637C8313.9611,-1988.4524 8296.1859,-1824.9867 8286,-1689.0027 8264.7728,-1405.6144 8250.8519,-1061.5878 8247.052,-961.9078"/>
<polygon fill="#000000" stroke="#000000" points="8250.5431,-961.6043 8246.6675,-951.7438 8243.5481,-961.869 8250.5431,-961.6043"/>
</g>
<!-- raw_124 -->
<g id="node125" class="node">
<title>raw_124</title>
<ellipse fill="none" stroke="#000000" cx="8322" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8322" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_111&#45;&gt;raw_124 -->
<g id="edge124" class="edge">
<title>prose_111&#45;&gt;raw_124</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8322,-2042.2475C8322,-1912.1832 8322,-1122.7229 8322,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="8325.5001,-961.6465 8322,-951.6465 8318.5001,-961.6466 8325.5001,-961.6465"/>
</g>
<!-- prespace_125 -->
<g id="node126" class="node">
<title>prespace_125</title>
<ellipse fill="none" stroke="#000000" cx="8413" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="8413" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_111&#45;&gt;prespace_125 -->
<g id="edge125" class="edge">
<title>prose_111&#45;&gt;prespace_125</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8323.9147,-2042.2535C8329.561,-1988.4143 8346.4699,-1824.8793 8358,-1689.0027 8382.0585,-1405.4858 8404.7415,-1061.548 8411.1851,-961.8986"/>
<polygon fill="#000000" stroke="#000000" points="8414.6894,-961.9423 8411.8405,-951.7377 8407.7039,-961.4917 8414.6894,-961.9423"/>
</g>
<!-- literal_126 -->
<g id="node127" class="node">
<title>literal_126</title>
<ellipse fill="none" stroke="#000000" cx="8509" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="8509" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_111&#45;&gt;literal_126 -->
<g id="edge126" class="edge">
<title>prose_111&#45;&gt;literal_126</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8331.2564,-2042.8813C8358.2572,-1990.769 8436.973,-1831.5036 8468,-1689.0027 8528.5307,-1410.9973 8515.9771,-1062.5743 8510.6841,-961.9801"/>
<polygon fill="#000000" stroke="#000000" points="8514.1644,-961.5226 8510.1237,-951.7286 8507.1749,-961.9048 8514.1644,-961.5226"/>
</g>
<!-- raw_127 -->
<g id="node128" class="node">
<title>raw_127</title>
<ellipse fill="none" stroke="#000000" cx="8585" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8585" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_111&#45;&gt;raw_127 -->
<g id="edge127" class="edge">
<title>prose_111&#45;&gt;raw_127</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8336.235,-2044.1387C8378.3255,-1994.8931 8502.1659,-1841.4205 8549,-1689.0027 8632.7187,-1416.547 8600.3375,-1062.9588 8588.56,-961.7672"/>
<polygon fill="#000000" stroke="#000000" points="8592.0222,-961.2418 8587.3612,-951.7272 8585.0716,-962.0717 8592.0222,-961.2418"/>
</g>
<!-- leaf_134 -->
<g id="node135" class="node">
<title>leaf_134</title>
<polygon fill="none" stroke="#c0c0c0" points="9073.5,-1030.5021 8630.5,-1030.5021 8630.5,-836.7006 9073.5,-836.7006 9073.5,-1030.5021"/>
<text text-anchor="middle" x="8852" y="-1015.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, match = L.P, L.match</text>
<text text-anchor="middle" x="8852" y="-983.7015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function fuzz_patt(frag)</text>
<text text-anchor="middle" x="8852" y="-968.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;frag = type(frag) == &quot;string&quot; and codepoints(frag) or frag</text>
<text text-anchor="middle" x="8852" y="-952.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = &#160;(P(1) &#45; P(frag[1]))^0</text>
<text text-anchor="middle" x="8852" y="-937.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1 , #frag &#45; 1 do</text>
<text text-anchor="middle" x="8852" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local v = frag[i]</text>
<text text-anchor="middle" x="8852" y="-906.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = patt * (P(v) * (P(1) &#45; P(frag[i + 1]))^0)</text>
<text text-anchor="middle" x="8852" y="-891.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="8852" y="-875.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;patt = patt * P(frag[#frag])</text>
<text text-anchor="middle" x="8852" y="-860.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return patt</text>
<text text-anchor="middle" x="8852" y="-845.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_112&#45;&gt;leaf_134 -->
<g id="edge134" class="edge">
<title>codeblock_112&#45;&gt;leaf_134</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8659.1581,-2042.2475C8679.177,-1927.159 8789.0013,-1295.78 8833.3828,-1040.6315"/>
<polygon fill="#000000" stroke="#000000" points="8836.8606,-1041.0608 8835.1262,-1030.6089 8829.9641,-1039.8612 8836.8606,-1041.0608"/>
</g>
<!-- leaf_118 -->
<g id="node119" class="node">
<title>leaf_118</title>
<polygon fill="none" stroke="#c0c0c0" points="7532.5,-135.0015 7243.5,-135.0015 7243.5,-79.1986 7532.5,-79.1986 7532.5,-135.0015"/>
<text text-anchor="middle" x="7388" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Here we incrementally build up a single</text>
</g>
<!-- raw_114&#45;&gt;leaf_118 -->
<g id="edge118" class="edge">
<title>raw_114&#45;&gt;leaf_118</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7798.004,-915.6366C7809.1574,-811.9864 7859.543,-291.0776 7759,-178.2001 7726.4876,-141.6991 7589.962,-151.6356 7542,-142.2001 7533.594,-140.5464 7524.946,-138.7735 7516.2405,-136.9353"/>
<polygon fill="#000000" stroke="#000000" points="7516.9071,-133.4988 7506.3969,-134.8349 7515.4463,-140.3447 7516.9071,-133.4988"/>
</g>
<!-- leaf_119 -->
<g id="node120" class="node">
<title>leaf_119</title>
<polygon fill="none" stroke="#c0c0c0" points="7605,-125.1 7551,-125.1 7551,-89.1 7605,-89.1 7605,-125.1"/>
<text text-anchor="middle" x="7578" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_115&#45;&gt;leaf_119 -->
<g id="edge119" class="edge">
<title>prespace_115&#45;&gt;leaf_119</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7888.5405,-915.6039C7897.0245,-811.7697 7934.0645,-290 7832,-178.2001 7765.7908,-105.6756 7701.6329,-186.5164 7614,-142.2001 7608.9367,-139.6396 7604.1238,-136.1165 7599.7605,-132.2847"/>
<polygon fill="#000000" stroke="#000000" points="7602.0551,-129.6347 7592.4352,-125.1953 7597.187,-134.6648 7602.0551,-129.6347"/>
</g>
<!-- leaf_120 -->
<g id="node121" class="node">
<title>leaf_120</title>
<polygon fill="none" stroke="#c0c0c0" points="7677,-125.1 7623,-125.1 7623,-89.1 7677,-89.1 7677,-125.1"/>
<text text-anchor="middle" x="7650" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_116&#45;&gt;leaf_120 -->
<g id="edge120" class="edge">
<title>literal_116&#45;&gt;leaf_120</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7984.9426,-915.5914C7995.7368,-811.6869 8044.2512,-289.5885 7942,-178.2001 7864.3012,-93.5581 7789.1458,-192.8195 7686,-142.2001 7680.9064,-139.7004 7676.0786,-136.2072 7671.7099,-132.3862"/>
<polygon fill="#000000" stroke="#000000" points="7674.0044,-129.7362 7664.3839,-125.2982 7669.137,-134.767 7674.0044,-129.7362"/>
</g>
<!-- leaf_121 -->
<g id="node122" class="node">
<title>leaf_121</title>
<polygon fill="none" stroke="#c0c0c0" points="7914.5,-126.4006 7695.5,-126.4006 7695.5,-87.7995 7914.5,-87.7995 7914.5,-126.4006"/>
<text text-anchor="middle" x="7805" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> pattern which will recognize</text>
<text text-anchor="middle" x="7805" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">our desired lines.</text>
</g>
<!-- raw_117&#45;&gt;leaf_121 -->
<g id="edge121" class="edge">
<title>raw_117&#45;&gt;leaf_121</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8060.7949,-915.5235C8070.6581,-812.3388 8114.5657,-298.2561 8023,-178.2001 8018.381,-172.1439 7941.3547,-147.9128 7880.1564,-129.4052"/>
<polygon fill="#000000" stroke="#000000" points="7881.0686,-126.0246 7870.4838,-126.4876 7879.047,-132.7264 7881.0686,-126.0246"/>
</g>
<!-- leaf_128 -->
<g id="node129" class="node">
<title>leaf_128</title>
<polygon fill="none" stroke="#c0c0c0" points="7987,-125.1 7933,-125.1 7933,-89.1 7987,-89.1 7987,-125.1"/>
</g>
<!-- prespace_122&#45;&gt;leaf_128 -->
<g id="edge128" class="edge">
<title>prespace_122&#45;&gt;leaf_128</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8155.0524,-915.5848C8179.24,-825.1917 8274.814,-416.0379 8095,-178.2001 8066.7647,-140.8535 8035.6487,-167.0996 7996,-142.2001 7991.4954,-139.3712 7987.0954,-135.9002 7983.0056,-132.2531"/>
<polygon fill="#000000" stroke="#000000" points="7985.222,-129.5297 7975.577,-125.1452 7980.3826,-134.5875 7985.222,-129.5297"/>
</g>
<!-- leaf_129 -->
<g id="node130" class="node">
<title>leaf_129</title>
<polygon fill="none" stroke="#c0c0c0" points="8168.5,-125.1 8005.5,-125.1 8005.5,-89.1 8168.5,-89.1 8168.5,-125.1"/>
<text text-anchor="middle" x="8087" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">(P(1) &#45; P(frag[n]))^0</text>
</g>
<!-- literal_123&#45;&gt;leaf_129 -->
<g id="edge129" class="edge">
<title>literal_123&#45;&gt;leaf_129</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8247.2475,-915.4813C8253.9672,-813.1445 8282.7474,-307.5015 8205,-178.2001 8192.0589,-156.6777 8169.8826,-140.8494 8148.2239,-129.6649"/>
<polygon fill="#000000" stroke="#000000" points="8149.5225,-126.4038 8139.0018,-125.1528 8146.4461,-132.6916 8149.5225,-126.4038"/>
</g>
<!-- leaf_130 -->
<g id="node131" class="node">
<title>leaf_130</title>
<polygon fill="none" stroke="#c0c0c0" points="8531.5,-126.4006 8186.5,-126.4006 8186.5,-87.7995 8531.5,-87.7995 8531.5,-126.4006"/>
<text text-anchor="middle" x="8359" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> matches anything that isn&#39;t the next fragment,</text>
<text text-anchor="middle" x="8359" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">including</text>
</g>
<!-- raw_124&#45;&gt;leaf_130 -->
<g id="edge130" class="edge">
<title>raw_124&#45;&gt;leaf_130</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8322.8072,-915.5701C8327.5408,-809.8326 8351.691,-270.3666 8357.6631,-136.9635"/>
<polygon fill="#000000" stroke="#000000" points="8361.172,-136.8406 8358.1228,-126.694 8354.179,-136.5275 8361.172,-136.8406"/>
</g>
<!-- leaf_131 -->
<g id="node132" class="node">
<title>leaf_131</title>
<polygon fill="none" stroke="#c0c0c0" points="8604,-125.1 8550,-125.1 8550,-89.1 8604,-89.1 8604,-125.1"/>
<text text-anchor="middle" x="8577" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_125&#45;&gt;leaf_131 -->
<g id="edge131" class="edge">
<title>prespace_125&#45;&gt;leaf_131</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8408.4088,-915.399C8386.9139,-825.7792 8304.0179,-425.8012 8469,-178.2001 8488.6183,-148.7574 8511.0853,-162.5886 8540,-142.2001 8544.2332,-139.2152 8548.4637,-135.7616 8552.4719,-132.2093"/>
<polygon fill="#000000" stroke="#000000" points="8554.9057,-134.7256 8559.8477,-125.354 8550.1401,-129.5982 8554.9057,-134.7256"/>
</g>
<!-- leaf_132 -->
<g id="node133" class="node">
<title>leaf_132</title>
<polygon fill="none" stroke="#c0c0c0" points="8676,-125.1 8622,-125.1 8622,-89.1 8676,-89.1 8676,-125.1"/>
<text text-anchor="middle" x="8649" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">&quot;&quot;</text>
</g>
<!-- literal_126&#45;&gt;leaf_132 -->
<g id="edge132" class="edge">
<title>literal_126&#45;&gt;leaf_132</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8507.6652,-915.4455C8500.4622,-812.9121 8469.4187,-306.3683 8549,-178.2001 8566.2153,-150.4743 8586.8732,-161.7571 8613,-142.2001 8616.9832,-139.2185 8620.9774,-135.8245 8624.7802,-132.3496"/>
<polygon fill="#000000" stroke="#000000" points="8627.4405,-134.6486 8632.2523,-125.2095 8622.6044,-129.5877 8627.4405,-134.6486"/>
</g>
<!-- leaf_133 -->
<g id="node134" class="node">
<title>leaf_133</title>
<polygon fill="none" stroke="#c0c0c0" points="9130,-126.4006 8694,-126.4006 8694,-87.7995 9130,-87.7995 9130,-126.4006"/>
<text text-anchor="middle" x="8912" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">. &#160;We then require this to be followed by the next fragment,</text>
<text text-anchor="middle" x="8912" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">and so on.</text>
</g>
<!-- raw_127&#45;&gt;leaf_133 -->
<g id="edge133" class="edge">
<title>raw_127&#45;&gt;leaf_133</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8583.0667,-915.4137C8572.4332,-811.6182 8524.9607,-294.7084 8621,-178.2001 8639.2935,-156.0077 8696.097,-139.7199 8754.7204,-128.3771"/>
<polygon fill="#000000" stroke="#000000" points="8755.7269,-131.7491 8764.9059,-126.458 8754.4307,-124.8702 8755.7269,-131.7491"/>
</g>
<!-- leaf_139 -->
<g id="node140" class="node">
<title>leaf_139</title>
<polygon fill="none" stroke="#c0c0c0" points="9282.5,-951.6014 9091.5,-951.6014 9091.5,-915.6014 9282.5,-915.6014 9282.5,-951.6014"/>
<text text-anchor="middle" x="9187" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** __repr for collection</text>
</g>
<!-- header_135&#45;&gt;leaf_139 -->
<g id="edge139" class="edge">
<title>header_135&#45;&gt;leaf_139</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9231.2749,-2042.2475C9226.0807,-1912.1832 9194.5528,-1122.7229 9188.1384,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="9191.617,-961.4989 9187.7207,-951.6465 9184.6226,-961.7783 9191.617,-961.4989"/>
</g>
<!-- raw_140 -->
<g id="node141" class="node">
<title>raw_140</title>
<ellipse fill="none" stroke="#000000" cx="9328" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9328" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_136&#45;&gt;raw_140 -->
<g id="edge140" class="edge">
<title>prose_136&#45;&gt;raw_140</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9464.2476,-2042.583C9444.5455,-1989.6499 9387.0698,-1828.3554 9364,-1689.0027 9317.5461,-1408.3989 9323.9331,-1061.775 9326.9963,-961.7957"/>
<polygon fill="#000000" stroke="#000000" points="9330.5006,-961.7154 9327.3239,-951.6081 9323.5042,-961.4904 9330.5006,-961.7154"/>
</g>
<!-- prespace_141 -->
<g id="node142" class="node">
<title>prespace_141</title>
<ellipse fill="none" stroke="#000000" cx="9419" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="9419" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_136&#45;&gt;prespace_141 -->
<g id="edge141" class="edge">
<title>prose_136&#45;&gt;prespace_141</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9470.1621,-2042.2475C9464.1599,-1912.1832 9427.7276,-1122.7229 9420.3155,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="9423.7901,-961.4745 9419.8328,-951.6465 9416.7976,-961.7973 9423.7901,-961.4745"/>
</g>
<!-- literal_142 -->
<g id="node143" class="node">
<title>literal_142</title>
<ellipse fill="none" stroke="#000000" cx="9515" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="9515" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_136&#45;&gt;literal_142 -->
<g id="edge142" class="edge">
<title>prose_136&#45;&gt;literal_142</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9471.709,-2042.2475C9476.7878,-1912.1832 9507.6151,-1122.7229 9513.8869,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="9517.4024,-961.7755 9514.2954,-951.6465 9510.4077,-961.5023 9517.4024,-961.7755"/>
</g>
<!-- raw_143 -->
<g id="node144" class="node">
<title>raw_143</title>
<ellipse fill="none" stroke="#000000" cx="9591" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9591" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_136&#45;&gt;raw_143 -->
<g id="edge143" class="edge">
<title>prose_136&#45;&gt;raw_143</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9474.5947,-2042.5076C9484.7649,-1992.2554 9514.9581,-1845.6464 9545,-1725.0027 9549.0125,-1708.8889 9552.3661,-1705.3983 9555,-1689.0027 9600.1127,-1408.1801 9594.6544,-1061.7077 9591.9085,-961.7802"/>
<polygon fill="#000000" stroke="#000000" points="9595.4017,-961.4925 9591.6139,-951.598 9588.4047,-961.695 9595.4017,-961.4925"/>
</g>
<!-- raw_148 -->
<g id="node149" class="node">
<title>raw_148</title>
<ellipse fill="none" stroke="#000000" cx="9663" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9663" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_137&#45;&gt;raw_148 -->
<g id="edge148" class="edge">
<title>prose_137&#45;&gt;raw_148</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9588.4066,-2042.2775C9595.4588,-1988.5043 9616.2529,-1825.1325 9627,-1689.0027 9649.36,-1405.7773 9659.6408,-1061.6382 9662.287,-961.9195"/>
<polygon fill="#000000" stroke="#000000" points="9665.7902,-961.8395 9662.5527,-951.7515 9658.7926,-961.6566 9665.7902,-961.8395"/>
</g>
<!-- leaf_150 -->
<g id="node151" class="node">
<title>leaf_150</title>
<polygon fill="none" stroke="#c0c0c0" points="10263.5,-1347.3029 9708.5,-1347.3029 9708.5,-519.8999 10263.5,-519.8999 10263.5,-1347.3029"/>
<text text-anchor="middle" x="9986" y="-1332.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat, litpat = assert(table.concat), assert(string.litpat)</text>
<text text-anchor="middle" x="9986" y="-1316.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = assert(string.gsub)</text>
<text text-anchor="middle" x="9986" y="-1285.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _highlight(line, frag, c, best)</text>
<text text-anchor="middle" x="9986" y="-1269.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local hl = {}</text>
<text text-anchor="middle" x="9986" y="-1254.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local og_line = line &#45;&#45; debugging</text>
<text text-anchor="middle" x="9986" y="-1239.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;while #frag &gt; 0 do</text>
<text text-anchor="middle" x="9986" y="-1223.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local char</text>
<text text-anchor="middle" x="9986" y="-1208.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;char, frag = frag:sub(1,1), frag:sub(2)</text>
<text text-anchor="middle" x="9986" y="-1192.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local at = line:find(litpat(char))</text>
<text text-anchor="middle" x="9986" y="-1177.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not at then</text>
<text text-anchor="middle" x="9986" y="-1162.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error (&quot;can&#39;t find &quot; .. char .. &quot; in: &quot; .. line)</text>
<text text-anchor="middle" x="9986" y="-1146.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-1131.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local color</text>
<text text-anchor="middle" x="9986" y="-1115.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; highlight the last two differently if this is a &#39;second best&#39;</text>
<text text-anchor="middle" x="9986" y="-1100.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; search</text>
<text text-anchor="middle" x="9986" y="-1085.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not best and #frag &lt;= 1 then</text>
<text text-anchor="middle" x="9986" y="-1069.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;color = c.alert</text>
<text text-anchor="middle" x="9986" y="-1054.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="9986" y="-1038.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;color = c.search_hl</text>
<text text-anchor="middle" x="9986" y="-1023.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-1008.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;hl[#hl + 1] = c.base(line:sub(1, at &#45;1))</text>
<text text-anchor="middle" x="9986" y="-992.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;hl[#hl + 1] = color(char)</text>
<text text-anchor="middle" x="9986" y="-977.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;line = line:sub(at + 1)</text>
<text text-anchor="middle" x="9986" y="-961.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-946.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;hl[#hl + 1] = c.base(line)</text>
<text text-anchor="middle" x="9986" y="-931.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return concat(hl):gsub(&quot;\n&quot;, c.stresc(&quot;\\n&quot;))</text>
<text text-anchor="middle" x="9986" y="-915.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="9986" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _collect_repr(collection, c)</text>
<text text-anchor="middle" x="9986" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="9986" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return c.alert &quot;No results found&quot;</text>
<text text-anchor="middle" x="9986" y="-822.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-806.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="9986" y="-791.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i,v in ipairs(collection) do</text>
<text text-anchor="middle" x="9986" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local alt_seq = &quot; &#160;&#160;&#160;&quot;</text>
<text text-anchor="middle" x="9986" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if i &lt; 10 then</text>
<text text-anchor="middle" x="9986" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;alt_seq = a.bold(&quot;M&#45;&quot; .. tostring(i) .. &quot; &quot;)</text>
<text text-anchor="middle" x="9986" y="-729.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-714.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local next_line = alt_seq</text>
<text text-anchor="middle" x="9986" y="-698.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. _highlight(v, collection.frag, c, collection.best)</text>
<text text-anchor="middle" x="9986" y="-683.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;\n&quot;</text>
<text text-anchor="middle" x="9986" y="-668.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if i == collection.hl then</text>
<text text-anchor="middle" x="9986" y="-652.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;next_line = c.highlight(next_line)</text>
<text text-anchor="middle" x="9986" y="-637.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-621.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase .. next_line</text>
<text text-anchor="middle" x="9986" y="-606.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-575.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="9986" y="-559.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="9986" y="-528.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local collect_M = {__repr = _collect_repr}</text>
</g>
<!-- codeblock_138&#45;&gt;leaf_150 -->
<g id="edge150" class="edge">
<title>codeblock_138&#45;&gt;leaf_150</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9857.1108,-2042.2475C9866.3674,-1962.6265 9904.3523,-1635.8976 9936.7073,-1357.5946"/>
<polygon fill="#000000" stroke="#000000" points="9940.2259,-1357.637 9937.9042,-1347.2997 9933.2727,-1356.8285 9940.2259,-1357.637"/>
</g>
<!-- leaf_144 -->
<g id="node145" class="node">
<title>leaf_144</title>
<polygon fill="none" stroke="#c0c0c0" points="9395.5,-135.0015 9148.5,-135.0015 9148.5,-79.1986 9395.5,-79.1986 9395.5,-135.0015"/>
<text text-anchor="middle" x="9272" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">We use a pseudo&#45;metamethod called</text>
</g>
<!-- raw_140&#45;&gt;leaf_144 -->
<g id="edge144" class="edge">
<title>raw_140&#45;&gt;leaf_144</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9328.5247,-915.3331C9330.6563,-830.8115 9336.5176,-469.4405 9291,-178.2001 9289.2806,-167.1988 9286.53,-155.448 9283.6495,-144.733"/>
<polygon fill="#000000" stroke="#000000" points="9286.9448,-143.5209 9280.8774,-134.8355 9280.2042,-145.4089 9286.9448,-143.5209"/>
</g>
<!-- leaf_145 -->
<g id="node146" class="node">
<title>leaf_145</title>
<polygon fill="none" stroke="#c0c0c0" points="9468,-125.1 9414,-125.1 9414,-89.1 9468,-89.1 9468,-125.1"/>
<text text-anchor="middle" x="9441" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_141&#45;&gt;leaf_145 -->
<g id="edge145" class="edge">
<title>prespace_141&#45;&gt;leaf_145</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9419.48,-915.5701C9422.3067,-809.3734 9436.7791,-265.6725 9440.2507,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="9443.7495,-135.3372 9440.5169,-125.2475 9436.752,-135.1508 9443.7495,-135.3372"/>
</g>
<!-- leaf_146 -->
<g id="node147" class="node">
<title>leaf_146</title>
<polygon fill="none" stroke="#c0c0c0" points="9544,-125.1 9486,-125.1 9486,-89.1 9544,-89.1 9544,-125.1"/>
<text text-anchor="middle" x="9515" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">__repr</text>
</g>
<!-- literal_142&#45;&gt;leaf_146 -->
<g id="edge146" class="edge">
<title>literal_142&#45;&gt;leaf_146</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9515,-915.5701C9515,-809.3734 9515,-265.6725 9515,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="9518.5001,-135.2475 9515,-125.2475 9511.5001,-135.2476 9518.5001,-135.2475"/>
</g>
<!-- leaf_147 -->
<g id="node148" class="node">
<title>leaf_147</title>
<polygon fill="none" stroke="#c0c0c0" points="10089.5,-134.3005 9562.5,-134.3005 9562.5,-79.8996 10089.5,-79.8996 10089.5,-134.3005"/>
<text text-anchor="middle" x="9826" y="-119.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> to specify custom table</text>
<text text-anchor="middle" x="9826" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">representations. &#160;These take the table as the first value and receive the</text>
<text text-anchor="middle" x="9826" y="-88.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local color palette for consistency.</text>
</g>
<!-- raw_143&#45;&gt;leaf_147 -->
<g id="edge147" class="edge">
<title>raw_143&#45;&gt;leaf_147</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9589.2572,-915.5626C9579.6837,-812.5957 9537.1169,-299.5209 9627,-178.2001 9638.0266,-163.3168 9671.3155,-149.1127 9707.5889,-137.3676"/>
<polygon fill="#000000" stroke="#000000" points="9708.8888,-140.6275 9717.371,-134.2791 9706.7812,-133.9523 9708.8888,-140.6275"/>
</g>
<!-- leaf_149 -->
<g id="node150" class="node">
<title>leaf_149</title>
<polygon fill="none" stroke="#c0c0c0" points="10620.5,-134.4005 10107.5,-134.4005 10107.5,-79.7996 10620.5,-79.7996 10620.5,-134.4005"/>
<text text-anchor="middle" x="10364" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">In this case we want to highlight the letters of the fragment, which we</text>
<text text-anchor="middle" x="10364" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">attach to the collection.</text>
</g>
<!-- raw_148&#45;&gt;leaf_149 -->
<g id="edge149" class="edge">
<title>raw_148&#45;&gt;leaf_149</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9660.8447,-915.5226C9648.8366,-811.2308 9594.4061,-287.3213 9699,-178.2001 9729.8021,-146.0648 10053.7585,-147.1128 10098,-142.2001 10116.0519,-140.1956 10134.7758,-137.9874 10153.5481,-135.684"/>
<polygon fill="#000000" stroke="#000000" points="10154.1752,-139.1333 10163.6707,-134.4336 10153.317,-132.1861 10154.1752,-139.1333"/>
</g>
<!-- leaf_161 -->
<g id="node162" class="node">
<title>leaf_161</title>
<polygon fill="none" stroke="#c0c0c0" points="10557.5,-2078.4033 10366.5,-2078.4033 10366.5,-2042.4033 10557.5,-2042.4033 10557.5,-2078.4033"/>
<text text-anchor="middle" x="10462" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_151&#45;&gt;leaf_161 -->
<g id="edge161" class="edge">
<title>header_151&#45;&gt;leaf_161</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10543.6679,-2502.4676C10530.6444,-2431.9721 10483.1194,-2174.7213 10467.2209,-2088.6638"/>
<polygon fill="#000000" stroke="#000000" points="10470.66,-2088.0128 10465.4014,-2078.8151 10463.7764,-2089.2846 10470.66,-2088.0128"/>
</g>
<!-- raw_162 -->
<g id="node163" class="node">
<title>raw_162</title>
<ellipse fill="none" stroke="#000000" cx="10603" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="10603" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_152&#45;&gt;raw_162 -->
<g id="edge162" class="edge">
<title>prose_152&#45;&gt;raw_162</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10765.9341,-2508.4638C10731.2215,-2489.6717 10668.0824,-2449.8436 10639,-2395.804 10584.1329,-2293.8525 10592.5386,-2149.343 10599.2134,-2088.8065"/>
<polygon fill="#000000" stroke="#000000" points="10602.7324,-2088.8497 10600.424,-2078.5094 10595.7802,-2088.0324 10602.7324,-2088.8497"/>
</g>
<!-- prespace_163 -->
<g id="node164" class="node">
<title>prespace_163</title>
<ellipse fill="none" stroke="#000000" cx="10694" cy="-2060.4033" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="10694" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_152&#45;&gt;prespace_163 -->
<g id="edge163" class="edge">
<title>prose_152&#45;&gt;prespace_163</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10783.3369,-2502.5651C10774.626,-2478.5453 10759.3772,-2434.4709 10750,-2395.804 10722.7467,-2283.4253 10704.414,-2146.6606 10697.306,-2088.6183"/>
<polygon fill="#000000" stroke="#000000" points="10700.7463,-2087.9126 10696.0722,-2078.4046 10693.7968,-2088.7522 10700.7463,-2087.9126"/>
</g>
<!-- literal_164 -->
<g id="node165" class="node">
<title>literal_164</title>
<ellipse fill="none" stroke="#000000" cx="10790" cy="-2060.4033" rx="31.481" ry="18"/>
<text text-anchor="middle" x="10790" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_152&#45;&gt;literal_164 -->
<g id="edge164" class="edge">
<title>prose_152&#45;&gt;literal_164</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10790,-2502.4676C10790,-2432.0438 10790,-2175.2445 10790,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="10793.5001,-2088.8151 10790,-2078.8151 10786.5001,-2088.8151 10793.5001,-2088.8151"/>
</g>
<!-- raw_165 -->
<g id="node166" class="node">
<title>raw_165</title>
<ellipse fill="none" stroke="#000000" cx="10868" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="10868" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_152&#45;&gt;raw_165 -->
<g id="edge165" class="edge">
<title>prose_152&#45;&gt;raw_165</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10796.9696,-2502.6352C10806.0197,-2478.693 10821.6433,-2434.7042 10830,-2395.804 10854.109,-2283.5775 10863.5712,-2146.7321 10866.6859,-2088.6435"/>
<polygon fill="#000000" stroke="#000000" points="10870.1933,-2088.5878 10867.2113,-2078.4213 10863.2025,-2088.2285 10870.1933,-2088.5878"/>
</g>
<!-- raw_170 -->
<g id="node171" class="node">
<title>raw_170</title>
<ellipse fill="none" stroke="#000000" cx="11448" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11448" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_153&#45;&gt;raw_170 -->
<g id="edge170" class="edge">
<title>prose_153&#45;&gt;raw_170</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11514.2951,-2502.4676C11503.71,-2431.8844 11465.048,-2174.0816 11452.1901,-2088.3437"/>
<polygon fill="#000000" stroke="#000000" points="11455.6306,-2087.6854 11450.6862,-2078.3151 11448.7081,-2088.7236 11455.6306,-2087.6854"/>
</g>
<!-- raw_172 -->
<g id="node173" class="node">
<title>raw_172</title>
<ellipse fill="none" stroke="#000000" cx="11598" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11598" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_154&#45;&gt;raw_172 -->
<g id="edge172" class="edge">
<title>prose_154&#45;&gt;raw_172</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11666.2167,-2502.4676C11655.3247,-2431.8844 11615.5422,-2174.0816 11602.3116,-2088.3437"/>
<polygon fill="#000000" stroke="#000000" points="11605.7483,-2087.6643 11600.764,-2078.3151 11598.8302,-2088.7319 11605.7483,-2087.6643"/>
</g>
<!-- raw_174 -->
<g id="node175" class="node">
<title>raw_174</title>
<ellipse fill="none" stroke="#000000" cx="11890" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11890" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_155&#45;&gt;raw_174 -->
<g id="edge174" class="edge">
<title>prose_155&#45;&gt;raw_174</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11890,-2502.4676C11890,-2432.0438 11890,-2175.2445 11890,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="11893.5001,-2088.8151 11890,-2078.8151 11886.5001,-2088.8151 11893.5001,-2088.8151"/>
</g>
<!-- raw_176 -->
<g id="node177" class="node">
<title>raw_176</title>
<ellipse fill="none" stroke="#000000" cx="12325" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="12325" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_156&#45;&gt;raw_176 -->
<g id="edge176" class="edge">
<title>prose_156&#45;&gt;raw_176</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12098.9253,-2503.0295C12134.7685,-2432.853 12268.3805,-2171.2572 12311.495,-2086.8445"/>
<polygon fill="#000000" stroke="#000000" points="12314.6341,-2088.3931 12316.0658,-2077.8954 12308.4001,-2085.209 12314.6341,-2088.3931"/>
</g>
<!-- raw_178 -->
<g id="node179" class="node">
<title>raw_178</title>
<ellipse fill="none" stroke="#000000" cx="12946" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="12946" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_157&#45;&gt;raw_178 -->
<g id="edge178" class="edge">
<title>prose_157&#45;&gt;raw_178</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13086.362,-2503.0664C13074.782,-2479.2443 13054.0574,-2435.004 13040,-2395.804 12999.9324,-2284.0728 12966.0465,-2146.5029 12952.4178,-2088.4012"/>
<polygon fill="#000000" stroke="#000000" points="12955.7892,-2087.4465 12950.1118,-2078.5013 12948.9717,-2089.0346 12955.7892,-2087.4465"/>
</g>
<!-- prespace_179 -->
<g id="node180" class="node">
<title>prespace_179</title>
<ellipse fill="none" stroke="#000000" cx="13095" cy="-2060.4033" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="13095" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_157&#45;&gt;prespace_179 -->
<g id="edge179" class="edge">
<title>prose_157&#45;&gt;prespace_179</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13095,-2502.4676C13095,-2432.0438 13095,-2175.2445 13095,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="13098.5001,-2088.8151 13095,-2078.8151 13091.5001,-2088.8151 13098.5001,-2088.8151"/>
</g>
<!-- literal_180 -->
<g id="node181" class="node">
<title>literal_180</title>
<ellipse fill="none" stroke="#000000" cx="13191" cy="-2060.4033" rx="31.481" ry="18"/>
<text text-anchor="middle" x="13191" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_157&#45;&gt;literal_180 -->
<g id="edge180" class="edge">
<title>prose_157&#45;&gt;literal_180</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13104.7349,-2502.9426C13117.3467,-2479.3408 13139.0145,-2435.7279 13150,-2395.804 13180.4847,-2285.0153 13188.3223,-2147.4075 13190.3222,-2088.8814"/>
<polygon fill="#000000" stroke="#000000" points="13193.83,-2088.6828 13190.6407,-2078.5794 13186.8333,-2088.4665 13193.83,-2088.6828"/>
</g>
<!-- raw_181 -->
<g id="node182" class="node">
<title>raw_181</title>
<ellipse fill="none" stroke="#000000" cx="13267" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="13267" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_157&#45;&gt;raw_181 -->
<g id="edge181" class="edge">
<title>prose_157&#45;&gt;raw_181</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13117.4921,-2507.3367C13148.9538,-2487.5586 13205.1426,-2446.9838 13231,-2395.804 13283.209,-2292.4661 13276.2507,-2148.7115 13270.3729,-2088.5908"/>
<polygon fill="#000000" stroke="#000000" points="13273.8249,-2087.9479 13269.3025,-2078.3668 13266.8629,-2088.6769 13273.8249,-2087.9479"/>
</g>
<!-- raw_186 -->
<g id="node187" class="node">
<title>raw_186</title>
<ellipse fill="none" stroke="#000000" cx="13339" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="13339" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_158&#45;&gt;raw_186 -->
<g id="edge186" class="edge">
<title>prose_158&#45;&gt;raw_186</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13265.9463,-2502.7396C13276.2446,-2478.9129 13293.9501,-2435.0518 13303,-2395.804 13328.7745,-2284.0248 13336.1826,-2146.9422 13338.2407,-2088.7175"/>
<polygon fill="#000000" stroke="#000000" points="13341.7469,-2088.5795 13338.5754,-2078.4705 13334.7507,-2088.3509 13341.7469,-2088.5795"/>
</g>
<!-- leaf_188 -->
<g id="node189" class="node">
<title>leaf_188</title>
<polygon fill="none" stroke="#c0c0c0" points="13939.5,-2395.7046 13384.5,-2395.7046 13384.5,-1725.102 13939.5,-1725.102 13939.5,-2395.7046"/>
<text text-anchor="middle" x="13662" y="-2380.604" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.search(historian, frag)</text>
<text text-anchor="middle" x="13662" y="-2365.2039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.last_collection</text>
<text text-anchor="middle" x="13662" y="-2349.8039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;and historian.last_collection.lit_frag == frag then</text>
<text text-anchor="middle" x="13662" y="-2334.4039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; don&#39;t repeat a search</text>
<text text-anchor="middle" x="13662" y="-2319.0038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return historian.last_collection</text>
<text text-anchor="middle" x="13662" y="-2303.6038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2288.2038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local collection = setmeta({}, collect_M)</text>
<text text-anchor="middle" x="13662" y="-2272.8037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.frag = frag</text>
<text text-anchor="middle" x="13662" y="-2257.4037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.lit_frag = frag</text>
<text text-anchor="middle" x="13662" y="-2242.0037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if frag == &quot;&quot; then</text>
<text text-anchor="middle" x="13662" y="-2226.6037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return collection, false</text>
<text text-anchor="middle" x="13662" y="-2211.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2195.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local cursors = {}</text>
<text text-anchor="middle" x="13662" y="-2180.4036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local best = true</text>
<text text-anchor="middle" x="13662" y="-2165.0035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = fuzz_patt(frag)</text>
<text text-anchor="middle" x="13662" y="-2149.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="13662" y="-2134.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="13662" y="-2118.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="13662" y="-2103.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="13662" y="-2072.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursors[#cursors + 1] = i</text>
<text text-anchor="middle" x="13662" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2025.8033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="13662" y="-2010.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; try the transpose</text>
<text text-anchor="middle" x="13662" y="-1995.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;best = false</text>
<text text-anchor="middle" x="13662" y="-1979.6032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local slip = sub(frag, 1, &#45;3) .. sub(frag, &#45;1, &#45;1) .. sub(frag, &#45;2, &#45;2)</text>
<text text-anchor="middle" x="13662" y="-1964.2032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;collection.frag = slip</text>
<text text-anchor="middle" x="13662" y="-1948.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = fuzz_patt(slip)</text>
<text text-anchor="middle" x="13662" y="-1933.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="13662" y="-1918.0031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="13662" y="-1902.603" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="13662" y="-1887.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="13662" y="-1871.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursors[#cursors + 1] = i</text>
<text text-anchor="middle" x="13662" y="-1856.4029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-1841.0029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-1825.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-1810.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.best = best</text>
<text text-anchor="middle" x="13662" y="-1794.8028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.cursors = cursors</text>
<text text-anchor="middle" x="13662" y="-1779.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.hl = 1</text>
<text text-anchor="middle" x="13662" y="-1764.0027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.last_collection = collection</text>
<text text-anchor="middle" x="13662" y="-1748.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return collection, best</text>
<text text-anchor="middle" x="13662" y="-1733.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_159&#45;&gt;leaf_188 -->
<g id="edge188" class="edge">
<title>codeblock_159&#45;&gt;leaf_188</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13534.2138,-2502.4676C13539.9959,-2482.4647 13550.1245,-2447.4258 13562.2358,-2405.5281"/>
<polygon fill="#000000" stroke="#000000" points="13565.602,-2406.4864 13565.0167,-2395.9077 13558.8773,-2404.5425 13565.602,-2406.4864"/>
</g>
<!-- header_189 -->
<g id="node190" class="node">
<title>header_189</title>
<ellipse fill="none" stroke="#000000" cx="14259" cy="-2060.4033" rx="143.582" ry="18"/>
<text text-anchor="middle" x="14259" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : _resultsFrom(historian, line_id)</text>
</g>
<!-- section_160&#45;&gt;header_189 -->
<g id="edge189" class="edge">
<title>section_160&#45;&gt;header_189</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14352.1975,-2502.4676C14337.3354,-2431.9721 14283.1009,-2174.7213 14264.958,-2088.6638"/>
<polygon fill="#000000" stroke="#000000" points="14268.3693,-2087.878 14262.8816,-2078.8151 14261.5199,-2089.3221 14268.3693,-2087.878"/>
</g>
<!-- prose_190 -->
<g id="node191" class="node">
<title>prose_190</title>
<ellipse fill="none" stroke="#000000" cx="14453" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="14453" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_160&#45;&gt;prose_190 -->
<g id="edge190" class="edge">
<title>section_160&#45;&gt;prose_190</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14366.143,-2502.5612C14379.0258,-2478.8947 14400.9115,-2435.5813 14412,-2395.804 14442.8553,-2285.118 14450.4963,-2147.4557 14452.3836,-2088.8984"/>
<polygon fill="#000000" stroke="#000000" points="14455.891,-2088.6876 14452.6814,-2078.5907 14448.8939,-2088.4854 14455.891,-2088.6876"/>
</g>
<!-- codeblock_191 -->
<g id="node192" class="node">
<title>codeblock_191</title>
<ellipse fill="none" stroke="#000000" cx="14591" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="14591" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 455&#45;468</text>
</g>
<!-- section_160&#45;&gt;codeblock_191 -->
<g id="edge191" class="edge">
<title>section_160&#45;&gt;codeblock_191</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14382.4053,-2503.4993C14413.5926,-2482.0671 14464.8989,-2442.3498 14494,-2395.804 14557.6594,-2293.9839 14580.881,-2148.8983 14588.1283,-2088.4834"/>
<polygon fill="#000000" stroke="#000000" points="14591.606,-2088.8779 14589.2663,-2078.5446 14584.6514,-2088.0816 14591.606,-2088.8779"/>
</g>
<!-- leaf_166 -->
<g id="node167" class="node">
<title>leaf_166</title>
<polygon fill="none" stroke="#c0c0c0" points="10648,-961.5029 10282,-961.5029 10282,-905.6999 10648,-905.6999 10648,-961.5029"/>
<text text-anchor="middle" x="10465" y="-914.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">This is an incremental &#39;fuzzy&#39; search, returning a</text>
</g>
<!-- raw_162&#45;&gt;leaf_166 -->
<g id="edge166" class="edge">
<title>raw_162&#45;&gt;leaf_166</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10601.1036,-2042.2124C10595.8235,-1991.7939 10580.394,-1846.0012 10566,-1725.0027 10531.4903,-1434.908 10485.2869,-1085.6274 10470.0833,-971.6002"/>
<polygon fill="#000000" stroke="#000000" points="10473.5432,-971.067 10468.7513,-961.6178 10466.6047,-971.9928 10473.5432,-971.067"/>
</g>
<!-- leaf_167 -->
<g id="node168" class="node">
<title>leaf_167</title>
<polygon fill="none" stroke="#c0c0c0" points="10720,-951.6014 10666,-951.6014 10666,-915.6014 10720,-915.6014 10720,-951.6014"/>
<text text-anchor="middle" x="10693" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_163&#45;&gt;leaf_167 -->
<g id="edge167" class="edge">
<title>prespace_163&#45;&gt;leaf_167</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10693.9839,-2042.2475C10693.8685,-1912.1832 10693.1678,-1122.7229 10693.0253,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="10696.525,-961.6434 10693.016,-951.6465 10689.525,-961.6497 10696.525,-961.6434"/>
</g>
<!-- leaf_168 -->
<g id="node169" class="node">
<title>leaf_168</title>
<polygon fill="none" stroke="#c0c0c0" points="10824,-951.6014 10738,-951.6014 10738,-915.6014 10824,-915.6014 10824,-951.6014"/>
<text text-anchor="middle" x="10781" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">collection</text>
</g>
<!-- literal_164&#45;&gt;leaf_168 -->
<g id="edge168" class="edge">
<title>literal_164&#45;&gt;leaf_168</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10789.855,-2042.2475C10788.8161,-1912.1832 10782.5106,-1122.7229 10781.2277,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="10784.724,-961.6182 10781.1441,-951.6465 10777.7242,-961.6742 10784.724,-961.6182"/>
</g>
<!-- leaf_169 -->
<g id="node170" class="node">
<title>leaf_169</title>
<polygon fill="none" stroke="#c0c0c0" points="10896,-951.6014 10842,-951.6014 10842,-915.6014 10896,-915.6014 10896,-951.6014"/>
<text text-anchor="middle" x="10869" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">.</text>
</g>
<!-- raw_165&#45;&gt;leaf_169 -->
<g id="edge169" class="edge">
<title>raw_165&#45;&gt;leaf_169</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10868.0161,-2042.2475C10868.1315,-1912.1832 10868.8322,-1122.7229 10868.9747,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="10872.475,-961.6497 10868.984,-951.6465 10865.475,-961.6434 10872.475,-961.6497"/>
</g>
<!-- leaf_171 -->
<g id="node172" class="node">
<title>leaf_171</title>
<polygon fill="none" stroke="#c0c0c0" points="11427.5,-953.5035 10914.5,-953.5035 10914.5,-913.6993 11427.5,-913.6993 11427.5,-953.5035"/>
<text text-anchor="middle" x="11171" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">The array portion of a collection is any line which matches the search.</text>
</g>
<!-- raw_170&#45;&gt;leaf_171 -->
<g id="edge171" class="edge">
<title>raw_170&#45;&gt;leaf_171</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11443.5368,-2042.2475C11411.6355,-1912.4771 11218.3676,-1126.2868 11178.2773,-963.2047"/>
<polygon fill="#000000" stroke="#000000" points="11181.6476,-962.2528 11175.8615,-953.3775 11174.85,-963.9239 11181.6476,-962.2528"/>
</g>
<!-- leaf_173 -->
<g id="node174" class="node">
<title>leaf_173</title>
<polygon fill="none" stroke="#c0c0c0" points="11608.5,-953.5035 11445.5,-953.5035 11445.5,-913.6993 11608.5,-913.6993 11608.5,-953.5035"/>
<text text-anchor="middle" x="11527" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">The other fields are:</text>
</g>
<!-- raw_172&#45;&gt;leaf_173 -->
<g id="edge173" class="edge">
<title>raw_172&#45;&gt;leaf_173</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11596.856,-2042.2475C11588.6873,-1912.6066 11539.24,-1127.8554 11528.8962,-963.6949"/>
<polygon fill="#000000" stroke="#000000" points="11532.3681,-963.1376 11528.2461,-953.3775 11525.382,-963.5778 11532.3681,-963.1376"/>
</g>
<!-- leaf_175 -->
<g id="node176" class="node">
<title>leaf_175</title>
<polygon fill="none" stroke="#c0c0c0" points="12153.5,-968.8018 11626.5,-968.8018 11626.5,-898.401 12153.5,-898.401 12153.5,-968.8018"/>
<text text-anchor="middle" x="11890" y="-937.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; #fields</text>
<text text-anchor="middle" x="11890" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;best : &#160;Whether this is a best&#45;fit collection, that is, one with all</text>
<text text-anchor="middle" x="11890" y="-906.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;codepoints in order.</text>
</g>
<!-- raw_174&#45;&gt;leaf_175 -->
<g id="edge175" class="edge">
<title>raw_174&#45;&gt;leaf_175</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11890,-2042.2475C11890,-1916.2627 11890,-1171.5967 11890,-979.0357"/>
<polygon fill="#000000" stroke="#000000" points="11893.5001,-978.975 11890,-968.975 11886.5001,-978.975 11893.5001,-978.975"/>
</g>
<!-- leaf_177 -->
<g id="node178" class="node">
<title>leaf_177</title>
<polygon fill="none" stroke="#c0c0c0" points="12712.5,-960.9018 12171.5,-960.9018 12171.5,-906.3009 12712.5,-906.3009 12712.5,-960.9018"/>
<text text-anchor="middle" x="12442" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;frag : &#160;The fragment, used to highlight the collection. &#160;Is transposed</text>
<text text-anchor="middle" x="12442" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in a next&#45;best search.</text>
</g>
<!-- raw_176&#45;&gt;leaf_177 -->
<g id="edge177" class="edge">
<title>raw_176&#45;&gt;leaf_177</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12326.8852,-2042.2475C12340.1561,-1914.4384 12419.5408,-1149.9016 12438.1145,-971.0217"/>
<polygon fill="#000000" stroke="#000000" points="12441.5995,-971.3466 12439.1511,-961.0385 12434.6369,-970.6236 12441.5995,-971.3466"/>
</g>
<!-- leaf_182 -->
<g id="node183" class="node">
<title>leaf_182</title>
<polygon fill="none" stroke="#c0c0c0" points="13103.5,-953.5035 12730.5,-953.5035 12730.5,-913.6993 13103.5,-913.6993 13103.5,-953.5035"/>
<text text-anchor="middle" x="12917" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;lit_frag : &#160;The literal fragment passed as the</text>
</g>
<!-- raw_178&#45;&gt;leaf_182 -->
<g id="edge182" class="edge">
<title>raw_178&#45;&gt;leaf_182</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12945.5327,-2042.2475C12942.1962,-1912.6066 12921.9994,-1127.8554 12917.7745,-963.6949"/>
<polygon fill="#000000" stroke="#000000" points="12921.2652,-963.2841 12917.509,-953.3775 12914.2675,-963.4643 12921.2652,-963.2841"/>
</g>
<!-- leaf_183 -->
<g id="node184" class="node">
<title>leaf_183</title>
<polygon fill="none" stroke="#c0c0c0" points="13176,-951.6014 13122,-951.6014 13122,-915.6014 13176,-915.6014 13176,-951.6014"/>
<text text-anchor="middle" x="13149" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_179&#45;&gt;leaf_183 -->
<g id="edge183" class="edge">
<title>prespace_179&#45;&gt;leaf_183</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13095.8701,-2042.2475C13102.1032,-1912.1832 13139.9367,-1122.7229 13147.6339,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="13151.1524,-961.8027 13148.1352,-951.6465 13144.1605,-961.4675 13151.1524,-961.8027"/>
</g>
<!-- leaf_184 -->
<g id="node185" class="node">
<title>leaf_184</title>
<polygon fill="none" stroke="#c0c0c0" points="13248,-951.6014 13194,-951.6014 13194,-915.6014 13248,-915.6014 13248,-951.6014"/>
<text text-anchor="middle" x="13221" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">frag</text>
</g>
<!-- literal_180&#45;&gt;leaf_184 -->
<g id="edge184" class="edge">
<title>literal_180&#45;&gt;leaf_184</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13191.4834,-2042.2475C13194.9462,-1912.1832 13215.9648,-1122.7229 13220.2411,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="13223.7521,-961.7362 13220.5196,-951.6465 13216.7546,-961.5498 13223.7521,-961.7362"/>
</g>
<!-- leaf_185 -->
<g id="node186" class="node">
<title>leaf_185</title>
<polygon fill="none" stroke="#c0c0c0" points="13590,-952.9019 13266,-952.9019 13266,-914.3008 13590,-914.3008 13590,-952.9019"/>
<text text-anchor="middle" x="13428" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> parameter. &#160;Used to</text>
<text text-anchor="middle" x="13428" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;compare to the last search.</text>
</g>
<!-- raw_181&#45;&gt;leaf_185 -->
<g id="edge185" class="edge">
<title>raw_181&#45;&gt;leaf_185</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13268.634,-2042.1868C13273.2317,-1991.7031 13286.9928,-1845.7589 13303,-1725.0027 13342.545,-1426.6795 13404.5243,-1067.3734 13422.7775,-963.2139"/>
<polygon fill="#000000" stroke="#000000" points="13426.2662,-963.5827 13424.5482,-953.1281 13419.3716,-962.3722 13426.2662,-963.5827"/>
</g>
<!-- leaf_187 -->
<g id="node188" class="node">
<title>leaf_187</title>
<polygon fill="none" stroke="#c0c0c0" points="14114,-960.9018 13608,-960.9018 13608,-906.3009 14114,-906.3009 14114,-960.9018"/>
<text text-anchor="middle" x="13861" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;cursors : &#160;This is an array, each value is the cursor position of</text>
<text text-anchor="middle" x="13861" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;the corresponding line in the history.</text>
</g>
<!-- raw_186&#45;&gt;leaf_187 -->
<g id="edge187" class="edge">
<title>raw_186&#45;&gt;leaf_187</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13334.3451,-2042.4615C13321.0835,-1986.7828 13289.3387,-1815.2769 13375,-1725.0027 13444.4065,-1651.8586 13521.7584,-1753.8181 13599,-1689.0027 13827.3416,-1497.3952 13856.9561,-1095.71 13860.5708,-971.2101"/>
<polygon fill="#000000" stroke="#000000" points="13864.0739,-971.127 13860.8249,-961.0426 13857.0761,-970.952 13864.0739,-971.127"/>
</g>
<!-- leaf_192 -->
<g id="node193" class="node">
<title>leaf_192</title>
<polygon fill="none" stroke="#c0c0c0" points="14407.5,-951.6014 14132.5,-951.6014 14132.5,-915.6014 14407.5,-915.6014 14407.5,-951.6014"/>
<text text-anchor="middle" x="14270" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">**** _resultsFrom(historian, line_id)</text>
</g>
<!-- header_189&#45;&gt;leaf_192 -->
<g id="edge192" class="edge">
<title>header_189&#45;&gt;leaf_192</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14259.1772,-2042.2475C14260.4469,-1912.1832 14268.1538,-1122.7229 14269.7217,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="14273.226,-961.6803 14269.8238,-951.6465 14266.2263,-961.6119 14273.226,-961.6803"/>
</g>
<!-- raw_193 -->
<g id="node194" class="node">
<title>raw_193</title>
<ellipse fill="none" stroke="#000000" cx="14453" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="14453" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_190&#45;&gt;raw_193 -->
<g id="edge193" class="edge">
<title>prose_190&#45;&gt;raw_193</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14453,-2042.2475C14453,-1912.1832 14453,-1122.7229 14453,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="14456.5001,-961.6465 14453,-951.6465 14449.5001,-961.6466 14456.5001,-961.6465"/>
</g>
<!-- leaf_195 -->
<g id="node196" class="node">
<title>leaf_195</title>
<polygon fill="none" stroke="#c0c0c0" points="14843.5,-1029.9019 14498.5,-1029.9019 14498.5,-837.3009 14843.5,-837.3009 14843.5,-1029.9019"/>
<text text-anchor="middle" x="14671" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _resultsFrom(historian, line_id)</text>
<text text-anchor="middle" x="14671" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local stmt = historian.get_results</text>
<text text-anchor="middle" x="14671" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;stmt:bindkv {line_id = line_id}</text>
<text text-anchor="middle" x="14671" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local results = stmt:resultset()</text>
<text text-anchor="middle" x="14671" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if results then</text>
<text text-anchor="middle" x="14671" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results = results[1]</text>
<text text-anchor="middle" x="14671" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results.n = #results</text>
<text text-anchor="middle" x="14671" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results.frozen = true</text>
<text text-anchor="middle" x="14671" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="14671" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.get_results:clearbind():reset()</text>
<text text-anchor="middle" x="14671" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return results</text>
<text text-anchor="middle" x="14671" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_191&#45;&gt;leaf_195 -->
<g id="edge195" class="edge">
<title>codeblock_191&#45;&gt;leaf_195</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14592.289,-2042.2475C14600.465,-1927.0892 14645.3407,-1295.0136 14663.4341,-1040.1675"/>
<polygon fill="#000000" stroke="#000000" points="14666.9277,-1040.3803 14664.1448,-1030.1576 14659.9453,-1039.8845 14666.9277,-1040.3803"/>
</g>
<!-- leaf_194 -->
<g id="node195" class="node">
<title>leaf_194</title>
<polygon fill="none" stroke="#c0c0c0" points="14695.5,-135.0015 14210.5,-135.0015 14210.5,-79.1986 14695.5,-79.1986 14695.5,-135.0015"/>
<text text-anchor="middle" x="14453" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Retrieve a set of results reprs from the database, given a line_id.</text>
</g>
<!-- raw_193&#45;&gt;leaf_194 -->
<g id="edge194" class="edge">
<title>raw_193&#45;&gt;leaf_194</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14453,-915.5701C14453,-811.9323 14453,-291.6209 14453,-145.3846"/>
<polygon fill="#000000" stroke="#000000" points="14456.5001,-145.1211 14453,-135.1211 14449.5001,-145.1212 14456.5001,-145.1211"/>
</g>
<!-- leaf_202 -->
<g id="node203" class="node">
<title>leaf_202</title>
<polygon fill="none" stroke="#c0c0c0" points="14845.5,-2078.4033 14696.5,-2078.4033 14696.5,-2042.4033 14845.5,-2042.4033 14845.5,-2078.4033"/>
<text text-anchor="middle" x="14771" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_196&#45;&gt;leaf_202 -->
<g id="edge202" class="edge">
<title>header_196&#45;&gt;leaf_202</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14813.2751,-2502.4676C14806.5404,-2432.0438 14781.9824,-2175.2445 14773.7278,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="14777.1969,-2088.4365 14772.7607,-2078.8151 14770.2287,-2089.1029 14777.1969,-2088.4365"/>
</g>
<!-- raw_203 -->
<g id="node204" class="node">
<title>raw_203</title>
<ellipse fill="none" stroke="#000000" cx="14891" cy="-2060.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="14891" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_197&#45;&gt;raw_203 -->
<g id="edge203" class="edge">
<title>prose_197&#45;&gt;raw_203</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14980.5688,-2503.6313C14965.4975,-2480.4495 14939.4398,-2436.9323 14927,-2395.804 14893.7897,-2286.0042 14890.3247,-2147.872 14890.5289,-2089.0451"/>
<polygon fill="#000000" stroke="#000000" points="14894.0314,-2088.7143 14890.6071,-2078.6881 14887.0316,-2088.6614 14894.0314,-2088.7143"/>
</g>
<!-- leaf_205 -->
<g id="node206" class="node">
<title>leaf_205</title>
<polygon fill="none" stroke="#c0c0c0" points="15499.9015,-2171.0439 14936.0985,-2171.0439 14936.0985,-1949.7627 15499.9015,-1949.7627 15499.9015,-2171.0439"/>
<text text-anchor="middle" x="15218" y="-2156.0235" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="15218" y="-2140.6234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 or #historian == 0 then</text>
<text text-anchor="middle" x="15218" y="-2125.2234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="15218" y="-2109.8234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="15218" y="-2094.4233" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local  = historian.cursor &gt; 1 and historian.cursor &#45; 1 or historian.cursor</text>
<text text-anchor="middle" x="15218" y="-2075.6633" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[]</text>
<text text-anchor="middle" x="15218" y="-2056.9033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = 1</text>
<text text-anchor="middle" x="15218" y="-2041.5033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[])</text>
<text text-anchor="middle" x="15218" y="-2022.7433" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;local result = historian.results[txtbuf]</text>
<text text-anchor="middle" x="15218" y="-2007.3433" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = </text>
<text text-anchor="middle" x="15218" y="-1988.5833" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="15218" y="-1973.1832" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return txtbuf:clone(), result</text>
<text text-anchor="middle" x="15218" y="-1957.7832" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_198&#45;&gt;leaf_205 -->
<g id="edge205" class="edge">
<title>codeblock_198&#45;&gt;leaf_205</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15218,-2502.4676C15218,-2449.8107 15218,-2292.9556 15218,-2181.0792"/>
<polygon fill="#000000" stroke="#000000" points="15221.5001,-2181.0765 15218,-2171.0766 15214.5001,-2181.0766 15221.5001,-2181.0765"/>
</g>
<!-- header_206 -->
<g id="node207" class="node">
<title>header_206</title>
<ellipse fill="none" stroke="#000000" cx="15600" cy="-2060.4033" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="15600" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_199&#45;&gt;header_206 -->
<g id="edge206" class="edge">
<title>section_199&#45;&gt;header_206</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15664.3735,-2502.4676C15654.1184,-2432.0438 15616.7232,-2175.2445 15604.1536,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="15607.5857,-2088.2064 15602.6811,-2078.8151 15600.6587,-2089.2151 15607.5857,-2088.2064"/>
</g>
<!-- prose_207 -->
<g id="node208" class="node">
<title>prose_207</title>
<ellipse fill="none" stroke="#000000" cx="15733" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="15733" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_199&#45;&gt;prose_207 -->
<g id="edge207" class="edge">
<title>section_199&#45;&gt;prose_207</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15670.8718,-2502.3963C15675.9588,-2478.1897 15684.954,-2433.9089 15691,-2395.804 15708.97,-2282.5484 15723.9775,-2146.7737 15730.0751,-2088.8446"/>
<polygon fill="#000000" stroke="#000000" points="15733.583,-2088.9507 15731.1414,-2078.6411 15726.6209,-2088.2231 15733.583,-2088.9507"/>
</g>
<!-- codeblock_208 -->
<g id="node209" class="node">
<title>codeblock_208</title>
<ellipse fill="none" stroke="#000000" cx="15960" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15960" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 496&#45;520</text>
</g>
<!-- section_199&#45;&gt;codeblock_208 -->
<g id="edge208" class="edge">
<title>section_199&#45;&gt;codeblock_208</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15684.1776,-2502.8601C15706.4112,-2479.5168 15745.6566,-2436.5525 15774,-2395.804 15849.1173,-2287.8098 15919.0735,-2146.7379 15947.0941,-2087.967"/>
<polygon fill="#000000" stroke="#000000" points="15950.4063,-2089.1509 15951.529,-2078.6158 15944.0815,-2086.1513 15950.4063,-2089.1509"/>
</g>
<!-- header_219 -->
<g id="node220" class="node">
<title>header_219</title>
<ellipse fill="none" stroke="#000000" cx="16395" cy="-2060.4033" rx="111.1981" ry="18"/>
<text text-anchor="middle" x="16395" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:index(cursor)</text>
</g>
<!-- section_200&#45;&gt;header_219 -->
<g id="edge219" class="edge">
<title>section_200&#45;&gt;header_219</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16472.8247,-2502.4676C16460.4141,-2431.9721 16415.1255,-2174.7213 16399.9752,-2088.6638"/>
<polygon fill="#000000" stroke="#000000" points="16403.4223,-2088.0568 16398.2414,-2078.8151 16396.5283,-2089.2705 16403.4223,-2088.0568"/>
</g>
<!-- prose_220 -->
<g id="node221" class="node">
<title>prose_220</title>
<ellipse fill="none" stroke="#000000" cx="16557" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="16557" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_200&#45;&gt;prose_220 -->
<g id="edge220" class="edge">
<title>section_200&#45;&gt;prose_220</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16482.8627,-2502.1896C16491.6171,-2478.1213 16506.6239,-2434.3741 16515,-2395.804 16539.394,-2283.4742 16551.0468,-2146.6836 16555.1748,-2088.6264"/>
<polygon fill="#000000" stroke="#000000" points="16558.683,-2088.6274 16555.8806,-2078.41 16551.6996,-2088.145 16558.683,-2088.6274"/>
</g>
<!-- codeblock_221 -->
<g id="node222" class="node">
<title>codeblock_221</title>
<ellipse fill="none" stroke="#000000" cx="16770" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="16770" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 527&#45;540</text>
</g>
<!-- section_200&#45;&gt;codeblock_221 -->
<g id="edge221" class="edge">
<title>section_200&#45;&gt;codeblock_221</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16496.5008,-2503.0875C16522.4291,-2480.3222 16567.3789,-2438.3218 16598,-2395.804 16673.7385,-2290.6401 16735.2296,-2147.4613 16759.1902,-2088.0215"/>
<polygon fill="#000000" stroke="#000000" points="16762.5064,-2089.1547 16762.9673,-2078.5699 16756.0062,-2086.557 16762.5064,-2089.1547"/>
</g>
<!-- header_226 -->
<g id="node227" class="node">
<title>header_226</title>
<ellipse fill="none" stroke="#000000" cx="17282" cy="-2060.4033" rx="184.6938" ry="18"/>
<text text-anchor="middle" x="17282" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append(txtbuf, results, success)</text>
</g>
<!-- section_201&#45;&gt;header_226 -->
<g id="edge226" class="edge">
<title>section_201&#45;&gt;header_226</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17578.6548,-2502.8716C17552.8558,-2479.8782 17507.8985,-2437.637 17476,-2395.804 17395.0548,-2289.6489 17323.0251,-2146.5215 17294.7315,-2087.5368"/>
<polygon fill="#000000" stroke="#000000" points="17297.8811,-2086.01 17290.4189,-2078.489 17291.5622,-2089.022 17297.8811,-2086.01"/>
</g>
<!-- prose_227 -->
<g id="node228" class="node">
<title>prose_227</title>
<ellipse fill="none" stroke="#000000" cx="17517" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="17517" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_201&#45;&gt;prose_227 -->
<g id="edge227" class="edge">
<title>section_201&#45;&gt;prose_227</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17591.7344,-2502.2299C17582.4759,-2478.2052 17566.6399,-2434.505 17558,-2395.804 17532.9637,-2283.6584 17522.2369,-2146.7701 17518.5793,-2088.6569"/>
<polygon fill="#000000" stroke="#000000" points="17522.0581,-2088.1996 17517.9583,-2078.4302 17515.071,-2088.624 17522.0581,-2088.1996"/>
</g>
<!-- prose_228 -->
<g id="node229" class="node">
<title>prose_228</title>
<ellipse fill="none" stroke="#000000" cx="17599" cy="-2060.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="17599" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_201&#45;&gt;prose_228 -->
<g id="edge228" class="edge">
<title>section_201&#45;&gt;prose_228</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17599,-2502.4676C17599,-2432.0438 17599,-2175.2445 17599,-2088.927"/>
<polygon fill="#000000" stroke="#000000" points="17602.5001,-2088.8151 17599,-2078.8151 17595.5001,-2088.8151 17602.5001,-2088.8151"/>
</g>
<!-- codeblock_229 -->
<g id="node230" class="node">
<title>codeblock_229</title>
<ellipse fill="none" stroke="#000000" cx="17788" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="17788" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 548&#45;563</text>
</g>
<!-- section_201&#45;&gt;codeblock_229 -->
<g id="edge229" class="edge">
<title>section_201&#45;&gt;codeblock_229</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17606.409,-2502.4676C17635.4261,-2431.8286 17741.4708,-2173.6738 17776.6061,-2088.1407"/>
<polygon fill="#000000" stroke="#000000" points="17779.8745,-2089.395 17780.4368,-2078.8151 17773.3995,-2086.7352 17779.8745,-2089.395"/>
</g>
<!-- codeblock_230 -->
<g id="node231" class="node">
<title>codeblock_230</title>
<ellipse fill="none" stroke="#000000" cx="18098" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="18098" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 565&#45;572</text>
</g>
<!-- section_201&#45;&gt;codeblock_230 -->
<g id="edge230" class="edge">
<title>section_201&#45;&gt;codeblock_230</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17651.616,-2507.5683C17712.9554,-2490.3725 17814.745,-2455.0494 17884,-2395.804 17989.1559,-2305.8464 18060.7893,-2151.2685 18086.9652,-2088.3109"/>
<polygon fill="#000000" stroke="#000000" points="18090.3604,-2089.2556 18090.9121,-2078.6751 18083.8828,-2086.6022 18090.3604,-2089.2556"/>
</g>
<!-- codeblock_231 -->
<g id="node232" class="node">
<title>codeblock_231</title>
<ellipse fill="none" stroke="#000000" cx="18409" cy="-2060.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="18409" y="-2056.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 574&#45;576</text>
</g>
<!-- section_201&#45;&gt;codeblock_231 -->
<g id="edge231" class="edge">
<title>section_201&#45;&gt;codeblock_231</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17667.4367,-2512.8725C17804.9201,-2496.4772 18108.7947,-2454.5567 18194,-2395.804 18309.1257,-2316.4198 18376.5102,-2153.2209 18399.7537,-2088.1135"/>
<polygon fill="#000000" stroke="#000000" points="18403.1063,-2089.1291 18403.1057,-2078.5343 18396.4992,-2086.8171 18403.1063,-2089.1291"/>
</g>
<!-- leaf_204 -->
<g id="node205" class="node">
<title>leaf_204</title>
<polygon fill="none" stroke="#c0c0c0" points="14918,-951.6014 14864,-951.6014 14864,-915.6014 14918,-915.6014 14918,-951.6014"/>
</g>
<!-- raw_203&#45;&gt;leaf_204 -->
<g id="edge204" class="edge">
<title>raw_203&#45;&gt;leaf_204</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14891,-2042.2475C14891,-1912.1832 14891,-1122.7229 14891,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="14894.5001,-961.6465 14891,-951.6465 14887.5001,-961.6466 14894.5001,-961.6465"/>
</g>
<!-- leaf_209 -->
<g id="node210" class="node">
<title>leaf_209</title>
<polygon fill="none" stroke="#c0c0c0" points="15463,-951.6014 15307,-951.6014 15307,-915.6014 15463,-915.6014 15463,-951.6014"/>
<text text-anchor="middle" x="15385" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_206&#45;&gt;leaf_209 -->
<g id="edge209" class="edge">
<title>header_206&#45;&gt;leaf_209</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15598.467,-2042.3837C15593.333,-1989.9382 15573.2727,-1834.1929 15509,-1725.0027 15497.3612,-1705.23 15482.1217,-1709.5932 15472,-1689.0027 15345.1628,-1430.9778 15371.1708,-1065.2398 15381.7594,-961.8159"/>
<polygon fill="#000000" stroke="#000000" points="15385.2434,-962.1511 15382.8182,-951.8376 15378.2825,-961.4124 15385.2434,-962.1511"/>
</g>
<!-- raw_210 -->
<g id="node211" class="node">
<title>raw_210</title>
<ellipse fill="none" stroke="#000000" cx="15508" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="15508" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_207&#45;&gt;raw_210 -->
<g id="edge210" class="edge">
<title>prose_207&#45;&gt;raw_210</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15737.0372,-2042.3186C15748.246,-1986.9539 15773.7426,-1817.9088 15691,-1725.0027 15646.2641,-1674.7717 15586.7705,-1740.9173 15544,-1689.0027 15450.8047,-1575.8827 15492.7825,-1085.5222 15505.0432,-961.9538"/>
<polygon fill="#000000" stroke="#000000" points="15508.5473,-962.0888 15506.0676,-951.7883 15501.5826,-961.3869 15508.5473,-962.0888"/>
</g>
<!-- prespace_211 -->
<g id="node212" class="node">
<title>prespace_211</title>
<ellipse fill="none" stroke="#000000" cx="15599" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="15599" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_207&#45;&gt;prespace_211 -->
<g id="edge211" class="edge">
<title>prose_207&#45;&gt;prespace_211</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15734.6939,-2042.1564C15738.755,-1989.7437 15745.0274,-1835.4384 15691,-1725.0027 15681.0564,-1704.6772 15664.4265,-1709.573 15655,-1689.0027 15535.6827,-1428.6297 15578.8526,-1064.5389 15594.3965,-961.659"/>
<polygon fill="#000000" stroke="#000000" points="15597.8618,-962.1521 15595.9345,-951.734 15590.9443,-961.0801 15597.8618,-962.1521"/>
</g>
<!-- literal_212 -->
<g id="node213" class="node">
<title>literal_212</title>
<ellipse fill="none" stroke="#000000" cx="15695" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="15695" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_207&#45;&gt;literal_212 -->
<g id="edge212" class="edge">
<title>prose_207&#45;&gt;literal_212</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15732.3877,-2042.2475C15728.0015,-1912.1832 15701.3779,-1122.7229 15695.9613,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="15699.4437,-961.5229 15695.6086,-951.6465 15692.4477,-961.7589 15699.4437,-961.5229"/>
</g>
<!-- raw_213 -->
<g id="node214" class="node">
<title>raw_213</title>
<ellipse fill="none" stroke="#000000" cx="15771" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="15771" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_207&#45;&gt;raw_213 -->
<g id="edge213" class="edge">
<title>prose_207&#45;&gt;raw_213</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15733.6123,-2042.2475C15737.9985,-1912.1832 15764.6221,-1122.7229 15770.0387,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="15773.5523,-961.7589 15770.3914,-951.6465 15766.5563,-961.5229 15773.5523,-961.7589"/>
</g>
<!-- leaf_218 -->
<g id="node219" class="node">
<title>leaf_218</title>
<polygon fill="none" stroke="#c0c0c0" points="16281.9015,-1121.2421 15816.0985,-1121.2421 15816.0985,-745.9606 16281.9015,-745.9606 16281.9015,-1121.2421"/>
<text text-anchor="middle" x="16049" y="-1106.2217" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="16049" y="-1090.8216" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local  = historian.cursor &lt; #historian</text>
<text text-anchor="middle" x="16049" y="-1072.0616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and historian.cursor + 1</text>
<text text-anchor="middle" x="16049" y="-1056.6616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or &#160;historian.cursor</text>
<text text-anchor="middle" x="16049" y="-1041.2616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local fwd = historian.cursor &gt;= #historian</text>
<text text-anchor="middle" x="16049" y="-1025.8615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 or #historian == 0 then</text>
<text text-anchor="middle" x="16049" y="-1010.4615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="16049" y="-995.0615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16049" y="-979.6615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[]</text>
<text text-anchor="middle" x="16049" y="-960.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not txtbuf then</text>
<text text-anchor="middle" x="16049" y="-945.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf(), nil, true</text>
<text text-anchor="middle" x="16049" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16049" y="-914.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = #txtbuf.lines</text>
<text text-anchor="middle" x="16049" y="-899.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[])</text>
<text text-anchor="middle" x="16049" y="-880.5413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = </text>
<text text-anchor="middle" x="16049" y="-861.7813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="16049" y="-846.3813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if fwd and #txtbuf.lines &gt; 0 then</text>
<text text-anchor="middle" x="16049" y="-830.9813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian + 1</text>
<text text-anchor="middle" x="16049" y="-815.5812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return txtbuf:clone(), nil, true</text>
<text text-anchor="middle" x="16049" y="-800.1812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="16049" y="-784.7812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return txtbuf:clone(), result, false</text>
<text text-anchor="middle" x="16049" y="-769.3811" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16049" y="-753.9811" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_208&#45;&gt;leaf_218 -->
<g id="edge218" class="edge">
<title>codeblock_208&#45;&gt;leaf_218</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15961.434,-2042.2475C15969.5765,-1939.1576 16010.4385,-1421.817 16033.3541,-1131.6894"/>
<polygon fill="#000000" stroke="#000000" points="16036.8633,-1131.7101 16034.1616,-1121.4655 16029.885,-1131.1589 16036.8633,-1131.7101"/>
</g>
<!-- leaf_214 -->
<g id="node215" class="node">
<title>leaf_214</title>
<polygon fill="none" stroke="#c0c0c0" points="15554.5,-135.0015 15083.5,-135.0015 15083.5,-79.1986 15554.5,-79.1986 15554.5,-135.0015"/>
<text text-anchor="middle" x="15319" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next txtbuf in history, and a second flag to tell the</text>
</g>
<!-- raw_210&#45;&gt;leaf_214 -->
<g id="edge214" class="edge">
<title>raw_210&#45;&gt;leaf_214</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15509.5957,-915.3514C15518.2481,-812.3 15556.1262,-303.3839 15472,-178.2001 15461.1483,-162.0523 15445.6279,-149.4975 15428.592,-139.7583"/>
<polygon fill="#000000" stroke="#000000" points="15430.029,-136.5575 15419.5618,-134.9178 15426.7219,-142.7271 15430.029,-136.5575"/>
</g>
<!-- leaf_215 -->
<g id="node216" class="node">
<title>leaf_215</title>
<polygon fill="none" stroke="#c0c0c0" points="15627,-125.1 15573,-125.1 15573,-89.1 15627,-89.1 15627,-125.1"/>
</g>
<!-- prespace_211&#45;&gt;leaf_215 -->
<g id="edge215" class="edge">
<title>prespace_211&#45;&gt;leaf_215</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15599.0218,-915.5701C15599.1503,-809.3734 15599.8081,-265.6725 15599.9659,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="15603.4658,-135.2518 15599.978,-125.2475 15596.4658,-135.2433 15603.4658,-135.2518"/>
</g>
<!-- leaf_216 -->
<g id="node217" class="node">
<title>leaf_216</title>
<polygon fill="none" stroke="#c0c0c0" points="15745,-125.1 15645,-125.1 15645,-89.1 15745,-89.1 15745,-125.1"/>
<text text-anchor="middle" x="15695" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_212&#45;&gt;leaf_216 -->
<g id="edge216" class="edge">
<title>literal_212&#45;&gt;leaf_216</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15695,-915.5701C15695,-809.3734 15695,-265.6725 15695,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="15698.5001,-135.2475 15695,-125.2475 15691.5001,-135.2476 15698.5001,-135.2475"/>
</g>
<!-- leaf_217 -->
<g id="node218" class="node">
<title>leaf_217</title>
<polygon fill="none" stroke="#c0c0c0" points="16003,-127.0021 15763,-127.0021 15763,-87.198 16003,-87.198 16003,-127.0021"/>
<text text-anchor="middle" x="15883" y="-111.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_213&#45;&gt;leaf_217 -->
<g id="edge217" class="edge">
<title>raw_213&#45;&gt;leaf_217</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15770.0445,-915.3896C15764.9751,-813.615 15743.7616,-314.9466 15807,-178.2001 15815.1907,-160.4886 15829.9968,-145.0669 15844.3789,-133.1552"/>
<polygon fill="#000000" stroke="#000000" points="15846.6079,-135.8547 15852.2806,-126.9065 15842.2658,-130.3641 15846.6079,-135.8547"/>
</g>
<!-- leaf_222 -->
<g id="node223" class="node">
<title>leaf_222</title>
<polygon fill="none" stroke="#c0c0c0" points="16504.5,-951.6014 16299.5,-951.6014 16299.5,-915.6014 16504.5,-915.6014 16504.5,-951.6014"/>
<text text-anchor="middle" x="16402" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:index(cursor)</text>
</g>
<!-- header_219&#45;&gt;leaf_222 -->
<g id="edge222" class="edge">
<title>header_219&#45;&gt;leaf_222</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16395.1128,-2042.2475C16395.9208,-1912.1832 16400.8251,-1122.7229 16401.8229,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="16405.3256,-961.6681 16401.8879,-951.6465 16398.3257,-961.6246 16405.3256,-961.6681"/>
</g>
<!-- raw_223 -->
<g id="node224" class="node">
<title>raw_223</title>
<ellipse fill="none" stroke="#000000" cx="16550" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="16550" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_220&#45;&gt;raw_223 -->
<g id="edge223" class="edge">
<title>prose_220&#45;&gt;raw_223</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16556.8872,-2042.2475C16556.0792,-1912.1832 16551.1749,-1122.7229 16550.1771,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="16553.6743,-961.6246 16550.1121,-951.6465 16546.6744,-961.6681 16553.6743,-961.6246"/>
</g>
<!-- leaf_225 -->
<g id="node226" class="node">
<title>leaf_225</title>
<polygon fill="none" stroke="#c0c0c0" points="17094.5,-1029.9019 16595.5,-1029.9019 16595.5,-837.3009 17094.5,-837.3009 17094.5,-1029.9019"/>
<text text-anchor="middle" x="16845" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.index(historian, cursor)</text>
<text text-anchor="middle" x="16845" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if (not cursor) or cursor &lt; 0 or cursor &gt; #historian + 1 then</text>
<text text-anchor="middle" x="16845" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="16845" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16845" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[cursor]</text>
<text text-anchor="middle" x="16845" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[cursor])</text>
<text text-anchor="middle" x="16845" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf = txtbuf:clone()</text>
<text text-anchor="middle" x="16845" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = cursor</text>
<text text-anchor="middle" x="16845" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = #txtbuf.lines</text>
<text text-anchor="middle" x="16845" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="16845" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return txtbuf, result</text>
<text text-anchor="middle" x="16845" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_221&#45;&gt;leaf_225 -->
<g id="edge225" class="edge">
<title>codeblock_221&#45;&gt;leaf_225</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16771.2084,-2042.2475C16778.8734,-1927.0892 16820.9444,-1295.0136 16837.907,-1040.1675"/>
<polygon fill="#000000" stroke="#000000" points="16841.4013,-1040.368 16838.5732,-1030.1576 16834.4167,-1039.903 16841.4013,-1040.368"/>
</g>
<!-- leaf_224 -->
<g id="node225" class="node">
<title>leaf_224</title>
<polygon fill="none" stroke="#c0c0c0" points="16684,-135.0015 16416,-135.0015 16416,-79.1986 16684,-79.1986 16684,-135.0015"/>
<text text-anchor="middle" x="16550" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Loads the history to an exact index.</text>
</g>
<!-- raw_223&#45;&gt;leaf_224 -->
<g id="edge224" class="edge">
<title>raw_223&#45;&gt;leaf_224</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16550,-915.5701C16550,-811.9323 16550,-291.6209 16550,-145.3846"/>
<polygon fill="#000000" stroke="#000000" points="16553.5001,-145.1211 16550,-135.1211 16546.5001,-145.1212 16553.5001,-145.1211"/>
</g>
<!-- leaf_232 -->
<g id="node233" class="node">
<title>leaf_232</title>
<polygon fill="none" stroke="#c0c0c0" points="17451,-951.6014 17113,-951.6014 17113,-915.6014 17451,-915.6014 17451,-951.6014"/>
<text text-anchor="middle" x="17282" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append(txtbuf, results, success)</text>
</g>
<!-- header_226&#45;&gt;leaf_232 -->
<g id="edge232" class="edge">
<title>header_226&#45;&gt;leaf_232</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17282,-2042.2475C17282,-1912.1832 17282,-1122.7229 17282,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="17285.5001,-961.6465 17282,-951.6465 17278.5001,-961.6466 17285.5001,-961.6465"/>
</g>
<!-- raw_233 -->
<g id="node234" class="node">
<title>raw_233</title>
<ellipse fill="none" stroke="#000000" cx="17496" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="17496" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_227&#45;&gt;raw_233 -->
<g id="edge233" class="edge">
<title>prose_227&#45;&gt;raw_233</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17516.6616,-2042.2475C17514.2377,-1912.1832 17499.5246,-1122.7229 17496.5312,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="17500.0221,-961.5796 17496.3363,-951.6465 17493.0233,-961.7101 17500.0221,-961.5796"/>
</g>
<!-- raw_235 -->
<g id="node236" class="node">
<title>raw_235</title>
<ellipse fill="none" stroke="#000000" cx="17568" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="17568" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_228&#45;&gt;raw_235 -->
<g id="edge235" class="edge">
<title>prose_228&#45;&gt;raw_235</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17598.5005,-2042.2475C17594.9222,-1912.1832 17573.203,-1122.7229 17568.7842,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="17572.2702,-961.5465 17568.4964,-951.6465 17565.2729,-961.739 17572.2702,-961.5465"/>
</g>
<!-- leaf_237 -->
<g id="node238" class="node">
<title>leaf_237</title>
<polygon fill="none" stroke="#c0c0c0" points="18063,-1045.2022 17613,-1045.2022 17613,-822.0006 18063,-822.0006 18063,-1045.2022"/>
<text text-anchor="middle" x="17838" y="-1030.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, txtbuf, results, success)</text>
<text text-anchor="middle" x="17838" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if tostring(historian[#historian]) == tostring(txtbuf)</text>
<text text-anchor="middle" x="17838" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;or tostring(txtbuf) == &quot;&quot; then</text>
<text text-anchor="middle" x="17838" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; don&#39;t bother</text>
<text text-anchor="middle" x="17838" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="17838" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="17838" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = txtbuf</text>
<text text-anchor="middle" x="17838" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if success then</text>
<text text-anchor="middle" x="17838" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian:persist(txtbuf, results)</text>
<text text-anchor="middle" x="17838" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="17838" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian:persist(txtbuf)</text>
<text text-anchor="middle" x="17838" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="17838" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="17838" y="-830.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_229&#45;&gt;leaf_237 -->
<g id="edge237" class="edge">
<title>codeblock_229&#45;&gt;leaf_237</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17788.8056,-2042.2475C17793.8158,-1929.3379 17820.8763,-1319.5018 17832.59,-1055.5216"/>
<polygon fill="#000000" stroke="#000000" points="17836.0873,-1055.6571 17833.0342,-1045.5118 17829.0942,-1055.3468 17836.0873,-1055.6571"/>
</g>
<!-- leaf_238 -->
<g id="node239" class="node">
<title>leaf_238</title>
<polygon fill="none" stroke="#c0c0c0" points="18349,-984.0024 18081,-984.0024 18081,-883.2004 18349,-883.2004 18349,-984.0024"/>
<text text-anchor="middle" x="18215" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new()</text>
<text text-anchor="middle" x="18215" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="18215" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="18215" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="18215" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="18215" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_230&#45;&gt;leaf_238 -->
<g id="edge238" class="edge">
<title>codeblock_230&#45;&gt;leaf_238</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M18099.8852,-2042.2475C18112.6456,-1919.3542 18186.532,-1207.771 18208.7087,-994.1916"/>
<polygon fill="#000000" stroke="#000000" points="18212.2046,-994.4116 18209.7562,-984.1036 18205.242,-993.6886 18212.2046,-994.4116"/>
</g>
<!-- leaf_239 -->
<g id="node240" class="node">
<title>leaf_239</title>
<polygon fill="none" stroke="#c0c0c0" points="18453,-951.6014 18367,-951.6014 18367,-915.6014 18453,-915.6014 18453,-951.6014"/>
<text text-anchor="middle" x="18410" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_231&#45;&gt;leaf_239 -->
<g id="edge239" class="edge">
<title>codeblock_231&#45;&gt;leaf_239</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M18409.0161,-2042.2475C18409.1315,-1912.1832 18409.8322,-1122.7229 18409.9747,-962.1065"/>
<polygon fill="#000000" stroke="#000000" points="18413.475,-961.6497 18409.984,-951.6465 18406.475,-961.6434 18413.475,-961.6497"/>
</g>
<!-- leaf_234 -->
<g id="node235" class="node">
<title>leaf_234</title>
<polygon fill="none" stroke="#c0c0c0" points="17554,-135.0015 17230,-135.0015 17230,-79.1986 17554,-79.1986 17554,-135.0015"/>
<text text-anchor="middle" x="17392" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Appends a txtbuf to history and persists it.</text>
</g>
<!-- raw_233&#45;&gt;leaf_234 -->
<g id="edge234" class="edge">
<title>raw_233&#45;&gt;leaf_234</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17499.5607,-915.5747C17515.7539,-829.1565 17576.7573,-450.2758 17460,-178.2001 17454.3088,-164.9381 17444.967,-152.6852 17435.0043,-142.22"/>
<polygon fill="#000000" stroke="#000000" points="17437.2381,-139.505 17427.6835,-134.9268 17432.2977,-144.4641 17437.2381,-139.505"/>
</g>
<!-- leaf_236 -->
<g id="node237" class="node">
<title>leaf_236</title>
<polygon fill="none" stroke="#c0c0c0" points="17770,-127.0021 17572,-127.0021 17572,-87.198 17770,-87.198 17770,-127.0021"/>
<text text-anchor="middle" x="17671" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Doesn&#39;t adjust the cursor.</text>
</g>
<!-- raw_235&#45;&gt;leaf_236 -->
<g id="edge236" class="edge">
<title>raw_235&#45;&gt;leaf_236</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17564.4822,-915.593C17548.486,-829.2589 17488.2498,-450.7058 17604,-178.2001 17611.206,-161.2354 17624.3675,-145.8615 17637.1297,-133.7848"/>
<polygon fill="#000000" stroke="#000000" points="17639.4849,-136.374 17644.5498,-127.0682 17634.7872,-131.1843 17639.4849,-136.374"/>
</g>
</g>
</svg>
