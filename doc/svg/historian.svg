<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="6910pt" height="1381pt"
 viewBox="0.00 0.00 6910.00 1381.44" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1377.4418)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1377.4418 6906,-1377.4418 6906,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1728" cy="-1355.4418" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1728" y="-1351.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 228</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1728" cy="-1283.4418" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1728" y="-1279.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;162</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1728,-1337.2731C1728,-1329.5727 1728,-1320.4161 1728,-1311.8584"/>
<polygon fill="#000000" stroke="#000000" points="1731.5001,-1311.855 1728,-1301.855 1724.5001,-1311.8551 1731.5001,-1311.855"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1305" cy="-1211.4418" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1305" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1667.7149,-1276.0845C1597.1794,-1267.0461 1477.0436,-1250.3123 1375,-1229.4418 1369.6215,-1228.3417 1364.037,-1227.092 1358.4738,-1225.7758"/>
<polygon fill="#000000" stroke="#000000" points="1359.0769,-1222.3204 1348.5325,-1223.3529 1357.4193,-1229.1213 1359.0769,-1222.3204"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1416" cy="-1211.4418" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1416" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1669.191,-1275.2853C1613.8997,-1266.7747 1529.2172,-1251.5611 1458,-1229.4418 1455.5472,-1228.68 1453.0431,-1227.823 1450.5399,-1226.907"/>
<polygon fill="#000000" stroke="#000000" points="1451.5872,-1223.5581 1440.9998,-1223.1589 1449.0274,-1230.0733 1451.5872,-1223.5581"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1499" cy="-1211.4418" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1499" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1679.4359,-1271.187C1641.3795,-1261.1606 1587.3029,-1245.9776 1541,-1229.4418 1538.5813,-1228.578 1536.1026,-1227.6448 1533.6178,-1226.6736"/>
<polygon fill="#000000" stroke="#000000" points="1534.6994,-1223.335 1524.1178,-1222.8055 1532.0596,-1229.8182 1534.6994,-1223.335"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1582" cy="-1211.4418" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1582" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1695.9597,-1267.6411C1672.0983,-1255.8738 1639.6044,-1239.8494 1615.4189,-1227.9223"/>
<polygon fill="#000000" stroke="#000000" points="1616.7832,-1224.6927 1606.2664,-1223.4088 1613.6871,-1230.9708 1616.7832,-1224.6927"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1664" cy="-1211.4418" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1664" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1712.1798,-1265.644C1704.1184,-1256.5749 1694.1979,-1245.4144 1685.4584,-1235.5824"/>
<polygon fill="#000000" stroke="#000000" points="1688.0204,-1233.1964 1678.7607,-1228.0476 1682.7885,-1237.847 1688.0204,-1233.1964"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1792" cy="-1211.4418" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1792" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;23</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1743.8202,-1265.644C1751.5126,-1256.99 1760.8978,-1246.4317 1769.3344,-1236.9406"/>
<polygon fill="#000000" stroke="#000000" points="1772.1122,-1239.0837 1776.14,-1229.2843 1766.8803,-1234.4331 1772.1122,-1239.0837"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="2009" cy="-1211.4418" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2009" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 25&#45;27</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1775.9863,-1271.1463C1823.2571,-1259.0342 1895.679,-1240.4777 1947.2255,-1227.2701"/>
<polygon fill="#000000" stroke="#000000" points="1948.1011,-1230.6589 1956.9194,-1224.7862 1946.3636,-1223.8779 1948.1011,-1230.6589"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2315" cy="-1211.4418" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2315" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 30&#45;73</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1788.0607,-1276.0749C1897.4038,-1262.6631 2128.3921,-1234.3306 2244.8035,-1220.0519"/>
<polygon fill="#000000" stroke="#000000" points="2245.5247,-1223.4898 2255.0242,-1218.7983 2244.6724,-1216.5418 2245.5247,-1223.4898"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="3329" cy="-1211.4418" rx="70.655" ry="18"/>
<text text-anchor="middle" x="3329" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 74&#45;162</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1792.9938,-1280.5189C2046.9008,-1269.1002 2971.5308,-1227.5178 3249.4574,-1215.0189"/>
<polygon fill="#000000" stroke="#000000" points="3249.6298,-1218.5148 3259.4624,-1214.569 3249.3152,-1211.5219 3249.6298,-1218.5148"/>
</g>
<!-- section_11 -->
<g id="node12" class="node">
<title>section_11</title>
<ellipse fill="none" stroke="#000000" cx="4699" cy="-1211.4418" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4699" y="-1207.2418" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 163&#45;203</text>
</g>
<!-- section_1&#45;&gt;section_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;section_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1793.5161,-1281.854C2181.3909,-1272.4542 4174.8089,-1224.1451 4613.5287,-1213.5131"/>
<polygon fill="#000000" stroke="#000000" points="4613.6892,-1217.0103 4623.6015,-1213.269 4613.5196,-1210.0124 4613.6892,-1217.0103"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1350.5,-1125.2417 1257.5,-1125.2417 1257.5,-1089.2417 1350.5,-1089.2417 1350.5,-1125.2417"/>
<text text-anchor="middle" x="1304" y="-1103.7417" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>header_2&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1304.8258,-1193.2915C1304.6733,-1177.4015 1304.4492,-1154.0489 1304.2729,-1135.6794"/>
<polygon fill="#000000" stroke="#000000" points="1307.7714,-1135.4995 1304.1755,-1125.5336 1300.7718,-1135.5667 1307.7714,-1135.4995"/>
</g>
<!-- raw_13 -->
<g id="node14" class="node">
<title>raw_13</title>
<ellipse fill="none" stroke="#000000" cx="1396" cy="-1107.2417" rx="27" ry="18"/>
<text text-anchor="middle" x="1396" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_13 -->
<g id="edge13" class="edge">
<title>prose_3&#45;&gt;raw_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1412.5163,-1193.2915C1409.4333,-1177.2293 1404.8868,-1153.5419 1401.344,-1135.0839"/>
<polygon fill="#000000" stroke="#000000" points="1404.7661,-1134.3449 1399.4438,-1125.1839 1397.8916,-1135.6645 1404.7661,-1134.3449"/>
</g>
<!-- raw_15 -->
<g id="node16" class="node">
<title>raw_15</title>
<ellipse fill="none" stroke="#000000" cx="1468" cy="-1107.2417" rx="27" ry="18"/>
<text text-anchor="middle" x="1468" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_15 -->
<g id="edge15" class="edge">
<title>prose_4&#45;&gt;raw_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1493.6002,-1193.2915C1488.7994,-1177.1546 1481.7089,-1153.3214 1476.2067,-1134.8267"/>
<polygon fill="#000000" stroke="#000000" points="1479.5442,-1133.7707 1473.3379,-1125.1839 1472.8348,-1135.7668 1479.5442,-1133.7707"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="1540" cy="-1107.2417" rx="27" ry="18"/>
<text text-anchor="middle" x="1540" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_5&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1574.8753,-1193.7656C1568.2889,-1177.4252 1558.4065,-1152.9074 1550.8413,-1134.1385"/>
<polygon fill="#000000" stroke="#000000" points="1554.0042,-1132.6232 1547.0195,-1124.6567 1547.5118,-1135.2401 1554.0042,-1132.6232"/>
</g>
<!-- raw_19 -->
<g id="node20" class="node">
<title>raw_19</title>
<ellipse fill="none" stroke="#000000" cx="1612" cy="-1107.2417" rx="27" ry="18"/>
<text text-anchor="middle" x="1612" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_19 -->
<g id="edge19" class="edge">
<title>prose_6&#45;&gt;raw_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1655.1789,-1193.7656C1646.9492,-1177.2746 1634.5632,-1152.4548 1625.1643,-1133.621"/>
<polygon fill="#000000" stroke="#000000" points="1628.2878,-1132.0416 1620.6908,-1124.6567 1622.0244,-1135.1673 1628.2878,-1132.0416"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1939,-1157.6427 1657,-1157.6427 1657,-1056.8407 1939,-1056.8407 1939,-1157.6427"/>
<text text-anchor="middle" x="1798" y="-1142.2418" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = require &quot;linebuf&quot;</text>
<text text-anchor="middle" x="1798" y="-1126.8417" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1798" y="-1111.4417" font-family="Inconsolata" font-size="14.00" fill="#000000">local L &#160;&#160;&#160;&#160;&#160;&#160;= require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1798" y="-1096.0417" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
<text text-anchor="middle" x="1798" y="-1080.6416" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub &#160;&#160;&#160;&#160;= assert (string.sub)</text>
<text text-anchor="middle" x="1798" y="-1065.2416" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(meta)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_7&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1793.0451,-1193.2915C1793.4643,-1186.012 1793.9736,-1177.1664 1794.5043,-1167.9512"/>
<polygon fill="#000000" stroke="#000000" points="1798.0044,-1168.0479 1795.0851,-1157.8632 1791.016,-1167.6454 1798.0044,-1168.0479"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2148.5,-1125.2417 1957.5,-1125.2417 1957.5,-1089.2417 2148.5,-1089.2417 2148.5,-1125.2417"/>
<text text-anchor="middle" x="2053" y="-1103.7417" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_8&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2016.6642,-1193.2915C2023.4681,-1177.1787 2033.5121,-1153.3927 2041.3167,-1134.9098"/>
<polygon fill="#000000" stroke="#000000" points="2044.6102,-1136.1075 2045.276,-1125.5336 2038.1615,-1133.3844 2044.6102,-1136.1075"/>
</g>
<!-- header_23 -->
<g id="node24" class="node">
<title>header_23</title>
<ellipse fill="none" stroke="#000000" cx="2249" cy="-1107.2417" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2249" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:load()</text>
</g>
<!-- section_9&#45;&gt;header_23 -->
<g id="edge23" class="edge">
<title>section_9&#45;&gt;header_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2303.5037,-1193.2915C2293.0933,-1176.8557 2277.626,-1152.436 2265.825,-1133.8048"/>
<polygon fill="#000000" stroke="#000000" points="2268.6723,-1131.7591 2260.3646,-1125.1839 2262.7587,-1135.5047 2268.6723,-1131.7591"/>
</g>
<!-- prose_24 -->
<g id="node25" class="node">
<title>prose_24</title>
<ellipse fill="none" stroke="#000000" cx="2382" cy="-1107.2417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2382" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;prose_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2326.6705,-1193.2915C2337.3675,-1176.6553 2353.324,-1151.8392 2365.3567,-1133.1258"/>
<polygon fill="#000000" stroke="#000000" points="2368.4436,-1134.7962 2370.9081,-1124.492 2362.5557,-1131.0103 2368.4436,-1134.7962"/>
</g>
<!-- codeblock_25 -->
<g id="node26" class="node">
<title>codeblock_25</title>
<ellipse fill="none" stroke="#000000" cx="2633" cy="-1107.2417" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2633" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 34&#45;71</text>
</g>
<!-- section_9&#45;&gt;codeblock_25 -->
<g id="edge25" class="edge">
<title>section_9&#45;&gt;codeblock_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2357.2279,-1197.6048C2414.1594,-1178.9499 2515.6057,-1145.7086 2578.3115,-1125.1616"/>
<polygon fill="#000000" stroke="#000000" points="2579.6171,-1128.417 2588.03,-1121.9771 2577.4373,-1121.765 2579.6171,-1128.417"/>
</g>
<!-- header_36 -->
<g id="node37" class="node">
<title>header_36</title>
<ellipse fill="none" stroke="#000000" cx="3171" cy="-1107.2417" rx="107.339" ry="18"/>
<text text-anchor="middle" x="3171" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_10&#45;&gt;header_36 -->
<g id="edge36" class="edge">
<title>section_10&#45;&gt;header_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3303.2629,-1194.4683C3276.8741,-1177.065 3235.6436,-1149.8737 3206.235,-1130.479"/>
<polygon fill="#000000" stroke="#000000" points="3207.7923,-1127.3134 3197.5173,-1124.7297 3203.9384,-1133.157 3207.7923,-1127.3134"/>
</g>
<!-- prose_37 -->
<g id="node38" class="node">
<title>prose_37</title>
<ellipse fill="none" stroke="#000000" cx="3329" cy="-1107.2417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3329" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_37 -->
<g id="edge37" class="edge">
<title>section_10&#45;&gt;prose_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3329,-1193.2915C3329,-1177.4015 3329,-1154.0489 3329,-1135.6794"/>
<polygon fill="#000000" stroke="#000000" points="3332.5001,-1135.5335 3329,-1125.5336 3325.5001,-1135.5336 3332.5001,-1135.5335"/>
</g>
<!-- codeblock_38 -->
<g id="node39" class="node">
<title>codeblock_38</title>
<ellipse fill="none" stroke="#000000" cx="3538" cy="-1107.2417" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="3538" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 76&#45;118</text>
</g>
<!-- section_10&#45;&gt;codeblock_38 -->
<g id="edge38" class="edge">
<title>section_10&#45;&gt;codeblock_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3361.1982,-1195.3889C3397.2402,-1177.4196 3455.7889,-1148.2292 3495.5491,-1128.4062"/>
<polygon fill="#000000" stroke="#000000" points="3497.3404,-1131.4241 3504.7281,-1123.8299 3494.217,-1125.1595 3497.3404,-1131.4241"/>
</g>
<!-- codeblock_39 -->
<g id="node40" class="node">
<title>codeblock_39</title>
<ellipse fill="none" stroke="#000000" cx="3921" cy="-1107.2417" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3921" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 121&#45;160</text>
</g>
<!-- section_10&#45;&gt;codeblock_39 -->
<g id="edge39" class="edge">
<title>section_10&#45;&gt;codeblock_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3387.1121,-1201.2132C3494.6466,-1182.2857 3724.6218,-1141.8069 3844.6,-1120.6891"/>
<polygon fill="#000000" stroke="#000000" points="3845.2108,-1124.1355 3854.4527,-1118.9549 3843.9973,-1117.2415 3845.2108,-1124.1355"/>
</g>
<!-- header_45 -->
<g id="node46" class="node">
<title>header_45</title>
<ellipse fill="none" stroke="#000000" cx="4448" cy="-1107.2417" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="4448" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_11&#45;&gt;header_45 -->
<g id="edge45" class="edge">
<title>section_11&#45;&gt;header_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4661.151,-1195.7291C4616.9842,-1177.3937 4543.889,-1147.049 4495.8318,-1127.0985"/>
<polygon fill="#000000" stroke="#000000" points="4497.1479,-1123.8553 4486.5701,-1123.2537 4494.4639,-1130.3204 4497.1479,-1123.8553"/>
</g>
<!-- prose_46 -->
<g id="node47" class="node">
<title>prose_46</title>
<ellipse fill="none" stroke="#000000" cx="4620" cy="-1107.2417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4620" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_46 -->
<g id="edge46" class="edge">
<title>section_11&#45;&gt;prose_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4685.2393,-1193.2915C4672.4351,-1176.4029 4653.2397,-1151.0845 4638.9818,-1132.2784"/>
<polygon fill="#000000" stroke="#000000" points="4641.6496,-1130.0039 4632.819,-1124.1498 4636.0715,-1134.233 4641.6496,-1130.0039"/>
</g>
<!-- codeblock_47 -->
<g id="node48" class="node">
<title>codeblock_47</title>
<ellipse fill="none" stroke="#000000" cx="4768" cy="-1107.2417" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4768" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 165&#45;177</text>
</g>
<!-- section_11&#45;&gt;codeblock_47 -->
<g id="edge47" class="edge">
<title>section_11&#45;&gt;codeblock_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4711.0189,-1193.2915C4721.9519,-1176.781 4738.22,-1152.2139 4750.5782,-1133.5511"/>
<polygon fill="#000000" stroke="#000000" points="4753.5159,-1135.4541 4756.1188,-1125.1839 4747.6795,-1131.5893 4753.5159,-1135.4541"/>
</g>
<!-- section_48 -->
<g id="node49" class="node">
<title>section_48</title>
<ellipse fill="none" stroke="#000000" cx="5137" cy="-1107.2417" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="5137" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 180&#45;203</text>
</g>
<!-- section_11&#45;&gt;section_48 -->
<g id="edge48" class="edge">
<title>section_11&#45;&gt;section_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4752.7074,-1198.6648C4833.7895,-1179.3754 4987.1422,-1142.8928 5073.5935,-1122.326"/>
<polygon fill="#000000" stroke="#000000" points="5074.6207,-1125.6795 5083.5391,-1119.96 5073.0005,-1118.8695 5074.6207,-1125.6795"/>
</g>
<!-- section_49 -->
<g id="node50" class="node">
<title>section_49</title>
<ellipse fill="none" stroke="#000000" cx="6080" cy="-1107.2417" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="6080" y="-1103.0417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 204&#45;228</text>
</g>
<!-- section_11&#45;&gt;section_49 -->
<g id="edge49" class="edge">
<title>section_11&#45;&gt;section_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4771.3042,-1205.9862C5006.5471,-1188.2365 5749.2449,-1132.198 5997.9422,-1113.4331"/>
<polygon fill="#000000" stroke="#000000" points="5998.2884,-1116.9171 6007.9967,-1112.6745 5997.7616,-1109.9369 5998.2884,-1116.9171"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-736.3421 0,-736.3421 0,-664.5398 324,-664.5398 324,-736.3421"/>
<text text-anchor="middle" x="162" y="-672.941" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_13&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>raw_13&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1388.0869,-1089.5198C1381.9347,-1078.0549 1372.2154,-1064.0118 1359,-1057.0416 1258.1038,-1003.8254 429.7711,-1081.4349 333,-1021.0416 233.8435,-959.1596 188.6428,-818.9098 171.2372,-746.1493"/>
<polygon fill="#000000" stroke="#000000" points="174.6323,-745.2959 168.963,-736.3455 167.8134,-746.8778 174.6323,-745.2959"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-727.7414 342.5,-727.7414 342.5,-673.1406 897.5,-673.1406 897.5,-727.7414"/>
<text text-anchor="middle" x="620" y="-696.641" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_15&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_15&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1460.3446,-1089.6704C1454.3783,-1078.2726 1444.927,-1064.2481 1432,-1057.0416 1329.8589,-1000.1003 1012.0662,-1072.3856 907,-1021.0416 776.9255,-957.4763 679.3141,-806.4195 639.5592,-736.7665"/>
<polygon fill="#000000" stroke="#000000" points="642.5163,-734.8848 634.5567,-727.8923 636.4184,-738.3223 642.5163,-734.8848"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-727.7414 916,-727.7414 916,-673.1406 1464,-673.1406 1464,-727.7414"/>
<text text-anchor="middle" x="1190" y="-696.641" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1528.7301,-1090.6589C1521.828,-1080.7268 1512.6802,-1067.952 1504,-1057.0416 1490.8491,-1040.5117 1297.6778,-822.0903 1221.0168,-735.4749"/>
<polygon fill="#000000" stroke="#000000" points="1223.4355,-732.9268 1214.1868,-727.7584 1218.1939,-737.5663 1223.4355,-732.9268"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-735.7413 1482,-735.7413 1482,-665.1406 2030,-665.1406 2030,-735.7413"/>
<text text-anchor="middle" x="1756" y="-704.641" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new linebuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-689.241" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_19&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>raw_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1618.2801,-1089.5004C1639.4377,-1029.73 1708.5481,-834.4929 1740.0699,-745.4437"/>
<polygon fill="#000000" stroke="#000000" points="1743.4143,-746.4842 1743.4519,-735.8894 1736.8155,-744.1483 1743.4143,-746.4842"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2197.5,-718.441 2048.5,-718.441 2048.5,-682.441 2197.5,-682.441 2197.5,-718.441"/>
<text text-anchor="middle" x="2123" y="-696.941" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:load()</text>
</g>
<!-- header_23&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>header_23&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2238.9108,-1089.2057C2229.6449,-1072.0759 2216.0223,-1045.3935 2207,-1021.0416 2168.0322,-915.8645 2139.7037,-784.9696 2128.4065,-728.5093"/>
<polygon fill="#000000" stroke="#000000" points="2131.81,-727.6781 2126.4361,-718.5472 2124.943,-729.0363 2131.81,-727.6781"/>
</g>
<!-- raw_27 -->
<g id="node28" class="node">
<title>raw_27</title>
<ellipse fill="none" stroke="#000000" cx="2243" cy="-700.441" rx="27" ry="18"/>
<text text-anchor="middle" x="2243" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_24&#45;&gt;raw_27 -->
<g id="edge27" class="edge">
<title>prose_24&#45;&gt;raw_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2370.0342,-1090.1484C2362.2462,-1079.7895 2351.4372,-1066.7461 2340,-1057.0416 2315.9963,-1036.6741 2296.113,-1047.4642 2279,-1021.0416 2218.9504,-928.3242 2230.0592,-788.1815 2238.3255,-728.7177"/>
<polygon fill="#000000" stroke="#000000" points="2241.8236,-728.9863 2239.8181,-718.583 2234.8983,-727.9663 2241.8236,-728.9863"/>
</g>
<!-- prespace_28 -->
<g id="node29" class="node">
<title>prespace_28</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-700.441" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2334" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_24&#45;&gt;prespace_28 -->
<g id="edge28" class="edge">
<title>prose_24&#45;&gt;prespace_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2379.8756,-1089.237C2372.3031,-1025.0599 2346.5917,-807.1554 2337.3461,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="2340.8021,-728.2202 2336.1544,-718.6992 2333.8504,-729.0405 2340.8021,-728.2202"/>
</g>
<!-- literal_29 -->
<g id="node30" class="node">
<title>literal_29</title>
<ellipse fill="none" stroke="#000000" cx="2430" cy="-700.441" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2430" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_24&#45;&gt;literal_29 -->
<g id="edge29" class="edge">
<title>prose_24&#45;&gt;literal_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2384.1244,-1089.237C2391.6969,-1025.0599 2417.4083,-807.1554 2426.6539,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="2430.1496,-729.0405 2427.8456,-718.6992 2423.1979,-728.2202 2430.1496,-729.0405"/>
</g>
<!-- raw_30 -->
<g id="node31" class="node">
<title>raw_30</title>
<ellipse fill="none" stroke="#000000" cx="2506" cy="-700.441" rx="27" ry="18"/>
<text text-anchor="middle" x="2506" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_24&#45;&gt;raw_30 -->
<g id="edge30" class="edge">
<title>prose_24&#45;&gt;raw_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2403.1257,-1093.2252C2423.9917,-1078.1044 2454.9064,-1051.9888 2470,-1021.0416 2518.0924,-922.4349 2513.6658,-787.0317 2508.9338,-728.8693"/>
<polygon fill="#000000" stroke="#000000" points="2512.3946,-728.2704 2508.029,-718.6168 2505.4217,-728.8858 2512.3946,-728.2704"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3057,-983.4419 2551,-983.4419 2551,-417.44 3057,-417.44 3057,-983.4419"/>
<text text-anchor="middle" x="2804" y="-968.2414" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 1000</text>
<text text-anchor="middle" x="2804" y="-936.8414" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2804" y="-921.4414" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS repl (</text>
<text text-anchor="middle" x="2804" y="-906.0414" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2804" y="-890.6413" font-family="Inconsolata" font-size="14.00" fill="#000000">project TEXT,</text>
<text text-anchor="middle" x="2804" y="-875.2413" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2804" y="-859.8413" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP);</text>
<text text-anchor="middle" x="2804" y="-844.4412" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-813.0412" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line_stmt = [[</text>
<text text-anchor="middle" x="2804" y="-797.6412" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES(:project, :line);</text>
<text text-anchor="middle" x="2804" y="-782.2411" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-750.8411" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2804" y="-735.4411" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2804" y="-720.041" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-688.641" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2804" y="-673.241" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT line FROM repl</text>
<text text-anchor="middle" x="2804" y="-657.8409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %s</text>
<text text-anchor="middle" x="2804" y="-642.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2804" y="-627.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2804" y="-611.6409" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-580.2408" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-564.8408" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-533.4408" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2804" y="-518.0407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2804" y="-502.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2804" y="-487.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-471.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-456.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-441.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2804" y="-425.6405" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_25&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>codeblock_25&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2640.5683,-1089.237C2648.9811,-1069.2234 2663.6781,-1034.2599 2680.9207,-993.2406"/>
<polygon fill="#000000" stroke="#000000" points="2684.2264,-994.4086 2684.875,-983.8336 2677.7733,-991.696 2684.2264,-994.4086"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2292,-245.5217 1926,-245.5217 1926,-189.7187 2292,-189.7187 2292,-245.5217"/>
<text text-anchor="middle" x="2109" y="-198.1202" font-family="Inconsolata" font-size="14.00" fill="#000000">This is where we either create query or create our</text>
</g>
<!-- raw_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>raw_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2243.5391,-682.1353C2244.4542,-632.1895 2243.333,-489.944 2206,-379.8404 2190.1561,-333.1131 2159.4604,-285.313 2136.8255,-253.8207"/>
<polygon fill="#000000" stroke="#000000" points="2139.3941,-251.4028 2130.6741,-245.3851 2133.7382,-255.5272 2139.3941,-251.4028"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2364,-235.6202 2310,-235.6202 2310,-199.6202 2364,-199.6202 2364,-235.6202"/>
<text text-anchor="middle" x="2337" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>prespace_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334.1121,-682.395C2334.566,-609.3458 2336.2692,-335.2408 2336.824,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="2340.325,-245.7784 2336.8873,-235.7568 2333.3251,-245.7348 2340.325,-245.7784"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2466.5,-235.6202 2387.5,-235.6202 2387.5,-199.6202 2466.5,-199.6202 2466.5,-235.6202"/>
<text text-anchor="middle" x="2427" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000">~/.bridge</text>
</g>
<!-- literal_29&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>literal_29&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2429.8879,-682.395C2429.434,-609.3458 2427.7308,-335.2408 2427.176,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="2430.6749,-245.7348 2427.1127,-235.7568 2423.675,-245.7784 2430.6749,-245.7348"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2571,-235.6202 2485,-235.6202 2485,-199.6202 2571,-199.6202 2571,-235.6202"/>
<text text-anchor="middle" x="2528" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> database.</text>
</g>
<!-- raw_30&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>raw_30&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2506.8223,-682.395C2510.1508,-609.3458 2522.6405,-335.2408 2526.7097,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="2530.2147,-245.9058 2527.1736,-235.7568 2523.2219,-245.5871 2530.2147,-245.9058"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3266.5,-718.441 3075.5,-718.441 3075.5,-682.441 3266.5,-682.441 3266.5,-718.441"/>
<text text-anchor="middle" x="3171" y="-696.941" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_36&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>header_36&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3171,-1089.237C3171,-1025.0599 3171,-807.1554 3171,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="3174.5001,-728.6992 3171,-718.6992 3167.5001,-728.6993 3174.5001,-728.6992"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="3312" cy="-700.441" rx="27" ry="18"/>
<text text-anchor="middle" x="3312" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_37&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_37&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3328.2476,-1089.237C3325.5657,-1025.0599 3316.4595,-807.1554 3313.1851,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="3316.6776,-728.5443 3312.763,-718.6992 3309.6837,-728.8367 3316.6776,-728.5443"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3870.5,-1021.1422 3357.5,-1021.1422 3357.5,-379.7398 3870.5,-379.7398 3870.5,-1021.1422"/>
<text text-anchor="middle" x="3614" y="-1005.8416" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, match = L.P, L.match</text>
<text text-anchor="middle" x="3614" y="-974.4415" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; second_best is broke and I don&#39;t know why</text>
<text text-anchor="middle" x="3614" y="-959.0415" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; also this fails on a single key search &gt;.&lt;</text>
<text text-anchor="middle" x="3614" y="-943.6415" font-family="Inconsolata" font-size="14.00" fill="#000000">local function fuzz_patt(frag)</text>
<text text-anchor="middle" x="3614" y="-928.2414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;frag = type(frag) == &quot;string&quot; and codepoints(frag) or frag</text>
<text text-anchor="middle" x="3614" y="-912.8414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = &#160;&#160;&#160;&#160;&#160;&#160;&#160;(P(1) &#45; P(frag[1]))^0</text>
<text text-anchor="middle" x="3614" y="-897.4414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1 , #frag &#45; 1 do</text>
<text text-anchor="middle" x="3614" y="-882.0414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local v = frag[i]</text>
<text text-anchor="middle" x="3614" y="-866.6413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = patt * (P(v) * (P(1) &#45; P(frag[i + 1]))^0)</text>
<text text-anchor="middle" x="3614" y="-851.2413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-835.8413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;patt = patt * P(frag[#frag])</text>
<text text-anchor="middle" x="3614" y="-820.4412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return patt</text>
<text text-anchor="middle" x="3614" y="-805.0412" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3614" y="-773.6412" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.search(historian, frag)</text>
<text text-anchor="middle" x="3614" y="-758.2411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local collection = {}</text>
<text text-anchor="middle" x="3614" y="-742.8411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local best = true</text>
<text text-anchor="middle" x="3614" y="-727.4411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = fuzz_patt(frag)</text>
<text text-anchor="middle" x="3614" y="-712.041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="3614" y="-696.641" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="3614" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="3614" y="-665.8409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="3614" y="-650.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-635.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-619.6409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local slip = &quot;&quot;</text>
<text text-anchor="middle" x="3614" y="-604.2408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="3614" y="-588.8408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; try the transpose</text>
<text text-anchor="middle" x="3614" y="-573.4408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;best = false</text>
<text text-anchor="middle" x="3614" y="-558.0407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;slip = sub(frag, 1, &#45;3) .. sub(frag, &#45;1, &#45;1) .. sub(frag, &#45;2, &#45;2)</text>
<text text-anchor="middle" x="3614" y="-542.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local second = fuzz_patt(slip)</text>
<text text-anchor="middle" x="3614" y="-527.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="3614" y="-511.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local score = match(second, tostring(historian[i]))</text>
<text text-anchor="middle" x="3614" y="-496.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="3614" y="-481.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="3614" y="-465.6405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-450.2405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-434.8405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-403.4404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return collection, best, slip</text>
<text text-anchor="middle" x="3614" y="-388.0404" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_38&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_38&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3541.3637,-1089.237C3543.8871,-1075.7303 3547.6826,-1055.4143 3552.2394,-1031.0232"/>
<polygon fill="#000000" stroke="#000000" points="3555.6971,-1031.5736 3554.0931,-1021.1009 3548.8161,-1030.288 3555.6971,-1031.5736"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="4345.5,-997.8422 3888.5,-997.8422 3888.5,-403.0397 4345.5,-403.0397 4345.5,-997.8422"/>
<text text-anchor="middle" x="4117" y="-982.4415" font-family="Inconsolata" font-size="14.00" fill="#000000">local reverse = assert(table.reverse)</text>
<text text-anchor="middle" x="4117" y="-951.0415" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="4117" y="-935.6415" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.home_dir .. &quot;/.bridge&quot;)</text>
<text text-anchor="middle" x="4117" y="-920.2414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="4117" y="-904.8414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local table_names = conn:exec(get_tables)</text>
<text text-anchor="middle" x="4117" y="-889.4414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not table_names or not has(table_names.name, &quot;repl&quot;) then</text>
<text text-anchor="middle" x="4117" y="-874.0414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local success, err = sql.pexec(conn, create_repl_table)</text>
<text text-anchor="middle" x="4117" y="-858.6413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; success is nil for creation, false for error</text>
<text text-anchor="middle" x="4117" y="-843.2413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if success == false then</text>
<text text-anchor="middle" x="4117" y="-827.8413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="4117" y="-812.4412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-797.0412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-781.6412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt = conn:prepare(insert_line_stmt)</text>
<text text-anchor="middle" x="4117" y="-766.2411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_stmt = sql.format(get_recent, historian.project,</text>
<text text-anchor="middle" x="4117" y="-750.8411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="4117" y="-735.4411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local values, err = sql.pexec(conn, pop_stmt)</text>
<text text-anchor="middle" x="4117" y="-720.041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if values then</text>
<text text-anchor="middle" x="4117" y="-704.641" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i,v in ipairs(reverse(values[1])) do</text>
<text text-anchor="middle" x="4117" y="-689.241" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = Linebuf(v)</text>
<text text-anchor="middle" x="4117" y="-673.8409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-658.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="4117" y="-643.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.up = false</text>
<text text-anchor="middle" x="4117" y="-627.6409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-612.2408" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4117" y="-580.8408" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, linebuf)</text>
<text text-anchor="middle" x="4117" y="-565.4408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="4117" y="-550.0407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt:bindkv { project = historian.project,</text>
<text text-anchor="middle" x="4117" y="-534.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;line &#160;&#160;&#160;= lb }</text>
<text text-anchor="middle" x="4117" y="-519.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local err = historian.insert_stmt:step()</text>
<text text-anchor="middle" x="4117" y="-503.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not err then</text>
<text text-anchor="middle" x="4117" y="-488.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_stmt:clearbind():reset()</text>
<text text-anchor="middle" x="4117" y="-473.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="4117" y="-457.6405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;error(error)</text>
<text text-anchor="middle" x="4117" y="-442.2405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-426.8405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="4117" y="-411.4404" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_39&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_39&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3929.6748,-1089.237C3938.212,-1071.5179 3952.3953,-1042.0802 3969.2508,-1007.0965"/>
<polygon fill="#000000" stroke="#000000" points="3972.4044,-1008.6146 3973.5918,-998.0866 3966.0981,-1005.5762 3972.4044,-1008.6146"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="3339,-235.6202 3285,-235.6202 3285,-199.6202 3339,-199.6202 3339,-235.6202"/>
</g>
<!-- raw_41&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_41&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3312,-682.395C3312,-609.3458 3312,-335.2408 3312,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="3315.5001,-245.7567 3312,-235.7568 3308.5001,-245.7568 3315.5001,-245.7567"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="4512.5,-718.441 4363.5,-718.441 4363.5,-682.441 4512.5,-682.441 4512.5,-718.441"/>
<text text-anchor="middle" x="4438" y="-696.941" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_45&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>header_45&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4447.5574,-1089.237C4445.9798,-1025.0599 4440.6233,-807.1554 4438.6971,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="4442.1936,-728.6102 4438.4488,-718.6992 4435.1957,-728.7822 4442.1936,-728.6102"/>
</g>
<!-- raw_51 -->
<g id="node52" class="node">
<title>raw_51</title>
<ellipse fill="none" stroke="#000000" cx="4558" cy="-700.441" rx="27" ry="18"/>
<text text-anchor="middle" x="4558" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_46&#45;&gt;raw_51 -->
<g id="edge51" class="edge">
<title>prose_46&#45;&gt;raw_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4613.5555,-1089.324C4607.5942,-1072.0562 4598.9329,-1045.0817 4594,-1021.0416 4572.1521,-914.5663 4562.7407,-785.2865 4559.4655,-728.9624"/>
<polygon fill="#000000" stroke="#000000" points="4562.9445,-728.4872 4558.8905,-718.6987 4555.9555,-728.8789 4562.9445,-728.4872"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="4970.9016,-794.4219 4603.0984,-794.4219 4603.0984,-606.4601 4970.9016,-606.4601 4970.9016,-794.4219"/>
<text text-anchor="middle" x="4787" y="-778.9811" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="4787" y="-763.5811" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="4787" y="-748.181" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="4787" y="-732.781" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4787" y="-717.381" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local  = historian.cursor &gt; 1 and 1 or 0</text>
<text text-anchor="middle" x="4787" y="-698.621" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = historian[historian.cursor &#45; ]</text>
<text text-anchor="middle" x="4787" y="-679.861" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = historian.results[linebuf]</text>
<text text-anchor="middle" x="4787" y="-664.4609" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor &#45; </text>
<text text-anchor="middle" x="4787" y="-645.7009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="4787" y="-630.3009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf:clone(), result</text>
<text text-anchor="middle" x="4787" y="-614.9009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_47&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>codeblock_47&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4768.8409,-1089.237C4771.123,-1040.3772 4777.5667,-902.4138 4782.1275,-804.7639"/>
<polygon fill="#000000" stroke="#000000" points="4785.6339,-804.7062 4782.6044,-794.5538 4778.6415,-804.3796 4785.6339,-804.7062"/>
</g>
<!-- header_54 -->
<g id="node55" class="node">
<title>header_54</title>
<ellipse fill="none" stroke="#000000" cx="5071" cy="-700.441" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="5071" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_48&#45;&gt;header_54 -->
<g id="edge54" class="edge">
<title>section_48&#45;&gt;header_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5134.0789,-1089.237C5123.6667,-1025.0599 5088.3135,-807.1554 5075.6008,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="5079.0186,-728.0096 5073.9622,-718.6992 5072.109,-729.1307 5079.0186,-728.0096"/>
</g>
<!-- prose_55 -->
<g id="node56" class="node">
<title>prose_55</title>
<ellipse fill="none" stroke="#000000" cx="5204" cy="-700.441" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5204" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_48&#45;&gt;prose_55 -->
<g id="edge55" class="edge">
<title>section_48&#45;&gt;prose_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5143.0767,-1089.2814C5148.7219,-1071.9827 5156.9896,-1044.9867 5162,-1021.0416 5184.3116,-914.4131 5196.9316,-785.2124 5201.7322,-728.9355"/>
<polygon fill="#000000" stroke="#000000" points="5205.2441,-728.9374 5202.5886,-718.6808 5198.2684,-728.3548 5205.2441,-728.9374"/>
</g>
<!-- codeblock_56 -->
<g id="node57" class="node">
<title>codeblock_56</title>
<ellipse fill="none" stroke="#000000" cx="5431" cy="-700.441" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5431" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 185&#45;201</text>
</g>
<!-- section_48&#45;&gt;codeblock_56 -->
<g id="edge56" class="edge">
<title>section_48&#45;&gt;codeblock_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5163.7422,-1090.1093C5187.1383,-1074.2027 5221.0344,-1048.8425 5245,-1021.0416 5328.0095,-924.7477 5393.6762,-786.1316 5419.3275,-727.8722"/>
<polygon fill="#000000" stroke="#000000" points="5422.5855,-729.1571 5423.3733,-718.5916 5416.1687,-726.3598 5422.5855,-729.1571"/>
</g>
<!-- header_67 -->
<g id="node68" class="node">
<title>header_67</title>
<ellipse fill="none" stroke="#000000" cx="5830" cy="-700.441" rx="95.2951" ry="18"/>
<text text-anchor="middle" x="5830" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append()</text>
</g>
<!-- section_49&#45;&gt;header_67 -->
<g id="edge67" class="edge">
<title>section_49&#45;&gt;header_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6048.9551,-1090.7691C6022.9789,-1075.6335 5986.4944,-1051.0321 5963,-1021.0416 5889.7086,-927.4854 5850.4064,-787.7963 5836.2229,-728.585"/>
<polygon fill="#000000" stroke="#000000" points="5839.5487,-727.4356 5833.8643,-718.4948 5832.7324,-729.029 5839.5487,-727.4356"/>
</g>
<!-- prose_68 -->
<g id="node69" class="node">
<title>prose_68</title>
<ellipse fill="none" stroke="#000000" cx="6004" cy="-700.441" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="6004" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_49&#45;&gt;prose_68 -->
<g id="edge68" class="edge">
<title>section_49&#45;&gt;prose_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6073.7863,-1089.2741C6067.9921,-1071.9701 6059.4472,-1044.9704 6054,-1021.0416 6029.7348,-914.448 6013.5259,-785.2293 6007.103,-728.9417"/>
<polygon fill="#000000" stroke="#000000" points="6010.5452,-728.231 6005.9494,-718.6849 6003.5891,-729.0134 6010.5452,-728.231"/>
</g>
<!-- codeblock_69 -->
<g id="node70" class="node">
<title>codeblock_69</title>
<ellipse fill="none" stroke="#000000" cx="6150" cy="-700.441" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6150" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 206&#45;213</text>
</g>
<!-- section_49&#45;&gt;codeblock_69 -->
<g id="edge69" class="edge">
<title>section_49&#45;&gt;codeblock_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6083.0981,-1089.237C6094.1414,-1025.0599 6131.6372,-807.1554 6145.1203,-728.799"/>
<polygon fill="#000000" stroke="#000000" points="6148.6116,-729.148 6146.8582,-718.6992 6141.713,-727.9608 6148.6116,-729.148"/>
</g>
<!-- codeblock_70 -->
<g id="node71" class="node">
<title>codeblock_70</title>
<ellipse fill="none" stroke="#000000" cx="6456" cy="-700.441" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6456" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 215&#45;224</text>
</g>
<!-- section_49&#45;&gt;codeblock_70 -->
<g id="edge70" class="edge">
<title>section_49&#45;&gt;codeblock_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6122.5103,-1092.2271C6158.4047,-1078.0033 6209.622,-1053.921 6246,-1021.0416 6344.1954,-932.29 6416.5852,-787.8852 6443.9825,-727.9076"/>
<polygon fill="#000000" stroke="#000000" points="6447.2145,-729.2545 6448.1365,-718.6999 6440.8338,-726.3759 6447.2145,-729.2545"/>
</g>
<!-- codeblock_71 -->
<g id="node72" class="node">
<title>codeblock_71</title>
<ellipse fill="none" stroke="#000000" cx="6811" cy="-700.441" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6811" y="-696.241" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 226&#45;228</text>
</g>
<!-- section_49&#45;&gt;codeblock_71 -->
<g id="edge71" class="edge">
<title>section_49&#45;&gt;codeblock_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6150.2487,-1100.4508C6264.6408,-1088.403 6485.1254,-1060.7618 6552,-1021.0416 6676.0544,-947.3594 6765.3738,-790.8365 6797.7089,-727.6948"/>
<polygon fill="#000000" stroke="#000000" points="6800.8511,-729.2369 6802.2352,-718.7328 6794.6028,-726.0811 6800.8511,-729.2369"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="4585,-235.6202 4531,-235.6202 4531,-199.6202 4585,-199.6202 4585,-235.6202"/>
</g>
<!-- raw_51&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>raw_51&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4558,-682.395C4558,-609.3458 4558,-335.2408 4558,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="4561.5001,-245.7567 4558,-235.7568 4554.5001,-245.7568 4561.5001,-245.7567"/>
</g>
<!-- leaf_57 -->
<g id="node58" class="node">
<title>leaf_57</title>
<polygon fill="none" stroke="#c0c0c0" points="4972,-235.6202 4816,-235.6202 4816,-199.6202 4972,-199.6202 4972,-235.6202"/>
<text text-anchor="middle" x="4894" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_54&#45;&gt;leaf_57 -->
<g id="edge57" class="edge">
<title>header_54&#45;&gt;leaf_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5067.2582,-682.2751C5056.7443,-632.6815 5024.7565,-491.2425 4980,-379.8404 4960.0992,-330.306 4929.4324,-276.1586 4910.6017,-244.6317"/>
<polygon fill="#000000" stroke="#000000" points="4913.5503,-242.7435 4905.3929,-235.9828 4907.5538,-246.3549 4913.5503,-242.7435"/>
</g>
<!-- raw_58 -->
<g id="node59" class="node">
<title>raw_58</title>
<ellipse fill="none" stroke="#000000" cx="5017" cy="-217.6202" rx="27" ry="18"/>
<text text-anchor="middle" x="5017" y="-213.4202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_55&#45;&gt;raw_58 -->
<g id="edge58" class="edge">
<title>prose_55&#45;&gt;raw_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5207.6284,-682.2875C5217.1676,-628.9729 5237.3104,-470.8971 5162,-379.8404 5129.4844,-340.5263 5088.3254,-380.6504 5053,-343.8404 5027.5371,-317.3073 5019.8713,-274.0666 5017.683,-245.7276"/>
<polygon fill="#000000" stroke="#000000" points="5021.1721,-245.4375 5017.0869,-235.662 5014.1843,-245.8514 5021.1721,-245.4375"/>
</g>
<!-- prespace_59 -->
<g id="node60" class="node">
<title>prespace_59</title>
<ellipse fill="none" stroke="#000000" cx="5108" cy="-217.6202" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5108" y="-213.4202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_55&#45;&gt;prespace_59 -->
<g id="edge59" class="edge">
<title>prose_55&#45;&gt;prespace_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5202.8323,-682.1477C5199.4198,-632.8104 5188.016,-493.0909 5162,-379.8404 5150.9062,-331.548 5131.3191,-277.2587 5119.0325,-245.3281"/>
<polygon fill="#000000" stroke="#000000" points="5122.2068,-243.8338 5115.32,-235.7826 5115.6829,-246.3713 5122.2068,-243.8338"/>
</g>
<!-- literal_60 -->
<g id="node61" class="node">
<title>literal_60</title>
<ellipse fill="none" stroke="#000000" cx="5204" cy="-217.6202" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5204" y="-213.4202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_55&#45;&gt;literal_60 -->
<g id="edge60" class="edge">
<title>prose_55&#45;&gt;literal_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5204,-682.395C5204,-609.3458 5204,-335.2408 5204,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="5207.5001,-245.7567 5204,-235.7568 5200.5001,-245.7568 5207.5001,-245.7567"/>
</g>
<!-- raw_61 -->
<g id="node62" class="node">
<title>raw_61</title>
<ellipse fill="none" stroke="#000000" cx="5280" cy="-217.6202" rx="27" ry="18"/>
<text text-anchor="middle" x="5280" y="-213.4202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_55&#45;&gt;raw_61 -->
<g id="edge61" class="edge">
<title>prose_55&#45;&gt;raw_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5206.8406,-682.395C5218.3508,-609.2715 5261.5734,-334.6829 5275.5853,-245.6665"/>
<polygon fill="#000000" stroke="#000000" points="5279.0476,-246.1794 5277.1452,-235.7568 5272.1327,-245.0909 5279.0476,-246.1794"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="5713.4016,-344.0609 5324.5984,-344.0609 5324.5984,-91.1795 5713.4016,-91.1795 5713.4016,-344.0609"/>
<text text-anchor="middle" x="5519" y="-328.6404" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="5519" y="-313.2404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local  = historian.cursor &lt; #historian and 1 or 0</text>
<text text-anchor="middle" x="5519" y="-294.4804" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="5519" y="-279.0803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="5519" y="-263.6803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="5519" y="-248.2803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf= historian[historian.cursor + ]</text>
<text text-anchor="middle" x="5519" y="-229.5203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = historian.results[linebuf]</text>
<text text-anchor="middle" x="5519" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor + </text>
<text text-anchor="middle" x="5519" y="-195.3602" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="5519" y="-179.9602" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not ( &gt; 0) and #linebuf.line &gt; 0 then</text>
<text text-anchor="middle" x="5519" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf:clone(), result, true</text>
<text text-anchor="middle" x="5519" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="5519" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf:clone(), result, false</text>
<text text-anchor="middle" x="5519" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="5519" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_56&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_56&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5434.2891,-682.395C5443.9229,-629.5385 5472.7424,-471.4171 5494.1053,-354.2075"/>
<polygon fill="#000000" stroke="#000000" points="5497.6036,-354.5325 5495.9535,-344.0669 5490.7171,-353.2773 5497.6036,-354.5325"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="5064,-55.6015 4586,-55.6015 4586,.2015 5064,.2015 5064,-55.6015"/>
<text text-anchor="middle" x="4825" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next linebuf in history, and a second flag to tell the</text>
</g>
<!-- raw_58&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>raw_58&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5016.6269,-199.3778C5015.1209,-172.4973 5008.5196,-122.1212 4981,-91.4 4969.5782,-78.6494 4955.2273,-68.3997 4939.8832,-60.1736"/>
<polygon fill="#000000" stroke="#000000" points="4941.2527,-56.9443 4930.7486,-55.5605 4938.0971,-63.1927 4941.2527,-56.9443"/>
</g>
<!-- leaf_63 -->
<g id="node64" class="node">
<title>leaf_63</title>
<polygon fill="none" stroke="#c0c0c0" points="5136,-45.7 5082,-45.7 5082,-9.7 5136,-9.7 5136,-45.7"/>
</g>
<!-- prespace_59&#45;&gt;leaf_63 -->
<g id="edge63" class="edge">
<title>prespace_59&#45;&gt;leaf_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5108.0959,-199.4099C5108.271,-166.1571 5108.6435,-95.4011 5108.8516,-55.8838"/>
<polygon fill="#000000" stroke="#000000" points="5112.3516,-55.8736 5108.9044,-45.8552 5105.3517,-55.8366 5112.3516,-55.8736"/>
</g>
<!-- leaf_64 -->
<g id="node65" class="node">
<title>leaf_64</title>
<polygon fill="none" stroke="#c0c0c0" points="5254,-45.7 5154,-45.7 5154,-9.7 5254,-9.7 5254,-45.7"/>
<text text-anchor="middle" x="5204" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_60&#45;&gt;leaf_64 -->
<g id="edge64" class="edge">
<title>literal_60&#45;&gt;leaf_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5204,-199.4099C5204,-166.1571 5204,-95.4011 5204,-55.8838"/>
<polygon fill="#000000" stroke="#000000" points="5207.5001,-55.8552 5204,-45.8552 5200.5001,-55.8553 5207.5001,-55.8552"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="5512,-45.7 5272,-45.7 5272,-9.7 5512,-9.7 5512,-45.7"/>
<text text-anchor="middle" x="5392" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_61&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>raw_61&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5281.7861,-199.5194C5285.0444,-173.6942 5293.7995,-125.6181 5316,-91.4 5325.855,-76.2104 5340.4398,-62.7501 5354.2048,-52.162"/>
<polygon fill="#000000" stroke="#000000" points="5356.6527,-54.7054 5362.62,-45.9508 5352.4957,-49.0734 5356.6527,-54.7054"/>
</g>
<!-- leaf_72 -->
<g id="node73" class="node">
<title>leaf_72</title>
<polygon fill="none" stroke="#c0c0c0" points="5901,-235.6202 5731,-235.6202 5731,-199.6202 5901,-199.6202 5901,-235.6202"/>
<text text-anchor="middle" x="5816" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append()</text>
</g>
<!-- header_67&#45;&gt;leaf_72 -->
<g id="edge72" class="edge">
<title>header_67&#45;&gt;leaf_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5829.4767,-682.395C5827.3586,-609.3458 5819.4106,-335.2408 5816.8211,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="5820.3144,-245.6511 5816.5259,-235.7568 5813.3173,-245.8541 5820.3144,-245.6511"/>
</g>
<!-- raw_73 -->
<g id="node74" class="node">
<title>raw_73</title>
<ellipse fill="none" stroke="#000000" cx="5946" cy="-217.6202" rx="27" ry="18"/>
<text text-anchor="middle" x="5946" y="-213.4202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_68&#45;&gt;raw_73 -->
<g id="edge73" class="edge">
<title>prose_68&#45;&gt;raw_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6001.8322,-682.395C5993.057,-609.3458 5960.1295,-335.2408 5949.4018,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="5952.8465,-245.2679 5948.1787,-235.7568 5945.8965,-246.1029 5952.8465,-245.2679"/>
</g>
<!-- leaf_75 -->
<g id="node76" class="node">
<title>leaf_75</title>
<polygon fill="none" stroke="#c0c0c0" points="6322.5,-268.0212 5991.5,-268.0212 5991.5,-167.2192 6322.5,-167.2192 6322.5,-268.0212"/>
<text text-anchor="middle" x="6157" y="-252.6203" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, linebuf)</text>
<text text-anchor="middle" x="6157" y="-237.2203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = linebuf</text>
<text text-anchor="middle" x="6157" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="6157" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:persist(linebuf)</text>
<text text-anchor="middle" x="6157" y="-191.0202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="6157" y="-175.6201" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_69&#45;&gt;leaf_75 -->
<g id="edge75" class="edge">
<title>codeblock_69&#45;&gt;leaf_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6150.2616,-682.395C6151.2138,-616.7205 6154.522,-388.5361 6156.1211,-278.2384"/>
<polygon fill="#000000" stroke="#000000" points="6159.625,-277.9915 6156.2704,-267.9418 6152.6257,-277.89 6159.625,-277.9915"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="6797.5,-283.3206 6340.5,-283.3206 6340.5,-151.9198 6797.5,-151.9198 6797.5,-283.3206"/>
<text text-anchor="middle" x="6569" y="-268.0203" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new()</text>
<text text-anchor="middle" x="6569" y="-252.6203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="6569" y="-237.2203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="6569" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This will also be load()ed once we have the tables for it</text>
<text text-anchor="middle" x="6569" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.results = {} &#45;&#45; keyed by linebuf</text>
<text text-anchor="middle" x="6569" y="-191.0202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="6569" y="-175.6201" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6569" y="-160.2201" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_70&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>codeblock_70&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6460.2235,-682.395C6474.9203,-619.5993 6524.3898,-408.2284 6551.2647,-293.3987"/>
<polygon fill="#000000" stroke="#000000" points="6554.6846,-294.145 6553.5556,-283.6105 6547.8687,-292.5497 6554.6846,-294.145"/>
</g>
<!-- leaf_77 -->
<g id="node78" class="node">
<title>leaf_77</title>
<polygon fill="none" stroke="#c0c0c0" points="6902,-235.6202 6816,-235.6202 6816,-199.6202 6902,-199.6202 6902,-235.6202"/>
<text text-anchor="middle" x="6859" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_71&#45;&gt;leaf_77 -->
<g id="edge77" class="edge">
<title>codeblock_71&#45;&gt;leaf_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6812.7941,-682.395C6820.0563,-609.3458 6847.3067,-335.2408 6856.1847,-245.9385"/>
<polygon fill="#000000" stroke="#000000" points="6859.6904,-246.054 6857.1969,-235.7568 6852.7247,-245.3614 6859.6904,-246.054"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="5973,-45.7 5919,-45.7 5919,-9.7 5973,-9.7 5973,-45.7"/>
</g>
<!-- raw_73&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>raw_73&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5946,-199.4099C5946,-166.1571 5946,-95.4011 5946,-55.8838"/>
<polygon fill="#000000" stroke="#000000" points="5949.5001,-55.8552 5946,-45.8552 5942.5001,-55.8553 5949.5001,-55.8552"/>
</g>
</g>
</svg>
