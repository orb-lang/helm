<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="6994pt" height="1366pt"
 viewBox="0.00 0.00 6994.00 1366.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1362.0417)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1362.0417 6990,-1362.0417 6990,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1728" cy="-1340.0417" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1728" y="-1335.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 226</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1728" cy="-1268.0417" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1728" y="-1263.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;162</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1728,-1321.8731C1728,-1314.1727 1728,-1305.0161 1728,-1296.4584"/>
<polygon fill="#000000" stroke="#000000" points="1731.5001,-1296.455 1728,-1286.455 1724.5001,-1296.455 1731.5001,-1296.455"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1305" cy="-1196.0417" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1305" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1667.7149,-1260.6845C1597.1794,-1251.6461 1477.0436,-1234.9123 1375,-1214.0417 1369.6215,-1212.9417 1364.037,-1211.6919 1358.4738,-1210.3757"/>
<polygon fill="#000000" stroke="#000000" points="1359.0769,-1206.9203 1348.5325,-1207.9529 1357.4193,-1213.7213 1359.0769,-1206.9203"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1416" cy="-1196.0417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1416" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1669.191,-1259.8852C1613.8997,-1251.3747 1529.2172,-1236.1611 1458,-1214.0417 1455.5472,-1213.2799 1453.0431,-1212.4229 1450.5399,-1211.507"/>
<polygon fill="#000000" stroke="#000000" points="1451.5872,-1208.1581 1440.9998,-1207.7589 1449.0274,-1214.6733 1451.5872,-1208.1581"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1499" cy="-1196.0417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1499" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1679.4359,-1255.7869C1641.3795,-1245.7606 1587.3029,-1230.5776 1541,-1214.0417 1538.5813,-1213.1779 1536.1026,-1212.2448 1533.6178,-1211.2735"/>
<polygon fill="#000000" stroke="#000000" points="1534.6994,-1207.935 1524.1178,-1207.4054 1532.0596,-1214.4182 1534.6994,-1207.935"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1582" cy="-1196.0417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1582" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1695.9597,-1252.241C1672.0983,-1240.4738 1639.6044,-1224.4494 1615.4189,-1212.5223"/>
<polygon fill="#000000" stroke="#000000" points="1616.7832,-1209.2927 1606.2664,-1208.0087 1613.6871,-1215.5708 1616.7832,-1209.2927"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1664" cy="-1196.0417" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1664" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1712.1798,-1250.244C1704.1184,-1241.1749 1694.1979,-1230.0143 1685.4584,-1220.1824"/>
<polygon fill="#000000" stroke="#000000" points="1688.0204,-1217.7964 1678.7607,-1212.6476 1682.7885,-1222.447 1688.0204,-1217.7964"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1792" cy="-1196.0417" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1792" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;23</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1743.8202,-1250.244C1751.5126,-1241.59 1760.8978,-1231.0317 1769.3344,-1221.5406"/>
<polygon fill="#000000" stroke="#000000" points="1772.1122,-1223.6837 1776.14,-1213.8843 1766.8803,-1219.0331 1772.1122,-1223.6837"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="2009" cy="-1196.0417" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2009" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 25&#45;27</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1775.9863,-1255.7463C1823.2571,-1243.6342 1895.679,-1225.0777 1947.2255,-1211.8701"/>
<polygon fill="#000000" stroke="#000000" points="1948.1011,-1215.2589 1956.9194,-1209.3862 1946.3636,-1208.4779 1948.1011,-1215.2589"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2315" cy="-1196.0417" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="2315" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 30&#45;73</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1788.0607,-1260.6748C1897.4038,-1247.2631 2128.3921,-1218.9306 2244.8035,-1204.6519"/>
<polygon fill="#000000" stroke="#000000" points="2245.5247,-1208.0897 2255.0242,-1203.3982 2244.6724,-1201.1418 2245.5247,-1208.0897"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="3329" cy="-1196.0417" rx="70.655" ry="18"/>
<text text-anchor="middle" x="3329" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 74&#45;162</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1792.9938,-1265.1188C2046.9008,-1253.7002 2971.5308,-1212.1178 3249.4574,-1199.6189"/>
<polygon fill="#000000" stroke="#000000" points="3249.6298,-1203.1148 3259.4624,-1199.169 3249.3152,-1196.1219 3249.6298,-1203.1148"/>
</g>
<!-- section_11 -->
<g id="node12" class="node">
<title>section_11</title>
<ellipse fill="none" stroke="#000000" cx="4719" cy="-1196.0417" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4719" y="-1191.8417" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 163&#45;201</text>
</g>
<!-- section_1&#45;&gt;section_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;section_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1793.6046,-1266.4625C2183.4327,-1257.0785 4193.202,-1208.6989 4633.6302,-1198.0968"/>
<polygon fill="#000000" stroke="#000000" points="4633.8277,-1201.5931 4643.7406,-1197.8534 4633.6592,-1194.5952 4633.8277,-1201.5931"/>
</g>
<!-- leaf_12 -->
<g id="node13" class="node">
<title>leaf_12</title>
<polygon fill="none" stroke="#c0c0c0" points="1350.5,-1109.8416 1257.5,-1109.8416 1257.5,-1073.8416 1350.5,-1073.8416 1350.5,-1109.8416"/>
<text text-anchor="middle" x="1304" y="-1088.3416" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_12 -->
<g id="edge12" class="edge">
<title>header_2&#45;&gt;leaf_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1304.8258,-1177.8915C1304.6733,-1162.0014 1304.4492,-1138.6489 1304.2729,-1120.2793"/>
<polygon fill="#000000" stroke="#000000" points="1307.7714,-1120.0994 1304.1755,-1110.1335 1300.7718,-1120.1667 1307.7714,-1120.0994"/>
</g>
<!-- raw_13 -->
<g id="node14" class="node">
<title>raw_13</title>
<ellipse fill="none" stroke="#000000" cx="1396" cy="-1091.8416" rx="27" ry="18"/>
<text text-anchor="middle" x="1396" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_13 -->
<g id="edge13" class="edge">
<title>prose_3&#45;&gt;raw_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1412.5163,-1177.8915C1409.4333,-1161.8292 1404.8868,-1138.1419 1401.344,-1119.6839"/>
<polygon fill="#000000" stroke="#000000" points="1404.7661,-1118.9449 1399.4438,-1109.7839 1397.8916,-1120.2644 1404.7661,-1118.9449"/>
</g>
<!-- raw_15 -->
<g id="node16" class="node">
<title>raw_15</title>
<ellipse fill="none" stroke="#000000" cx="1468" cy="-1091.8416" rx="27" ry="18"/>
<text text-anchor="middle" x="1468" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_15 -->
<g id="edge15" class="edge">
<title>prose_4&#45;&gt;raw_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1493.6002,-1177.8915C1488.7994,-1161.7545 1481.7089,-1137.9214 1476.2067,-1119.4267"/>
<polygon fill="#000000" stroke="#000000" points="1479.5442,-1118.3707 1473.3379,-1109.7839 1472.8348,-1120.3668 1479.5442,-1118.3707"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="1540" cy="-1091.8416" rx="27" ry="18"/>
<text text-anchor="middle" x="1540" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_5&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1574.8753,-1178.3656C1568.2889,-1162.0251 1558.4065,-1137.5074 1550.8413,-1118.7385"/>
<polygon fill="#000000" stroke="#000000" points="1554.0042,-1117.2232 1547.0195,-1109.2567 1547.5118,-1119.8401 1554.0042,-1117.2232"/>
</g>
<!-- raw_19 -->
<g id="node20" class="node">
<title>raw_19</title>
<ellipse fill="none" stroke="#000000" cx="1612" cy="-1091.8416" rx="27" ry="18"/>
<text text-anchor="middle" x="1612" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_19 -->
<g id="edge19" class="edge">
<title>prose_6&#45;&gt;raw_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1655.1789,-1178.3656C1646.9492,-1161.8745 1634.5632,-1137.0548 1625.1643,-1118.221"/>
<polygon fill="#000000" stroke="#000000" points="1628.2878,-1116.6416 1620.6908,-1109.2567 1622.0244,-1119.7673 1628.2878,-1116.6416"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1939,-1142.2426 1657,-1142.2426 1657,-1041.4406 1939,-1041.4406 1939,-1142.2426"/>
<text text-anchor="middle" x="1798" y="-1126.8417" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = require &quot;linebuf&quot;</text>
<text text-anchor="middle" x="1798" y="-1111.4417" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1798" y="-1096.0417" font-family="Inconsolata" font-size="14.00" fill="#000000">local L &#160;&#160;&#160;&#160;&#160;&#160;= require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1798" y="-1080.6416" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
<text text-anchor="middle" x="1798" y="-1065.2416" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub &#160;&#160;&#160;&#160;= assert (string.sub)</text>
<text text-anchor="middle" x="1798" y="-1049.8416" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(meta)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_7&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1793.0451,-1177.8915C1793.4643,-1170.612 1793.9736,-1161.7663 1794.5043,-1152.5511"/>
<polygon fill="#000000" stroke="#000000" points="1798.0044,-1152.6479 1795.0851,-1142.4632 1791.016,-1152.2454 1798.0044,-1152.6479"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2148.5,-1109.8416 1957.5,-1109.8416 1957.5,-1073.8416 2148.5,-1073.8416 2148.5,-1109.8416"/>
<text text-anchor="middle" x="2053" y="-1088.3416" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_8&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2016.6642,-1177.8915C2023.4681,-1161.7787 2033.5121,-1137.9927 2041.3167,-1119.5098"/>
<polygon fill="#000000" stroke="#000000" points="2044.6102,-1120.7074 2045.276,-1110.1335 2038.1615,-1117.9844 2044.6102,-1120.7074"/>
</g>
<!-- header_23 -->
<g id="node24" class="node">
<title>header_23</title>
<ellipse fill="none" stroke="#000000" cx="2249" cy="-1091.8416" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2249" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:load()</text>
</g>
<!-- section_9&#45;&gt;header_23 -->
<g id="edge23" class="edge">
<title>section_9&#45;&gt;header_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2303.5037,-1177.8915C2293.0933,-1161.4557 2277.626,-1137.036 2265.825,-1118.4048"/>
<polygon fill="#000000" stroke="#000000" points="2268.6723,-1116.359 2260.3646,-1109.7839 2262.7587,-1120.1047 2268.6723,-1116.359"/>
</g>
<!-- prose_24 -->
<g id="node25" class="node">
<title>prose_24</title>
<ellipse fill="none" stroke="#000000" cx="2382" cy="-1091.8416" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2382" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;prose_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2326.6705,-1177.8915C2337.3675,-1161.2553 2353.324,-1136.4392 2365.3567,-1117.7258"/>
<polygon fill="#000000" stroke="#000000" points="2368.4436,-1119.3962 2370.9081,-1109.092 2362.5557,-1115.6103 2368.4436,-1119.3962"/>
</g>
<!-- codeblock_25 -->
<g id="node26" class="node">
<title>codeblock_25</title>
<ellipse fill="none" stroke="#000000" cx="2633" cy="-1091.8416" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2633" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 34&#45;71</text>
</g>
<!-- section_9&#45;&gt;codeblock_25 -->
<g id="edge25" class="edge">
<title>section_9&#45;&gt;codeblock_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2357.2279,-1182.2048C2414.1594,-1163.5499 2515.6057,-1130.3086 2578.3115,-1109.7616"/>
<polygon fill="#000000" stroke="#000000" points="2579.6171,-1113.017 2588.03,-1106.5771 2577.4373,-1106.365 2579.6171,-1113.017"/>
</g>
<!-- header_36 -->
<g id="node37" class="node">
<title>header_36</title>
<ellipse fill="none" stroke="#000000" cx="3171" cy="-1091.8416" rx="107.339" ry="18"/>
<text text-anchor="middle" x="3171" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_10&#45;&gt;header_36 -->
<g id="edge36" class="edge">
<title>section_10&#45;&gt;header_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3303.2629,-1179.0683C3276.8741,-1161.665 3235.6436,-1134.4737 3206.235,-1115.0789"/>
<polygon fill="#000000" stroke="#000000" points="3207.7923,-1111.9134 3197.5173,-1109.3296 3203.9384,-1117.757 3207.7923,-1111.9134"/>
</g>
<!-- prose_37 -->
<g id="node38" class="node">
<title>prose_37</title>
<ellipse fill="none" stroke="#000000" cx="3329" cy="-1091.8416" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3329" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_37 -->
<g id="edge37" class="edge">
<title>section_10&#45;&gt;prose_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3329,-1177.8915C3329,-1162.0014 3329,-1138.6489 3329,-1120.2793"/>
<polygon fill="#000000" stroke="#000000" points="3332.5001,-1120.1335 3329,-1110.1335 3325.5001,-1120.1336 3332.5001,-1120.1335"/>
</g>
<!-- codeblock_38 -->
<g id="node39" class="node">
<title>codeblock_38</title>
<ellipse fill="none" stroke="#000000" cx="3538" cy="-1091.8416" rx="81.9542" ry="18"/>
<text text-anchor="middle" x="3538" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 76&#45;118</text>
</g>
<!-- section_10&#45;&gt;codeblock_38 -->
<g id="edge38" class="edge">
<title>section_10&#45;&gt;codeblock_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3361.1982,-1179.9888C3397.2402,-1162.0195 3455.7889,-1132.8292 3495.5491,-1113.0062"/>
<polygon fill="#000000" stroke="#000000" points="3497.3404,-1116.024 3504.7281,-1108.4298 3494.217,-1109.7594 3497.3404,-1116.024"/>
</g>
<!-- codeblock_39 -->
<g id="node40" class="node">
<title>codeblock_39</title>
<ellipse fill="none" stroke="#000000" cx="3921" cy="-1091.8416" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3921" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 121&#45;160</text>
</g>
<!-- section_10&#45;&gt;codeblock_39 -->
<g id="edge39" class="edge">
<title>section_10&#45;&gt;codeblock_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3387.1121,-1185.8132C3494.6466,-1166.8857 3724.6218,-1126.4069 3844.6,-1105.2891"/>
<polygon fill="#000000" stroke="#000000" points="3845.2108,-1108.7355 3854.4527,-1103.5549 3843.9973,-1101.8414 3845.2108,-1108.7355"/>
</g>
<!-- header_45 -->
<g id="node46" class="node">
<title>header_45</title>
<ellipse fill="none" stroke="#000000" cx="4451" cy="-1091.8416" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="4451" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_11&#45;&gt;header_45 -->
<g id="edge45" class="edge">
<title>section_11&#45;&gt;header_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4679.4557,-1180.6666C4632.1273,-1162.2651 4552.8134,-1131.4273 4501.2027,-1111.3608"/>
<polygon fill="#000000" stroke="#000000" points="4502.1738,-1107.9831 4491.5851,-1107.6214 4499.6371,-1114.5074 4502.1738,-1107.9831"/>
</g>
<!-- prose_46 -->
<g id="node47" class="node">
<title>prose_46</title>
<ellipse fill="none" stroke="#000000" cx="4637" cy="-1091.8416" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4637" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_46 -->
<g id="edge46" class="edge">
<title>section_11&#45;&gt;prose_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4704.7167,-1177.8915C4691.2865,-1160.8252 4671.0821,-1135.1508 4656.2373,-1116.2871"/>
<polygon fill="#000000" stroke="#000000" points="4658.9732,-1114.104 4650.0385,-1108.41 4653.4722,-1118.433 4658.9732,-1114.104"/>
</g>
<!-- codeblock_47 -->
<g id="node48" class="node">
<title>codeblock_47</title>
<ellipse fill="none" stroke="#000000" cx="4789" cy="-1091.8416" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4789" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 165&#45;176</text>
</g>
<!-- section_11&#45;&gt;codeblock_47 -->
<g id="edge47" class="edge">
<title>section_11&#45;&gt;codeblock_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4731.1931,-1177.8915C4742.2845,-1161.381 4758.7884,-1136.8138 4771.3257,-1118.1511"/>
<polygon fill="#000000" stroke="#000000" points="4774.2755,-1120.0365 4776.9467,-1109.7839 4768.4649,-1116.133 4774.2755,-1120.0365"/>
</g>
<!-- section_48 -->
<g id="node49" class="node">
<title>section_48</title>
<ellipse fill="none" stroke="#000000" cx="5193" cy="-1091.8416" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="5193" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 179&#45;201</text>
</g>
<!-- section_11&#45;&gt;section_48 -->
<g id="edge48" class="edge">
<title>section_11&#45;&gt;section_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4774.7677,-1183.7822C4862.8401,-1164.4211 5033.7373,-1126.8526 5127.5092,-1106.2386"/>
<polygon fill="#000000" stroke="#000000" points="5128.4294,-1109.6199 5137.4447,-1104.0544 5126.9264,-1102.7832 5128.4294,-1109.6199"/>
</g>
<!-- section_49 -->
<g id="node50" class="node">
<title>section_49</title>
<ellipse fill="none" stroke="#000000" cx="6165" cy="-1091.8416" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="6165" y="-1087.6416" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 202&#45;226</text>
</g>
<!-- section_11&#45;&gt;section_49 -->
<g id="edge49" class="edge">
<title>section_11&#45;&gt;section_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4791.6983,-1190.803C5035.7032,-1173.2198 5824.5761,-1116.3729 6082.5344,-1097.7842"/>
<polygon fill="#000000" stroke="#000000" points="6082.8638,-1101.2696 6092.5863,-1097.0598 6082.3606,-1094.2877 6082.8638,-1101.2696"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-720.9421 0,-720.9421 0,-649.1398 324,-649.1398 324,-720.9421"/>
<text text-anchor="middle" x="162" y="-657.541" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_13&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>raw_13&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1388.0869,-1074.1198C1381.9347,-1062.6548 1372.2154,-1048.6118 1359,-1041.6415 1258.1038,-988.4254 429.7711,-1066.0348 333,-1005.6415 233.8435,-943.7596 188.6428,-803.5098 171.2372,-730.7492"/>
<polygon fill="#000000" stroke="#000000" points="174.6323,-729.8959 168.963,-720.9455 167.8134,-731.4778 174.6323,-729.8959"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-712.3414 342.5,-712.3414 342.5,-657.7405 897.5,-657.7405 897.5,-712.3414"/>
<text text-anchor="middle" x="620" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-665.8409" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_15&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_15&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1460.3446,-1074.2704C1454.3783,-1062.8726 1444.927,-1048.8481 1432,-1041.6415 1329.8589,-984.7003 1012.0662,-1056.9856 907,-1005.6415 776.9255,-942.0763 679.3141,-791.0194 639.5592,-721.3665"/>
<polygon fill="#000000" stroke="#000000" points="642.5163,-719.4847 634.5567,-712.4922 636.4184,-722.9222 642.5163,-719.4847"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-712.3414 916,-712.3414 916,-657.7405 1464,-657.7405 1464,-712.3414"/>
<text text-anchor="middle" x="1190" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-665.8409" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1528.7301,-1075.2589C1521.828,-1065.3267 1512.6802,-1052.5519 1504,-1041.6415 1490.8491,-1025.1117 1297.6778,-806.6903 1221.0168,-720.0749"/>
<polygon fill="#000000" stroke="#000000" points="1223.4355,-717.5267 1214.1868,-712.3584 1218.1939,-722.1663 1223.4355,-717.5267"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-720.3413 1482,-720.3413 1482,-649.7406 2030,-649.7406 2030,-720.3413"/>
<text text-anchor="middle" x="1756" y="-689.241" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new linebuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-673.8409" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_19&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>raw_19&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1618.2801,-1074.1003C1639.4377,-1014.33 1708.5481,-819.0929 1740.0699,-730.0436"/>
<polygon fill="#000000" stroke="#000000" points="1743.4143,-731.0842 1743.4519,-720.4894 1736.8155,-728.7483 1743.4143,-731.0842"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="2197.5,-703.0409 2048.5,-703.0409 2048.5,-667.0409 2197.5,-667.0409 2197.5,-703.0409"/>
<text text-anchor="middle" x="2123" y="-681.541" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:load()</text>
</g>
<!-- header_23&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>header_23&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2238.9108,-1073.8056C2229.6449,-1056.6759 2216.0223,-1029.9935 2207,-1005.6415 2168.0322,-900.4645 2139.7037,-769.5696 2128.4065,-713.1093"/>
<polygon fill="#000000" stroke="#000000" points="2131.81,-712.278 2126.4361,-703.1472 2124.943,-713.6363 2131.81,-712.278"/>
</g>
<!-- raw_27 -->
<g id="node28" class="node">
<title>raw_27</title>
<ellipse fill="none" stroke="#000000" cx="2243" cy="-685.0409" rx="27" ry="18"/>
<text text-anchor="middle" x="2243" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_24&#45;&gt;raw_27 -->
<g id="edge27" class="edge">
<title>prose_24&#45;&gt;raw_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2370.0342,-1074.7484C2362.2462,-1064.3895 2351.4372,-1051.3461 2340,-1041.6415 2315.9963,-1021.2741 2296.113,-1032.0642 2279,-1005.6415 2218.9504,-912.9242 2230.0592,-772.7814 2238.3255,-713.3176"/>
<polygon fill="#000000" stroke="#000000" points="2241.8236,-713.5862 2239.8181,-703.183 2234.8983,-712.5662 2241.8236,-713.5862"/>
</g>
<!-- prespace_28 -->
<g id="node29" class="node">
<title>prespace_28</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-685.0409" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2334" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_24&#45;&gt;prespace_28 -->
<g id="edge28" class="edge">
<title>prose_24&#45;&gt;prespace_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2379.8756,-1073.837C2372.3031,-1009.6598 2346.5917,-791.7554 2337.3461,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="2340.8021,-712.8201 2336.1544,-703.2992 2333.8504,-713.6405 2340.8021,-712.8201"/>
</g>
<!-- literal_29 -->
<g id="node30" class="node">
<title>literal_29</title>
<ellipse fill="none" stroke="#000000" cx="2430" cy="-685.0409" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2430" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_24&#45;&gt;literal_29 -->
<g id="edge29" class="edge">
<title>prose_24&#45;&gt;literal_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2384.1244,-1073.837C2391.6969,-1009.6598 2417.4083,-791.7554 2426.6539,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="2430.1496,-713.6405 2427.8456,-703.2992 2423.1979,-712.8201 2430.1496,-713.6405"/>
</g>
<!-- raw_30 -->
<g id="node31" class="node">
<title>raw_30</title>
<ellipse fill="none" stroke="#000000" cx="2506" cy="-685.0409" rx="27" ry="18"/>
<text text-anchor="middle" x="2506" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_24&#45;&gt;raw_30 -->
<g id="edge30" class="edge">
<title>prose_24&#45;&gt;raw_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2403.1257,-1077.8252C2423.9917,-1062.7043 2454.9064,-1036.5888 2470,-1005.6415 2518.0924,-907.0349 2513.6658,-771.6317 2508.9338,-713.4693"/>
<polygon fill="#000000" stroke="#000000" points="2512.3946,-712.8704 2508.029,-703.2168 2505.4217,-713.4858 2512.3946,-712.8704"/>
</g>
<!-- leaf_35 -->
<g id="node36" class="node">
<title>leaf_35</title>
<polygon fill="none" stroke="#c0c0c0" points="3057,-968.0419 2551,-968.0419 2551,-402.04 3057,-402.04 3057,-968.0419"/>
<text text-anchor="middle" x="2804" y="-952.8414" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 1000</text>
<text text-anchor="middle" x="2804" y="-921.4414" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2804" y="-906.0414" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS repl (</text>
<text text-anchor="middle" x="2804" y="-890.6413" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2804" y="-875.2413" font-family="Inconsolata" font-size="14.00" fill="#000000">project TEXT,</text>
<text text-anchor="middle" x="2804" y="-859.8413" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2804" y="-844.4412" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP);</text>
<text text-anchor="middle" x="2804" y="-829.0412" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-797.6412" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line_stmt = [[</text>
<text text-anchor="middle" x="2804" y="-782.2411" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES(:project, :line);</text>
<text text-anchor="middle" x="2804" y="-766.8411" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-735.4411" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2804" y="-720.041" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2804" y="-704.641" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-673.241" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2804" y="-657.8409" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT line FROM repl</text>
<text text-anchor="middle" x="2804" y="-642.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %s</text>
<text text-anchor="middle" x="2804" y="-627.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2804" y="-611.6409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2804" y="-596.2408" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-564.8408" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-549.4408" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-518.0407" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2804" y="-502.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2804" y="-487.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2804" y="-471.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-456.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-441.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-425.6405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2804" y="-410.2405" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_25&#45;&gt;leaf_35 -->
<g id="edge35" class="edge">
<title>codeblock_25&#45;&gt;leaf_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2640.5683,-1073.837C2648.9811,-1053.8234 2663.6781,-1018.8598 2680.9207,-977.8406"/>
<polygon fill="#000000" stroke="#000000" points="2684.2264,-979.0086 2684.875,-968.4336 2677.7733,-976.296 2684.2264,-979.0086"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2292,-237.8217 1926,-237.8217 1926,-182.0187 2292,-182.0187 2292,-237.8217"/>
<text text-anchor="middle" x="2109" y="-190.4202" font-family="Inconsolata" font-size="14.00" fill="#000000">This is where we either create query or create our</text>
</g>
<!-- raw_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>raw_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2243.6672,-666.6911C2244.9052,-616.6338 2244.5233,-474.1332 2206,-364.4404 2190.5067,-320.3241 2160.6273,-275.7057 2138.1049,-245.8338"/>
<polygon fill="#000000" stroke="#000000" points="2140.8228,-243.6261 2131.9656,-237.8122 2135.2639,-247.8805 2140.8228,-243.6261"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2364,-227.9202 2310,-227.9202 2310,-191.9202 2364,-191.9202 2364,-227.9202"/>
<text text-anchor="middle" x="2337" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>prespace_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334.1139,-666.9958C2334.5701,-594.749 2336.2668,-326.0349 2336.8225,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="2340.3226,-238.0053 2336.8859,-227.9833 2333.3228,-237.961 2340.3226,-238.0053"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2466.5,-227.9202 2387.5,-227.9202 2387.5,-191.9202 2466.5,-191.9202 2466.5,-227.9202"/>
<text text-anchor="middle" x="2427" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000">~/.bridge</text>
</g>
<!-- literal_29&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>literal_29&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2429.8861,-666.9958C2429.4299,-594.749 2427.7332,-326.0349 2427.1775,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="2430.6772,-237.961 2427.1141,-227.9833 2423.6774,-238.0053 2430.6772,-237.961"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2571,-227.9202 2485,-227.9202 2485,-191.9202 2571,-191.9202 2571,-227.9202"/>
<text text-anchor="middle" x="2528" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000"> database.</text>
</g>
<!-- raw_30&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>raw_30&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2506.8356,-666.9958C2510.1809,-594.749 2522.6234,-326.0349 2526.6986,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="2530.1972,-238.1345 2527.1636,-227.9833 2523.2047,-237.8107 2530.1972,-238.1345"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3266.5,-703.0409 3075.5,-703.0409 3075.5,-667.0409 3266.5,-667.0409 3266.5,-703.0409"/>
<text text-anchor="middle" x="3171" y="-681.541" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_36&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>header_36&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3171,-1073.837C3171,-1009.6598 3171,-791.7554 3171,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="3174.5001,-713.2992 3171,-703.2992 3167.5001,-713.2992 3174.5001,-713.2992"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="3312" cy="-685.0409" rx="27" ry="18"/>
<text text-anchor="middle" x="3312" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_37&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_37&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3328.2476,-1073.837C3325.5657,-1009.6598 3316.4595,-791.7554 3313.1851,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="3316.6776,-713.1443 3312.763,-703.2992 3309.6837,-713.4366 3316.6776,-713.1443"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3870.5,-1005.7422 3357.5,-1005.7422 3357.5,-364.3397 3870.5,-364.3397 3870.5,-1005.7422"/>
<text text-anchor="middle" x="3614" y="-990.4415" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, match = L.P, L.match</text>
<text text-anchor="middle" x="3614" y="-959.0415" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; second_best is broke and I don&#39;t know why</text>
<text text-anchor="middle" x="3614" y="-943.6415" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; also this fails on a single key search &gt;.&lt;</text>
<text text-anchor="middle" x="3614" y="-928.2414" font-family="Inconsolata" font-size="14.00" fill="#000000">local function fuzz_patt(frag)</text>
<text text-anchor="middle" x="3614" y="-912.8414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;frag = type(frag) == &quot;string&quot; and codepoints(frag) or frag</text>
<text text-anchor="middle" x="3614" y="-897.4414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = &#160;&#160;&#160;&#160;&#160;&#160;&#160;(P(1) &#45; P(frag[1]))^0</text>
<text text-anchor="middle" x="3614" y="-882.0414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1 , #frag &#45; 1 do</text>
<text text-anchor="middle" x="3614" y="-866.6413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local v = frag[i]</text>
<text text-anchor="middle" x="3614" y="-851.2413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = patt * (P(v) * (P(1) &#45; P(frag[i + 1]))^0)</text>
<text text-anchor="middle" x="3614" y="-835.8413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-820.4412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;patt = patt * P(frag[#frag])</text>
<text text-anchor="middle" x="3614" y="-805.0412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return patt</text>
<text text-anchor="middle" x="3614" y="-789.6412" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="3614" y="-758.2411" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.search(historian, frag)</text>
<text text-anchor="middle" x="3614" y="-742.8411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local collection = {}</text>
<text text-anchor="middle" x="3614" y="-727.4411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local best = true</text>
<text text-anchor="middle" x="3614" y="-712.041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = fuzz_patt(frag)</text>
<text text-anchor="middle" x="3614" y="-696.641" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="3614" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="3614" y="-665.8409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="3614" y="-650.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="3614" y="-635.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-619.6409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-604.2408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local slip = &quot;&quot;</text>
<text text-anchor="middle" x="3614" y="-588.8408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="3614" y="-573.4408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; try the transpose</text>
<text text-anchor="middle" x="3614" y="-558.0407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;best = false</text>
<text text-anchor="middle" x="3614" y="-542.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;slip = sub(frag, 1, &#45;3) .. sub(frag, &#45;1, &#45;1) .. sub(frag, &#45;2, &#45;2)</text>
<text text-anchor="middle" x="3614" y="-527.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local second = fuzz_patt(slip)</text>
<text text-anchor="middle" x="3614" y="-511.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="3614" y="-496.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local score = match(second, tostring(historian[i]))</text>
<text text-anchor="middle" x="3614" y="-481.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="3614" y="-465.6405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="3614" y="-450.2405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-434.8405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-419.4404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3614" y="-388.0404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return collection, best, slip</text>
<text text-anchor="middle" x="3614" y="-372.6404" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_38&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_38&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3541.3637,-1073.837C3543.8871,-1060.3302 3547.6826,-1040.0143 3552.2394,-1015.6232"/>
<polygon fill="#000000" stroke="#000000" points="3555.6971,-1016.1735 3554.0931,-1005.7008 3548.8161,-1014.888 3555.6971,-1016.1735"/>
</g>
<!-- leaf_44 -->
<g id="node45" class="node">
<title>leaf_44</title>
<polygon fill="none" stroke="#c0c0c0" points="4345.5,-982.4422 3888.5,-982.4422 3888.5,-387.6397 4345.5,-387.6397 4345.5,-982.4422"/>
<text text-anchor="middle" x="4117" y="-967.0415" font-family="Inconsolata" font-size="14.00" fill="#000000">local reverse = assert(table.reverse)</text>
<text text-anchor="middle" x="4117" y="-935.6415" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="4117" y="-920.2414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.home_dir .. &quot;/.bridge&quot;)</text>
<text text-anchor="middle" x="4117" y="-904.8414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="4117" y="-889.4414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local table_names = conn:exec(get_tables)</text>
<text text-anchor="middle" x="4117" y="-874.0414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not table_names or not has(table_names.name, &quot;repl&quot;) then</text>
<text text-anchor="middle" x="4117" y="-858.6413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local success, err = sql.pexec(conn, create_repl_table)</text>
<text text-anchor="middle" x="4117" y="-843.2413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; success is nil for creation, false for error</text>
<text text-anchor="middle" x="4117" y="-827.8413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if success == false then</text>
<text text-anchor="middle" x="4117" y="-812.4412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="4117" y="-797.0412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-781.6412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-766.2411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt = conn:prepare(insert_line_stmt)</text>
<text text-anchor="middle" x="4117" y="-750.8411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_stmt = sql.format(get_recent, historian.project,</text>
<text text-anchor="middle" x="4117" y="-735.4411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="4117" y="-720.041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local values, err = sql.pexec(conn, pop_stmt)</text>
<text text-anchor="middle" x="4117" y="-704.641" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if values then</text>
<text text-anchor="middle" x="4117" y="-689.241" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i,v in ipairs(reverse(values[1])) do</text>
<text text-anchor="middle" x="4117" y="-673.8409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = Linebuf(v)</text>
<text text-anchor="middle" x="4117" y="-658.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-643.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="4117" y="-627.6409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.up = false</text>
<text text-anchor="middle" x="4117" y="-612.2408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-596.8408" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="4117" y="-565.4408" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, linebuf)</text>
<text text-anchor="middle" x="4117" y="-550.0407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="4117" y="-534.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt:bindkv { project = historian.project,</text>
<text text-anchor="middle" x="4117" y="-519.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;line &#160;&#160;&#160;= lb }</text>
<text text-anchor="middle" x="4117" y="-503.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local err = historian.insert_stmt:step()</text>
<text text-anchor="middle" x="4117" y="-488.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not err then</text>
<text text-anchor="middle" x="4117" y="-473.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_stmt:clearbind():reset()</text>
<text text-anchor="middle" x="4117" y="-457.6405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="4117" y="-442.2405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;error(error)</text>
<text text-anchor="middle" x="4117" y="-426.8405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4117" y="-411.4404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="4117" y="-396.0404" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_39&#45;&gt;leaf_44 -->
<g id="edge44" class="edge">
<title>codeblock_39&#45;&gt;leaf_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3929.6748,-1073.837C3938.212,-1056.1179 3952.3953,-1026.6802 3969.2508,-991.6964"/>
<polygon fill="#000000" stroke="#000000" points="3972.4044,-993.2146 3973.5918,-982.6865 3966.0981,-990.1762 3972.4044,-993.2146"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="3339,-227.9202 3285,-227.9202 3285,-191.9202 3339,-191.9202 3339,-227.9202"/>
</g>
<!-- raw_41&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_41&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3312,-666.9958C3312,-594.749 3312,-326.0349 3312,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="3315.5001,-237.9833 3312,-227.9833 3308.5001,-237.9834 3315.5001,-237.9833"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="4512.5,-703.0409 4363.5,-703.0409 4363.5,-667.0409 4512.5,-667.0409 4512.5,-703.0409"/>
<text text-anchor="middle" x="4438" y="-681.541" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_45&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>header_45&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4450.4246,-1073.837C4448.3737,-1009.6598 4441.4102,-791.7554 4438.9062,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="4442.4012,-713.1823 4438.5835,-703.2992 4435.4048,-713.4059 4442.4012,-713.1823"/>
</g>
<!-- raw_51 -->
<g id="node52" class="node">
<title>raw_51</title>
<ellipse fill="none" stroke="#000000" cx="4558" cy="-685.0409" rx="27" ry="18"/>
<text text-anchor="middle" x="4558" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_46&#45;&gt;raw_51 -->
<g id="edge51" class="edge">
<title>prose_46&#45;&gt;raw_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4626.2117,-1074.7573C4616.1117,-1057.8786 4601.4868,-1030.9826 4594,-1005.6415 4563.1289,-901.1502 4558.3875,-770.3381 4557.8904,-713.5432"/>
<polygon fill="#000000" stroke="#000000" points="4561.3888,-713.184 4557.8411,-703.2008 4554.3889,-713.2174 4561.3888,-713.184"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="5026.9016,-771.1212 4603.0984,-771.1212 4603.0984,-598.9607 5026.9016,-598.9607 5026.9016,-771.1212"/>
<text text-anchor="middle" x="4815" y="-755.8811" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="4815" y="-740.481" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="4815" y="-725.081" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="4815" y="-709.681" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4815" y="-694.2809" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local  = historian.cursor &gt; 1 and 1 or 0</text>
<text text-anchor="middle" x="4815" y="-675.5209" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf = historian[historian.cursor &#45; ]:clone()</text>
<text text-anchor="middle" x="4815" y="-656.7609" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor &#45; </text>
<text text-anchor="middle" x="4815" y="-638.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="4815" y="-622.6009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="4815" y="-607.2009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_47&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>codeblock_47&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4790.1507,-1073.837C4793.359,-1023.6405 4802.5779,-879.3989 4808.8386,-781.4431"/>
<polygon fill="#000000" stroke="#000000" points="4812.3467,-781.4264 4809.4918,-771.2235 4805.361,-780.9799 4812.3467,-781.4264"/>
</g>
<!-- header_54 -->
<g id="node55" class="node">
<title>header_54</title>
<ellipse fill="none" stroke="#000000" cx="5127" cy="-685.0409" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="5127" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_48&#45;&gt;header_54 -->
<g id="edge54" class="edge">
<title>section_48&#45;&gt;header_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5190.0789,-1073.837C5179.6667,-1009.6598 5144.3135,-791.7554 5131.6008,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="5135.0186,-712.6096 5129.9622,-703.2992 5128.109,-713.7307 5135.0186,-712.6096"/>
</g>
<!-- prose_55 -->
<g id="node56" class="node">
<title>prose_55</title>
<ellipse fill="none" stroke="#000000" cx="5260" cy="-685.0409" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5260" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_48&#45;&gt;prose_55 -->
<g id="edge55" class="edge">
<title>section_48&#45;&gt;prose_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5199.0767,-1073.8813C5204.7219,-1056.5826 5212.9896,-1029.5867 5218,-1005.6415 5240.3116,-899.0131 5252.9316,-769.8123 5257.7322,-713.5355"/>
<polygon fill="#000000" stroke="#000000" points="5261.2441,-713.5374 5258.5886,-703.2807 5254.2684,-712.9547 5261.2441,-713.5374"/>
</g>
<!-- codeblock_56 -->
<g id="node57" class="node">
<title>codeblock_56</title>
<ellipse fill="none" stroke="#000000" cx="5494" cy="-685.0409" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5494" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 184&#45;199</text>
</g>
<!-- section_48&#45;&gt;codeblock_56 -->
<g id="edge56" class="edge">
<title>section_48&#45;&gt;codeblock_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5219.1773,-1074.9266C5242.5151,-1058.9778 5276.6522,-1033.4281 5301,-1005.6415 5385.591,-909.1036 5454.5674,-770.6201 5481.6472,-712.434"/>
<polygon fill="#000000" stroke="#000000" points="5484.912,-713.7121 5485.9212,-703.1655 5478.5553,-710.7808 5484.912,-713.7121"/>
</g>
<!-- header_67 -->
<g id="node68" class="node">
<title>header_67</title>
<ellipse fill="none" stroke="#000000" cx="5915" cy="-685.0409" rx="95.2951" ry="18"/>
<text text-anchor="middle" x="5915" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append()</text>
</g>
<!-- section_49&#45;&gt;header_67 -->
<g id="edge67" class="edge">
<title>section_49&#45;&gt;header_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6133.9551,-1075.3691C6107.9789,-1060.2335 6071.4944,-1035.632 6048,-1005.6415 5974.7086,-912.0854 5935.4064,-772.3963 5921.2229,-713.185"/>
<polygon fill="#000000" stroke="#000000" points="5924.5487,-712.0356 5918.8643,-703.0948 5917.7324,-713.629 5924.5487,-712.0356"/>
</g>
<!-- prose_68 -->
<g id="node69" class="node">
<title>prose_68</title>
<ellipse fill="none" stroke="#000000" cx="6089" cy="-685.0409" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="6089" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_49&#45;&gt;prose_68 -->
<g id="edge68" class="edge">
<title>section_49&#45;&gt;prose_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6158.5019,-1073.8997C6152.452,-1056.6144 6143.5556,-1029.6277 6138,-1005.6415 6113.344,-899.1905 6097.9114,-769.8982 6091.8871,-713.5667"/>
<polygon fill="#000000" stroke="#000000" points="6095.3344,-712.8807 6090.8077,-703.3015 6088.3727,-713.6128 6095.3344,-712.8807"/>
</g>
<!-- codeblock_69 -->
<g id="node70" class="node">
<title>codeblock_69</title>
<ellipse fill="none" stroke="#000000" cx="6234" cy="-685.0409" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="6234" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 204&#45;211</text>
</g>
<!-- section_49&#45;&gt;codeblock_69 -->
<g id="edge69" class="edge">
<title>section_49&#45;&gt;codeblock_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6168.0539,-1073.837C6178.9394,-1009.6598 6215.8995,-791.7554 6229.19,-713.399"/>
<polygon fill="#000000" stroke="#000000" points="6232.6815,-713.7437 6230.9031,-703.2992 6225.78,-712.5731 6232.6815,-713.7437"/>
</g>
<!-- codeblock_70 -->
<g id="node71" class="node">
<title>codeblock_70</title>
<ellipse fill="none" stroke="#000000" cx="6540" cy="-685.0409" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6540" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 213&#45;222</text>
</g>
<!-- section_49&#45;&gt;codeblock_70 -->
<g id="edge70" class="edge">
<title>section_49&#45;&gt;codeblock_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6207.2511,-1076.771C6242.9273,-1062.5121 6293.835,-1038.4098 6330,-1005.6415 6428.0855,-916.7685 6500.5362,-772.431 6527.9661,-712.4895"/>
<polygon fill="#000000" stroke="#000000" points="6531.1959,-713.8414 6532.1253,-703.2874 6524.8172,-710.9584 6531.1959,-713.8414"/>
</g>
<!-- codeblock_71 -->
<g id="node72" class="node">
<title>codeblock_71</title>
<ellipse fill="none" stroke="#000000" cx="6895" cy="-685.0409" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6895" y="-680.8409" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 224&#45;226</text>
</g>
<!-- section_49&#45;&gt;codeblock_71 -->
<g id="edge71" class="edge">
<title>section_49&#45;&gt;codeblock_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6235.1005,-1085.0356C6349.2512,-1072.9656 6569.2699,-1045.2928 6636,-1005.6415 6760.0406,-931.9361 6849.368,-775.4266 6881.7071,-712.2916"/>
<polygon fill="#000000" stroke="#000000" points="6884.8488,-713.8345 6886.2339,-703.3306 6878.6008,-710.6782 6884.8488,-713.8345"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="4585,-227.9202 4531,-227.9202 4531,-191.9202 4585,-191.9202 4585,-227.9202"/>
</g>
<!-- raw_51&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>raw_51&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4558,-666.9958C4558,-594.749 4558,-326.0349 4558,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="4561.5001,-237.9833 4558,-227.9833 4554.5001,-237.9834 4561.5001,-237.9833"/>
</g>
<!-- leaf_57 -->
<g id="node58" class="node">
<title>leaf_57</title>
<polygon fill="none" stroke="#c0c0c0" points="5028,-227.9202 4872,-227.9202 4872,-191.9202 5028,-191.9202 5028,-227.9202"/>
<text text-anchor="middle" x="4950" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_54&#45;&gt;leaf_57 -->
<g id="edge57" class="edge">
<title>header_54&#45;&gt;leaf_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5123.3803,-666.8253C5113.1738,-617.1063 5081.8902,-475.3802 5036,-364.4404 5016.6441,-317.6474 4986.5306,-267.0084 4967.5562,-236.9033"/>
<polygon fill="#000000" stroke="#000000" points="4970.37,-234.8056 4962.0495,-228.2466 4964.4637,-238.5627 4970.37,-234.8056"/>
</g>
<!-- raw_58 -->
<g id="node59" class="node">
<title>raw_58</title>
<ellipse fill="none" stroke="#000000" cx="5073" cy="-209.9202" rx="27" ry="18"/>
<text text-anchor="middle" x="5073" y="-205.7202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_55&#45;&gt;raw_58 -->
<g id="edge58" class="edge">
<title>prose_55&#45;&gt;raw_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5263.6284,-666.8875C5273.1676,-613.5729 5293.3104,-455.497 5218,-364.4404 5185.4844,-325.1262 5144.6379,-364.9479 5109,-328.4404 5085.3672,-304.2309 5077.1853,-265.0158 5074.389,-238.3816"/>
<polygon fill="#000000" stroke="#000000" points="5077.8543,-237.8261 5073.5136,-228.1614 5070.8799,-238.4236 5077.8543,-237.8261"/>
</g>
<!-- prespace_59 -->
<g id="node60" class="node">
<title>prespace_59</title>
<ellipse fill="none" stroke="#000000" cx="5164" cy="-209.9202" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5164" y="-205.7202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_55&#45;&gt;prespace_59 -->
<g id="edge59" class="edge">
<title>prose_55&#45;&gt;prespace_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5258.9246,-666.7261C5255.7416,-617.3352 5244.8566,-477.4945 5218,-364.4404 5207.2014,-318.9832 5187.9998,-268.1793 5175.6428,-237.6465"/>
<polygon fill="#000000" stroke="#000000" points="5178.7648,-236.0341 5171.7367,-228.106 5172.2867,-238.6865 5178.7648,-236.0341"/>
</g>
<!-- literal_60 -->
<g id="node61" class="node">
<title>literal_60</title>
<ellipse fill="none" stroke="#000000" cx="5260" cy="-209.9202" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5260" y="-205.7202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_55&#45;&gt;literal_60 -->
<g id="edge60" class="edge">
<title>prose_55&#45;&gt;literal_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5260,-666.9958C5260,-594.749 5260,-326.0349 5260,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="5263.5001,-237.9833 5260,-227.9833 5256.5001,-237.9834 5263.5001,-237.9833"/>
</g>
<!-- raw_61 -->
<g id="node62" class="node">
<title>raw_61</title>
<ellipse fill="none" stroke="#000000" cx="5336" cy="-209.9202" rx="27" ry="18"/>
<text text-anchor="middle" x="5336" y="-205.7202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_55&#45;&gt;raw_61 -->
<g id="edge61" class="edge">
<title>prose_55&#45;&gt;raw_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5262.8865,-666.9958C5274.443,-594.749 5317.4264,-326.0349 5331.5043,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="5334.9871,-238.4106 5333.1106,-227.9833 5328.075,-237.3049 5334.9871,-238.4106"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="5797.4016,-328.4605 5380.5984,-328.4605 5380.5984,-91.3799 5797.4016,-91.3799 5797.4016,-328.4605"/>
<text text-anchor="middle" x="5589" y="-313.2404" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="5589" y="-297.8403" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local  = historian.cursor &lt; #historian and 1 or 0</text>
<text text-anchor="middle" x="5589" y="-279.0803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="5589" y="-263.6803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="5589" y="-248.2803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="5589" y="-232.8802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf= historian[historian.cursor + ]:clone()</text>
<text text-anchor="middle" x="5589" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor + </text>
<text text-anchor="middle" x="5589" y="-195.3602" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="5589" y="-179.9602" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not ( &gt; 0) and #linebuf.line &gt; 0 then</text>
<text text-anchor="middle" x="5589" y="-161.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf, true</text>
<text text-anchor="middle" x="5589" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="5589" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return linebuf, false</text>
<text text-anchor="middle" x="5589" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="5589" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_56&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_56&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5497.6081,-666.9958C5508.2371,-613.8375 5540.1335,-454.3148 5563.2562,-338.672"/>
<polygon fill="#000000" stroke="#000000" points="5566.7262,-339.1682 5565.2549,-328.6761 5559.862,-337.7957 5566.7262,-339.1682"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="5120,-55.6015 4642,-55.6015 4642,.2015 5120,.2015 5120,-55.6015"/>
<text text-anchor="middle" x="4881" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next linebuf in history, and a second flag to tell the</text>
</g>
<!-- raw_58&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>raw_58&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5072.2254,-191.9252C5070.1976,-166.4609 5062.9274,-119.8519 5037,-91.4 5025.3875,-78.6569 5010.8542,-68.4051 4995.3603,-60.1728"/>
<polygon fill="#000000" stroke="#000000" points="4996.6502,-56.9045 4986.1416,-55.5557 4993.5154,-63.1633 4996.6502,-56.9045"/>
</g>
<!-- leaf_63 -->
<g id="node64" class="node">
<title>leaf_63</title>
<polygon fill="none" stroke="#c0c0c0" points="5192,-45.7 5138,-45.7 5138,-9.7 5192,-9.7 5192,-45.7"/>
</g>
<!-- prespace_59&#45;&gt;leaf_63 -->
<g id="edge63" class="edge">
<title>prespace_59&#45;&gt;leaf_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5164.0995,-191.782C5164.274,-159.9922 5164.6362,-93.9972 5164.8441,-56.1047"/>
<polygon fill="#000000" stroke="#000000" points="5168.3458,-55.7839 5164.9009,-45.7648 5161.3459,-55.7454 5168.3458,-55.7839"/>
</g>
<!-- leaf_64 -->
<g id="node65" class="node">
<title>leaf_64</title>
<polygon fill="none" stroke="#c0c0c0" points="5310,-45.7 5210,-45.7 5210,-9.7 5310,-9.7 5310,-45.7"/>
<text text-anchor="middle" x="5260" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_60&#45;&gt;leaf_64 -->
<g id="edge64" class="edge">
<title>literal_60&#45;&gt;leaf_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5260,-191.782C5260,-159.9922 5260,-93.9972 5260,-56.1047"/>
<polygon fill="#000000" stroke="#000000" points="5263.5001,-55.7648 5260,-45.7648 5256.5001,-55.7648 5263.5001,-55.7648"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="5568,-45.7 5328,-45.7 5328,-9.7 5568,-9.7 5568,-45.7"/>
<text text-anchor="middle" x="5448" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_61&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>raw_61&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5338.2354,-191.6817C5341.9407,-167.1533 5351.1301,-122.9743 5372,-91.4 5382.1577,-76.0324 5397.1012,-62.3829 5411.0554,-51.6999"/>
<polygon fill="#000000" stroke="#000000" points="5413.1392,-54.5121 5419.1134,-45.7622 5408.9867,-48.8767 5413.1392,-54.5121"/>
</g>
<!-- leaf_72 -->
<g id="node73" class="node">
<title>leaf_72</title>
<polygon fill="none" stroke="#c0c0c0" points="5985,-227.9202 5815,-227.9202 5815,-191.9202 5985,-191.9202 5985,-227.9202"/>
<text text-anchor="middle" x="5900" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append()</text>
</g>
<!-- header_67&#45;&gt;leaf_72 -->
<g id="edge72" class="edge">
<title>header_67&#45;&gt;leaf_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5914.4303,-666.9958C5912.1494,-594.749 5903.6658,-326.0349 5900.8873,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="5904.3842,-237.8679 5900.5703,-227.9833 5897.3877,-238.0888 5904.3842,-237.8679"/>
</g>
<!-- raw_73 -->
<g id="node74" class="node">
<title>raw_73</title>
<ellipse fill="none" stroke="#000000" cx="6030" cy="-209.9202" rx="27" ry="18"/>
<text text-anchor="middle" x="6030" y="-205.7202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_68&#45;&gt;raw_73 -->
<g id="edge73" class="edge">
<title>prose_68&#45;&gt;raw_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6086.7592,-666.9958C6077.7876,-594.749 6044.419,-326.0349 6033.4901,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="6036.9488,-237.4758 6032.2431,-227.9833 6030.0021,-238.3384 6036.9488,-237.4758"/>
</g>
<!-- leaf_75 -->
<g id="node76" class="node">
<title>leaf_75</title>
<polygon fill="none" stroke="#c0c0c0" points="6406.5,-260.3212 6075.5,-260.3212 6075.5,-159.5192 6406.5,-159.5192 6406.5,-260.3212"/>
<text text-anchor="middle" x="6241" y="-244.9203" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, linebuf)</text>
<text text-anchor="middle" x="6241" y="-229.5203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = linebuf</text>
<text text-anchor="middle" x="6241" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="6241" y="-198.7202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:persist(linebuf)</text>
<text text-anchor="middle" x="6241" y="-183.3202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="6241" y="-167.9201" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_69&#45;&gt;leaf_75 -->
<g id="edge75" class="edge">
<title>codeblock_69&#45;&gt;leaf_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6234.2659,-666.9958C6235.2215,-602.1337 6238.5102,-378.9155 6240.1108,-270.2742"/>
<polygon fill="#000000" stroke="#000000" points="6243.6125,-270.1779 6240.2603,-260.1273 6236.6133,-270.0747 6243.6125,-270.1779"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="6881.5,-275.6206 6424.5,-275.6206 6424.5,-144.2198 6881.5,-144.2198 6881.5,-275.6206"/>
<text text-anchor="middle" x="6653" y="-260.3203" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new()</text>
<text text-anchor="middle" x="6653" y="-244.9203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="6653" y="-229.5203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="6653" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This will also be load()ed once we have the tables for it</text>
<text text-anchor="middle" x="6653" y="-198.7202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.results = {} &#45;&#45; keyed by linebuf</text>
<text text-anchor="middle" x="6653" y="-183.3202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="6653" y="-167.9201" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="6653" y="-152.5201" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_70&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>codeblock_70&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6544.2917,-666.9958C6559.0253,-605.0469 6608.1142,-398.6472 6635.0052,-285.5813"/>
<polygon fill="#000000" stroke="#000000" points="6638.4689,-286.144 6637.3778,-275.6055 6631.6589,-284.5243 6638.4689,-286.144"/>
</g>
<!-- leaf_77 -->
<g id="node78" class="node">
<title>leaf_77</title>
<polygon fill="none" stroke="#c0c0c0" points="6986,-227.9202 6900,-227.9202 6900,-191.9202 6986,-191.9202 6986,-227.9202"/>
<text text-anchor="middle" x="6943" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_71&#45;&gt;leaf_77 -->
<g id="edge77" class="edge">
<title>codeblock_71&#45;&gt;leaf_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6896.823,-666.9958C6904.1219,-594.749 6931.2693,-326.0349 6940.1606,-238.0253"/>
<polygon fill="#000000" stroke="#000000" points="6943.6522,-238.2845 6941.1751,-227.9833 6936.6876,-237.5808 6943.6522,-238.2845"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="6057,-45.7 6003,-45.7 6003,-9.7 6057,-9.7 6057,-45.7"/>
</g>
<!-- raw_73&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>raw_73&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6030,-191.782C6030,-159.9922 6030,-93.9972 6030,-56.1047"/>
<polygon fill="#000000" stroke="#000000" points="6033.5001,-55.7648 6030,-45.7648 6026.5001,-55.7648 6033.5001,-55.7648"/>
</g>
</g>
</svg>
