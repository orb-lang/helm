<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="18504pt" height="2817pt"
 viewBox="0.00 0.00 18504.30 2817.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2813.2043)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2813.2043 18500.2972,-2813.2043 18500.2972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2791.2043" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1787" y="-2787.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 575</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2719.2043" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1787" y="-2715.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;469</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2773.0357C1787,-2765.3353 1787,-2756.1787 1787,-2747.6209"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2747.6175 1787,-2737.6176 1783.5001,-2747.6176 1790.5001,-2747.6175"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1168" cy="-2647.2043" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1168" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1725.4565,-2712.6516C1633.9363,-2702.8264 1456.5725,-2683.4749 1306,-2665.2043 1281.4502,-2662.2254 1254.4713,-2658.7512 1230.9302,-2655.6539"/>
<polygon fill="#000000" stroke="#000000" points="1231.0962,-2652.1455 1220.7241,-2654.3064 1230.1799,-2659.0853 1231.0962,-2652.1455"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1347" cy="-2647.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1347" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1726.8328,-2711.8767C1654.436,-2702.6917 1529.3399,-2685.6464 1423,-2665.2043 1411.0534,-2662.9078 1398.1458,-2660.0101 1386.4181,-2657.2147"/>
<polygon fill="#000000" stroke="#000000" points="1387.0127,-2653.7575 1376.4695,-2654.8021 1385.363,-2660.5603 1387.0127,-2653.7575"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1464" cy="-2647.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1464" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1731.5408,-2709.4356C1677.8804,-2699.6137 1594.4109,-2683.3578 1523,-2665.2043 1516.1661,-2663.467 1508.9445,-2661.4327 1501.9868,-2659.369"/>
<polygon fill="#000000" stroke="#000000" points="1502.6431,-2655.9106 1492.0577,-2656.3556 1500.6102,-2662.6089 1502.6431,-2655.9106"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1564" cy="-2647.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1564" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1742.3852,-2705.8546C1707.3486,-2695.2321 1657.3972,-2679.7813 1614,-2665.2043 1609.6517,-2663.7437 1605.1065,-2662.1716 1600.6048,-2660.5862"/>
<polygon fill="#000000" stroke="#000000" points="1601.5075,-2657.1923 1590.9128,-2657.1328 1599.1579,-2663.7863 1601.5075,-2657.1923"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1655" cy="-2647.2043" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1655" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1757.3766,-2703.0461C1736.5856,-2691.7056 1708.7908,-2676.5448 1687.4091,-2664.882"/>
<polygon fill="#000000" stroke="#000000" points="1688.8366,-2661.6738 1678.3816,-2659.9579 1685.4846,-2667.8191 1688.8366,-2661.6738"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1787" cy="-2647.2043" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1787" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;28</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2701.0357C1787,-2693.3353 1787,-2684.1787 1787,-2675.6209"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2675.6175 1787,-2665.6176 1783.5001,-2675.6176 1790.5001,-2675.6175"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="2066" cy="-2647.2043" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="2066" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 30&#45;32</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1834.9618,-2706.8271C1881.7022,-2694.765 1952.9893,-2676.3683 2004.0105,-2663.2016"/>
<polygon fill="#000000" stroke="#000000" points="2005.1231,-2666.5292 2013.9312,-2660.6414 2003.3739,-2659.7513 2005.1231,-2666.5292"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2647.2043" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2593" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 35&#45;223</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1849.5748,-2713.6145C1995.3393,-2700.5933 2357.1653,-2668.2714 2516.0774,-2654.0758"/>
<polygon fill="#000000" stroke="#000000" points="2516.5979,-2657.5433 2526.2468,-2653.1674 2515.975,-2650.5711 2516.5979,-2657.5433"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="7307" cy="-2647.2043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7307" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 281&#45;316</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.8377,-2718.3456C2426.4627,-2710.8635 6570.374,-2656.8125 7221.1088,-2648.3246"/>
<polygon fill="#000000" stroke="#000000" points="7221.3907,-2651.8213 7231.3442,-2648.1911 7221.2993,-2644.8219 7221.3907,-2651.8213"/>
</g>
<!-- section_11 -->
<g id="node12" class="node">
<title>section_11</title>
<ellipse fill="none" stroke="#000000" cx="11890" cy="-2647.2043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="11890" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 383&#45;449</text>
</g>
<!-- section_1&#45;&gt;section_11 -->
<g id="edge11" class="edge">
<title>section_1&#45;&gt;section_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.8447,-2718.7351C2671.9167,-2712.8979 10873.0109,-2654.452 11804.0846,-2647.8166"/>
<polygon fill="#000000" stroke="#000000" points="11804.4045,-2651.3145 11814.3793,-2647.7432 11804.3545,-2644.3147 11804.4045,-2651.3145"/>
</g>
<!-- section_12 -->
<g id="node13" class="node">
<title>section_12</title>
<ellipse fill="none" stroke="#000000" cx="15218" cy="-2647.2043" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="15218" y="-2643.0043" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 470&#45;540</text>
</g>
<!-- section_1&#45;&gt;section_12 -->
<g id="edge12" class="edge">
<title>section_1&#45;&gt;section_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1852.6648,-2718.8625C2495.4669,-2715.515 7731.6302,-2688.2183 11974,-2665.2043 13229.0835,-2658.3957 14757.3061,-2649.8008 15132.0392,-2647.6891"/>
<polygon fill="#000000" stroke="#000000" points="15132.2817,-2651.1879 15142.2618,-2647.6315 15132.2422,-2644.188 15132.2817,-2651.1879"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="1209.5,-2522.5041 1116.5,-2522.5041 1116.5,-2486.5041 1209.5,-2486.5041 1209.5,-2522.5041"/>
<text text-anchor="middle" x="1163" y="-2501.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>header_2&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1167.3667,-2629.1312C1166.5186,-2604.9247 1165.0044,-2561.7102 1164.001,-2533.073"/>
<polygon fill="#000000" stroke="#000000" points="1167.492,-2532.7525 1163.6439,-2522.8812 1160.4963,-2532.9977 1167.492,-2532.7525"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="1255" cy="-2504.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1255" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_3&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1328.1396,-2632.5399C1316.2278,-2622.4994 1301.2132,-2608.3085 1291,-2593.2043 1278.2561,-2574.3576 1268.8474,-2550.3033 1262.8511,-2532.0001"/>
<polygon fill="#000000" stroke="#000000" points="1266.1211,-2530.7301 1259.7935,-2522.2324 1259.4408,-2532.8213 1266.1211,-2530.7301"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="1327" cy="-2504.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1327" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_4&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1435.7492,-2638.1614C1413.3647,-2629.7106 1382.6832,-2615.0804 1363,-2593.2043 1347.5243,-2576.0045 1338.2339,-2551.2795 1332.9783,-2532.3007"/>
<polygon fill="#000000" stroke="#000000" points="1336.324,-2531.2564 1330.4599,-2522.4325 1329.5414,-2532.9874 1336.324,-2531.2564"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1399" cy="-2504.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1399" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_5&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1535.8995,-2638.276C1502.5599,-2627.2104 1449.641,-2608.0056 1435,-2593.2043 1418.5545,-2576.5787 1409.3113,-2551.4318 1404.3215,-2532.154"/>
<polygon fill="#000000" stroke="#000000" points="1407.7263,-2531.343 1402.0261,-2522.4123 1400.9129,-2532.9484 1407.7263,-2531.343"/>
</g>
<!-- raw_20 -->
<g id="node21" class="node">
<title>raw_20</title>
<ellipse fill="none" stroke="#000000" cx="1471" cy="-2504.5041" rx="27" ry="18"/>
<text text-anchor="middle" x="1471" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_20 -->
<g id="edge20" class="edge">
<title>prose_6&#45;&gt;raw_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1627.639,-2637.2991C1585.0229,-2621.8607 1507.5705,-2593.7548 1507,-2593.2043 1490.1717,-2576.9662 1480.9666,-2551.7808 1476.0886,-2532.3898"/>
<polygon fill="#000000" stroke="#000000" points="1479.4886,-2531.557 1473.8587,-2522.5818 1472.6628,-2533.1089 1479.4886,-2531.557"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="2057.5,-2593.4049 1516.5,-2593.4049 1516.5,-2415.6033 2057.5,-2415.6033 2057.5,-2593.4049"/>
<text text-anchor="middle" x="1787" y="-2578.0043" font-family="Inconsolata" font-size="14.00" fill="#000000">local Txtbuf &#160;= require &quot;txtbuf&quot;</text>
<text text-anchor="middle" x="1787" y="-2562.6043" font-family="Inconsolata" font-size="14.00" fill="#000000">local Rainbuf = require &quot;rainbuf&quot;</text>
<text text-anchor="middle" x="1787" y="-2547.2042" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1787" y="-2531.8042" font-family="Inconsolata" font-size="14.00" fill="#000000">local color &#160;&#160;= require &quot;color&quot;</text>
<text text-anchor="middle" x="1787" y="-2516.4042" font-family="Inconsolata" font-size="14.00" fill="#000000">local L &#160;&#160;&#160;&#160;&#160;&#160;= require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1787" y="-2501.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">local repr &#160;&#160;&#160;= require &quot;repr&quot;</text>
<text text-anchor="middle" x="1787" y="-2485.6041" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
<text text-anchor="middle" x="1787" y="-2470.2041" font-family="Inconsolata" font-size="14.00" fill="#000000">local sub &#160;&#160;&#160;&#160;= assert (string.sub)</text>
<text text-anchor="middle" x="1787" y="-2454.8041" font-family="Inconsolata" font-size="14.00" fill="#000000">local codepoints = assert(string.codepoints, &quot;must have string.codepoints&quot;)</text>
<text text-anchor="middle" x="1787" y="-2439.404" font-family="Inconsolata" font-size="14.00" fill="#000000">local reverse = assert (table.reverse)</text>
<text text-anchor="middle" x="1787" y="-2424.004" font-family="Inconsolata" font-size="14.00" fill="#000000">assert(meta)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>codeblock_7&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1787,-2629.1312C1787,-2622.0065 1787,-2613.2351 1787,-2603.6733"/>
<polygon fill="#000000" stroke="#000000" points="1790.5001,-2603.4588 1787,-2593.4588 1783.5001,-2603.4589 1790.5001,-2603.4588"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="2266.5,-2522.5041 2075.5,-2522.5041 2075.5,-2486.5041 2266.5,-2486.5041 2266.5,-2522.5041"/>
<text text-anchor="middle" x="2171" y="-2501.0042" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>codeblock_8&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2079.086,-2629.4198C2097.3205,-2604.6382 2130.5038,-2559.5404 2151.6149,-2530.8495"/>
<polygon fill="#000000" stroke="#000000" points="2154.6415,-2532.6417 2157.7491,-2522.5128 2149.0033,-2528.493 2154.6415,-2532.6417"/>
</g>
<!-- header_24 -->
<g id="node25" class="node">
<title>header_24</title>
<ellipse fill="none" stroke="#000000" cx="2353" cy="-2504.5041" rx="68.6997" ry="18"/>
<text text-anchor="middle" x="2353" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Persistence</text>
</g>
<!-- section_9&#45;&gt;header_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;header_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2536.8606,-2636.2231C2504.0745,-2627.9939 2462.9947,-2614.4243 2431,-2593.2043 2406.1395,-2576.7159 2384.3461,-2550.3244 2370.1616,-2530.609"/>
<polygon fill="#000000" stroke="#000000" points="2372.9813,-2528.5337 2364.3791,-2522.3488 2367.2468,-2532.5481 2372.9813,-2528.5337"/>
</g>
<!-- prose_25 -->
<g id="node26" class="node">
<title>prose_25</title>
<ellipse fill="none" stroke="#000000" cx="2472" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2472" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_25 -->
<g id="edge25" class="edge">
<title>section_9&#45;&gt;prose_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2561.079,-2631.105C2545.0381,-2621.7679 2526.2482,-2608.774 2513,-2593.2043 2497.7871,-2575.3256 2487.0412,-2550.8592 2480.378,-2532.1504"/>
<polygon fill="#000000" stroke="#000000" points="2483.61,-2530.7815 2477.0938,-2522.4274 2476.9781,-2533.0216 2483.61,-2530.7815"/>
</g>
<!-- section_26 -->
<g id="node27" class="node">
<title>section_26</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2504.5041" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2593" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 39&#45;141</text>
</g>
<!-- section_9&#45;&gt;section_26 -->
<g id="edge26" class="edge">
<title>section_9&#45;&gt;section_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593,-2629.1312C2593,-2604.9247 2593,-2561.7102 2593,-2533.073"/>
<polygon fill="#000000" stroke="#000000" points="2596.5001,-2532.8812 2593,-2522.8812 2589.5001,-2532.8812 2596.5001,-2532.8812"/>
</g>
<!-- section_27 -->
<g id="node28" class="node">
<title>section_27</title>
<ellipse fill="none" stroke="#000000" cx="2991" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="2991" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 142&#45;212</text>
</g>
<!-- section_9&#45;&gt;section_27 -->
<g id="edge27" class="edge">
<title>section_9&#45;&gt;section_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2634.0939,-2632.4704C2707.0416,-2606.3155 2858.9975,-2551.8327 2939.0663,-2523.1246"/>
<polygon fill="#000000" stroke="#000000" points="2940.7016,-2526.2565 2948.9336,-2519.5868 2938.339,-2519.6672 2940.7016,-2526.2565"/>
</g>
<!-- section_28 -->
<g id="node29" class="node">
<title>section_28</title>
<ellipse fill="none" stroke="#000000" cx="4150" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4150" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 213&#45;223</text>
</g>
<!-- section_9&#45;&gt;section_28 -->
<g id="edge28" class="edge">
<title>section_9&#45;&gt;section_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2659.9023,-2641.0727C2910.8938,-2618.0691 3796.0385,-2536.945 4069.1439,-2511.9147"/>
<polygon fill="#000000" stroke="#000000" points="4069.7341,-2515.3753 4079.3729,-2510.9772 4069.0951,-2508.4045 4069.7341,-2515.3753"/>
</g>
<!-- section_29 -->
<g id="node30" class="node">
<title>section_29</title>
<ellipse fill="none" stroke="#000000" cx="4967" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4967" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 224&#45;280</text>
</g>
<!-- section_9&#45;&gt;section_29 -->
<g id="edge29" class="edge">
<title>section_9&#45;&gt;section_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2663.6081,-2645.7055C2936.3943,-2639.7871 3921.7211,-2617.1905 4234,-2593.2043 4475.9649,-2574.619 4760.9261,-2535.0126 4892.9608,-2515.6405"/>
<polygon fill="#000000" stroke="#000000" points="4893.5814,-2519.0869 4902.9653,-2514.1683 4892.5623,-2512.1615 4893.5814,-2519.0869"/>
</g>
<!-- header_99 -->
<g id="node100" class="node">
<title>header_99</title>
<ellipse fill="none" stroke="#000000" cx="7108" cy="-2504.5041" rx="107.339" ry="18"/>
<text text-anchor="middle" x="7108" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_10&#45;&gt;header_99 -->
<g id="edge99" class="edge">
<title>section_10&#45;&gt;header_99</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7280.1096,-2630.1354C7263.9556,-2619.724 7243.0927,-2605.9987 7225,-2593.2043 7195.1577,-2572.101 7162.039,-2546.8102 7138.6768,-2528.6437"/>
<polygon fill="#000000" stroke="#000000" points="7140.5732,-2525.6841 7130.5353,-2522.2941 7136.2682,-2531.2038 7140.5732,-2525.6841"/>
</g>
<!-- prose_100 -->
<g id="node101" class="node">
<title>prose_100</title>
<ellipse fill="none" stroke="#000000" cx="7266" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7266" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_100 -->
<g id="edge100" class="edge">
<title>section_10&#45;&gt;prose_100</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7301.8073,-2629.1312C7294.7834,-2604.6845 7282.1892,-2560.8507 7273.9646,-2532.2247"/>
<polygon fill="#000000" stroke="#000000" points="7277.2759,-2531.0751 7271.1505,-2522.4305 7270.5481,-2533.0082 7277.2759,-2531.0751"/>
</g>
<!-- prose_101 -->
<g id="node102" class="node">
<title>prose_101</title>
<ellipse fill="none" stroke="#000000" cx="7348" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7348" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_101 -->
<g id="edge101" class="edge">
<title>section_10&#45;&gt;prose_101</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7312.1927,-2629.1312C7319.2166,-2604.6845 7331.8108,-2560.8507 7340.0354,-2532.2247"/>
<polygon fill="#000000" stroke="#000000" points="7343.4519,-2533.0082 7342.8495,-2522.4305 7336.7241,-2531.0751 7343.4519,-2533.0082"/>
</g>
<!-- section_102 -->
<g id="node103" class="node">
<title>section_102</title>
<ellipse fill="none" stroke="#000000" cx="7939" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="7939" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 291&#45;316</text>
</g>
<!-- section_10&#45;&gt;section_102 -->
<g id="edge102" class="edge">
<title>section_10&#45;&gt;section_102</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7361.9803,-2634.7902C7478.5006,-2608.4809 7749.7814,-2547.2281 7874.3555,-2519.1003"/>
<polygon fill="#000000" stroke="#000000" points="7875.1641,-2522.5059 7884.1476,-2516.8893 7873.6223,-2515.6778 7875.1641,-2522.5059"/>
</g>
<!-- section_103 -->
<g id="node104" class="node">
<title>section_103</title>
<ellipse fill="none" stroke="#000000" cx="9471" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="9471" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 317&#45;382</text>
</g>
<!-- section_10&#45;&gt;section_103 -->
<g id="edge103" class="edge">
<title>section_10&#45;&gt;section_103</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7379.9292,-2642.3952C7707.3683,-2620.8029 9040.8362,-2532.8703 9388.0338,-2509.9752"/>
<polygon fill="#000000" stroke="#000000" points="9388.2682,-2513.4674 9398.0162,-2509.3169 9387.8076,-2506.4826 9388.2682,-2513.4674"/>
</g>
<!-- header_151 -->
<g id="node152" class="node">
<title>header_151</title>
<ellipse fill="none" stroke="#000000" cx="10547" cy="-2504.5041" rx="107.339" ry="18"/>
<text text-anchor="middle" x="10547" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:search(frag)</text>
</g>
<!-- section_11&#45;&gt;header_151 -->
<g id="edge151" class="edge">
<title>section_11&#45;&gt;header_151</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11814.62,-2645.2333C11576.8151,-2638.7932 10852.0489,-2617.3897 10749,-2593.2043 10689.326,-2579.1989 10625.3205,-2548.0407 10585.7191,-2526.6484"/>
<polygon fill="#000000" stroke="#000000" points="10587.3761,-2523.5655 10576.9227,-2521.8399 10584.0184,-2529.7076 10587.3761,-2523.5655"/>
</g>
<!-- prose_152 -->
<g id="node153" class="node">
<title>prose_152</title>
<ellipse fill="none" stroke="#000000" cx="10790" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="10790" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_152 -->
<g id="edge152" class="edge">
<title>section_11&#45;&gt;prose_152</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11823.6673,-2638.5991C11618.6809,-2612.0068 10999.1204,-2531.6328 10831.9482,-2509.946"/>
<polygon fill="#000000" stroke="#000000" points="10831.9675,-2506.4192 10821.6003,-2508.6036 10831.0669,-2513.3611 10831.9675,-2506.4192"/>
</g>
<!-- prose_153 -->
<g id="node154" class="node">
<title>prose_153</title>
<ellipse fill="none" stroke="#000000" cx="11517" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11517" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_153 -->
<g id="edge153" class="edge">
<title>section_11&#45;&gt;prose_153</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11818.1995,-2641.5531C11763.8736,-2635.1476 11688.5431,-2621.6127 11628,-2593.2043 11593.5918,-2577.0591 11560.3928,-2548.2173 11539.4116,-2527.8107"/>
<polygon fill="#000000" stroke="#000000" points="11541.8199,-2525.2698 11532.2549,-2520.7133 11536.8908,-2530.2401 11541.8199,-2525.2698"/>
</g>
<!-- prose_154 -->
<g id="node155" class="node">
<title>prose_154</title>
<ellipse fill="none" stroke="#000000" cx="11669" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11669" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_154 -->
<g id="edge154" class="edge">
<title>section_11&#45;&gt;prose_154</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11863.7805,-2630.2743C11822.384,-2603.5445 11742.134,-2551.7269 11698.6807,-2523.669"/>
<polygon fill="#000000" stroke="#000000" points="11700.5479,-2520.7085 11690.2484,-2518.2243 11696.7507,-2526.5891 11700.5479,-2520.7085"/>
</g>
<!-- prose_155 -->
<g id="node156" class="node">
<title>prose_155</title>
<ellipse fill="none" stroke="#000000" cx="11890" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="11890" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_155 -->
<g id="edge155" class="edge">
<title>section_11&#45;&gt;prose_155</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11890,-2629.1312C11890,-2604.9247 11890,-2561.7102 11890,-2533.073"/>
<polygon fill="#000000" stroke="#000000" points="11893.5001,-2532.8812 11890,-2522.8812 11886.5001,-2532.8812 11893.5001,-2532.8812"/>
</g>
<!-- prose_156 -->
<g id="node157" class="node">
<title>prose_156</title>
<ellipse fill="none" stroke="#000000" cx="12090" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="12090" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_156 -->
<g id="edge156" class="edge">
<title>section_11&#45;&gt;prose_156</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11914.1247,-2629.9913C11951.215,-2603.5274 12022.0886,-2552.959 12061.6012,-2524.7667"/>
<polygon fill="#000000" stroke="#000000" points="12063.8924,-2527.4316 12069.9999,-2518.7742 12059.8266,-2521.7333 12063.8924,-2527.4316"/>
</g>
<!-- prose_157 -->
<g id="node158" class="node">
<title>prose_157</title>
<ellipse fill="none" stroke="#000000" cx="13095" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="13095" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_157 -->
<g id="edge157" class="edge">
<title>section_11&#45;&gt;prose_157</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11957.8027,-2639.1749C12178.9251,-2612.9888 12875.1177,-2530.5433 13053.1917,-2509.4552"/>
<polygon fill="#000000" stroke="#000000" points="13053.6899,-2512.9208 13063.2089,-2508.2689 13052.8666,-2505.9693 13053.6899,-2512.9208"/>
</g>
<!-- prose_158 -->
<g id="node159" class="node">
<title>prose_158</title>
<ellipse fill="none" stroke="#000000" cx="13258" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="13258" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_11&#45;&gt;prose_158 -->
<g id="edge158" class="edge">
<title>section_11&#45;&gt;prose_158</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.8598,-2646.4602C12219.1482,-2643.6248 13025.9347,-2631.6415 13136,-2593.2043 13174.9229,-2579.6116 13212.1134,-2549.1901 13234.9811,-2527.7798"/>
<polygon fill="#000000" stroke="#000000" points="13237.6506,-2530.0695 13242.4518,-2520.6249 13232.8088,-2525.014 13237.6506,-2530.0695"/>
</g>
<!-- codeblock_159 -->
<g id="node160" class="node">
<title>codeblock_159</title>
<ellipse fill="none" stroke="#000000" cx="13529" cy="-2504.5041" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="13529" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 404&#45;447</text>
</g>
<!-- section_11&#45;&gt;codeblock_159 -->
<g id="edge159" class="edge">
<title>section_11&#45;&gt;codeblock_159</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.2824,-2645.7677C12238.4587,-2640.3555 13168.33,-2620.1269 13299,-2593.2043 13367.0916,-2579.175 13441.3788,-2547.2347 13486.5812,-2525.7633"/>
<polygon fill="#000000" stroke="#000000" points="13488.2726,-2528.8338 13495.7728,-2521.3506 13485.2431,-2522.5233 13488.2726,-2528.8338"/>
</g>
<!-- section_160 -->
<g id="node161" class="node">
<title>section_160</title>
<ellipse fill="none" stroke="#000000" cx="14356" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="14356" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 450&#45;469</text>
</g>
<!-- section_11&#45;&gt;section_160 -->
<g id="edge160" class="edge">
<title>section_11&#45;&gt;section_160</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11965.64,-2645.7542C12255.4342,-2640.0582 13295.2092,-2618.2943 13625,-2593.2043 13866.3277,-2574.8445 14150.5003,-2535.1301 14282.1675,-2515.6864"/>
<polygon fill="#000000" stroke="#000000" points="14282.7649,-2519.1362 14292.1442,-2514.2087 14281.7393,-2512.2117 14282.7649,-2519.1362"/>
</g>
<!-- header_196 -->
<g id="node197" class="node">
<title>header_196</title>
<ellipse fill="none" stroke="#000000" cx="14815" cy="-2504.5041" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="14815" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_12&#45;&gt;header_196 -->
<g id="edge196" class="edge">
<title>section_12&#45;&gt;header_196</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15147.8659,-2640.3578C15092.7537,-2633.2585 15014.8955,-2619.3748 14951,-2593.2043 14911.2202,-2576.9112 14870.5743,-2548.5545 14844.2098,-2528.2881"/>
<polygon fill="#000000" stroke="#000000" points="14846.2086,-2525.4084 14836.1709,-2522.0179 14841.9034,-2530.928 14846.2086,-2525.4084"/>
</g>
<!-- prose_197 -->
<g id="node198" class="node">
<title>prose_197</title>
<ellipse fill="none" stroke="#000000" cx="14992" cy="-2504.5041" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="14992" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_12&#45;&gt;prose_197 -->
<g id="edge197" class="edge">
<title>section_12&#45;&gt;prose_197</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15186.9098,-2630.6035C15167.9222,-2620.2472 15143.2828,-2606.4166 15122,-2593.2043 15086.1284,-2570.9353 15046.1945,-2543.2307 15020.1734,-2524.7671"/>
<polygon fill="#000000" stroke="#000000" points="15022.0841,-2521.831 15011.9083,-2518.881 15018.0235,-2527.5329 15022.0841,-2521.831"/>
</g>
<!-- codeblock_198 -->
<g id="node199" class="node">
<title>codeblock_198</title>
<ellipse fill="none" stroke="#000000" cx="15218" cy="-2504.5041" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15218" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 472&#45;486</text>
</g>
<!-- section_12&#45;&gt;codeblock_198 -->
<g id="edge198" class="edge">
<title>section_12&#45;&gt;codeblock_198</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15218,-2629.1312C15218,-2604.9247 15218,-2561.7102 15218,-2533.073"/>
<polygon fill="#000000" stroke="#000000" points="15221.5001,-2532.8812 15218,-2522.8812 15214.5001,-2532.8812 15221.5001,-2532.8812"/>
</g>
<!-- section_199 -->
<g id="node200" class="node">
<title>section_199</title>
<ellipse fill="none" stroke="#000000" cx="15667" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="15667" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 489&#45;521</text>
</g>
<!-- section_12&#45;&gt;section_199 -->
<g id="edge199" class="edge">
<title>section_12&#45;&gt;section_199</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15263.5234,-2632.7362C15346.5789,-2606.3396 15522.3761,-2550.4682 15611.9855,-2521.9887"/>
<polygon fill="#000000" stroke="#000000" points="15613.2202,-2525.2689 15621.6904,-2518.9043 15611.1,-2518.5977 15613.2202,-2525.2689"/>
</g>
<!-- section_200 -->
<g id="node201" class="node">
<title>section_200</title>
<ellipse fill="none" stroke="#000000" cx="16476" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="16476" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 522&#45;540</text>
</g>
<!-- section_12&#45;&gt;section_200 -->
<g id="edge200" class="edge">
<title>section_12&#45;&gt;section_200</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15288.3201,-2640.5492C15390.3379,-2630.7877 15585.315,-2611.7307 15751,-2593.2043 15987.7383,-2566.7329 16267.432,-2531.3483 16399.5598,-2514.386"/>
<polygon fill="#000000" stroke="#000000" points="16400.1101,-2517.8442 16409.5826,-2513.0983 16399.218,-2510.9012 16400.1101,-2517.8442"/>
</g>
<!-- section_201 -->
<g id="node202" class="node">
<title>section_201</title>
<ellipse fill="none" stroke="#000000" cx="17599" cy="-2504.5041" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="17599" y="-2500.3041" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 541&#45;575</text>
</g>
<!-- section_12&#45;&gt;section_201 -->
<g id="edge201" class="edge">
<title>section_12&#45;&gt;section_201</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15293.3609,-2645.3596C15497.458,-2640.1068 16077.9857,-2623.4617 16560,-2593.2043 16918.5144,-2570.6994 17345.4589,-2529.7935 17519.3736,-2512.5314"/>
<polygon fill="#000000" stroke="#000000" points="17519.8585,-2516.0005 17529.4632,-2511.5283 17519.166,-2509.0349 17519.8585,-2516.0005"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-2088.3045 0,-2088.3045 0,-2016.5022 324,-2016.5022 324,-2088.3045"/>
<text text-anchor="middle" x="162" y="-2024.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1253.1032,-2486.3162C1249.8547,-2465.4103 1241.1428,-2431.9146 1218,-2415.804 1137.2294,-2359.5763 416.1165,-2432.502 333,-2379.804 232.2651,-2315.9354 187.6406,-2172.0413 170.7686,-2098.126"/>
<polygon fill="#000000" stroke="#000000" points="174.1451,-2097.1851 168.5691,-2088.1763 167.3101,-2098.6961 174.1451,-2097.1851"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-2079.7037 342.5,-2079.7037 342.5,-2025.1029 897.5,-2025.1029 897.5,-2079.7037"/>
<text text-anchor="middle" x="620" y="-2048.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-2033.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1325.162,-2486.5407C1322.0084,-2465.8508 1313.5389,-2432.5628 1291,-2415.804 1222.2217,-2364.6637 983.3259,-2418.793 907,-2379.804 776.2246,-2313.0009 678.6491,-2159.0334 639.1996,-2088.6724"/>
<polygon fill="#000000" stroke="#000000" points="642.1463,-2086.7687 634.2397,-2079.7162 636.0226,-2090.16 642.1463,-2086.7687"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-2079.7037 916,-2079.7037 916,-2025.1029 1464,-2025.1029 1464,-2079.7037"/>
<text text-anchor="middle" x="1190" y="-2048.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-2033.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1392.263,-2487.0413C1385.2444,-2469.0606 1373.7865,-2440.2906 1363,-2415.804 1309.7068,-2294.8221 1240.6954,-2154.1777 1208.3067,-2089.0123"/>
<polygon fill="#000000" stroke="#000000" points="1211.389,-2087.3499 1203.8001,-2079.9567 1205.1221,-2090.4688 1211.389,-2087.3499"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-2087.7037 1482,-2087.7037 1482,-2017.103 2030,-2017.103 2030,-2087.7037"/>
<text text-anchor="middle" x="1756" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new txtbuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_20&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>raw_20&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1476.9603,-2486.6622C1483.3602,-2468.3796 1494.3335,-2439.3731 1507,-2415.804 1572.6203,-2293.7017 1670.1371,-2162.3365 1721.4917,-2096.0302"/>
<polygon fill="#000000" stroke="#000000" points="1724.4488,-2097.929 1727.8216,-2087.8853 1718.9216,-2093.6335 1724.4488,-2097.929"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2162,-2070.4033 2048,-2070.4033 2048,-2034.4033 2162,-2034.4033 2162,-2070.4033"/>
<text text-anchor="middle" x="2105" y="-2048.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Persistence</text>
</g>
<!-- header_24&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>header_24&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2341.5813,-2486.7189C2327.9609,-2466.8255 2303.4301,-2434.896 2275,-2415.804 2234.3935,-2388.5349 2203.1877,-2416.6339 2171,-2379.804 2095.0495,-2292.8994 2097.3063,-2143.2041 2102.0693,-2080.901"/>
<polygon fill="#000000" stroke="#000000" points="2105.5805,-2080.9164 2102.9379,-2070.6564 2098.6055,-2080.3249 2105.5805,-2080.9164"/>
</g>
<!-- raw_31 -->
<g id="node32" class="node">
<title>raw_31</title>
<ellipse fill="none" stroke="#000000" cx="2207" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="2207" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_25&#45;&gt;raw_31 -->
<g id="edge31" class="edge">
<title>prose_25&#45;&gt;raw_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2468.7564,-2486.4889C2464.0944,-2466.0718 2453.4541,-2433.3573 2431,-2415.804 2363.9759,-2363.4084 2300.7124,-2442.3084 2243,-2379.804 2165.2587,-2295.6075 2187.1729,-2142.5931 2200.3571,-2080.1056"/>
<polygon fill="#000000" stroke="#000000" points="2203.8058,-2080.719 2202.5366,-2070.2005 2196.9693,-2079.2147 2203.8058,-2080.719"/>
</g>
<!-- header_33 -->
<g id="node34" class="node">
<title>header_33</title>
<ellipse fill="none" stroke="#000000" cx="2331" cy="-2052.4033" rx="78.8488" ry="18"/>
<text text-anchor="middle" x="2331" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : SQLite battery</text>
</g>
<!-- section_26&#45;&gt;header_33 -->
<g id="edge33" class="edge">
<title>section_26&#45;&gt;header_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2580.8142,-2486.5447C2566.5962,-2466.7934 2541.3855,-2435.2792 2513,-2415.804 2476.1109,-2390.4944 2448.9605,-2413.0267 2419,-2379.804 2340.54,-2292.8011 2330.8895,-2143.1604 2330.4787,-2080.8864"/>
<polygon fill="#000000" stroke="#000000" points="2333.9789,-2080.6512 2330.4917,-2070.6467 2326.9789,-2080.6422 2333.9789,-2080.6512"/>
</g>
<!-- prose_34 -->
<g id="node35" class="node">
<title>prose_34</title>
<ellipse fill="none" stroke="#000000" cx="2460" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2460" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_26&#45;&gt;prose_34 -->
<g id="edge34" class="edge">
<title>section_26&#45;&gt;prose_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2575.5458,-2486.8698C2554.2717,-2464.2004 2519.0558,-2422.6302 2502,-2379.804 2460.4687,-2275.5207 2457.9035,-2139.1467 2458.9894,-2080.8414"/>
<polygon fill="#000000" stroke="#000000" points="2462.4948,-2080.6515 2459.2354,-2070.5705 2455.4968,-2080.4838 2462.4948,-2080.6515"/>
</g>
<!-- codeblock_35 -->
<g id="node36" class="node">
<title>codeblock_35</title>
<ellipse fill="none" stroke="#000000" cx="2593" cy="-2052.4033" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2593" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 41&#45;139</text>
</g>
<!-- section_26&#45;&gt;codeblock_35 -->
<g id="edge35" class="edge">
<title>section_26&#45;&gt;codeblock_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2593,-2486.5023C2593,-2416.9612 2593,-2165.5307 2593,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="2596.5001,-2080.4566 2593,-2070.4566 2589.5001,-2080.4567 2596.5001,-2080.4566"/>
</g>
<!-- header_40 -->
<g id="node41" class="node">
<title>header_40</title>
<ellipse fill="none" stroke="#000000" cx="2776" cy="-2052.4033" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2776" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:load()</text>
</g>
<!-- section_27&#45;&gt;header_40 -->
<g id="edge40" class="edge">
<title>section_27&#45;&gt;header_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2967.9626,-2487.2618C2940.2245,-2465.3017 2894.1182,-2424.7677 2868,-2379.804 2809.6513,-2279.3537 2786.6483,-2139.9141 2779.1263,-2080.7531"/>
<polygon fill="#000000" stroke="#000000" points="2782.5814,-2080.1711 2777.8969,-2070.6682 2775.6328,-2081.0183 2782.5814,-2080.1711"/>
</g>
<!-- prose_41 -->
<g id="node42" class="node">
<title>prose_41</title>
<ellipse fill="none" stroke="#000000" cx="2909" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2909" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_41 -->
<g id="edge41" class="edge">
<title>section_27&#45;&gt;prose_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2983.7519,-2486.226C2974.5124,-2462.197 2958.6969,-2418.4922 2950,-2379.804 2925.5089,-2270.8546 2914.543,-2137.9895 2910.705,-2080.8039"/>
<polygon fill="#000000" stroke="#000000" points="2914.1908,-2080.4691 2910.0501,-2070.7169 2907.2055,-2080.9227 2914.1908,-2080.4691"/>
</g>
<!-- prose_42 -->
<g id="node43" class="node">
<title>prose_42</title>
<ellipse fill="none" stroke="#000000" cx="2991" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2991" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_42 -->
<g id="edge42" class="edge">
<title>section_27&#45;&gt;prose_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2991,-2486.5023C2991,-2416.9612 2991,-2165.5307 2991,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="2994.5001,-2080.4566 2991,-2070.4566 2987.5001,-2080.4567 2994.5001,-2080.4566"/>
</g>
<!-- structure_43 -->
<g id="node44" class="node">
<title>structure_43</title>
<ellipse fill="none" stroke="#000000" cx="3086" cy="-2052.4033" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="3086" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_27&#45;&gt;structure_43 -->
<g id="edge43" class="edge">
<title>section_27&#45;&gt;structure_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2998.0171,-2486.1717C3007.0068,-2462.084 3022.5527,-2418.3158 3032,-2379.804 3058.7549,-2270.738 3076.0749,-2137.9338 3082.8153,-2080.784"/>
<polygon fill="#000000" stroke="#000000" points="3086.3089,-2081.0406 3083.9864,-2070.7035 3079.3557,-2080.2328 3086.3089,-2081.0406"/>
</g>
<!-- prose_44 -->
<g id="node45" class="node">
<title>prose_44</title>
<ellipse fill="none" stroke="#000000" cx="3181" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3181" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_27&#45;&gt;prose_44 -->
<g id="edge44" class="edge">
<title>section_27&#45;&gt;prose_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3022.0967,-2488.0661C3057.1776,-2467.7126 3112.8676,-2429.5564 3140,-2379.804 3194.092,-2280.6159 3189.1728,-2139.9366 3184.0627,-2080.5675"/>
<polygon fill="#000000" stroke="#000000" points="3187.5333,-2080.0886 3183.1205,-2070.4565 3180.5635,-2080.7382 3187.5333,-2080.0886"/>
</g>
<!-- codeblock_45 -->
<g id="node46" class="node">
<title>codeblock_45</title>
<ellipse fill="none" stroke="#000000" cx="3400" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="3400" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 156&#45;210</text>
</g>
<!-- section_27&#45;&gt;codeblock_45 -->
<g id="edge45" class="edge">
<title>section_27&#45;&gt;codeblock_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3034.4525,-2489.7613C3084.7486,-2470.8925 3167.6184,-2434.024 3222,-2379.804 3313.1691,-2288.9058 3370.1533,-2141.5046 3391.0126,-2080.3598"/>
<polygon fill="#000000" stroke="#000000" points="3394.4104,-2081.2354 3394.2698,-2070.6415 3387.7733,-2079.0109 3394.4104,-2081.2354"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="3909" cy="-2052.4033" rx="190.9667" ry="18"/>
<text text-anchor="middle" x="3909" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:restore_session(modeS, session)</text>
</g>
<!-- section_28&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_28&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4140.4038,-2486.5023C4103.1448,-2416.6067 3967.9357,-2162.963 3923.3625,-2079.3464"/>
<polygon fill="#000000" stroke="#000000" points="3926.4163,-2077.6347 3918.6236,-2070.4566 3920.2391,-2080.9276 3926.4163,-2077.6347"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4150" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4150" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_28&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_28&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4150,-2486.5023C4150,-2416.9612 4150,-2165.5307 4150,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="4153.5001,-2080.4566 4150,-2070.4566 4146.5001,-2080.4567 4153.5001,-2080.4566"/>
</g>
<!-- prose_59 -->
<g id="node60" class="node">
<title>prose_59</title>
<ellipse fill="none" stroke="#000000" cx="4232" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4232" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_28&#45;&gt;prose_59 -->
<g id="edge59" class="edge">
<title>section_28&#45;&gt;prose_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4157.2481,-2486.226C4166.4876,-2462.197 4182.3031,-2418.4922 4191,-2379.804 4215.4911,-2270.8546 4226.457,-2137.9895 4230.295,-2080.8039"/>
<polygon fill="#000000" stroke="#000000" points="4233.7945,-2080.9227 4230.9499,-2070.7169 4226.8092,-2080.4691 4233.7945,-2080.9227"/>
</g>
<!-- codeblock_60 -->
<g id="node61" class="node">
<title>codeblock_60</title>
<ellipse fill="none" stroke="#000000" cx="4370" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4370" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 219&#45;221</text>
</g>
<!-- section_28&#45;&gt;codeblock_60 -->
<g id="edge60" class="edge">
<title>section_28&#45;&gt;codeblock_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4172.9328,-2487.2005C4200.5655,-2465.1787 4246.5656,-2424.5825 4273,-2379.804 4332.296,-2279.3597 4357.7436,-2139.9168 4366.3464,-2080.7541"/>
<polygon fill="#000000" stroke="#000000" points="4369.838,-2081.0581 4367.7611,-2070.6688 4362.9058,-2080.0857 4369.838,-2081.0581"/>
</g>
<!-- header_67 -->
<g id="node68" class="node">
<title>header_67</title>
<ellipse fill="none" stroke="#000000" cx="4674" cy="-2052.4033" rx="113.1277" ry="18"/>
<text text-anchor="middle" x="4674" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:persist(txtbuf)</text>
</g>
<!-- section_29&#45;&gt;header_67 -->
<g id="edge67" class="edge">
<title>section_29&#45;&gt;header_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4934.3909,-2488.1667C4896.4865,-2467.6545 4834.3693,-2429.0993 4797,-2379.804 4724.333,-2283.946 4690.4749,-2140.3857 4678.8774,-2080.3558"/>
<polygon fill="#000000" stroke="#000000" points="4682.3078,-2079.6589 4677.0256,-2070.4747 4675.4276,-2080.9484 4682.3078,-2079.6589"/>
</g>
<!-- prose_68 -->
<g id="node69" class="node">
<title>prose_68</title>
<ellipse fill="none" stroke="#000000" cx="4838" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4838" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_68 -->
<g id="edge68" class="edge">
<title>section_29&#45;&gt;prose_68</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4950.1111,-2486.7639C4929.5278,-2463.9852 4895.462,-2422.3023 4879,-2379.804 4838.4707,-2275.1731 4835.9596,-2138.9834 4837.0156,-2080.7839"/>
<polygon fill="#000000" stroke="#000000" points="4840.5205,-2080.6113 4837.255,-2070.5323 4833.5224,-2080.4478 4840.5205,-2080.6113"/>
</g>
<!-- prose_69 -->
<g id="node70" class="node">
<title>prose_69</title>
<ellipse fill="none" stroke="#000000" cx="4920" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4920" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_69 -->
<g id="edge69" class="edge">
<title>section_29&#45;&gt;prose_69</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4965.1285,-2486.5023C4957.8991,-2416.9612 4931.7606,-2165.5307 4922.9346,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="4926.3922,-2080.0411 4921.8768,-2070.4566 4919.4297,-2080.765 4926.3922,-2080.0411"/>
</g>
<!-- structure_70 -->
<g id="node71" class="node">
<title>structure_70</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-2052.4033" rx="44.5182" ry="18"/>
<text text-anchor="middle" x="5015" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">structure</text>
</g>
<!-- section_29&#45;&gt;structure_70 -->
<g id="edge70" class="edge">
<title>section_29&#45;&gt;structure_70</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4968.9113,-2486.5023C4976.2945,-2416.9612 5002.9892,-2165.5307 5012.003,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="5015.5078,-2080.7703 5013.0833,-2070.4566 5008.547,-2080.0312 5015.5078,-2080.7703"/>
</g>
<!-- prose_71 -->
<g id="node72" class="node">
<title>prose_71</title>
<ellipse fill="none" stroke="#000000" cx="5590" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5590" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_71 -->
<g id="edge71" class="edge">
<title>section_29&#45;&gt;prose_71</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4990.6616,-2487.3333C5087.9449,-2416.7364 5456.9002,-2148.9916 5561.9415,-2072.7649"/>
<polygon fill="#000000" stroke="#000000" points="5564.125,-2075.5049 5570.1628,-2066.7988 5560.0137,-2069.8394 5564.125,-2075.5049"/>
</g>
<!-- prose_72 -->
<g id="node73" class="node">
<title>prose_72</title>
<ellipse fill="none" stroke="#000000" cx="5818" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="5818" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_29&#45;&gt;prose_72 -->
<g id="edge72" class="edge">
<title>section_29&#45;&gt;prose_72</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5038.6663,-2498.6249C5190.0565,-2485.0141 5536.2882,-2447.2401 5631,-2379.804 5738.3361,-2303.3791 5792.4919,-2144.7171 5810.736,-2080.3964"/>
<polygon fill="#000000" stroke="#000000" points="5814.1636,-2081.1327 5813.452,-2070.5618 5807.4162,-2079.2692 5814.1636,-2081.1327"/>
</g>
<!-- codeblock_73 -->
<g id="node74" class="node">
<title>codeblock_73</title>
<ellipse fill="none" stroke="#000000" cx="6111" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="6111" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 243&#45;278</text>
</g>
<!-- section_29&#45;&gt;codeblock_73 -->
<g id="edge73" class="edge">
<title>section_29&#45;&gt;codeblock_73</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5041.5693,-2501.2751C5230.0153,-2491.9928 5720.2047,-2460.5407 5859,-2379.804 5984.6141,-2306.7347 6069.238,-2144.2621 6099.0766,-2079.6595"/>
<polygon fill="#000000" stroke="#000000" points="6102.2839,-2081.0614 6103.2369,-2070.5095 6095.9117,-2078.164 6102.2839,-2081.0614"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="1892,-961.5029 1554,-961.5029 1554,-905.6999 1892,-905.6999 1892,-961.5029"/>
<text text-anchor="middle" x="1723" y="-914.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">This defines the persistence model for bridge.</text>
</g>
<!-- raw_31&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>raw_31&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2211.684,-2034.3966C2224.8138,-1979.3351 2255.7281,-1811.7053 2171,-1725.0027 2086.3878,-1638.4187 1990.729,-1770.272 1901,-1689.0027 1687.0333,-1495.2087 1706.5371,-1096.6721 1718.5873,-971.8504"/>
<polygon fill="#000000" stroke="#000000" points="1722.0953,-971.9463 1719.616,-961.6457 1715.1306,-971.2442 1722.0953,-971.9463"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2052,-951.6014 1910,-951.6014 1910,-915.6014 2052,-915.6014 2052,-951.6014"/>
<text text-anchor="middle" x="1981" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** SQLite battery</text>
</g>
<!-- header_33&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>header_33&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2332.1728,-2034.2646C2334.6825,-1978.8232 2334.1501,-1810.2162 2243,-1725.0027 2182.7662,-1668.6919 2116.6304,-1749.8654 2061,-1689.0027 1865.3212,-1474.9191 1946.8104,-1071.1584 1973.6615,-961.6197"/>
<polygon fill="#000000" stroke="#000000" points="1977.1181,-962.224 1976.1499,-951.6736 1970.3274,-960.5251 1977.1181,-962.224"/>
</g>
<!-- raw_37 -->
<g id="node38" class="node">
<title>raw_37</title>
<ellipse fill="none" stroke="#000000" cx="2097" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2097" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_34&#45;&gt;raw_37 -->
<g id="edge37" class="edge">
<title>prose_34&#45;&gt;raw_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2464.3907,-2034.3255C2476.6269,-1979.0593 2504.8458,-1810.903 2419,-1725.0027 2328.4384,-1634.3835 2220.0084,-1783.0387 2133,-1689.0027 2033.3521,-1581.3063 2080.2615,-1085.8639 2093.7761,-961.8202"/>
<polygon fill="#000000" stroke="#000000" points="2097.2831,-961.9489 2094.9036,-951.6247 2090.3256,-961.1794 2097.2831,-961.9489"/>
</g>
<!-- leaf_39 -->
<g id="node40" class="node">
<title>leaf_39</title>
<polygon fill="none" stroke="#c0c0c0" points="2690,-1688.9039 2142,-1688.9039 2142,-178.2988 2690,-178.2988 2690,-1688.9039"/>
<text text-anchor="middle" x="2416" y="-1673.8027" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 2000</text>
<text text-anchor="middle" x="2416" y="-1642.4026" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_project_table = [[</text>
<text text-anchor="middle" x="2416" y="-1627.0026" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS project (</text>
<text text-anchor="middle" x="2416" y="-1611.6026" font-family="Inconsolata" font-size="14.00" fill="#000000">project_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1596.2025" font-family="Inconsolata" font-size="14.00" fill="#000000">directory TEXT UNIQUE,</text>
<text text-anchor="middle" x="2416" y="-1580.8025" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP );</text>
<text text-anchor="middle" x="2416" y="-1565.4025" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1534.0024" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2416" y="-1518.6024" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS repl (</text>
<text text-anchor="middle" x="2416" y="-1503.2024" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1487.8023" font-family="Inconsolata" font-size="14.00" fill="#000000">project INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1472.4023" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2416" y="-1457.0023" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP,</text>
<text text-anchor="middle" x="2416" y="-1441.6022" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (project)</text>
<text text-anchor="middle" x="2416" y="-1426.2022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES project (project_id)</text>
<text text-anchor="middle" x="2416" y="-1410.8022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-1395.4022" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1364.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_result_table = [[</text>
<text text-anchor="middle" x="2416" y="-1348.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS result (</text>
<text text-anchor="middle" x="2416" y="-1333.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">result_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1317.802" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1302.402" font-family="Inconsolata" font-size="14.00" fill="#000000">repr text NOT NULL,</text>
<text text-anchor="middle" x="2416" y="-1287.002" font-family="Inconsolata" font-size="14.00" fill="#000000">value blob,</text>
<text text-anchor="middle" x="2416" y="-1271.6019" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (line_id)</text>
<text text-anchor="middle" x="2416" y="-1256.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES repl (line_id)</text>
<text text-anchor="middle" x="2416" y="-1240.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-1225.4018" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-1194.0018" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_session_table = [[</text>
<text text-anchor="middle" x="2416" y="-1178.6018" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE IF NOT EXISTS session (</text>
<text text-anchor="middle" x="2416" y="-1163.2017" font-family="Inconsolata" font-size="14.00" fill="#000000">session_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2416" y="-1147.8017" font-family="Inconsolata" font-size="14.00" fill="#000000">name TEXT,</text>
<text text-anchor="middle" x="2416" y="-1132.4017" font-family="Inconsolata" font-size="14.00" fill="#000000">project INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1117.0017" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; These two are line_ids</text>
<text text-anchor="middle" x="2416" y="-1101.6016" font-family="Inconsolata" font-size="14.00" fill="#000000">start INTEGER NOT NULL,</text>
<text text-anchor="middle" x="2416" y="-1086.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">end INTEGER,</text>
<text text-anchor="middle" x="2416" y="-1070.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">test BOOLEAN,</text>
<text text-anchor="middle" x="2416" y="-1055.4015" font-family="Inconsolata" font-size="14.00" fill="#000000">sha TEXT,</text>
<text text-anchor="middle" x="2416" y="-1040.0015" font-family="Inconsolata" font-size="14.00" fill="#000000">FOREIGN KEY (project)</text>
<text text-anchor="middle" x="2416" y="-1024.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;REFERENCES project (project_id)</text>
<text text-anchor="middle" x="2416" y="-1009.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ON DELETE CASCADE );</text>
<text text-anchor="middle" x="2416" y="-993.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-962.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line = [[</text>
<text text-anchor="middle" x="2416" y="-947.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES (:project, :line);</text>
<text text-anchor="middle" x="2416" y="-931.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-900.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_result = [[</text>
<text text-anchor="middle" x="2416" y="-884.8012" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO result (line_id, repr) VALUES (:line_id, :repr);</text>
<text text-anchor="middle" x="2416" y="-869.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-838.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_project = [[</text>
<text text-anchor="middle" x="2416" y="-822.6012" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO project (directory) VALUES (:dir);</text>
<text text-anchor="middle" x="2416" y="-807.2011" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2416" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2416" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-713.601" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2416" y="-698.201" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT CAST (line_id AS REAL), line FROM repl</text>
<text text-anchor="middle" x="2416" y="-682.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %d</text>
<text text-anchor="middle" x="2416" y="-667.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2416" y="-652.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2416" y="-636.6008" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-605.2008" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_project = [[</text>
<text text-anchor="middle" x="2416" y="-589.8008" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT project_id FROM project</text>
<text text-anchor="middle" x="2416" y="-574.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE directory = %s;</text>
<text text-anchor="middle" x="2416" y="-559.0007" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-527.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_results = [[</text>
<text text-anchor="middle" x="2416" y="-512.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT result.repr</text>
<text text-anchor="middle" x="2416" y="-496.8006" font-family="Inconsolata" font-size="14.00" fill="#000000">FROM result</text>
<text text-anchor="middle" x="2416" y="-481.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">WHERE result.line_id = :line_id</text>
<text text-anchor="middle" x="2416" y="-466.0006" font-family="Inconsolata" font-size="14.00" fill="#000000">ORDER BY result.result_id;</text>
<text text-anchor="middle" x="2416" y="-450.6005" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2416" y="-419.2005" font-family="Inconsolata" font-size="14.00" fill="#000000">local home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-387.8005" font-family="Inconsolata" font-size="14.00" fill="#000000">local bridge_home = io.popen(&quot;echo $BRIDGE_HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-372.4004" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.bridge_home = bridge_home ~= &quot;&quot; and bridge_home</text>
<text text-anchor="middle" x="2416" y="-357.0004" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or home_dir .. &quot;/.bridge&quot;</text>
<text text-anchor="middle" x="2416" y="-325.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2416" y="-294.2003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2416" y="-278.8003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2416" y="-263.4003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2416" y="-248.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2416" y="-232.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2416" y="-217.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2416" y="-201.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2416" y="-186.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_35&#45;&gt;leaf_39 -->
<g id="edge39" class="edge">
<title>codeblock_35&#45;&gt;leaf_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2590.1481,-2034.3764C2582.7766,-1987.782 2561.9213,-1855.9578 2537.0869,-1698.9811"/>
<polygon fill="#000000" stroke="#000000" points="2540.5415,-1698.4189 2535.5218,-1689.0887 2533.6275,-1699.5128 2540.5415,-1698.4189"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="1954,-125.1 1900,-125.1 1900,-89.1 1954,-89.1 1954,-125.1"/>
</g>
<!-- raw_37&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>raw_37&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2098.7261,-915.5749C2108.2066,-812.6766 2150.3428,-299.9194 2061,-178.2001 2033.5436,-140.7938 2002.2547,-166.9419 1963,-142.2001 1958.5,-139.3638 1954.1025,-135.889 1950.0137,-132.2403"/>
<polygon fill="#000000" stroke="#000000" points="1952.2302,-129.517 1942.5855,-125.1317 1947.3904,-134.5743 1952.2302,-129.517"/>
</g>
<!-- leaf_46 -->
<g id="node47" class="node">
<title>leaf_46</title>
<polygon fill="none" stroke="#c0c0c0" points="2864,-951.6014 2708,-951.6014 2708,-915.6014 2864,-915.6014 2864,-951.6014"/>
<text text-anchor="middle" x="2786" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:load()</text>
</g>
<!-- header_40&#45;&gt;leaf_46 -->
<g id="edge46" class="edge">
<title>header_40&#45;&gt;leaf_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2776.1611,-2034.3764C2777.3142,-1905.3728 2784.3067,-1123.0454 2785.7425,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="2789.2465,-961.9721 2785.8361,-951.9411 2782.2467,-961.9094 2789.2465,-961.9721"/>
</g>
<!-- raw_47 -->
<g id="node48" class="node">
<title>raw_47</title>
<ellipse fill="none" stroke="#000000" cx="2909" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2909" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_41&#45;&gt;raw_47 -->
<g id="edge47" class="edge">
<title>prose_41&#45;&gt;raw_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2909,-2034.3764C2909,-1905.3728 2909,-1123.0454 2909,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="2912.5001,-961.9411 2909,-951.9411 2905.5001,-961.9412 2912.5001,-961.9411"/>
</g>
<!-- raw_49 -->
<g id="node50" class="node">
<title>raw_49</title>
<ellipse fill="none" stroke="#000000" cx="2981" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="2981" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_42&#45;&gt;raw_49 -->
<g id="edge49" class="edge">
<title>prose_42&#45;&gt;raw_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2990.8389,-2034.3764C2989.6858,-1905.3728 2982.6933,-1123.0454 2981.2575,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="2984.7533,-961.9094 2981.1639,-951.9411 2977.7535,-961.9721 2984.7533,-961.9094"/>
</g>
<!-- hashline_51 -->
<g id="node52" class="node">
<title>hashline_51</title>
<ellipse fill="none" stroke="#000000" cx="3069" cy="-933.6014" rx="43.0992" ry="18"/>
<text text-anchor="middle" x="3069" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashline</text>
</g>
<!-- structure_43&#45;&gt;hashline_51 -->
<g id="edge51" class="edge">
<title>structure_43&#45;&gt;hashline_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3085.7261,-2034.3764C3083.7659,-1905.3728 3071.8786,-1123.0454 3069.4378,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="3072.9303,-961.8868 3069.2787,-951.9411 3065.9311,-961.9932 3072.9303,-961.8868"/>
</g>
<!-- raw_54 -->
<g id="node55" class="node">
<title>raw_54</title>
<ellipse fill="none" stroke="#000000" cx="3157" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="3157" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_44&#45;&gt;raw_54 -->
<g id="edge54" class="edge">
<title>prose_44&#45;&gt;raw_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3180.6133,-2034.3764C3177.846,-1905.3728 3161.0639,-1123.0454 3157.6181,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="3161.1072,-961.8637 3157.3934,-951.9411 3154.1088,-962.0139 3161.1072,-961.8637"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="3757.5,-1345.903 3202.5,-1345.903 3202.5,-521.2997 3757.5,-521.2997 3757.5,-1345.903"/>
<text text-anchor="middle" x="3480" y="-1330.8022" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="3480" y="-1315.4022" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.bridge_home)</text>
<text text-anchor="middle" x="3480" y="-1300.0021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="3480" y="-1284.6021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Set up bridge tables</text>
<text text-anchor="middle" x="3480" y="-1269.2021" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn.pragma.foreign_keys(true)</text>
<text text-anchor="middle" x="3480" y="-1253.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_project_table)</text>
<text text-anchor="middle" x="3480" y="-1238.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_result_table)</text>
<text text-anchor="middle" x="3480" y="-1223.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_repl_table)</text>
<text text-anchor="middle" x="3480" y="-1207.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;conn:exec(create_session_table)</text>
<text text-anchor="middle" x="3480" y="-1192.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Retrive project id</text>
<text text-anchor="middle" x="3480" y="-1176.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local proj_val, proj_row = sql.pexec(conn,</text>
<text text-anchor="middle" x="3480" y="-1161.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.format(get_project, historian.project),</text>
<text text-anchor="middle" x="3480" y="-1146.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-1130.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not proj_val then</text>
<text text-anchor="middle" x="3480" y="-1115.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local ins_proj_stmt = conn:prepare(insert_project)</text>
<text text-anchor="middle" x="3480" y="-1099.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;ins_proj_stmt:bindkv {dir = historian.project}</text>
<text text-anchor="middle" x="3480" y="-1084.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;proj_val, proj_row = ins_proj_stmt:step()</text>
<text text-anchor="middle" x="3480" y="-1069.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; retry</text>
<text text-anchor="middle" x="3480" y="-1053.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;proj_val, proj_row = sql.pexec(conn,</text>
<text text-anchor="middle" x="3480" y="-1038.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sql.format(get_project, historian.project),</text>
<text text-anchor="middle" x="3480" y="-1022.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-1007.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not proj_val then</text>
<text text-anchor="middle" x="3480" y="-992.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error &quot;Could not create project in .bridge&quot;</text>
<text text-anchor="middle" x="3480" y="-976.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-961.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local project_id = proj_val[1][1]</text>
<text text-anchor="middle" x="3480" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.project_id = project_id</text>
<text text-anchor="middle" x="3480" y="-899.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Create insert prepared statements</text>
<text text-anchor="middle" x="3480" y="-883.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_line = conn:prepare(insert_line)</text>
<text text-anchor="middle" x="3480" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_result = conn:prepare(insert_result)</text>
<text text-anchor="middle" x="3480" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Create result retrieval prepared statement</text>
<text text-anchor="middle" x="3480" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.get_results = conn:prepare(get_results)</text>
<text text-anchor="middle" x="3480" y="-822.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Retrieve history</text>
<text text-anchor="middle" x="3480" y="-806.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_str = sql.format(get_recent, project_id,</text>
<text text-anchor="middle" x="3480" y="-791.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="3480" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local repl_val &#160;= sql.pexec(conn, pop_str, &quot;i&quot;)</text>
<text text-anchor="middle" x="3480" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if repl_val then</text>
<text text-anchor="middle" x="3480" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local lines = reverse(repl_val[2])</text>
<text text-anchor="middle" x="3480" y="-729.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local line_ids = reverse(repl_val[1])</text>
<text text-anchor="middle" x="3480" y="-714.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.line_ids = line_ids</text>
<text text-anchor="middle" x="3480" y="-698.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local repl_map = {}</text>
<text text-anchor="middle" x="3480" y="-683.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i, v in ipairs(lines) do</text>
<text text-anchor="middle" x="3480" y="-668.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local buf = Txtbuf(v)</text>
<text text-anchor="middle" x="3480" y="-652.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = buf</text>
<text text-anchor="middle" x="3480" y="-637.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repl_map[line_ids[i]] = buf</text>
<text text-anchor="middle" x="3480" y="-621.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-606.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="3480" y="-591.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="3480" y="-575.6007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.results = {}</text>
<text text-anchor="middle" x="3480" y="-560.2007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = 0</text>
<text text-anchor="middle" x="3480" y="-544.8006" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3480" y="-529.4006" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_45&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_45&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3401.289,-2034.3764C3406.9295,-1955.4942 3430.037,-1632.3344 3449.7674,-1356.4046"/>
<polygon fill="#000000" stroke="#000000" points="3453.2751,-1356.4213 3450.4973,-1346.1971 3446.2929,-1355.9219 3453.2751,-1356.4213"/>
</g>
<!-- leaf_48 -->
<g id="node49" class="node">
<title>leaf_48</title>
<polygon fill="none" stroke="#c0c0c0" points="2492,-135.0015 1972,-135.0015 1972,-79.1986 2492,-79.1986 2492,-135.0015"/>
<text text-anchor="middle" x="2232" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Brings up the project history and results, and (eventually) user config.</text>
</g>
<!-- raw_47&#45;&gt;leaf_48 -->
<g id="edge48" class="edge">
<title>raw_47&#45;&gt;leaf_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2911.1445,-915.5329C2923.092,-811.299 2977.2391,-287.6602 2873,-178.2001 2844.3623,-148.1281 2542.2611,-146.8872 2501,-142.2001 2484.1789,-140.2893 2466.7782,-138.223 2449.2921,-136.0827"/>
<polygon fill="#000000" stroke="#000000" points="2449.3432,-132.5627 2438.9905,-134.8146 2448.4879,-139.5102 2449.3432,-132.5627"/>
</g>
<!-- leaf_50 -->
<g id="node51" class="node">
<title>leaf_50</title>
<polygon fill="none" stroke="#c0c0c0" points="3009.5,-134.4005 2510.5,-134.4005 2510.5,-79.7996 3009.5,-79.7996 3009.5,-134.4005"/>
<text text-anchor="middle" x="2760" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">Most of the complexity serves to make a simple key/value relationship</text>
<text text-anchor="middle" x="2760" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">between the regenerated txtbufs and their associated result history.</text>
</g>
<!-- raw_49&#45;&gt;leaf_50 -->
<g id="edge50" class="edge">
<title>raw_49&#45;&gt;leaf_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2982.698,-915.5954C2992.0222,-812.8109 3033.4349,-300.5806 2945,-178.2001 2934.6841,-163.9245 2903.0334,-149.6961 2868.7612,-137.7602"/>
<polygon fill="#000000" stroke="#000000" points="2869.6352,-134.3606 2859.0408,-134.4563 2867.3825,-140.9883 2869.6352,-134.3606"/>
</g>
<!-- hashtag_52 -->
<g id="node53" class="node">
<title>hashtag_52</title>
<ellipse fill="none" stroke="#000000" cx="3069" cy="-107.1" rx="41.6544" ry="18"/>
<text text-anchor="middle" x="3069" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashtag</text>
</g>
<!-- hashline_51&#45;&gt;hashtag_52 -->
<g id="edge52" class="edge">
<title>hashline_51&#45;&gt;hashtag_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3069,-915.5701C3069,-809.3734 3069,-265.6725 3069,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="3072.5001,-135.2475 3069,-125.2475 3065.5001,-135.2476 3072.5001,-135.2475"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3096,-36 3042,-36 3042,0 3096,0 3096,-36"/>
<text text-anchor="middle" x="3069" y="-14.5" font-family="Inconsolata" font-size="14.00" fill="#000000">todo</text>
</g>
<!-- hashtag_52&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>hashtag_52&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3069,-89.0693C3069,-76.7509 3069,-60.1792 3069,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="3072.5001,-46.0039 3069,-36.0039 3065.5001,-46.0039 3072.5001,-46.0039"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="3333.5,-127.0021 3128.5,-127.0021 3128.5,-87.198 3333.5,-87.198 3333.5,-127.0021"/>
<text text-anchor="middle" x="3231" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">the results never get used.</text>
</g>
<!-- raw_54&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>raw_54&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3154.9992,-915.5806C3146.1608,-830.6978 3114.4241,-462.9719 3193,-178.2001 3197.1041,-163.3263 3204.7204,-148.0776 3212.0628,-135.5352"/>
<polygon fill="#000000" stroke="#000000" points="3215.0945,-137.2861 3217.3068,-126.9248 3209.116,-133.645 3215.0945,-137.2861"/>
</g>
<!-- leaf_61 -->
<g id="node62" class="node">
<title>leaf_61</title>
<polygon fill="none" stroke="#c0c0c0" points="4106.5,-951.6014 3775.5,-951.6014 3775.5,-915.6014 4106.5,-915.6014 4106.5,-951.6014"/>
<text text-anchor="middle" x="3941" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:restore_session(modeS, session)</text>
</g>
<!-- header_57&#45;&gt;leaf_61 -->
<g id="edge61" class="edge">
<title>header_57&#45;&gt;leaf_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3909.5156,-2034.3764C3913.2054,-1905.3728 3935.5815,-1123.0454 3940.1759,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="3943.688,-962.0371 3940.4754,-951.9411 3936.6909,-961.8369 3943.688,-962.0371"/>
</g>
<!-- raw_62 -->
<g id="node63" class="node">
<title>raw_62</title>
<ellipse fill="none" stroke="#000000" cx="4152" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4152" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_62 -->
<g id="edge62" class="edge">
<title>prose_58&#45;&gt;raw_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4150.0322,-2034.3764C4150.2628,-1905.3728 4151.6613,-1123.0454 4151.9485,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="4155.4492,-961.9474 4151.9672,-951.9411 4148.4492,-961.9348 4155.4492,-961.9474"/>
</g>
<!-- raw_64 -->
<g id="node65" class="node">
<title>raw_64</title>
<ellipse fill="none" stroke="#000000" cx="4229" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4229" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_59&#45;&gt;raw_64 -->
<g id="edge64" class="edge">
<title>prose_59&#45;&gt;raw_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4231.9517,-2034.3764C4231.6057,-1905.3728 4229.508,-1123.0454 4229.0773,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="4232.5761,-961.9317 4229.0492,-951.9411 4225.5761,-961.9505 4232.5761,-961.9317"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="4397,-951.6014 4343,-951.6014 4343,-915.6014 4397,-915.6014 4397,-951.6014"/>
</g>
<!-- codeblock_60&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_60&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4370,-2034.3764C4370,-1905.3728 4370,-1123.0454 4370,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="4373.5001,-961.9411 4370,-951.9411 4366.5001,-961.9412 4373.5001,-961.9411"/>
</g>
<!-- leaf_63 -->
<g id="node64" class="node">
<title>leaf_63</title>
<polygon fill="none" stroke="#c0c0c0" points="3718,-135.0015 3352,-135.0015 3352,-79.1986 3718,-79.1986 3718,-135.0015"/>
<text text-anchor="middle" x="3535" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">If there is an open session, we want to replay it.</text>
</g>
<!-- raw_62&#45;&gt;leaf_63 -->
<g id="edge63" class="edge">
<title>raw_62&#45;&gt;leaf_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4154.1251,-915.5248C4165.9603,-811.245 4219.5342,-287.3918 4115,-178.2001 4085.0592,-146.9253 3769.8926,-148.0989 3727,-142.2001 3714.6828,-140.5062 3701.9522,-138.5768 3689.1797,-136.5142"/>
<polygon fill="#000000" stroke="#000000" points="3689.3693,-132.9986 3678.9346,-134.8335 3688.2361,-139.9063 3689.3693,-132.9986"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="4081.5,-127.0021 3736.5,-127.0021 3736.5,-87.198 4081.5,-87.198 4081.5,-127.0021"/>
<text text-anchor="middle" x="3909" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">To do this, we need to borrow the modeselektor.</text>
</g>
<!-- raw_64&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>raw_64&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4234.7337,-915.8851C4262.8641,-825.258 4377.4666,-408.8201 4188,-178.2001 4176.806,-164.5747 4093.1798,-144.3671 4020.3752,-128.9738"/>
<polygon fill="#000000" stroke="#000000" points="4020.6883,-125.4633 4010.1826,-126.8349 4019.2506,-132.3141 4020.6883,-125.4633"/>
</g>
<!-- leaf_74 -->
<g id="node75" class="node">
<title>leaf_74</title>
<polygon fill="none" stroke="#c0c0c0" points="4783.5,-951.6014 4564.5,-951.6014 4564.5,-915.6014 4783.5,-915.6014 4783.5,-951.6014"/>
<text text-anchor="middle" x="4674" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:persist(txtbuf)</text>
</g>
<!-- header_67&#45;&gt;leaf_74 -->
<g id="edge74" class="edge">
<title>header_67&#45;&gt;leaf_74</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4674,-2034.3764C4674,-1905.3728 4674,-1123.0454 4674,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="4677.5001,-961.9411 4674,-951.9411 4670.5001,-961.9412 4677.5001,-961.9411"/>
</g>
<!-- raw_75 -->
<g id="node76" class="node">
<title>raw_75</title>
<ellipse fill="none" stroke="#000000" cx="4834" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4834" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_68&#45;&gt;raw_75 -->
<g id="edge75" class="edge">
<title>prose_68&#45;&gt;raw_75</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4837.9355,-2034.3764C4837.4743,-1905.3728 4834.6773,-1123.0454 4834.103,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="4837.6014,-961.9285 4834.0656,-951.9411 4830.6014,-961.9536 4837.6014,-961.9285"/>
</g>
<!-- raw_77 -->
<g id="node78" class="node">
<title>raw_77</title>
<ellipse fill="none" stroke="#000000" cx="4913" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="4913" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_69&#45;&gt;raw_77 -->
<g id="edge77" class="edge">
<title>prose_69&#45;&gt;raw_77</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4919.8872,-2034.3764C4919.0801,-1905.3728 4914.1853,-1123.0454 4913.1803,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="4916.6773,-961.919 4913.1147,-951.9411 4909.6775,-961.9629 4916.6773,-961.919"/>
</g>
<!-- hashline_79 -->
<g id="node80" class="node">
<title>hashline_79</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-933.6014" rx="43.0992" ry="18"/>
<text text-anchor="middle" x="5015" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashline</text>
</g>
<!-- structure_70&#45;&gt;hashline_79 -->
<g id="edge79" class="edge">
<title>structure_70&#45;&gt;hashline_79</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-2034.3764C5015,-1905.3728 5015,-1123.0454 5015,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-961.9411 5015,-951.9411 5011.5001,-961.9412 5018.5001,-961.9411"/>
</g>
<!-- raw_82 -->
<g id="node83" class="node">
<title>raw_82</title>
<ellipse fill="none" stroke="#000000" cx="5300" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5300" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_82 -->
<g id="edge82" class="edge">
<title>prose_71&#45;&gt;raw_82</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5578.488,-2035.5711C5544.8293,-1985.4406 5446.1304,-1831.7303 5401,-1689.0027 5314.4014,-1415.1295 5302.0445,-1062.5278 5300.2888,-961.669"/>
<polygon fill="#000000" stroke="#000000" points="5303.7884,-961.608 5300.136,-951.6626 5296.7892,-961.7149 5303.7884,-961.608"/>
</g>
<!-- prespace_83 -->
<g id="node84" class="node">
<title>prespace_83</title>
<ellipse fill="none" stroke="#000000" cx="5456" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5456" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_71&#45;&gt;prespace_83 -->
<g id="edge83" class="edge">
<title>prose_71&#45;&gt;prespace_83</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5585.2166,-2034.4122C5571.4135,-1981.7424 5531.2733,-1823.1324 5512,-1689.0027 5471.5265,-1407.3323 5459.4642,-1062.1194 5456.7003,-962.0312"/>
<polygon fill="#000000" stroke="#000000" points="5460.1935,-961.7277 5456.4277,-951.8248 5453.196,-961.9147 5460.1935,-961.7277"/>
</g>
<!-- literal_84 -->
<g id="node85" class="node">
<title>literal_84</title>
<ellipse fill="none" stroke="#000000" cx="5552" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5552" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_71&#45;&gt;literal_84 -->
<g id="edge84" class="edge">
<title>prose_71&#45;&gt;literal_84</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5589.3877,-2034.3764C5585.0061,-1905.3728 5558.4344,-1123.0454 5552.9786,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="5556.4604,-961.8165 5552.6229,-951.9411 5549.4645,-962.0542 5556.4604,-961.8165"/>
</g>
<!-- raw_85 -->
<g id="node86" class="node">
<title>raw_85</title>
<ellipse fill="none" stroke="#000000" cx="5628" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5628" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_85 -->
<g id="edge85" class="edge">
<title>prose_71&#45;&gt;raw_85</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5590.6123,-2034.3764C5594.9939,-1905.3728 5621.5656,-1123.0454 5627.0214,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="5630.5355,-962.0542 5627.3771,-951.9411 5623.5396,-961.8165 5630.5355,-962.0542"/>
</g>
<!-- prespace_86 -->
<g id="node87" class="node">
<title>prespace_86</title>
<ellipse fill="none" stroke="#000000" cx="5719" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="5719" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_71&#45;&gt;prespace_86 -->
<g id="edge86" class="edge">
<title>prose_71&#45;&gt;prespace_86</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5594.5234,-2034.3944C5607.5788,-1981.6764 5645.5633,-1822.9486 5664,-1689.0027 5702.7984,-1407.1245 5715.303,-1062.0551 5718.2438,-962.0163"/>
<polygon fill="#000000" stroke="#000000" points="5721.7481,-961.9108 5718.5351,-951.815 5714.751,-961.711 5721.7481,-961.9108"/>
</g>
<!-- literal_87 -->
<g id="node88" class="node">
<title>literal_87</title>
<ellipse fill="none" stroke="#000000" cx="5815" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="5815" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_71&#45;&gt;literal_87 -->
<g id="edge87" class="edge">
<title>prose_71&#45;&gt;literal_87</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5601.9694,-2035.3157C5636.3887,-1985.0947 5735.6128,-1832.4605 5774,-1689.0027 5847.702,-1413.5692 5825.8881,-1062.0535 5817.5544,-961.5609"/>
<polygon fill="#000000" stroke="#000000" points="5821.0412,-961.2571 5816.7023,-951.5915 5814.0667,-961.8532 5821.0412,-961.2571"/>
</g>
<!-- raw_88 -->
<g id="node89" class="node">
<title>raw_88</title>
<ellipse fill="none" stroke="#000000" cx="5891" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5891" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_71&#45;&gt;raw_88 -->
<g id="edge88" class="edge">
<title>prose_71&#45;&gt;raw_88</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5595.7373,-2034.6461C5613.887,-1981.0031 5674.9617,-1818.5717 5777,-1725.0027 5805.1405,-1699.1978 5833.6624,-1720.6647 5855,-1689.0027 5936.8199,-1567.593 5903.4036,-1084.4201 5893.4355,-961.9391"/>
<polygon fill="#000000" stroke="#000000" points="5896.9138,-961.532 5892.6008,-951.8548 5889.9377,-962.1095 5896.9138,-961.532"/>
</g>
<!-- raw_96 -->
<g id="node97" class="node">
<title>raw_96</title>
<ellipse fill="none" stroke="#000000" cx="5963" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="5963" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_72&#45;&gt;raw_96 -->
<g id="edge96" class="edge">
<title>prose_72&#45;&gt;raw_96</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5825.033,-2034.6261C5845.2665,-1982.5363 5903.6648,-1825.3414 5927,-1689.0027 5974.9829,-1408.6563 5967.5372,-1061.8542 5964.1122,-961.8139"/>
<polygon fill="#000000" stroke="#000000" points="5967.6028,-961.4883 5963.7471,-951.62 5960.6073,-961.7389 5967.6028,-961.4883"/>
</g>
<!-- leaf_98 -->
<g id="node99" class="node">
<title>leaf_98</title>
<polygon fill="none" stroke="#c0c0c0" points="6521.5,-1199.8024 6008.5,-1199.8024 6008.5,-667.4003 6521.5,-667.4003 6521.5,-1199.8024"/>
<text text-anchor="middle" x="6265" y="-1184.5019" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = table.concat</text>
<text text-anchor="middle" x="6265" y="-1169.1019" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, txtbuf, results)</text>
<text text-anchor="middle" x="6265" y="-1153.7018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(txtbuf)</text>
<text text-anchor="middle" x="6265" y="-1138.3018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if lb ~= &quot;&quot; then</text>
<text text-anchor="middle" x="6265" y="-1122.9018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_line:bindkv { project = historian.project_id,</text>
<text text-anchor="middle" x="6265" y="-1107.5017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;line &#160;&#160;&#160;= lb }</text>
<text text-anchor="middle" x="6265" y="-1092.1017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local err = historian.insert_line:step()</text>
<text text-anchor="middle" x="6265" y="-1076.7017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not err then</text>
<text text-anchor="middle" x="6265" y="-1061.3016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_line:clearbind():reset()</text>
<text text-anchor="middle" x="6265" y="-1045.9016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="6265" y="-1030.5016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="6265" y="-1015.1015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-999.7015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local line_id = sql.lastRowId(historian.conn)</text>
<text text-anchor="middle" x="6265" y="-984.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;table.insert(historian.line_ids, line_id)</text>
<text text-anchor="middle" x="6265" y="-968.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if results and type(results) == &quot;table&quot; then</text>
<text text-anchor="middle" x="6265" y="-953.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="6265" y="-938.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; insert result repr</text>
<text text-anchor="middle" x="6265" y="-922.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local res = results[i]</text>
<text text-anchor="middle" x="6265" y="-907.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_result:bindkv { line_id = line_id,</text>
<text text-anchor="middle" x="6265" y="-891.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repr = repr.ts(res) }</text>
<text text-anchor="middle" x="6265" y="-876.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;err = historian.insert_result:step()</text>
<text text-anchor="middle" x="6265" y="-861.1012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if not err then</text>
<text text-anchor="middle" x="6265" y="-845.7012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.insert_result:clearbind():reset()</text>
<text text-anchor="middle" x="6265" y="-830.3012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-814.9011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-799.5011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-768.1011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="6265" y="-752.701" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="6265" y="-737.301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; A blank line can have no results and is uninteresting.</text>
<text text-anchor="middle" x="6265" y="-721.901" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="6265" y="-706.501" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="6265" y="-691.1009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;]]</text>
<text text-anchor="middle" x="6265" y="-675.7009" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_73&#45;&gt;leaf_98 -->
<g id="edge98" class="edge">
<title>codeblock_73&#45;&gt;leaf_98</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M6113.4813,-2034.3764C6126.3487,-1940.8956 6186.4374,-1504.3546 6226.9672,-1209.9076"/>
<polygon fill="#000000" stroke="#000000" points="6230.4442,-1210.3142 6228.3406,-1199.9303 6223.5095,-1209.3596 6230.4442,-1210.3142"/>
</g>
<!-- leaf_76 -->
<g id="node77" class="node">
<title>leaf_76</title>
<polygon fill="none" stroke="#c0c0c0" points="4374.5,-135.0015 4099.5,-135.0015 4099.5,-79.1986 4374.5,-79.1986 4374.5,-135.0015"/>
<text text-anchor="middle" x="4237" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Persists a line and results to store.</text>
</g>
<!-- raw_75&#45;&gt;leaf_76 -->
<g id="edge76" class="edge">
<title>raw_75&#45;&gt;leaf_76</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4836.003,-915.5082C4847.1341,-811.1353 4897.1755,-286.8468 4792,-178.2001 4760.3465,-145.5019 4428.9195,-149.5044 4384,-142.2001 4374.6777,-140.6842 4365.0706,-138.9007 4355.4432,-136.9547"/>
<polygon fill="#000000" stroke="#000000" points="4355.9169,-133.4785 4345.4142,-134.8724 4354.4938,-140.3323 4355.9169,-133.4785"/>
</g>
<!-- leaf_78 -->
<g id="node79" class="node">
<title>leaf_78</title>
<polygon fill="none" stroke="#c0c0c0" points="4955,-142.3004 4393,-142.3004 4393,-71.8997 4955,-71.8997 4955,-142.3004"/>
<text text-anchor="middle" x="4674" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">The hooks are in place to persist the results. I&#39;m starting with a string</text>
<text text-anchor="middle" x="4674" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">representation; the goal is to provide the sense of persistence across</text>
<text text-anchor="middle" x="4674" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">sessions, and supplement that over time with better and better approximations.</text>
</g>
<!-- raw_77&#45;&gt;leaf_78 -->
<g id="edge78" class="edge">
<title>raw_77&#45;&gt;leaf_78</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4914.5505,-915.5583C4923.0297,-812.5674 4960.1934,-299.3815 4870,-178.2001 4861.4936,-166.7711 4839.6861,-155.6481 4813.5619,-145.7236"/>
<polygon fill="#000000" stroke="#000000" points="4814.7497,-142.4313 4804.1562,-142.2646 4812.3336,-149.0011 4814.7497,-142.4313"/>
</g>
<!-- hashtag_80 -->
<g id="node81" class="node">
<title>hashtag_80</title>
<ellipse fill="none" stroke="#000000" cx="5015" cy="-107.1" rx="41.6544" ry="18"/>
<text text-anchor="middle" x="5015" y="-102.9" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">hashtag</text>
</g>
<!-- hashline_79&#45;&gt;hashtag_80 -->
<g id="edge80" class="edge">
<title>hashline_79&#45;&gt;hashtag_80</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-915.5701C5015,-809.3734 5015,-265.6725 5015,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-135.2475 5015,-125.2475 5011.5001,-135.2476 5018.5001,-135.2475"/>
</g>
<!-- leaf_81 -->
<g id="node82" class="node">
<title>leaf_81</title>
<polygon fill="none" stroke="#c0c0c0" points="5042,-36 4988,-36 4988,0 5042,0 5042,-36"/>
<text text-anchor="middle" x="5015" y="-14.5" font-family="Inconsolata" font-size="14.00" fill="#000000">todo</text>
</g>
<!-- hashtag_80&#45;&gt;leaf_81 -->
<g id="edge81" class="edge">
<title>hashtag_80&#45;&gt;leaf_81</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5015,-89.0693C5015,-76.7509 5015,-60.1792 5015,-46.1369"/>
<polygon fill="#000000" stroke="#000000" points="5018.5001,-46.0039 5015,-36.0039 5011.5001,-46.0039 5018.5001,-46.0039"/>
</g>
<!-- leaf_89 -->
<g id="node90" class="node">
<title>leaf_89</title>
<polygon fill="none" stroke="#c0c0c0" points="5461.5,-127.0021 5074.5,-127.0021 5074.5,-87.198 5461.5,-87.198 5461.5,-127.0021"/>
<text text-anchor="middle" x="5268" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">parsing. &#160;General&#45;purpose persistence tools belong in</text>
</g>
<!-- raw_82&#45;&gt;leaf_89 -->
<g id="edge89" class="edge">
<title>raw_82&#45;&gt;leaf_89</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5299.3019,-915.5701C5295.2124,-809.9474 5274.3666,-271.5375 5269.1731,-137.3995"/>
<polygon fill="#000000" stroke="#000000" points="5272.6573,-136.9208 5268.7729,-127.0637 5265.6625,-137.1917 5272.6573,-136.9208"/>
</g>
<!-- leaf_90 -->
<g id="node91" class="node">
<title>leaf_90</title>
<polygon fill="none" stroke="#c0c0c0" points="5534,-125.1 5480,-125.1 5480,-89.1 5534,-89.1 5534,-125.1"/>
<text text-anchor="middle" x="5507" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_83&#45;&gt;leaf_90 -->
<g id="edge90" class="edge">
<title>prespace_83&#45;&gt;leaf_90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5457.1126,-915.5701C5463.6656,-809.3734 5497.2151,-265.6725 5505.2631,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5508.7576,-135.4441 5505.8802,-125.2475 5501.7709,-135.013 5508.7576,-135.4441"/>
</g>
<!-- leaf_91 -->
<g id="node92" class="node">
<title>leaf_91</title>
<polygon fill="none" stroke="#c0c0c0" points="5617.5,-125.1 5552.5,-125.1 5552.5,-89.1 5617.5,-89.1 5617.5,-125.1"/>
<text text-anchor="middle" x="5585" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">sqlayer</text>
</g>
<!-- literal_84&#45;&gt;leaf_91 -->
<g id="edge91" class="edge">
<title>literal_84&#45;&gt;leaf_91</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5552.7199,-915.5701C5556.9601,-809.3734 5578.6686,-265.6725 5583.8761,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="5587.3736,-135.3792 5584.2754,-125.2475 5580.3792,-135.0999 5587.3736,-135.3792"/>
</g>
<!-- leaf_92 -->
<g id="node93" class="node">
<title>leaf_92</title>
<polygon fill="none" stroke="#c0c0c0" points="5904,-126.4006 5636,-126.4006 5636,-87.7995 5904,-87.7995 5904,-126.4006"/>
<text text-anchor="middle" x="5770" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">, which will</text>
<text text-anchor="middle" x="5770" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">merge with our increasingly&#45;modified</text>
</g>
<!-- raw_85&#45;&gt;leaf_92 -->
<g id="edge92" class="edge">
<title>raw_85&#45;&gt;leaf_92</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5626.7197,-915.5459C5619.8022,-813.5649 5589.8717,-309.5515 5664,-178.2001 5675.2862,-158.2016 5694.8045,-142.7433 5714.041,-131.4263"/>
<polygon fill="#000000" stroke="#000000" points="5715.806,-134.4495 5722.8289,-126.5166 5712.3919,-128.3385 5715.806,-134.4495"/>
</g>
<!-- leaf_93 -->
<g id="node94" class="node">
<title>leaf_93</title>
<polygon fill="none" stroke="#c0c0c0" points="5976,-125.1 5922,-125.1 5922,-89.1 5976,-89.1 5976,-125.1"/>
<text text-anchor="middle" x="5949" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_86&#45;&gt;leaf_93 -->
<g id="edge93" class="edge">
<title>prespace_86&#45;&gt;leaf_93</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5717.6194,-915.4033C5710.13,-811.55 5678.1759,-294.3731 5775,-178.2001 5815.582,-129.5084 5857.8033,-173.3626 5913,-142.2001 5917.8458,-139.4643 5922.5107,-135.9144 5926.7841,-132.1255"/>
<polygon fill="#000000" stroke="#000000" points="5929.231,-134.6283 5934.0083,-125.1717 5924.3764,-129.5851 5929.231,-134.6283"/>
</g>
<!-- leaf_94 -->
<g id="node95" class="node">
<title>leaf_94</title>
<polygon fill="none" stroke="#c0c0c0" points="6052,-125.1 5994,-125.1 5994,-89.1 6052,-89.1 6052,-125.1"/>
<text text-anchor="middle" x="6023" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">sqlite</text>
</g>
<!-- literal_87&#45;&gt;leaf_94 -->
<g id="edge94" class="edge">
<title>literal_87&#45;&gt;leaf_94</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5813.227,-915.4519C5803.4995,-811.8688 5760.4133,-295.9422 5855,-178.2001 5892.5469,-131.4615 5932.6171,-171.3601 5985,-142.2001 5989.9044,-139.47 5994.679,-135.9808 5999.095,-132.2659"/>
<polygon fill="#000000" stroke="#000000" points="6001.5525,-134.7621 6006.6068,-125.4506 5996.8489,-129.5779 6001.5525,-134.7621"/>
</g>
<!-- leaf_95 -->
<g id="node96" class="node">
<title>leaf_95</title>
<polygon fill="none" stroke="#c0c0c0" points="6156,-125.1 6070,-125.1 6070,-89.1 6156,-89.1 6156,-125.1"/>
<text text-anchor="middle" x="6113" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> bindings.</text>
</g>
<!-- raw_88&#45;&gt;leaf_95 -->
<g id="edge95" class="edge">
<title>raw_88&#45;&gt;leaf_95</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5889.108,-915.4474C5878.7045,-811.8392 5832.2966,-295.7968 5927,-178.2001 5965.679,-130.171 6004.8979,-167.8011 6061,-142.2001 6067.8124,-139.0914 6074.7162,-135.1209 6081.1709,-130.9758"/>
<polygon fill="#000000" stroke="#000000" points="6083.2975,-133.7635 6089.6436,-125.2795 6079.3919,-127.9543 6083.2975,-133.7635"/>
</g>
<!-- leaf_97 -->
<g id="node98" class="node">
<title>leaf_97</title>
<polygon fill="none" stroke="#c0c0c0" points="6708,-134.4005 6174,-134.4005 6174,-79.7996 6708,-79.7996 6708,-134.4005"/>
<text text-anchor="middle" x="6441" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">Medium&#45;term goal is to hash any Lua object in a way that will resolve to a</text>
<text text-anchor="middle" x="6441" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">common value for any identical semantics.</text>
</g>
<!-- raw_96&#45;&gt;leaf_97 -->
<g id="edge97" class="edge">
<title>raw_96&#45;&gt;leaf_97</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5960.9617,-915.6309C5949.6121,-811.9487 5898.2611,-290.8899 5999,-178.2001 6007.2568,-168.9638 6116.959,-151.2874 6224.9936,-135.871"/>
<polygon fill="#000000" stroke="#000000" points="6225.6957,-139.3065 6235.1037,-134.4341 6224.7106,-132.3762 6225.6957,-139.3065"/>
</g>
<!-- leaf_104 -->
<g id="node105" class="node">
<title>leaf_104</title>
<polygon fill="none" stroke="#c0c0c0" points="7203.5,-2070.4033 7012.5,-2070.4033 7012.5,-2034.4033 7203.5,-2034.4033 7203.5,-2070.4033"/>
<text text-anchor="middle" x="7108" y="-2048.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_99&#45;&gt;leaf_104 -->
<g id="edge104" class="edge">
<title>header_99&#45;&gt;leaf_104</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7108,-2486.5023C7108,-2416.9612 7108,-2165.5307 7108,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="7111.5001,-2080.4566 7108,-2070.4566 7104.5001,-2080.4567 7111.5001,-2080.4566"/>
</g>
<!-- raw_105 -->
<g id="node106" class="node">
<title>raw_105</title>
<ellipse fill="none" stroke="#000000" cx="7257" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="7257" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_100&#45;&gt;raw_105 -->
<g id="edge105" class="edge">
<title>prose_100&#45;&gt;raw_105</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7265.6416,-2486.5023C7264.2573,-2416.9612 7259.252,-2165.5307 7257.5619,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="7261.0578,-2080.3849 7257.3594,-2070.4566 7254.0592,-2080.5243 7261.0578,-2080.3849"/>
</g>
<!-- raw_107 -->
<g id="node108" class="node">
<title>raw_107</title>
<ellipse fill="none" stroke="#000000" cx="7348" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="7348" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_101&#45;&gt;raw_107 -->
<g id="edge107" class="edge">
<title>prose_101&#45;&gt;raw_107</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7348,-2486.5023C7348,-2416.9612 7348,-2165.5307 7348,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="7351.5001,-2080.4566 7348,-2070.4566 7344.5001,-2080.4567 7351.5001,-2080.4566"/>
</g>
<!-- header_109 -->
<g id="node110" class="node">
<title>header_109</title>
<ellipse fill="none" stroke="#000000" cx="7742" cy="-2052.4033" rx="58.0685" ry="18"/>
<text text-anchor="middle" x="7742" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : fuzz_patt</text>
</g>
<!-- section_102&#45;&gt;header_109 -->
<g id="edge109" class="edge">
<title>section_102&#45;&gt;header_109</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7931.1558,-2486.5023C7900.7611,-2416.7485 7790.6237,-2163.9912 7753.9629,-2079.8573"/>
<polygon fill="#000000" stroke="#000000" points="7757.07,-2078.226 7749.8666,-2070.4566 7750.6527,-2081.0223 7757.07,-2078.226"/>
</g>
<!-- prose_110 -->
<g id="node111" class="node">
<title>prose_110</title>
<ellipse fill="none" stroke="#000000" cx="7939" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="7939" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_102&#45;&gt;prose_110 -->
<g id="edge110" class="edge">
<title>section_102&#45;&gt;prose_110</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7939,-2486.5023C7939,-2416.9612 7939,-2165.5307 7939,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="7942.5001,-2080.4566 7939,-2070.4566 7935.5001,-2080.4567 7942.5001,-2080.4566"/>
</g>
<!-- prose_111 -->
<g id="node112" class="node">
<title>prose_111</title>
<ellipse fill="none" stroke="#000000" cx="8322" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="8322" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_102&#45;&gt;prose_111 -->
<g id="edge111" class="edge">
<title>section_102&#45;&gt;prose_111</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7954.0141,-2486.7812C8013.5154,-2416.5446 8232.8464,-2157.642 8301.3906,-2076.7311"/>
<polygon fill="#000000" stroke="#000000" points="8304.1132,-2078.932 8307.9066,-2069.0395 8298.7721,-2074.4072 8304.1132,-2078.932"/>
</g>
<!-- codeblock_112 -->
<g id="node113" class="node">
<title>codeblock_112</title>
<ellipse fill="none" stroke="#000000" cx="8656" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="8656" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 300&#45;314</text>
</g>
<!-- section_102&#45;&gt;codeblock_112 -->
<g id="edge112" class="edge">
<title>section_102&#45;&gt;codeblock_112</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8006.5179,-2496.3216C8094.3673,-2483.1829 8249.9654,-2451.2098 8363,-2379.804 8493.3071,-2297.4868 8600.4501,-2141.1444 8639.8142,-2078.9179"/>
<polygon fill="#000000" stroke="#000000" points="8642.7824,-2080.7726 8645.1249,-2070.4399 8636.8502,-2077.0565 8642.7824,-2080.7726"/>
</g>
<!-- header_135 -->
<g id="node136" class="node">
<title>header_135</title>
<ellipse fill="none" stroke="#000000" cx="9232" cy="-2052.4033" rx="100.1229" ry="18"/>
<text text-anchor="middle" x="9232" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : __repr for collection</text>
</g>
<!-- section_103&#45;&gt;header_135 -->
<g id="edge135" class="edge">
<title>section_103&#45;&gt;header_135</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9461.4834,-2486.5023C9424.5336,-2416.6067 9290.4466,-2162.963 9246.2433,-2079.3464"/>
<polygon fill="#000000" stroke="#000000" points="9249.3116,-2077.6616 9241.5438,-2070.4566 9243.1231,-2080.9331 9249.3116,-2077.6616"/>
</g>
<!-- prose_136 -->
<g id="node137" class="node">
<title>prose_136</title>
<ellipse fill="none" stroke="#000000" cx="9471" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="9471" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_103&#45;&gt;prose_136 -->
<g id="edge136" class="edge">
<title>section_103&#45;&gt;prose_136</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9471,-2486.5023C9471,-2416.9612 9471,-2165.5307 9471,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="9474.5001,-2080.4566 9471,-2070.4566 9467.5001,-2080.4567 9474.5001,-2080.4566"/>
</g>
<!-- prose_137 -->
<g id="node138" class="node">
<title>prose_137</title>
<ellipse fill="none" stroke="#000000" cx="9586" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="9586" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_103&#45;&gt;prose_137 -->
<g id="edge137" class="edge">
<title>section_103&#45;&gt;prose_137</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9477.5219,-2486.4961C9486.1097,-2462.3998 9501.3634,-2418.241 9512,-2379.804 9542.2969,-2270.321 9569.3614,-2137.7349 9580.549,-2080.7128"/>
<polygon fill="#000000" stroke="#000000" points="9584.0313,-2081.1409 9582.5108,-2070.6557 9577.1608,-2079.8006 9584.0313,-2081.1409"/>
</g>
<!-- codeblock_138 -->
<g id="node139" class="node">
<title>codeblock_138</title>
<ellipse fill="none" stroke="#000000" cx="9855" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="9855" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 326&#45;380</text>
</g>
<!-- section_103&#45;&gt;codeblock_138 -->
<g id="edge138" class="edge">
<title>section_103&#45;&gt;codeblock_138</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9496.635,-2487.4894C9529.1775,-2465.1487 9586.0086,-2423.5963 9627,-2379.804 9720.9354,-2279.45 9806.2472,-2137.9371 9839.8558,-2079.3853"/>
<polygon fill="#000000" stroke="#000000" points="9843.0669,-2080.8198 9844.9807,-2070.3992 9836.9862,-2077.3519 9843.0669,-2080.8198"/>
</g>
<!-- leaf_106 -->
<g id="node107" class="node">
<title>leaf_106</title>
<polygon fill="none" stroke="#c0c0c0" points="7052.5,-968.9017 6539.5,-968.9017 6539.5,-898.301 7052.5,-898.301 7052.5,-968.9017"/>
<text text-anchor="middle" x="6796" y="-921.8014" font-family="Inconsolata" font-size="14.00" fill="#000000">This is a &#39;fuzzy search&#39;, that attempts to find a string containing the</text>
<text text-anchor="middle" x="6796" y="-906.4014" font-family="Inconsolata" font-size="14.00" fill="#000000">letters of the fragment in order.</text>
</g>
<!-- raw_105&#45;&gt;leaf_106 -->
<g id="edge106" class="edge">
<title>raw_105&#45;&gt;leaf_106</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7260.7836,-2034.312C7271.0577,-1979.7217 7293.5246,-1814.8858 7212,-1725.0027 7165.6493,-1673.8997 7112.2395,-1735.2024 7061,-1689.0027 6844.4261,-1493.7303 6804.8479,-1111.1111 6797.6163,-979.4178"/>
<polygon fill="#000000" stroke="#000000" points="6801.1041,-979.0872 6797.0971,-969.2793 6794.1133,-979.4453 6801.1041,-979.0872"/>
</g>
<!-- leaf_108 -->
<g id="node109" class="node">
<title>leaf_108</title>
<polygon fill="none" stroke="#c0c0c0" points="7625.5,-976.8017 7070.5,-976.8017 7070.5,-890.401 7625.5,-890.401 7625.5,-976.8017"/>
<text text-anchor="middle" x="7348" y="-945.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">If it finds nothing, it switches the last two letters and tries again. This</text>
<text text-anchor="middle" x="7348" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">is an affordance for incremental searches, it&#39;s easy to make this mistake and</text>
<text text-anchor="middle" x="7348" y="-914.7014" font-family="Inconsolata" font-size="14.00" fill="#000000">harmless to suggest the alternative.</text>
</g>
<!-- raw_107&#45;&gt;leaf_108 -->
<g id="edge108" class="edge">
<title>raw_107&#45;&gt;leaf_108</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7348,-2034.3764C7348,-1911.0264 7348,-1190.3616 7348,-987.0084"/>
<polygon fill="#000000" stroke="#000000" points="7351.5001,-986.8763 7348,-976.8763 7344.5001,-986.8764 7351.5001,-986.8763"/>
</g>
<!-- leaf_113 -->
<g id="node114" class="node">
<title>leaf_113</title>
<polygon fill="none" stroke="#c0c0c0" points="7750.5,-951.6014 7643.5,-951.6014 7643.5,-915.6014 7750.5,-915.6014 7750.5,-951.6014"/>
<text text-anchor="middle" x="7697" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** fuzz_patt</text>
</g>
<!-- header_109&#45;&gt;leaf_113 -->
<g id="edge113" class="edge">
<title>header_109&#45;&gt;leaf_113</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7741.2749,-2034.3764C7736.081,-1905.2438 7704.5568,-1121.4801 7698.1396,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="7701.6368,-961.7924 7697.7377,-951.9411 7694.6425,-962.0738 7701.6368,-961.7924"/>
</g>
<!-- raw_114 -->
<g id="node115" class="node">
<title>raw_114</title>
<ellipse fill="none" stroke="#000000" cx="7796" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="7796" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_110&#45;&gt;raw_114 -->
<g id="edge114" class="edge">
<title>prose_110&#45;&gt;raw_114</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7932.1008,-2034.612C7912.2514,-1982.4837 7854.9558,-1825.1951 7832,-1689.0027 7784.7261,-1408.5358 7791.6808,-1061.8172 7794.9381,-961.8054"/>
<polygon fill="#000000" stroke="#000000" points="7798.4427,-961.728 7795.2858,-951.6145 7791.4468,-961.4893 7798.4427,-961.728"/>
</g>
<!-- prespace_115 -->
<g id="node116" class="node">
<title>prespace_115</title>
<ellipse fill="none" stroke="#000000" cx="7887" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="7887" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_110&#45;&gt;prespace_115 -->
<g id="edge115" class="edge">
<title>prose_110&#45;&gt;prespace_115</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7938.1621,-2034.3764C7932.1603,-1905.2438 7895.7323,-1121.4801 7888.3169,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="7891.813,-961.7678 7887.8524,-951.9411 7884.8206,-962.0929 7891.813,-961.7678"/>
</g>
<!-- literal_116 -->
<g id="node117" class="node">
<title>literal_116</title>
<ellipse fill="none" stroke="#000000" cx="7983" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="7983" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_110&#45;&gt;literal_116 -->
<g id="edge116" class="edge">
<title>prose_110&#45;&gt;literal_116</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7939.709,-2034.3764C7944.7875,-1905.2438 7975.6111,-1121.4801 7981.8857,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="7985.383,-962.071 7982.2787,-951.9411 7978.3884,-961.7958 7985.383,-962.071"/>
</g>
<!-- raw_117 -->
<g id="node118" class="node">
<title>raw_117</title>
<ellipse fill="none" stroke="#000000" cx="8059" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8059" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_110&#45;&gt;raw_117 -->
<g id="edge117" class="edge">
<title>prose_110&#45;&gt;raw_117</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7944.3578,-2034.4676C7959.7823,-1981.948 8004.3759,-1823.7045 8023,-1689.0027 8061.9109,-1407.5732 8060.7627,-1062.194 8059.4758,-962.0485"/>
<polygon fill="#000000" stroke="#000000" points="8062.9726,-961.786 8059.3326,-951.8361 8055.9733,-961.8842 8062.9726,-961.786"/>
</g>
<!-- prespace_122 -->
<g id="node123" class="node">
<title>prespace_122</title>
<ellipse fill="none" stroke="#000000" cx="8150" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="8150" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_111&#45;&gt;prespace_122 -->
<g id="edge122" class="edge">
<title>prose_111&#45;&gt;prespace_122</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8314.6738,-2034.645C8293.5703,-1982.6064 8232.4693,-1825.5366 8206,-1689.0027 8151.781,-1409.3296 8149.2233,-1062.0613 8149.719,-961.8617"/>
<polygon fill="#000000" stroke="#000000" points="8153.2202,-961.6737 8149.785,-951.6513 8146.2203,-961.6284 8153.2202,-961.6737"/>
</g>
<!-- literal_123 -->
<g id="node124" class="node">
<title>literal_123</title>
<ellipse fill="none" stroke="#000000" cx="8246" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="8246" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_111&#45;&gt;literal_123 -->
<g id="edge123" class="edge">
<title>prose_111&#45;&gt;literal_123</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8319.9075,-2034.2791C8313.8492,-1981.2487 8296.0852,-1821.7585 8286,-1689.0027 8264.4733,-1405.637 8250.7592,-1061.5948 8247.0305,-961.9094"/>
<polygon fill="#000000" stroke="#000000" points="8250.5218,-961.6082 8246.6534,-951.7449 8243.5267,-961.8678 8250.5218,-961.6082"/>
</g>
<!-- raw_124 -->
<g id="node125" class="node">
<title>raw_124</title>
<ellipse fill="none" stroke="#000000" cx="8322" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8322" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_111&#45;&gt;raw_124 -->
<g id="edge124" class="edge">
<title>prose_111&#45;&gt;raw_124</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8322,-2034.3764C8322,-1905.3728 8322,-1123.0454 8322,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="8325.5001,-961.9411 8322,-951.9411 8318.5001,-961.9412 8325.5001,-961.9411"/>
</g>
<!-- prespace_125 -->
<g id="node126" class="node">
<title>prespace_125</title>
<ellipse fill="none" stroke="#000000" cx="8413" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="8413" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_111&#45;&gt;prespace_125 -->
<g id="edge125" class="edge">
<title>prose_111&#45;&gt;prespace_125</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8323.9653,-2034.2688C8329.6792,-1981.2105 8346.6025,-1821.6522 8358,-1689.0027 8382.3581,-1405.5114 8404.8342,-1061.5559 8411.2066,-961.9004"/>
<polygon fill="#000000" stroke="#000000" points="8414.711,-961.9415 8411.8546,-951.739 8407.7252,-961.4959 8414.711,-961.9415"/>
</g>
<!-- literal_126 -->
<g id="node127" class="node">
<title>literal_126</title>
<ellipse fill="none" stroke="#000000" cx="8509" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="8509" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_111&#45;&gt;literal_126 -->
<g id="edge126" class="edge">
<title>prose_111&#45;&gt;literal_126</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8331.455,-2034.9226C8358.6509,-1983.6362 8437.1022,-1828.4022 8468,-1689.0027 8529.5691,-1411.2255 8516.2965,-1062.6444 8510.7578,-961.9962"/>
<polygon fill="#000000" stroke="#000000" points="8514.2366,-961.5233 8510.1718,-951.7392 8507.248,-961.9226 8514.2366,-961.5233"/>
</g>
<!-- raw_127 -->
<g id="node128" class="node">
<title>raw_127</title>
<ellipse fill="none" stroke="#000000" cx="8585" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="8585" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_111&#45;&gt;raw_127 -->
<g id="edge127" class="edge">
<title>prose_111&#45;&gt;raw_127</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8336.5358,-2036.2085C8378.9128,-1987.8314 8502.2792,-1838.4562 8549,-1689.0027 8634.0442,-1416.9578 8600.7404,-1063.0836 8588.6518,-961.7957"/>
<polygon fill="#000000" stroke="#000000" points="8592.1108,-961.2466 8587.4217,-951.746 8585.1627,-962.0972 8592.1108,-961.2466"/>
</g>
<!-- leaf_134 -->
<g id="node135" class="node">
<title>leaf_134</title>
<polygon fill="none" stroke="#c0c0c0" points="9073.5,-1030.5021 8630.5,-1030.5021 8630.5,-836.7006 9073.5,-836.7006 9073.5,-1030.5021"/>
<text text-anchor="middle" x="8852" y="-1015.1015" font-family="Inconsolata" font-size="14.00" fill="#000000">local P, match = L.P, L.match</text>
<text text-anchor="middle" x="8852" y="-983.7015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function fuzz_patt(frag)</text>
<text text-anchor="middle" x="8852" y="-968.3015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;frag = type(frag) == &quot;string&quot; and codepoints(frag) or frag</text>
<text text-anchor="middle" x="8852" y="-952.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = &#160;(P(1) &#45; P(frag[1]))^0</text>
<text text-anchor="middle" x="8852" y="-937.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = 1 , #frag &#45; 1 do</text>
<text text-anchor="middle" x="8852" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local v = frag[i]</text>
<text text-anchor="middle" x="8852" y="-906.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = patt * (P(v) * (P(1) &#45; P(frag[i + 1]))^0)</text>
<text text-anchor="middle" x="8852" y="-891.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="8852" y="-875.9013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;patt = patt * P(frag[#frag])</text>
<text text-anchor="middle" x="8852" y="-860.5013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return patt</text>
<text text-anchor="middle" x="8852" y="-845.1012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_112&#45;&gt;leaf_134 -->
<g id="edge134" class="edge">
<title>codeblock_112&#45;&gt;leaf_134</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8659.1581,-2034.3764C8679.1648,-1920.1744 8788.8681,-1293.9692 8833.3019,-1040.3332"/>
<polygon fill="#000000" stroke="#000000" points="8836.7693,-1040.8233 8835.0475,-1030.3693 8829.8743,-1039.6153 8836.7693,-1040.8233"/>
</g>
<!-- leaf_118 -->
<g id="node119" class="node">
<title>leaf_118</title>
<polygon fill="none" stroke="#c0c0c0" points="7532.5,-135.0015 7243.5,-135.0015 7243.5,-79.1986 7532.5,-79.1986 7532.5,-135.0015"/>
<text text-anchor="middle" x="7388" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Here we incrementally build up a single</text>
</g>
<!-- raw_114&#45;&gt;leaf_118 -->
<g id="edge118" class="edge">
<title>raw_114&#45;&gt;leaf_118</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7798.004,-915.6366C7809.1574,-811.9864 7859.543,-291.0776 7759,-178.2001 7726.4876,-141.6991 7589.962,-151.6356 7542,-142.2001 7533.594,-140.5464 7524.946,-138.7735 7516.2405,-136.9353"/>
<polygon fill="#000000" stroke="#000000" points="7516.9071,-133.4988 7506.3969,-134.8349 7515.4463,-140.3447 7516.9071,-133.4988"/>
</g>
<!-- leaf_119 -->
<g id="node120" class="node">
<title>leaf_119</title>
<polygon fill="none" stroke="#c0c0c0" points="7605,-125.1 7551,-125.1 7551,-89.1 7605,-89.1 7605,-125.1"/>
<text text-anchor="middle" x="7578" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_115&#45;&gt;leaf_119 -->
<g id="edge119" class="edge">
<title>prespace_115&#45;&gt;leaf_119</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7888.5405,-915.6039C7897.0245,-811.7697 7934.0645,-290 7832,-178.2001 7765.7908,-105.6756 7701.6329,-186.5164 7614,-142.2001 7608.9367,-139.6396 7604.1238,-136.1165 7599.7605,-132.2847"/>
<polygon fill="#000000" stroke="#000000" points="7602.0551,-129.6347 7592.4352,-125.1953 7597.187,-134.6648 7602.0551,-129.6347"/>
</g>
<!-- leaf_120 -->
<g id="node121" class="node">
<title>leaf_120</title>
<polygon fill="none" stroke="#c0c0c0" points="7677,-125.1 7623,-125.1 7623,-89.1 7677,-89.1 7677,-125.1"/>
<text text-anchor="middle" x="7650" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">lpeg</text>
</g>
<!-- literal_116&#45;&gt;leaf_120 -->
<g id="edge120" class="edge">
<title>literal_116&#45;&gt;leaf_120</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M7984.9426,-915.5914C7995.7368,-811.6869 8044.2512,-289.5885 7942,-178.2001 7864.3012,-93.5581 7789.1458,-192.8195 7686,-142.2001 7680.9064,-139.7004 7676.0786,-136.2072 7671.7099,-132.3862"/>
<polygon fill="#000000" stroke="#000000" points="7674.0044,-129.7362 7664.3839,-125.2982 7669.137,-134.767 7674.0044,-129.7362"/>
</g>
<!-- leaf_121 -->
<g id="node122" class="node">
<title>leaf_121</title>
<polygon fill="none" stroke="#c0c0c0" points="7914.5,-126.4006 7695.5,-126.4006 7695.5,-87.7995 7914.5,-87.7995 7914.5,-126.4006"/>
<text text-anchor="middle" x="7805" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> pattern which will recognize</text>
<text text-anchor="middle" x="7805" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">our desired lines.</text>
</g>
<!-- raw_117&#45;&gt;leaf_121 -->
<g id="edge121" class="edge">
<title>raw_117&#45;&gt;leaf_121</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8060.7949,-915.5235C8070.6581,-812.3388 8114.5657,-298.2561 8023,-178.2001 8018.381,-172.1439 7941.3547,-147.9128 7880.1564,-129.4052"/>
<polygon fill="#000000" stroke="#000000" points="7881.0686,-126.0246 7870.4838,-126.4876 7879.047,-132.7264 7881.0686,-126.0246"/>
</g>
<!-- leaf_128 -->
<g id="node129" class="node">
<title>leaf_128</title>
<polygon fill="none" stroke="#c0c0c0" points="7987,-125.1 7933,-125.1 7933,-89.1 7987,-89.1 7987,-125.1"/>
</g>
<!-- prespace_122&#45;&gt;leaf_128 -->
<g id="edge128" class="edge">
<title>prespace_122&#45;&gt;leaf_128</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8155.0524,-915.5848C8179.24,-825.1917 8274.814,-416.0379 8095,-178.2001 8066.7647,-140.8535 8035.6487,-167.0996 7996,-142.2001 7991.4954,-139.3712 7987.0954,-135.9002 7983.0056,-132.2531"/>
<polygon fill="#000000" stroke="#000000" points="7985.222,-129.5297 7975.577,-125.1452 7980.3826,-134.5875 7985.222,-129.5297"/>
</g>
<!-- leaf_129 -->
<g id="node130" class="node">
<title>leaf_129</title>
<polygon fill="none" stroke="#c0c0c0" points="8168.5,-125.1 8005.5,-125.1 8005.5,-89.1 8168.5,-89.1 8168.5,-125.1"/>
<text text-anchor="middle" x="8087" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">(P(1) &#45; P(frag[n]))^0</text>
</g>
<!-- literal_123&#45;&gt;leaf_129 -->
<g id="edge129" class="edge">
<title>literal_123&#45;&gt;leaf_129</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8247.2475,-915.4813C8253.9672,-813.1445 8282.7474,-307.5015 8205,-178.2001 8192.0589,-156.6777 8169.8826,-140.8494 8148.2239,-129.6649"/>
<polygon fill="#000000" stroke="#000000" points="8149.5225,-126.4038 8139.0018,-125.1528 8146.4461,-132.6916 8149.5225,-126.4038"/>
</g>
<!-- leaf_130 -->
<g id="node131" class="node">
<title>leaf_130</title>
<polygon fill="none" stroke="#c0c0c0" points="8531.5,-126.4006 8186.5,-126.4006 8186.5,-87.7995 8531.5,-87.7995 8531.5,-126.4006"/>
<text text-anchor="middle" x="8359" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000"> matches anything that isn&#39;t the next fragment,</text>
<text text-anchor="middle" x="8359" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">including</text>
</g>
<!-- raw_124&#45;&gt;leaf_130 -->
<g id="edge130" class="edge">
<title>raw_124&#45;&gt;leaf_130</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8322.8072,-915.5701C8327.5408,-809.8326 8351.691,-270.3666 8357.6631,-136.9635"/>
<polygon fill="#000000" stroke="#000000" points="8361.172,-136.8406 8358.1228,-126.694 8354.179,-136.5275 8361.172,-136.8406"/>
</g>
<!-- leaf_131 -->
<g id="node132" class="node">
<title>leaf_131</title>
<polygon fill="none" stroke="#c0c0c0" points="8604,-125.1 8550,-125.1 8550,-89.1 8604,-89.1 8604,-125.1"/>
<text text-anchor="middle" x="8577" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_125&#45;&gt;leaf_131 -->
<g id="edge131" class="edge">
<title>prespace_125&#45;&gt;leaf_131</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8408.4088,-915.399C8386.9139,-825.7792 8304.0179,-425.8012 8469,-178.2001 8488.6183,-148.7574 8511.0853,-162.5886 8540,-142.2001 8544.2332,-139.2152 8548.4637,-135.7616 8552.4719,-132.2093"/>
<polygon fill="#000000" stroke="#000000" points="8554.9057,-134.7256 8559.8477,-125.354 8550.1401,-129.5982 8554.9057,-134.7256"/>
</g>
<!-- leaf_132 -->
<g id="node133" class="node">
<title>leaf_132</title>
<polygon fill="none" stroke="#c0c0c0" points="8676,-125.1 8622,-125.1 8622,-89.1 8676,-89.1 8676,-125.1"/>
<text text-anchor="middle" x="8649" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">&quot;&quot;</text>
</g>
<!-- literal_126&#45;&gt;leaf_132 -->
<g id="edge132" class="edge">
<title>literal_126&#45;&gt;leaf_132</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8507.6652,-915.4455C8500.4622,-812.9121 8469.4187,-306.3683 8549,-178.2001 8566.2153,-150.4743 8586.8732,-161.7571 8613,-142.2001 8616.9832,-139.2185 8620.9774,-135.8245 8624.7802,-132.3496"/>
<polygon fill="#000000" stroke="#000000" points="8627.4405,-134.6486 8632.2523,-125.2095 8622.6044,-129.5877 8627.4405,-134.6486"/>
</g>
<!-- leaf_133 -->
<g id="node134" class="node">
<title>leaf_133</title>
<polygon fill="none" stroke="#c0c0c0" points="9130,-126.4006 8694,-126.4006 8694,-87.7995 9130,-87.7995 9130,-126.4006"/>
<text text-anchor="middle" x="8912" y="-111.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">. &#160;We then require this to be followed by the next fragment,</text>
<text text-anchor="middle" x="8912" y="-95.9" font-family="Inconsolata" font-size="14.00" fill="#000000">and so on.</text>
</g>
<!-- raw_127&#45;&gt;leaf_133 -->
<g id="edge133" class="edge">
<title>raw_127&#45;&gt;leaf_133</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M8583.0667,-915.4137C8572.4332,-811.6182 8524.9607,-294.7084 8621,-178.2001 8639.2935,-156.0077 8696.097,-139.7199 8754.7204,-128.3771"/>
<polygon fill="#000000" stroke="#000000" points="8755.7269,-131.7491 8764.9059,-126.458 8754.4307,-124.8702 8755.7269,-131.7491"/>
</g>
<!-- leaf_139 -->
<g id="node140" class="node">
<title>leaf_139</title>
<polygon fill="none" stroke="#c0c0c0" points="9282.5,-951.6014 9091.5,-951.6014 9091.5,-915.6014 9282.5,-915.6014 9282.5,-951.6014"/>
<text text-anchor="middle" x="9187" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** __repr for collection</text>
</g>
<!-- header_135&#45;&gt;leaf_139 -->
<g id="edge139" class="edge">
<title>header_135&#45;&gt;leaf_139</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9231.2749,-2034.3764C9226.081,-1905.2438 9194.5568,-1121.4801 9188.1396,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="9191.6368,-961.7924 9187.7377,-951.9411 9184.6425,-962.0738 9191.6368,-961.7924"/>
</g>
<!-- raw_140 -->
<g id="node141" class="node">
<title>raw_140</title>
<ellipse fill="none" stroke="#000000" cx="9328" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9328" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_136&#45;&gt;raw_140 -->
<g id="edge140" class="edge">
<title>prose_136&#45;&gt;raw_140</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9464.1008,-2034.612C9444.2514,-1982.4837 9386.9558,-1825.1951 9364,-1689.0027 9316.7261,-1408.5358 9323.6808,-1061.8172 9326.9381,-961.8054"/>
<polygon fill="#000000" stroke="#000000" points="9330.4427,-961.728 9327.2858,-951.6145 9323.4468,-961.4893 9330.4427,-961.728"/>
</g>
<!-- prespace_141 -->
<g id="node142" class="node">
<title>prespace_141</title>
<ellipse fill="none" stroke="#000000" cx="9419" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="9419" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_136&#45;&gt;prespace_141 -->
<g id="edge141" class="edge">
<title>prose_136&#45;&gt;prespace_141</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9470.1621,-2034.3764C9464.1603,-1905.2438 9427.7323,-1121.4801 9420.3169,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="9423.813,-961.7678 9419.8524,-951.9411 9416.8206,-962.0929 9423.813,-961.7678"/>
</g>
<!-- literal_142 -->
<g id="node143" class="node">
<title>literal_142</title>
<ellipse fill="none" stroke="#000000" cx="9515" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="9515" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_136&#45;&gt;literal_142 -->
<g id="edge142" class="edge">
<title>prose_136&#45;&gt;literal_142</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9471.709,-2034.3764C9476.7875,-1905.2438 9507.6111,-1121.4801 9513.8857,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="9517.383,-962.071 9514.2787,-951.9411 9510.3884,-961.7958 9517.383,-962.071"/>
</g>
<!-- raw_143 -->
<g id="node144" class="node">
<title>raw_143</title>
<ellipse fill="none" stroke="#000000" cx="9591" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9591" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_136&#45;&gt;raw_143 -->
<g id="edge143" class="edge">
<title>prose_136&#45;&gt;raw_143</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9474.7832,-2034.2286C9485.198,-1984.5311 9515.4807,-1842.263 9545,-1725.0027 9549.0539,-1708.8993 9552.3661,-1705.3983 9555,-1689.0027 9600.1127,-1408.1801 9594.6544,-1061.7077 9591.9085,-961.7802"/>
<polygon fill="#000000" stroke="#000000" points="9595.4017,-961.4925 9591.6139,-951.598 9588.4047,-961.695 9595.4017,-961.4925"/>
</g>
<!-- raw_148 -->
<g id="node149" class="node">
<title>raw_148</title>
<ellipse fill="none" stroke="#000000" cx="9663" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="9663" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_137&#45;&gt;raw_148 -->
<g id="edge148" class="edge">
<title>prose_137&#45;&gt;raw_148</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9588.4638,-2034.2934C9595.5822,-1981.302 9616.347,-1821.9068 9627,-1689.0027 9649.6999,-1405.8043 9659.746,-1061.6465 9662.3114,-961.9214"/>
<polygon fill="#000000" stroke="#000000" points="9665.8146,-961.8381 9662.5687,-951.7528 9658.8168,-961.661 9665.8146,-961.8381"/>
</g>
<!-- leaf_150 -->
<g id="node151" class="node">
<title>leaf_150</title>
<polygon fill="none" stroke="#c0c0c0" points="10263.5,-1347.3029 9708.5,-1347.3029 9708.5,-519.8999 10263.5,-519.8999 10263.5,-1347.3029"/>
<text text-anchor="middle" x="9986" y="-1332.0021" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat, litpat = assert(table.concat), assert(string.litpat)</text>
<text text-anchor="middle" x="9986" y="-1316.6021" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = assert(string.gsub)</text>
<text text-anchor="middle" x="9986" y="-1285.2021" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _highlight(line, frag, c, best)</text>
<text text-anchor="middle" x="9986" y="-1269.802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local hl = {}</text>
<text text-anchor="middle" x="9986" y="-1254.402" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local og_line = line &#45;&#45; debugging</text>
<text text-anchor="middle" x="9986" y="-1239.002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;while #frag &gt; 0 do</text>
<text text-anchor="middle" x="9986" y="-1223.6019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local char</text>
<text text-anchor="middle" x="9986" y="-1208.2019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;char, frag = frag:sub(1,1), frag:sub(2)</text>
<text text-anchor="middle" x="9986" y="-1192.8019" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local at = line:find(litpat(char))</text>
<text text-anchor="middle" x="9986" y="-1177.4018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not at then</text>
<text text-anchor="middle" x="9986" y="-1162.0018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error (&quot;can&#39;t find &quot; .. char .. &quot; in: &quot; .. line)</text>
<text text-anchor="middle" x="9986" y="-1146.6018" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-1131.2017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local color</text>
<text text-anchor="middle" x="9986" y="-1115.8017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; highlight the last two differently if this is a &#39;second best&#39;</text>
<text text-anchor="middle" x="9986" y="-1100.4017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; search</text>
<text text-anchor="middle" x="9986" y="-1085.0017" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not best and #frag &lt;= 1 then</text>
<text text-anchor="middle" x="9986" y="-1069.6016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;color = c.alert</text>
<text text-anchor="middle" x="9986" y="-1054.2016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="9986" y="-1038.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;color = c.search_hl</text>
<text text-anchor="middle" x="9986" y="-1023.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-1008.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;hl[#hl + 1] = c.base(line:sub(1, at &#45;1))</text>
<text text-anchor="middle" x="9986" y="-992.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;hl[#hl + 1] = color(char)</text>
<text text-anchor="middle" x="9986" y="-977.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;line = line:sub(at + 1)</text>
<text text-anchor="middle" x="9986" y="-961.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-946.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;hl[#hl + 1] = c.base(line)</text>
<text text-anchor="middle" x="9986" y="-931.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return concat(hl):gsub(&quot;\n&quot;, c.stresc(&quot;\\n&quot;))</text>
<text text-anchor="middle" x="9986" y="-915.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="9986" y="-868.2013" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _collect_repr(collection, c)</text>
<text text-anchor="middle" x="9986" y="-852.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="9986" y="-837.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return c.alert &quot;No results found&quot;</text>
<text text-anchor="middle" x="9986" y="-822.0012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-806.6012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local phrase = &quot;&quot;</text>
<text text-anchor="middle" x="9986" y="-791.2011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i,v in ipairs(collection) do</text>
<text text-anchor="middle" x="9986" y="-775.8011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local alt_seq = &quot; &#160;&#160;&#160;&quot;</text>
<text text-anchor="middle" x="9986" y="-760.4011" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if i &lt; 10 then</text>
<text text-anchor="middle" x="9986" y="-745.001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;alt_seq = a.bold(&quot;M&#45;&quot; .. tostring(i) .. &quot; &quot;)</text>
<text text-anchor="middle" x="9986" y="-729.601" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-714.201" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local next_line = alt_seq</text>
<text text-anchor="middle" x="9986" y="-698.8009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. _highlight(v, collection.frag, c, collection.best)</text>
<text text-anchor="middle" x="9986" y="-683.4009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;\n&quot;</text>
<text text-anchor="middle" x="9986" y="-668.0009" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if i == collection.hl then</text>
<text text-anchor="middle" x="9986" y="-652.6008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;next_line = c.highlight(next_line)</text>
<text text-anchor="middle" x="9986" y="-637.2008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-621.8008" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;phrase = phrase .. next_line</text>
<text text-anchor="middle" x="9986" y="-606.4007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="9986" y="-575.0007" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return phrase</text>
<text text-anchor="middle" x="9986" y="-559.6007" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="9986" y="-528.2007" font-family="Inconsolata" font-size="14.00" fill="#000000">local collect_M = {__repr = _collect_repr}</text>
</g>
<!-- codeblock_138&#45;&gt;leaf_150 -->
<g id="edge150" class="edge">
<title>codeblock_138&#45;&gt;leaf_150</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9857.1108,-2034.3764C9866.3349,-1955.5983 9904.0858,-1633.1871 9936.3662,-1357.4974"/>
<polygon fill="#000000" stroke="#000000" points="9939.8736,-1357.6378 9937.5604,-1347.2985 9932.9211,-1356.8236 9939.8736,-1357.6378"/>
</g>
<!-- leaf_144 -->
<g id="node145" class="node">
<title>leaf_144</title>
<polygon fill="none" stroke="#c0c0c0" points="9395.5,-135.0015 9148.5,-135.0015 9148.5,-79.1986 9395.5,-79.1986 9395.5,-135.0015"/>
<text text-anchor="middle" x="9272" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">We use a pseudo&#45;metamethod called</text>
</g>
<!-- raw_140&#45;&gt;leaf_144 -->
<g id="edge144" class="edge">
<title>raw_140&#45;&gt;leaf_144</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9328.5247,-915.3331C9330.6563,-830.8115 9336.5176,-469.4405 9291,-178.2001 9289.2806,-167.1988 9286.53,-155.448 9283.6495,-144.733"/>
<polygon fill="#000000" stroke="#000000" points="9286.9448,-143.5209 9280.8774,-134.8355 9280.2042,-145.4089 9286.9448,-143.5209"/>
</g>
<!-- leaf_145 -->
<g id="node146" class="node">
<title>leaf_145</title>
<polygon fill="none" stroke="#c0c0c0" points="9468,-125.1 9414,-125.1 9414,-89.1 9468,-89.1 9468,-125.1"/>
<text text-anchor="middle" x="9441" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_141&#45;&gt;leaf_145 -->
<g id="edge145" class="edge">
<title>prespace_141&#45;&gt;leaf_145</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9419.48,-915.5701C9422.3067,-809.3734 9436.7791,-265.6725 9440.2507,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="9443.7495,-135.3372 9440.5169,-125.2475 9436.752,-135.1508 9443.7495,-135.3372"/>
</g>
<!-- leaf_146 -->
<g id="node147" class="node">
<title>leaf_146</title>
<polygon fill="none" stroke="#c0c0c0" points="9544,-125.1 9486,-125.1 9486,-89.1 9544,-89.1 9544,-125.1"/>
<text text-anchor="middle" x="9515" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">__repr</text>
</g>
<!-- literal_142&#45;&gt;leaf_146 -->
<g id="edge146" class="edge">
<title>literal_142&#45;&gt;leaf_146</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9515,-915.5701C9515,-809.3734 9515,-265.6725 9515,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="9518.5001,-135.2475 9515,-125.2475 9511.5001,-135.2476 9518.5001,-135.2475"/>
</g>
<!-- leaf_147 -->
<g id="node148" class="node">
<title>leaf_147</title>
<polygon fill="none" stroke="#c0c0c0" points="10089.5,-134.3005 9562.5,-134.3005 9562.5,-79.8996 10089.5,-79.8996 10089.5,-134.3005"/>
<text text-anchor="middle" x="9826" y="-119.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> to specify custom table</text>
<text text-anchor="middle" x="9826" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">representations. &#160;These take the table as the first value and receive the</text>
<text text-anchor="middle" x="9826" y="-88.2" font-family="Inconsolata" font-size="14.00" fill="#000000">local color palette for consistency.</text>
</g>
<!-- raw_143&#45;&gt;leaf_147 -->
<g id="edge147" class="edge">
<title>raw_143&#45;&gt;leaf_147</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9589.2572,-915.5626C9579.6837,-812.5957 9537.1169,-299.5209 9627,-178.2001 9638.0266,-163.3168 9671.3155,-149.1127 9707.5889,-137.3676"/>
<polygon fill="#000000" stroke="#000000" points="9708.8888,-140.6275 9717.371,-134.2791 9706.7812,-133.9523 9708.8888,-140.6275"/>
</g>
<!-- leaf_149 -->
<g id="node150" class="node">
<title>leaf_149</title>
<polygon fill="none" stroke="#c0c0c0" points="10620.5,-134.4005 10107.5,-134.4005 10107.5,-79.7996 10620.5,-79.7996 10620.5,-134.4005"/>
<text text-anchor="middle" x="10364" y="-103.3001" font-family="Inconsolata" font-size="14.00" fill="#000000">In this case we want to highlight the letters of the fragment, which we</text>
<text text-anchor="middle" x="10364" y="-87.9" font-family="Inconsolata" font-size="14.00" fill="#000000">attach to the collection.</text>
</g>
<!-- raw_148&#45;&gt;leaf_149 -->
<g id="edge149" class="edge">
<title>raw_148&#45;&gt;leaf_149</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M9660.8447,-915.5226C9648.8366,-811.2308 9594.4061,-287.3213 9699,-178.2001 9729.8021,-146.0648 10053.7585,-147.1128 10098,-142.2001 10116.0519,-140.1956 10134.7758,-137.9874 10153.5481,-135.684"/>
<polygon fill="#000000" stroke="#000000" points="10154.1752,-139.1333 10163.6707,-134.4336 10153.317,-132.1861 10154.1752,-139.1333"/>
</g>
<!-- leaf_161 -->
<g id="node162" class="node">
<title>leaf_161</title>
<polygon fill="none" stroke="#c0c0c0" points="10557.5,-2070.4033 10366.5,-2070.4033 10366.5,-2034.4033 10557.5,-2034.4033 10557.5,-2070.4033"/>
<text text-anchor="middle" x="10462" y="-2048.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:search(frag)</text>
</g>
<!-- header_151&#45;&gt;leaf_161 -->
<g id="edge161" class="edge">
<title>header_151&#45;&gt;leaf_161</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10543.6154,-2486.5023C10530.5276,-2416.8903 10483.1728,-2165.0179 10467.2585,-2080.3724"/>
<polygon fill="#000000" stroke="#000000" points="10470.6818,-2079.6377 10465.3942,-2070.4566 10463.8023,-2080.9312 10470.6818,-2079.6377"/>
</g>
<!-- raw_162 -->
<g id="node163" class="node">
<title>raw_162</title>
<ellipse fill="none" stroke="#000000" cx="10603" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="10603" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_152&#45;&gt;raw_162 -->
<g id="edge162" class="edge">
<title>prose_152&#45;&gt;raw_162</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10765.9524,-2492.454C10731.2628,-2473.6495 10668.1524,-2433.8058 10639,-2379.804 10585.4254,-2280.5626 10593.0324,-2139.9121 10599.3495,-2080.5591"/>
<polygon fill="#000000" stroke="#000000" points="10602.8465,-2080.7824 10600.4989,-2070.4509 10595.8914,-2079.9914 10602.8465,-2080.7824"/>
</g>
<!-- prespace_163 -->
<g id="node164" class="node">
<title>prespace_163</title>
<ellipse fill="none" stroke="#000000" cx="10694" cy="-2052.4033" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="10694" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_152&#45;&gt;prespace_163 -->
<g id="edge163" class="edge">
<title>prose_152&#45;&gt;prespace_163</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10783.3599,-2486.5595C10774.6746,-2462.5335 10759.4539,-2418.4522 10750,-2379.804 10723.29,-2270.6115 10704.7869,-2137.8735 10697.4795,-2080.7624"/>
<polygon fill="#000000" stroke="#000000" points="10700.9327,-2080.1715 10696.2069,-2070.689 10693.9879,-2081.0489 10700.9327,-2080.1715"/>
</g>
<!-- literal_164 -->
<g id="node165" class="node">
<title>literal_164</title>
<ellipse fill="none" stroke="#000000" cx="10790" cy="-2052.4033" rx="31.481" ry="18"/>
<text text-anchor="middle" x="10790" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_152&#45;&gt;literal_164 -->
<g id="edge164" class="edge">
<title>prose_152&#45;&gt;literal_164</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10790,-2486.5023C10790,-2416.9612 10790,-2165.5307 10790,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="10793.5001,-2080.4566 10790,-2070.4566 10786.5001,-2080.4567 10793.5001,-2080.4566"/>
</g>
<!-- raw_165 -->
<g id="node166" class="node">
<title>raw_165</title>
<ellipse fill="none" stroke="#000000" cx="10868" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="10868" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_152&#45;&gt;raw_165 -->
<g id="edge165" class="edge">
<title>prose_152&#45;&gt;raw_165</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10796.9536,-2486.6317C10805.9861,-2462.6857 10821.5901,-2418.6928 10830,-2379.804 10853.5774,-2270.7777 10863.2816,-2137.9528 10866.5697,-2080.7907"/>
<polygon fill="#000000" stroke="#000000" points="10870.0696,-2080.8862 10867.1274,-2070.7081 10863.0803,-2080.4995 10870.0696,-2080.8862"/>
</g>
<!-- raw_170 -->
<g id="node171" class="node">
<title>raw_170</title>
<ellipse fill="none" stroke="#000000" cx="11448" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11448" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_153&#45;&gt;raw_170 -->
<g id="edge170" class="edge">
<title>prose_153&#45;&gt;raw_170</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11514.2525,-2486.5023C11503.6283,-2416.8903 11465.1873,-2165.0179 11452.2687,-2080.3724"/>
<polygon fill="#000000" stroke="#000000" points="11455.7241,-2079.8141 11450.7553,-2070.4566 11448.8042,-2080.8702 11455.7241,-2079.8141"/>
</g>
<!-- raw_172 -->
<g id="node173" class="node">
<title>raw_172</title>
<ellipse fill="none" stroke="#000000" cx="11598" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11598" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_154&#45;&gt;raw_172 -->
<g id="edge172" class="edge">
<title>prose_154&#45;&gt;raw_172</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11666.1729,-2486.5023C11655.2407,-2416.8903 11615.6855,-2165.0179 11602.3924,-2080.3724"/>
<polygon fill="#000000" stroke="#000000" points="11605.8443,-2079.7925 11600.8352,-2070.4566 11598.9291,-2080.8786 11605.8443,-2079.7925"/>
</g>
<!-- raw_174 -->
<g id="node175" class="node">
<title>raw_174</title>
<ellipse fill="none" stroke="#000000" cx="11890" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="11890" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_155&#45;&gt;raw_174 -->
<g id="edge174" class="edge">
<title>prose_155&#45;&gt;raw_174</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11890,-2486.5023C11890,-2416.9612 11890,-2165.5307 11890,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="11893.5001,-2080.4566 11890,-2070.4566 11886.5001,-2080.4567 11893.5001,-2080.4566"/>
</g>
<!-- raw_176 -->
<g id="node177" class="node">
<title>raw_176</title>
<ellipse fill="none" stroke="#000000" cx="12325" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="12325" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_156&#45;&gt;raw_176 -->
<g id="edge176" class="edge">
<title>prose_156&#45;&gt;raw_176</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12099.0683,-2487.0583C12135.0936,-2417.7515 12268.2256,-2161.6278 12311.392,-2078.5828"/>
<polygon fill="#000000" stroke="#000000" points="12314.5781,-2080.042 12316.0847,-2069.5549 12308.367,-2076.8135 12314.5781,-2080.042"/>
</g>
<!-- raw_178 -->
<g id="node179" class="node">
<title>raw_178</title>
<ellipse fill="none" stroke="#000000" cx="12946" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="12946" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_157&#45;&gt;raw_178 -->
<g id="edge178" class="edge">
<title>prose_157&#45;&gt;raw_178</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13086.3984,-2487.0532C13074.8596,-2463.2163 13054.1816,-2418.9592 13040,-2379.804 13000.6483,-2271.1539 12966.6036,-2137.615 12952.6919,-2080.4862"/>
<polygon fill="#000000" stroke="#000000" points="12956.01,-2079.3166 12950.2569,-2070.4198 12949.2062,-2080.9624 12956.01,-2079.3166"/>
</g>
<!-- prespace_179 -->
<g id="node180" class="node">
<title>prespace_179</title>
<ellipse fill="none" stroke="#000000" cx="13095" cy="-2052.4033" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="13095" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_157&#45;&gt;prespace_179 -->
<g id="edge179" class="edge">
<title>prose_157&#45;&gt;prespace_179</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13095,-2486.5023C13095,-2416.9612 13095,-2165.5307 13095,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="13098.5001,-2080.4566 13095,-2070.4566 13091.5001,-2080.4567 13098.5001,-2080.4566"/>
</g>
<!-- literal_180 -->
<g id="node181" class="node">
<title>literal_180</title>
<ellipse fill="none" stroke="#000000" cx="13191" cy="-2052.4033" rx="31.481" ry="18"/>
<text text-anchor="middle" x="13191" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_157&#45;&gt;literal_180 -->
<g id="edge180" class="edge">
<title>prose_157&#45;&gt;literal_180</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13104.7172,-2486.9378C13117.3096,-2463.3305 13138.9558,-2419.7117 13150,-2379.804 13179.8557,-2271.9217 13188.0214,-2137.9785 13190.2143,-2080.6153"/>
<polygon fill="#000000" stroke="#000000" points="13193.7161,-2080.6223 13190.5681,-2070.506 13186.7204,-2080.3775 13193.7161,-2080.6223"/>
</g>
<!-- raw_181 -->
<g id="node182" class="node">
<title>raw_181</title>
<ellipse fill="none" stroke="#000000" cx="13267" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="13267" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_157&#45;&gt;raw_181 -->
<g id="edge181" class="edge">
<title>prose_157&#45;&gt;raw_181</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13117.4741,-2491.3276C13148.9139,-2471.5384 13205.0763,-2430.9502 13231,-2379.804 13281.8654,-2279.4489 13275.8088,-2139.9581 13270.281,-2080.7684"/>
<polygon fill="#000000" stroke="#000000" points="13273.7496,-2080.2791 13269.2689,-2070.6784 13266.7846,-2080.9778 13273.7496,-2080.2791"/>
</g>
<!-- raw_186 -->
<g id="node187" class="node">
<title>raw_186</title>
<ellipse fill="none" stroke="#000000" cx="13339" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="13339" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_158&#45;&gt;raw_186 -->
<g id="edge186" class="edge">
<title>prose_158&#45;&gt;raw_186</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13265.931,-2486.7361C13276.2124,-2462.9055 13293.8992,-2419.04 13303,-2379.804 13328.1869,-2271.2162 13335.8898,-2138.162 13338.1315,-2080.8656"/>
<polygon fill="#000000" stroke="#000000" points="13341.6332,-2080.8793 13338.5001,-2070.7583 13334.6379,-2080.6241 13341.6332,-2080.8793"/>
</g>
<!-- leaf_188 -->
<g id="node189" class="node">
<title>leaf_188</title>
<polygon fill="none" stroke="#c0c0c0" points="13939.5,-2379.7046 13384.5,-2379.7046 13384.5,-1725.102 13939.5,-1725.102 13939.5,-2379.7046"/>
<text text-anchor="middle" x="13662" y="-2364.604" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.search(historian, frag)</text>
<text text-anchor="middle" x="13662" y="-2349.2039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.last_collection</text>
<text text-anchor="middle" x="13662" y="-2333.8039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;and historian.last_collection.lit_frag == frag then</text>
<text text-anchor="middle" x="13662" y="-2318.4039" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; don&#39;t repeat a search</text>
<text text-anchor="middle" x="13662" y="-2303.0038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return historian.last_collection</text>
<text text-anchor="middle" x="13662" y="-2287.6038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2272.2038" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local collection = setmeta({}, collect_M)</text>
<text text-anchor="middle" x="13662" y="-2256.8037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.frag = frag</text>
<text text-anchor="middle" x="13662" y="-2241.4037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.lit_frag = frag</text>
<text text-anchor="middle" x="13662" y="-2226.0037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if frag == &quot;&quot; then</text>
<text text-anchor="middle" x="13662" y="-2210.6037" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return collection, false</text>
<text text-anchor="middle" x="13662" y="-2195.2036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2179.8036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local cursors = {}</text>
<text text-anchor="middle" x="13662" y="-2164.4036" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local best = true</text>
<text text-anchor="middle" x="13662" y="-2149.0035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local patt = fuzz_patt(frag)</text>
<text text-anchor="middle" x="13662" y="-2133.6035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="13662" y="-2118.2035" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="13662" y="-2102.8034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="13662" y="-2087.4034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="13662" y="-2072.0034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursors[#cursors + 1] = i</text>
<text text-anchor="middle" x="13662" y="-2056.6033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2041.2033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-2025.8033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #collection == 0 then</text>
<text text-anchor="middle" x="13662" y="-2010.4032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; try the transpose</text>
<text text-anchor="middle" x="13662" y="-1995.0032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;best = false</text>
<text text-anchor="middle" x="13662" y="-1979.6032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local slip = sub(frag, 1, &#45;3) .. sub(frag, &#45;1, &#45;1) .. sub(frag, &#45;2, &#45;2)</text>
<text text-anchor="middle" x="13662" y="-1964.2032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;collection.frag = slip</text>
<text text-anchor="middle" x="13662" y="-1948.8031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;patt = fuzz_patt(slip)</text>
<text text-anchor="middle" x="13662" y="-1933.4031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i = #historian, 1, &#45;1 do</text>
<text text-anchor="middle" x="13662" y="-1918.0031" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local score = match(patt, tostring(historian[i]))</text>
<text text-anchor="middle" x="13662" y="-1902.603" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if score then</text>
<text text-anchor="middle" x="13662" y="-1887.203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;collection[#collection + 1] = tostring(historian[i])</text>
<text text-anchor="middle" x="13662" y="-1871.803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cursors[#cursors + 1] = i</text>
<text text-anchor="middle" x="13662" y="-1856.4029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-1841.0029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-1825.6029" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="13662" y="-1810.2028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.best = best</text>
<text text-anchor="middle" x="13662" y="-1794.8028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.cursors = cursors</text>
<text text-anchor="middle" x="13662" y="-1779.4028" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;collection.hl = 1</text>
<text text-anchor="middle" x="13662" y="-1764.0027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.last_collection = collection</text>
<text text-anchor="middle" x="13662" y="-1748.6027" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return collection, best</text>
<text text-anchor="middle" x="13662" y="-1733.2027" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_159&#45;&gt;leaf_188 -->
<g id="edge188" class="edge">
<title>codeblock_159&#45;&gt;leaf_188</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13534.2958,-2486.5023C13540.1911,-2466.4628 13550.5297,-2431.3191 13562.859,-2389.4088"/>
<polygon fill="#000000" stroke="#000000" points="13566.2249,-2390.3686 13565.6895,-2379.7873 13559.5095,-2388.3929 13566.2249,-2390.3686"/>
</g>
<!-- header_189 -->
<g id="node190" class="node">
<title>header_189</title>
<ellipse fill="none" stroke="#000000" cx="14259" cy="-2052.4033" rx="143.582" ry="18"/>
<text text-anchor="middle" x="14259" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : _resultsFrom(historian, line_id)</text>
</g>
<!-- section_160&#45;&gt;header_189 -->
<g id="edge189" class="edge">
<title>section_160&#45;&gt;header_189</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14352.1376,-2486.5023C14337.2021,-2416.8903 14283.1619,-2165.0179 14265.0009,-2080.3724"/>
<polygon fill="#000000" stroke="#000000" points="14268.3934,-2079.4999 14262.8734,-2070.4566 14261.5492,-2080.9684 14268.3934,-2079.4999"/>
</g>
<!-- prose_190 -->
<g id="node191" class="node">
<title>prose_190</title>
<ellipse fill="none" stroke="#000000" cx="14453" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="14453" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_160&#45;&gt;prose_190 -->
<g id="edge190" class="edge">
<title>section_160&#45;&gt;prose_190</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14366.125,-2486.5561C14378.9884,-2462.8842 14400.853,-2419.5649 14412,-2379.804 14442.2166,-2272.0223 14450.1923,-2138.0261 14452.275,-2080.6322"/>
<polygon fill="#000000" stroke="#000000" points="14455.7769,-2080.6273 14452.6086,-2070.5173 14448.7808,-2080.3964 14455.7769,-2080.6273"/>
</g>
<!-- codeblock_191 -->
<g id="node192" class="node">
<title>codeblock_191</title>
<ellipse fill="none" stroke="#000000" cx="14591" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="14591" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 454&#45;467</text>
</g>
<!-- section_160&#45;&gt;codeblock_191 -->
<g id="edge191" class="edge">
<title>section_160&#45;&gt;codeblock_191</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14382.3541,-2487.4671C14413.4909,-2466.0033 14464.7475,-2426.2548 14494,-2379.804 14556.305,-2280.8679 14580.1817,-2140.0523 14587.8613,-2080.6073"/>
<polygon fill="#000000" stroke="#000000" points="14591.3595,-2080.8368 14589.1124,-2070.483 14584.4123,-2079.9783 14591.3595,-2080.8368"/>
</g>
<!-- leaf_166 -->
<g id="node167" class="node">
<title>leaf_166</title>
<polygon fill="none" stroke="#c0c0c0" points="10648,-961.5029 10282,-961.5029 10282,-905.6999 10648,-905.6999 10648,-961.5029"/>
<text text-anchor="middle" x="10465" y="-914.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">This is an incremental &#39;fuzzy&#39; search, returning a</text>
</g>
<!-- raw_162&#45;&gt;leaf_166 -->
<g id="edge166" class="edge">
<title>raw_162&#45;&gt;leaf_166</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10601.0458,-2034.2915C10595.6806,-1984.7525 10580.1779,-1842.8474 10566,-1725.0027 10531.1042,-1434.9542 10485.1509,-1085.6437 10470.0474,-971.6045"/>
<polygon fill="#000000" stroke="#000000" points="10473.5078,-971.0745 10468.7243,-961.621 10466.5685,-971.9942 10473.5078,-971.0745"/>
</g>
<!-- leaf_167 -->
<g id="node168" class="node">
<title>leaf_167</title>
<polygon fill="none" stroke="#c0c0c0" points="10720,-951.6014 10666,-951.6014 10666,-915.6014 10720,-915.6014 10720,-951.6014"/>
<text text-anchor="middle" x="10693" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_163&#45;&gt;leaf_167 -->
<g id="edge167" class="edge">
<title>prespace_163&#45;&gt;leaf_167</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10693.9839,-2034.3764C10693.8686,-1905.3728 10693.1693,-1123.0454 10693.0258,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="10696.5254,-961.938 10693.0164,-951.9411 10689.5254,-961.9443 10696.5254,-961.938"/>
</g>
<!-- leaf_168 -->
<g id="node169" class="node">
<title>leaf_168</title>
<polygon fill="none" stroke="#c0c0c0" points="10824,-951.6014 10738,-951.6014 10738,-915.6014 10824,-915.6014 10824,-951.6014"/>
<text text-anchor="middle" x="10781" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">collection</text>
</g>
<!-- literal_164&#45;&gt;leaf_168 -->
<g id="edge168" class="edge">
<title>literal_164&#45;&gt;leaf_168</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10789.855,-2034.3764C10788.8172,-1905.3728 10782.5239,-1123.0454 10781.2318,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="10784.728,-961.9126 10781.1475,-951.9411 10777.7282,-961.969 10784.728,-961.9126"/>
</g>
<!-- leaf_169 -->
<g id="node170" class="node">
<title>leaf_169</title>
<polygon fill="none" stroke="#c0c0c0" points="10896,-951.6014 10842,-951.6014 10842,-915.6014 10896,-915.6014 10896,-951.6014"/>
<text text-anchor="middle" x="10869" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">.</text>
</g>
<!-- raw_165&#45;&gt;leaf_169 -->
<g id="edge169" class="edge">
<title>raw_165&#45;&gt;leaf_169</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M10868.0161,-2034.3764C10868.1314,-1905.3728 10868.8307,-1123.0454 10868.9742,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="10872.4746,-961.9443 10868.9836,-951.9411 10865.4746,-961.938 10872.4746,-961.9443"/>
</g>
<!-- leaf_171 -->
<g id="node172" class="node">
<title>leaf_171</title>
<polygon fill="none" stroke="#c0c0c0" points="11427.5,-953.5035 10914.5,-953.5035 10914.5,-913.6993 11427.5,-913.6993 11427.5,-953.5035"/>
<text text-anchor="middle" x="11171" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">The array portion of a collection is any line which matches the search.</text>
</g>
<!-- raw_170&#45;&gt;leaf_171 -->
<g id="edge171" class="edge">
<title>raw_170&#45;&gt;leaf_171</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11443.5368,-2034.3764C11411.6696,-1905.6649 11218.7799,-1126.5842 11178.4062,-963.5151"/>
<polygon fill="#000000" stroke="#000000" points="11181.7716,-962.544 11175.9708,-953.6783 11174.9767,-964.2264 11181.7716,-962.544"/>
</g>
<!-- leaf_173 -->
<g id="node174" class="node">
<title>leaf_173</title>
<polygon fill="none" stroke="#c0c0c0" points="11608.5,-953.5035 11445.5,-953.5035 11445.5,-913.6993 11608.5,-913.6993 11608.5,-953.5035"/>
<text text-anchor="middle" x="11527" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">The other fields are:</text>
</g>
<!-- raw_172&#45;&gt;leaf_173 -->
<g id="edge173" class="edge">
<title>raw_172&#45;&gt;leaf_173</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11596.856,-2034.3764C11588.696,-1905.7933 11539.3455,-1128.1386 11528.9294,-964.0052"/>
<polygon fill="#000000" stroke="#000000" points="11532.4005,-963.4365 11528.2741,-953.6783 11525.4145,-963.8799 11532.4005,-963.4365"/>
</g>
<!-- leaf_175 -->
<g id="node176" class="node">
<title>leaf_175</title>
<polygon fill="none" stroke="#c0c0c0" points="12153.5,-968.8018 11626.5,-968.8018 11626.5,-898.401 12153.5,-898.401 12153.5,-968.8018"/>
<text text-anchor="middle" x="11890" y="-937.5014" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45; #fields</text>
<text text-anchor="middle" x="11890" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;best : &#160;Whether this is a best&#45;fit collection, that is, one with all</text>
<text text-anchor="middle" x="11890" y="-906.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;codepoints in order.</text>
</g>
<!-- raw_174&#45;&gt;leaf_175 -->
<g id="edge175" class="edge">
<title>raw_174&#45;&gt;leaf_175</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M11890,-2034.3764C11890,-1909.3482 11890,-1170.6422 11890,-978.9987"/>
<polygon fill="#000000" stroke="#000000" points="11893.5001,-978.7238 11890,-968.7239 11886.5001,-978.7239 11893.5001,-978.7238"/>
</g>
<!-- leaf_177 -->
<g id="node178" class="node">
<title>leaf_177</title>
<polygon fill="none" stroke="#c0c0c0" points="12712.5,-960.9018 12171.5,-960.9018 12171.5,-906.3009 12712.5,-906.3009 12712.5,-960.9018"/>
<text text-anchor="middle" x="12442" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;frag : &#160;The fragment, used to highlight the collection. &#160;Is transposed</text>
<text text-anchor="middle" x="12442" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;in a next&#45;best search.</text>
</g>
<!-- raw_176&#45;&gt;leaf_177 -->
<g id="edge177" class="edge">
<title>raw_176&#45;&gt;leaf_177</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12326.8852,-2034.3764C12340.1489,-1907.5436 12419.4546,-1149.1899 12438.0842,-971.0458"/>
<polygon fill="#000000" stroke="#000000" points="12441.5651,-971.4099 12439.1243,-961.1001 12434.6031,-970.6818 12441.5651,-971.4099"/>
</g>
<!-- leaf_182 -->
<g id="node183" class="node">
<title>leaf_182</title>
<polygon fill="none" stroke="#c0c0c0" points="13103.5,-953.5035 12730.5,-953.5035 12730.5,-913.6993 13103.5,-913.6993 13103.5,-953.5035"/>
<text text-anchor="middle" x="12917" y="-922.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;lit_frag : &#160;The literal fragment passed as the</text>
</g>
<!-- raw_178&#45;&gt;leaf_182 -->
<g id="edge182" class="edge">
<title>raw_178&#45;&gt;leaf_182</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M12945.5327,-2034.3764C12942.1998,-1905.7933 12922.0425,-1128.1386 12917.7881,-964.0052"/>
<polygon fill="#000000" stroke="#000000" points="12921.2784,-963.5842 12917.5204,-953.6783 12914.2808,-963.7657 12921.2784,-963.5842"/>
</g>
<!-- leaf_183 -->
<g id="node184" class="node">
<title>leaf_183</title>
<polygon fill="none" stroke="#c0c0c0" points="13176,-951.6014 13122,-951.6014 13122,-915.6014 13176,-915.6014 13176,-951.6014"/>
<text text-anchor="middle" x="13149" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_179&#45;&gt;leaf_183 -->
<g id="edge183" class="edge">
<title>prespace_179&#45;&gt;leaf_183</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13095.8701,-2034.3764C13102.1028,-1905.2438 13139.9319,-1121.4801 13147.6325,-961.9346"/>
<polygon fill="#000000" stroke="#000000" points="13151.1286,-962.0983 13148.1148,-951.9411 13144.1367,-961.7607 13151.1286,-962.0983"/>
</g>
<!-- leaf_184 -->
<g id="node185" class="node">
<title>leaf_184</title>
<polygon fill="none" stroke="#c0c0c0" points="13248,-951.6014 13194,-951.6014 13194,-915.6014 13248,-915.6014 13248,-951.6014"/>
<text text-anchor="middle" x="13221" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">frag</text>
</g>
<!-- literal_180&#45;&gt;leaf_184 -->
<g id="edge184" class="edge">
<title>literal_180&#45;&gt;leaf_184</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13191.4834,-2034.3764C13194.9425,-1905.3728 13215.9202,-1123.0454 13220.2274,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="13223.7388,-962.0314 13220.5082,-951.9411 13216.7413,-961.8437 13223.7388,-962.0314"/>
</g>
<!-- leaf_185 -->
<g id="node186" class="node">
<title>leaf_185</title>
<polygon fill="none" stroke="#c0c0c0" points="13590,-952.9019 13266,-952.9019 13266,-914.3008 13590,-914.3008 13590,-952.9019"/>
<text text-anchor="middle" x="13428" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> parameter. &#160;Used to</text>
<text text-anchor="middle" x="13428" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;compare to the last search.</text>
</g>
<!-- raw_181&#45;&gt;leaf_185 -->
<g id="edge185" class="edge">
<title>raw_181&#45;&gt;leaf_185</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13268.6915,-2034.2657C13273.3828,-1984.6618 13287.2554,-1842.6081 13303,-1725.0027 13342.9316,-1426.731 13404.6441,-1067.3894 13422.8053,-963.2176"/>
<polygon fill="#000000" stroke="#000000" points="13426.2943,-963.5837 13424.5669,-953.1306 13419.3987,-962.3794 13426.2943,-963.5837"/>
</g>
<!-- leaf_187 -->
<g id="node188" class="node">
<title>leaf_187</title>
<polygon fill="none" stroke="#c0c0c0" points="14114,-960.9018 13608,-960.9018 13608,-906.3009 14114,-906.3009 14114,-960.9018"/>
<text text-anchor="middle" x="13861" y="-929.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45; &#160;cursors : &#160;This is an array, each value is the cursor position of</text>
<text text-anchor="middle" x="13861" y="-914.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;the corresponding line in the history.</text>
</g>
<!-- raw_186&#45;&gt;leaf_187 -->
<g id="edge187" class="edge">
<title>raw_186&#45;&gt;leaf_187</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M13334.4196,-2034.4965C13321.5882,-1979.7227 13291.4413,-1812.8328 13375,-1725.0027 13444.5012,-1651.9486 13521.7584,-1753.8181 13599,-1689.0027 13827.3416,-1497.3952 13856.9561,-1095.71 13860.5708,-971.2101"/>
<polygon fill="#000000" stroke="#000000" points="13864.0739,-971.127 13860.8249,-961.0426 13857.0761,-970.952 13864.0739,-971.127"/>
</g>
<!-- leaf_192 -->
<g id="node193" class="node">
<title>leaf_192</title>
<polygon fill="none" stroke="#c0c0c0" points="14407.5,-951.6014 14132.5,-951.6014 14132.5,-915.6014 14407.5,-915.6014 14407.5,-951.6014"/>
<text text-anchor="middle" x="14270" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">**** _resultsFrom(historian, line_id)</text>
</g>
<!-- header_189&#45;&gt;leaf_192 -->
<g id="edge192" class="edge">
<title>header_189&#45;&gt;leaf_192</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14259.1772,-2034.3764C14260.4456,-1905.3728 14268.1374,-1123.0454 14269.7167,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="14273.2211,-961.9751 14269.8197,-951.9411 14266.2214,-961.9062 14273.2211,-961.9751"/>
</g>
<!-- raw_193 -->
<g id="node194" class="node">
<title>raw_193</title>
<ellipse fill="none" stroke="#000000" cx="14453" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="14453" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_190&#45;&gt;raw_193 -->
<g id="edge193" class="edge">
<title>prose_190&#45;&gt;raw_193</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14453,-2034.3764C14453,-1905.3728 14453,-1123.0454 14453,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="14456.5001,-961.9411 14453,-951.9411 14449.5001,-961.9412 14456.5001,-961.9411"/>
</g>
<!-- leaf_195 -->
<g id="node196" class="node">
<title>leaf_195</title>
<polygon fill="none" stroke="#c0c0c0" points="14843.5,-1029.9019 14498.5,-1029.9019 14498.5,-837.3009 14843.5,-837.3009 14843.5,-1029.9019"/>
<text text-anchor="middle" x="14671" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">local function _resultsFrom(historian, line_id)</text>
<text text-anchor="middle" x="14671" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local stmt = historian.get_results</text>
<text text-anchor="middle" x="14671" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;stmt:bindkv {line_id = line_id}</text>
<text text-anchor="middle" x="14671" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local results = stmt:resultset()</text>
<text text-anchor="middle" x="14671" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if results then</text>
<text text-anchor="middle" x="14671" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results = results[1]</text>
<text text-anchor="middle" x="14671" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results.n = #results</text>
<text text-anchor="middle" x="14671" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;results.frozen = true</text>
<text text-anchor="middle" x="14671" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="14671" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.get_results:clearbind():reset()</text>
<text text-anchor="middle" x="14671" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return results</text>
<text text-anchor="middle" x="14671" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_191&#45;&gt;leaf_195 -->
<g id="edge195" class="edge">
<title>codeblock_191&#45;&gt;leaf_195</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14592.289,-2034.3764C14600.456,-1920.1616 14645.2419,-1293.8289 14663.3742,-1040.248"/>
<polygon fill="#000000" stroke="#000000" points="14666.8905,-1040.1444 14664.1127,-1029.9202 14659.9083,-1039.6451 14666.8905,-1040.1444"/>
</g>
<!-- leaf_194 -->
<g id="node195" class="node">
<title>leaf_194</title>
<polygon fill="none" stroke="#c0c0c0" points="14695.5,-135.0015 14210.5,-135.0015 14210.5,-79.1986 14695.5,-79.1986 14695.5,-135.0015"/>
<text text-anchor="middle" x="14453" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Retrieve a set of results reprs from the database, given a line_id.</text>
</g>
<!-- raw_193&#45;&gt;leaf_194 -->
<g id="edge194" class="edge">
<title>raw_193&#45;&gt;leaf_194</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14453,-915.5701C14453,-811.9323 14453,-291.6209 14453,-145.3846"/>
<polygon fill="#000000" stroke="#000000" points="14456.5001,-145.1211 14453,-135.1211 14449.5001,-145.1212 14456.5001,-145.1211"/>
</g>
<!-- leaf_202 -->
<g id="node203" class="node">
<title>leaf_202</title>
<polygon fill="none" stroke="#c0c0c0" points="14845.5,-2070.4033 14696.5,-2070.4033 14696.5,-2034.4033 14845.5,-2034.4033 14845.5,-2070.4033"/>
<text text-anchor="middle" x="14771" y="-2048.9033" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_196&#45;&gt;leaf_202 -->
<g id="edge202" class="edge">
<title>header_196&#45;&gt;leaf_202</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14813.248,-2486.5023C14806.48,-2416.9612 14782.0099,-2165.5307 14773.7473,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="14777.2093,-2080.0705 14772.757,-2070.4566 14770.2422,-2080.7487 14777.2093,-2080.0705"/>
</g>
<!-- raw_203 -->
<g id="node204" class="node">
<title>raw_203</title>
<ellipse fill="none" stroke="#000000" cx="14891" cy="-2052.4033" rx="27" ry="18"/>
<text text-anchor="middle" x="14891" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_197&#45;&gt;raw_203 -->
<g id="edge203" class="edge">
<title>prose_197&#45;&gt;raw_203</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14980.5844,-2487.6266C14965.5308,-2464.4394 14939.4931,-2420.9162 14927,-2379.804 14894.5119,-2272.8921 14890.6456,-2138.4378 14890.6355,-2080.7784"/>
<polygon fill="#000000" stroke="#000000" points="14894.136,-2080.6285 14890.675,-2070.6149 14887.1361,-2080.6012 14894.136,-2080.6285"/>
</g>
<!-- leaf_205 -->
<g id="node206" class="node">
<title>leaf_205</title>
<polygon fill="none" stroke="#c0c0c0" points="15499.9015,-2163.0439 14936.0985,-2163.0439 14936.0985,-1941.7627 15499.9015,-1941.7627 15499.9015,-2163.0439"/>
<text text-anchor="middle" x="15218" y="-2148.0235" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="15218" y="-2132.6234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 or #historian == 0 then</text>
<text text-anchor="middle" x="15218" y="-2117.2234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="15218" y="-2101.8234" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="15218" y="-2086.4233" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local Δ = historian.cursor &gt; 1 and historian.cursor &#45; 1 or historian.cursor</text>
<text text-anchor="middle" x="15218" y="-2067.6633" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[Δ]</text>
<text text-anchor="middle" x="15218" y="-2048.9033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = 1</text>
<text text-anchor="middle" x="15218" y="-2033.5033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[Δ])</text>
<text text-anchor="middle" x="15218" y="-2014.7433" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;local result = historian.results[txtbuf]</text>
<text text-anchor="middle" x="15218" y="-1999.3433" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = Δ</text>
<text text-anchor="middle" x="15218" y="-1980.5833" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="15218" y="-1965.1832" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return txtbuf:clone(), result</text>
<text text-anchor="middle" x="15218" y="-1949.7832" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_198&#45;&gt;leaf_205 -->
<g id="edge205" class="edge">
<title>codeblock_198&#45;&gt;leaf_205</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15218,-2486.5023C15218,-2434.8631 15218,-2282.928 15218,-2173.362"/>
<polygon fill="#000000" stroke="#000000" points="15221.5001,-2173.2288 15218,-2163.2288 15214.5001,-2173.2288 15221.5001,-2173.2288"/>
</g>
<!-- header_206 -->
<g id="node207" class="node">
<title>header_206</title>
<ellipse fill="none" stroke="#000000" cx="15600" cy="-2052.4033" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="15600" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_199&#45;&gt;header_206 -->
<g id="edge206" class="edge">
<title>section_199&#45;&gt;header_206</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15664.3322,-2486.5023C15654.0159,-2416.8903 15616.6892,-2165.0179 15604.1449,-2080.3724"/>
<polygon fill="#000000" stroke="#000000" points="15607.6037,-2079.8355 15602.6754,-2070.4566 15600.6793,-2080.8617 15607.6037,-2079.8355"/>
</g>
<!-- prose_207 -->
<g id="node208" class="node">
<title>prose_207</title>
<ellipse fill="none" stroke="#000000" cx="15733" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="15733" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_199&#45;&gt;prose_207 -->
<g id="edge207" class="edge">
<title>section_199&#45;&gt;prose_207</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15670.8546,-2486.3936C15675.9225,-2462.1839 15684.8966,-2417.8998 15691,-2379.804 15708.672,-2269.4999 15723.7838,-2137.3432 15729.9875,-2080.5726"/>
<polygon fill="#000000" stroke="#000000" points="15733.4745,-2080.881 15731.0743,-2070.5616 15726.5154,-2080.1255 15733.4745,-2080.881"/>
</g>
<!-- codeblock_208 -->
<g id="node209" class="node">
<title>codeblock_208</title>
<ellipse fill="none" stroke="#000000" cx="15960" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="15960" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 495&#45;519</text>
</g>
<!-- section_199&#45;&gt;codeblock_208 -->
<g id="edge208" class="edge">
<title>section_199&#45;&gt;codeblock_208</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15684.1131,-2486.815C15706.2769,-2463.423 15745.4471,-2420.4059 15774,-2379.804 15848.1185,-2274.4083 15918.3619,-2137.2317 15946.7622,-2079.6862"/>
<polygon fill="#000000" stroke="#000000" points="15949.9971,-2081.0389 15951.2637,-2070.5201 15943.7139,-2077.9532 15949.9971,-2081.0389"/>
</g>
<!-- header_219 -->
<g id="node220" class="node">
<title>header_219</title>
<ellipse fill="none" stroke="#000000" cx="16395" cy="-2052.4033" rx="111.1981" ry="18"/>
<text text-anchor="middle" x="16395" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:index(cursor)</text>
</g>
<!-- section_200&#45;&gt;header_219 -->
<g id="edge219" class="edge">
<title>section_200&#45;&gt;header_219</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16472.7747,-2486.5023C16460.3028,-2416.8903 16415.1764,-2165.0179 16400.011,-2080.3724"/>
<polygon fill="#000000" stroke="#000000" points="16403.4433,-2079.6826 16398.2345,-2070.4566 16396.553,-2080.9172 16403.4433,-2079.6826"/>
</g>
<!-- prose_220 -->
<g id="node221" class="node">
<title>prose_220</title>
<ellipse fill="none" stroke="#000000" cx="16557" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="16557" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_200&#45;&gt;prose_220 -->
<g id="edge220" class="edge">
<title>section_200&#45;&gt;prose_220</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16482.8448,-2486.1857C16491.5799,-2462.1132 16506.5659,-2418.3615 16515,-2379.804 16538.8713,-2270.6736 16550.7412,-2137.9031 16555.0456,-2080.773"/>
<polygon fill="#000000" stroke="#000000" points="16558.5438,-2080.9254 16555.7848,-2070.6962 16551.5625,-2080.4133 16558.5438,-2080.9254"/>
</g>
<!-- codeblock_221 -->
<g id="node222" class="node">
<title>codeblock_221</title>
<ellipse fill="none" stroke="#000000" cx="16770" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="16770" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 526&#45;539</text>
</g>
<!-- section_200&#45;&gt;codeblock_221 -->
<g id="edge221" class="edge">
<title>section_200&#45;&gt;codeblock_221</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16496.4348,-2487.0397C16522.2933,-2464.2239 16567.1694,-2422.1701 16598,-2379.804 16672.6416,-2277.2346 16734.5178,-2137.9791 16758.8748,-2079.7548"/>
<polygon fill="#000000" stroke="#000000" points="16762.1209,-2081.064 16762.7206,-2070.4861 16755.6553,-2078.3812 16762.1209,-2081.064"/>
</g>
<!-- header_226 -->
<g id="node227" class="node">
<title>header_226</title>
<ellipse fill="none" stroke="#000000" cx="17282" cy="-2052.4033" rx="184.6938" ry="18"/>
<text text-anchor="middle" x="17282" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append(txtbuf, results, success)</text>
</g>
<!-- section_201&#45;&gt;header_226 -->
<g id="edge226" class="edge">
<title>section_201&#45;&gt;header_226</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17578.7241,-2486.8184C17552.9983,-2463.769 17508.1182,-2421.4686 17476,-2379.804 17396.3052,-2276.4216 17324.072,-2137.608 17295.2505,-2079.6277"/>
<polygon fill="#000000" stroke="#000000" points="17298.2586,-2077.8144 17290.6913,-2070.3991 17291.9827,-2080.915 17298.2586,-2077.8144"/>
</g>
<!-- prose_227 -->
<g id="node228" class="node">
<title>prose_227</title>
<ellipse fill="none" stroke="#000000" cx="17517" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="17517" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_201&#45;&gt;prose_227 -->
<g id="edge227" class="edge">
<title>section_201&#45;&gt;prose_227</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17591.7519,-2486.226C17582.5124,-2462.197 17566.6969,-2418.4922 17558,-2379.804 17533.5089,-2270.8546 17522.543,-2137.9895 17518.705,-2080.8039"/>
<polygon fill="#000000" stroke="#000000" points="17522.1908,-2080.4691 17518.0501,-2070.7169 17515.2055,-2080.9227 17522.1908,-2080.4691"/>
</g>
<!-- prose_228 -->
<g id="node229" class="node">
<title>prose_228</title>
<ellipse fill="none" stroke="#000000" cx="17599" cy="-2052.4033" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="17599" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_201&#45;&gt;prose_228 -->
<g id="edge228" class="edge">
<title>section_201&#45;&gt;prose_228</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17599,-2486.5023C17599,-2416.9612 17599,-2165.5307 17599,-2080.6315"/>
<polygon fill="#000000" stroke="#000000" points="17602.5001,-2080.4566 17599,-2070.4566 17595.5001,-2080.4567 17602.5001,-2080.4566"/>
</g>
<!-- codeblock_229 -->
<g id="node230" class="node">
<title>codeblock_229</title>
<ellipse fill="none" stroke="#000000" cx="17788" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="17788" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 547&#45;562</text>
</g>
<!-- section_201&#45;&gt;codeblock_229 -->
<g id="edge229" class="edge">
<title>section_201&#45;&gt;codeblock_229</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17606.5257,-2486.5023C17635.6861,-2416.7485 17741.3509,-2163.9912 17776.5229,-2079.8573"/>
<polygon fill="#000000" stroke="#000000" points="17779.825,-2081.0328 17780.4528,-2070.4566 17773.3666,-2078.3329 17779.825,-2081.0328"/>
</g>
<!-- codeblock_230 -->
<g id="node231" class="node">
<title>codeblock_230</title>
<ellipse fill="none" stroke="#000000" cx="18098" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="18098" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 564&#45;571</text>
</g>
<!-- section_201&#45;&gt;codeblock_230 -->
<g id="edge230" class="edge">
<title>section_201&#45;&gt;codeblock_230</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17651.5028,-2491.4353C17712.734,-2474.1122 17814.4202,-2438.6676 17884,-2379.804 17987.619,-2292.1437 18059.8856,-2141.7897 18086.593,-2080.0745"/>
<polygon fill="#000000" stroke="#000000" points="18089.9227,-2081.189 18090.6274,-2070.6177 18083.4841,-2078.4422 18089.9227,-2081.189"/>
</g>
<!-- codeblock_231 -->
<g id="node232" class="node">
<title>codeblock_231</title>
<ellipse fill="none" stroke="#000000" cx="18409" cy="-2052.4033" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="18409" y="-2048.2033" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 573&#45;575</text>
</g>
<!-- section_201&#45;&gt;codeblock_231 -->
<g id="edge231" class="edge">
<title>section_201&#45;&gt;codeblock_231</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17667.3837,-2496.7953C17804.7693,-2480.2571 18108.4722,-2438.0862 18194,-2379.804 18307.348,-2302.5639 18375.5542,-2143.7835 18399.3859,-2079.911"/>
<polygon fill="#000000" stroke="#000000" points="18402.6793,-2081.0955 18402.8298,-2070.5018 18396.1058,-2078.6895 18402.6793,-2081.0955"/>
</g>
<!-- leaf_204 -->
<g id="node205" class="node">
<title>leaf_204</title>
<polygon fill="none" stroke="#c0c0c0" points="14918,-951.6014 14864,-951.6014 14864,-915.6014 14918,-915.6014 14918,-951.6014"/>
</g>
<!-- raw_203&#45;&gt;leaf_204 -->
<g id="edge204" class="edge">
<title>raw_203&#45;&gt;leaf_204</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M14891,-2034.3764C14891,-1905.3728 14891,-1123.0454 14891,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="14894.5001,-961.9411 14891,-951.9411 14887.5001,-961.9412 14894.5001,-961.9411"/>
</g>
<!-- leaf_209 -->
<g id="node210" class="node">
<title>leaf_209</title>
<polygon fill="none" stroke="#c0c0c0" points="15463,-951.6014 15307,-951.6014 15307,-915.6014 15463,-915.6014 15463,-951.6014"/>
<text text-anchor="middle" x="15385" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_206&#45;&gt;leaf_209 -->
<g id="edge209" class="edge">
<title>header_206&#45;&gt;leaf_209</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15598.2822,-2034.0739C15592.7398,-1982.1671 15571.8739,-1831.0674 15509,-1725.0027 15497.3003,-1705.266 15482.1217,-1709.5932 15472,-1689.0027 15345.1628,-1430.9778 15371.1708,-1065.2398 15381.7594,-961.8159"/>
<polygon fill="#000000" stroke="#000000" points="15385.2434,-962.1511 15382.8182,-951.8376 15378.2825,-961.4124 15385.2434,-962.1511"/>
</g>
<!-- raw_210 -->
<g id="node211" class="node">
<title>raw_210</title>
<ellipse fill="none" stroke="#000000" cx="15508" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="15508" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_207&#45;&gt;raw_210 -->
<g id="edge210" class="edge">
<title>prose_207&#45;&gt;raw_210</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15736.9534,-2034.3578C15747.7392,-1979.8976 15771.7455,-1815.3919 15691,-1725.0027 15646.1885,-1674.8392 15586.7705,-1740.9173 15544,-1689.0027 15450.8047,-1575.8827 15492.7825,-1085.5222 15505.0432,-961.9538"/>
<polygon fill="#000000" stroke="#000000" points="15508.5473,-962.0888 15506.0676,-951.7883 15501.5826,-961.3869 15508.5473,-962.0888"/>
</g>
<!-- prespace_211 -->
<g id="node212" class="node">
<title>prespace_211</title>
<ellipse fill="none" stroke="#000000" cx="15599" cy="-933.6014" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="15599" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_207&#45;&gt;prespace_211 -->
<g id="edge211" class="edge">
<title>prose_207&#45;&gt;prespace_211</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15734.6114,-2034.2197C15738.3794,-1982.6963 15743.7949,-1832.5086 15691,-1725.0027 15681.0258,-1704.6922 15664.4265,-1709.573 15655,-1689.0027 15535.6827,-1428.6297 15578.8526,-1064.5389 15594.3965,-961.659"/>
<polygon fill="#000000" stroke="#000000" points="15597.8618,-962.1521 15595.9345,-951.734 15590.9443,-961.0801 15597.8618,-962.1521"/>
</g>
<!-- literal_212 -->
<g id="node213" class="node">
<title>literal_212</title>
<ellipse fill="none" stroke="#000000" cx="15695" cy="-933.6014" rx="31.481" ry="18"/>
<text text-anchor="middle" x="15695" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_207&#45;&gt;literal_212 -->
<g id="edge212" class="edge">
<title>prose_207&#45;&gt;literal_212</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15732.3877,-2034.3764C15728.0061,-1905.3728 15701.4344,-1123.0454 15695.9786,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="15699.4604,-961.8165 15695.6229,-951.9411 15692.4645,-962.0542 15699.4604,-961.8165"/>
</g>
<!-- raw_213 -->
<g id="node214" class="node">
<title>raw_213</title>
<ellipse fill="none" stroke="#000000" cx="15771" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="15771" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_207&#45;&gt;raw_213 -->
<g id="edge213" class="edge">
<title>prose_207&#45;&gt;raw_213</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15733.6123,-2034.3764C15737.9939,-1905.3728 15764.5656,-1123.0454 15770.0214,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="15773.5355,-962.0542 15770.3771,-951.9411 15766.5396,-961.8165 15773.5355,-962.0542"/>
</g>
<!-- leaf_218 -->
<g id="node219" class="node">
<title>leaf_218</title>
<polygon fill="none" stroke="#c0c0c0" points="16281.9015,-1121.2421 15816.0985,-1121.2421 15816.0985,-745.9606 16281.9015,-745.9606 16281.9015,-1121.2421"/>
<text text-anchor="middle" x="16049" y="-1106.2217" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="16049" y="-1090.8216" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local Δ = historian.cursor &lt; #historian</text>
<text text-anchor="middle" x="16049" y="-1072.0616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;and historian.cursor + 1</text>
<text text-anchor="middle" x="16049" y="-1056.6616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or &#160;historian.cursor</text>
<text text-anchor="middle" x="16049" y="-1041.2616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local fwd = historian.cursor &gt;= #historian</text>
<text text-anchor="middle" x="16049" y="-1025.8615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 or #historian == 0 then</text>
<text text-anchor="middle" x="16049" y="-1010.4615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="16049" y="-995.0615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16049" y="-979.6615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[Δ]</text>
<text text-anchor="middle" x="16049" y="-960.9015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not txtbuf then</text>
<text text-anchor="middle" x="16049" y="-945.5014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf(), nil, true</text>
<text text-anchor="middle" x="16049" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16049" y="-914.7014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = #txtbuf.lines</text>
<text text-anchor="middle" x="16049" y="-899.3013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[Δ])</text>
<text text-anchor="middle" x="16049" y="-880.5413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = Δ</text>
<text text-anchor="middle" x="16049" y="-861.7813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="16049" y="-846.3813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if fwd and #txtbuf.lines &gt; 0 then</text>
<text text-anchor="middle" x="16049" y="-830.9813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.cursor = #historian + 1</text>
<text text-anchor="middle" x="16049" y="-815.5812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return txtbuf:clone(), nil, true</text>
<text text-anchor="middle" x="16049" y="-800.1812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="16049" y="-784.7812" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return txtbuf:clone(), result, false</text>
<text text-anchor="middle" x="16049" y="-769.3811" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16049" y="-753.9811" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_208&#45;&gt;leaf_218 -->
<g id="edge218" class="edge">
<title>codeblock_208&#45;&gt;leaf_218</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15961.434,-2034.3764C15969.5655,-1932.1573 16010.3277,-1419.744 16033.2607,-1131.4568"/>
<polygon fill="#000000" stroke="#000000" points="16036.7648,-1131.5432 16034.0689,-1121.2972 16029.7869,-1130.9881 16036.7648,-1131.5432"/>
</g>
<!-- leaf_214 -->
<g id="node215" class="node">
<title>leaf_214</title>
<polygon fill="none" stroke="#c0c0c0" points="15554.5,-135.0015 15083.5,-135.0015 15083.5,-79.1986 15554.5,-79.1986 15554.5,-135.0015"/>
<text text-anchor="middle" x="15319" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next txtbuf in history, and a second flag to tell the</text>
</g>
<!-- raw_210&#45;&gt;leaf_214 -->
<g id="edge214" class="edge">
<title>raw_210&#45;&gt;leaf_214</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15509.5957,-915.3514C15518.2481,-812.3 15556.1262,-303.3839 15472,-178.2001 15461.1483,-162.0523 15445.6279,-149.4975 15428.592,-139.7583"/>
<polygon fill="#000000" stroke="#000000" points="15430.029,-136.5575 15419.5618,-134.9178 15426.7219,-142.7271 15430.029,-136.5575"/>
</g>
<!-- leaf_215 -->
<g id="node216" class="node">
<title>leaf_215</title>
<polygon fill="none" stroke="#c0c0c0" points="15627,-125.1 15573,-125.1 15573,-89.1 15627,-89.1 15627,-125.1"/>
</g>
<!-- prespace_211&#45;&gt;leaf_215 -->
<g id="edge215" class="edge">
<title>prespace_211&#45;&gt;leaf_215</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15599.0218,-915.5701C15599.1503,-809.3734 15599.8081,-265.6725 15599.9659,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="15603.4658,-135.2518 15599.978,-125.2475 15596.4658,-135.2433 15603.4658,-135.2518"/>
</g>
<!-- leaf_216 -->
<g id="node217" class="node">
<title>leaf_216</title>
<polygon fill="none" stroke="#c0c0c0" points="15745,-125.1 15645,-125.1 15645,-89.1 15745,-89.1 15745,-125.1"/>
<text text-anchor="middle" x="15695" y="-103.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_212&#45;&gt;leaf_216 -->
<g id="edge216" class="edge">
<title>literal_212&#45;&gt;leaf_216</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15695,-915.5701C15695,-809.3734 15695,-265.6725 15695,-135.2484"/>
<polygon fill="#000000" stroke="#000000" points="15698.5001,-135.2475 15695,-125.2475 15691.5001,-135.2476 15698.5001,-135.2475"/>
</g>
<!-- leaf_217 -->
<g id="node218" class="node">
<title>leaf_217</title>
<polygon fill="none" stroke="#c0c0c0" points="16003,-127.0021 15763,-127.0021 15763,-87.198 16003,-87.198 16003,-127.0021"/>
<text text-anchor="middle" x="15883" y="-111.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_213&#45;&gt;leaf_217 -->
<g id="edge217" class="edge">
<title>raw_213&#45;&gt;leaf_217</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M15770.0445,-915.3896C15764.9751,-813.615 15743.7616,-314.9466 15807,-178.2001 15815.1907,-160.4886 15829.9968,-145.0669 15844.3789,-133.1552"/>
<polygon fill="#000000" stroke="#000000" points="15846.6079,-135.8547 15852.2806,-126.9065 15842.2658,-130.3641 15846.6079,-135.8547"/>
</g>
<!-- leaf_222 -->
<g id="node223" class="node">
<title>leaf_222</title>
<polygon fill="none" stroke="#c0c0c0" points="16504.5,-951.6014 16299.5,-951.6014 16299.5,-915.6014 16504.5,-915.6014 16504.5,-951.6014"/>
<text text-anchor="middle" x="16402" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:index(cursor)</text>
</g>
<!-- header_219&#45;&gt;leaf_222 -->
<g id="edge222" class="edge">
<title>header_219&#45;&gt;leaf_222</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16395.1128,-2034.3764C16395.9199,-1905.3728 16400.8147,-1123.0454 16401.8197,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="16405.3225,-961.9629 16401.8853,-951.9411 16398.3227,-961.919 16405.3225,-961.9629"/>
</g>
<!-- raw_223 -->
<g id="node224" class="node">
<title>raw_223</title>
<ellipse fill="none" stroke="#000000" cx="16550" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="16550" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_220&#45;&gt;raw_223 -->
<g id="edge223" class="edge">
<title>prose_220&#45;&gt;raw_223</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16556.8872,-2034.3764C16556.0801,-1905.3728 16551.1853,-1123.0454 16550.1803,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="16553.6773,-961.919 16550.1147,-951.9411 16546.6775,-961.9629 16553.6773,-961.919"/>
</g>
<!-- leaf_225 -->
<g id="node226" class="node">
<title>leaf_225</title>
<polygon fill="none" stroke="#c0c0c0" points="17094.5,-1029.9019 16595.5,-1029.9019 16595.5,-837.3009 17094.5,-837.3009 17094.5,-1029.9019"/>
<text text-anchor="middle" x="16845" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.index(historian, cursor)</text>
<text text-anchor="middle" x="16845" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if (not cursor) or cursor &lt; 0 or cursor &gt; #historian + 1 then</text>
<text text-anchor="middle" x="16845" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Txtbuf()</text>
<text text-anchor="middle" x="16845" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="16845" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local txtbuf = historian[cursor]</text>
<text text-anchor="middle" x="16845" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local result = _resultsFrom(historian, historian.line_ids[cursor])</text>
<text text-anchor="middle" x="16845" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf = txtbuf:clone()</text>
<text text-anchor="middle" x="16845" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = cursor</text>
<text text-anchor="middle" x="16845" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cur_row = #txtbuf.lines</text>
<text text-anchor="middle" x="16845" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;txtbuf.cursor = #txtbuf.lines[txtbuf.cur_row] + 1</text>
<text text-anchor="middle" x="16845" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return txtbuf, result</text>
<text text-anchor="middle" x="16845" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_221&#45;&gt;leaf_225 -->
<g id="edge225" class="edge">
<title>codeblock_221&#45;&gt;leaf_225</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16771.2084,-2034.3764C16778.865,-1920.1616 16820.8518,-1293.8289 16837.8508,-1040.248"/>
<polygon fill="#000000" stroke="#000000" points="16841.3664,-1040.132 16838.5432,-1029.9202 16834.3821,-1039.6637 16841.3664,-1040.132"/>
</g>
<!-- leaf_224 -->
<g id="node225" class="node">
<title>leaf_224</title>
<polygon fill="none" stroke="#c0c0c0" points="16684,-135.0015 16416,-135.0015 16416,-79.1986 16684,-79.1986 16684,-135.0015"/>
<text text-anchor="middle" x="16550" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Loads the history to an exact index.</text>
</g>
<!-- raw_223&#45;&gt;leaf_224 -->
<g id="edge224" class="edge">
<title>raw_223&#45;&gt;leaf_224</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M16550,-915.5701C16550,-811.9323 16550,-291.6209 16550,-145.3846"/>
<polygon fill="#000000" stroke="#000000" points="16553.5001,-145.1211 16550,-135.1211 16546.5001,-145.1212 16553.5001,-145.1211"/>
</g>
<!-- leaf_232 -->
<g id="node233" class="node">
<title>leaf_232</title>
<polygon fill="none" stroke="#c0c0c0" points="17451,-951.6014 17113,-951.6014 17113,-915.6014 17451,-915.6014 17451,-951.6014"/>
<text text-anchor="middle" x="17282" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append(txtbuf, results, success)</text>
</g>
<!-- header_226&#45;&gt;leaf_232 -->
<g id="edge232" class="edge">
<title>header_226&#45;&gt;leaf_232</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17282,-2034.3764C17282,-1905.3728 17282,-1123.0454 17282,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="17285.5001,-961.9411 17282,-951.9411 17278.5001,-961.9412 17285.5001,-961.9411"/>
</g>
<!-- raw_233 -->
<g id="node234" class="node">
<title>raw_233</title>
<ellipse fill="none" stroke="#000000" cx="17496" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="17496" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_227&#45;&gt;raw_233 -->
<g id="edge233" class="edge">
<title>prose_227&#45;&gt;raw_233</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17516.6616,-2034.3764C17514.2402,-1905.3728 17499.5559,-1123.0454 17496.5408,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="17500.0314,-961.8737 17496.3442,-951.9411 17493.0326,-962.0051 17500.0314,-961.8737"/>
</g>
<!-- raw_235 -->
<g id="node236" class="node">
<title>raw_235</title>
<ellipse fill="none" stroke="#000000" cx="17568" cy="-933.6014" rx="27" ry="18"/>
<text text-anchor="middle" x="17568" y="-929.4014" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_228&#45;&gt;raw_235 -->
<g id="edge235" class="edge">
<title>prose_228&#45;&gt;raw_235</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17598.5005,-2034.3764C17594.926,-1905.3728 17573.2492,-1123.0454 17568.7984,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="17572.2839,-961.8403 17568.5082,-951.9411 17565.2866,-962.0343 17572.2839,-961.8403"/>
</g>
<!-- leaf_237 -->
<g id="node238" class="node">
<title>leaf_237</title>
<polygon fill="none" stroke="#c0c0c0" points="18063,-1045.2022 17613,-1045.2022 17613,-822.0006 18063,-822.0006 18063,-1045.2022"/>
<text text-anchor="middle" x="17838" y="-1030.2016" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, txtbuf, results, success)</text>
<text text-anchor="middle" x="17838" y="-1014.8016" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if tostring(historian[#historian]) == tostring(txtbuf)</text>
<text text-anchor="middle" x="17838" y="-999.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;or tostring(txtbuf) == &quot;&quot; then</text>
<text text-anchor="middle" x="17838" y="-984.0015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; don&#39;t bother</text>
<text text-anchor="middle" x="17838" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return false</text>
<text text-anchor="middle" x="17838" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="17838" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = txtbuf</text>
<text text-anchor="middle" x="17838" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if success then</text>
<text text-anchor="middle" x="17838" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian:persist(txtbuf, results)</text>
<text text-anchor="middle" x="17838" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="17838" y="-876.2013" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian:persist(txtbuf)</text>
<text text-anchor="middle" x="17838" y="-860.8012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="17838" y="-845.4012" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="17838" y="-830.0012" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_229&#45;&gt;leaf_237 -->
<g id="edge237" class="edge">
<title>codeblock_229&#45;&gt;leaf_237</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17788.8056,-2034.3764C17793.8071,-1922.4626 17820.7826,-1318.8575 17832.529,-1056.0207"/>
<polygon fill="#000000" stroke="#000000" points="17836.0415,-1055.8172 17832.9915,-1045.6709 17829.0485,-1055.5046 17836.0415,-1055.8172"/>
</g>
<!-- leaf_238 -->
<g id="node239" class="node">
<title>leaf_238</title>
<polygon fill="none" stroke="#c0c0c0" points="18349,-984.0024 18081,-984.0024 18081,-883.2004 18349,-883.2004 18349,-984.0024"/>
<text text-anchor="middle" x="18215" y="-968.6015" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new()</text>
<text text-anchor="middle" x="18215" y="-953.2014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="18215" y="-937.8014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="18215" y="-922.4014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="18215" y="-907.0013" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="18215" y="-891.6013" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_230&#45;&gt;leaf_238 -->
<g id="edge238" class="edge">
<title>codeblock_230&#45;&gt;leaf_238</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M18099.8852,-2034.3764C18112.6384,-1912.4248 18186.4483,-1206.6248 18208.671,-994.1223"/>
<polygon fill="#000000" stroke="#000000" points="18212.1616,-994.3932 18209.7208,-984.0834 18205.1996,-993.6651 18212.1616,-994.3932"/>
</g>
<!-- leaf_239 -->
<g id="node240" class="node">
<title>leaf_239</title>
<polygon fill="none" stroke="#c0c0c0" points="18453,-951.6014 18367,-951.6014 18367,-915.6014 18453,-915.6014 18453,-951.6014"/>
<text text-anchor="middle" x="18410" y="-930.1014" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_231&#45;&gt;leaf_239 -->
<g id="edge239" class="edge">
<title>codeblock_231&#45;&gt;leaf_239</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M18409.0161,-2034.3764C18409.1314,-1905.3728 18409.8307,-1123.0454 18409.9742,-962.4146"/>
<polygon fill="#000000" stroke="#000000" points="18413.4746,-961.9443 18409.9836,-951.9411 18406.4746,-961.938 18413.4746,-961.9443"/>
</g>
<!-- leaf_234 -->
<g id="node235" class="node">
<title>leaf_234</title>
<polygon fill="none" stroke="#c0c0c0" points="17554,-135.0015 17230,-135.0015 17230,-79.1986 17554,-79.1986 17554,-135.0015"/>
<text text-anchor="middle" x="17392" y="-87.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Appends a txtbuf to history and persists it.</text>
</g>
<!-- raw_233&#45;&gt;leaf_234 -->
<g id="edge234" class="edge">
<title>raw_233&#45;&gt;leaf_234</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17499.5607,-915.5747C17515.7539,-829.1565 17576.7573,-450.2758 17460,-178.2001 17454.3088,-164.9381 17444.967,-152.6852 17435.0043,-142.22"/>
<polygon fill="#000000" stroke="#000000" points="17437.2381,-139.505 17427.6835,-134.9268 17432.2977,-144.4641 17437.2381,-139.505"/>
</g>
<!-- leaf_236 -->
<g id="node237" class="node">
<title>leaf_236</title>
<polygon fill="none" stroke="#c0c0c0" points="17770,-127.0021 17572,-127.0021 17572,-87.198 17770,-87.198 17770,-127.0021"/>
<text text-anchor="middle" x="17671" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">Doesn&#39;t adjust the cursor.</text>
</g>
<!-- raw_235&#45;&gt;leaf_236 -->
<g id="edge236" class="edge">
<title>raw_235&#45;&gt;leaf_236</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M17564.4822,-915.593C17548.486,-829.2589 17488.2498,-450.7058 17604,-178.2001 17611.206,-161.2354 17624.3675,-145.8615 17637.1297,-133.7848"/>
<polygon fill="#000000" stroke="#000000" points="17639.4849,-136.374 17644.5498,-127.0682 17634.7872,-131.1843 17639.4849,-136.374"/>
</g>
</g>
</svg>
