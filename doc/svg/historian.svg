<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="5490pt" height="1831pt"
 viewBox="0.00 0.00 5490.30 1831.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1827.0425)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1827.0425 5486.2972,-1827.0425 5486.2972,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1805.0425" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="1389" y="-1800.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 178</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1733.0425" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="1389" y="-1728.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;107</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1389,-1786.8739C1389,-1779.1735 1389,-1770.0169 1389,-1761.4591"/>
<polygon fill="#000000" stroke="#000000" points="1392.5001,-1761.4557 1389,-1751.4558 1385.5001,-1761.4558 1392.5001,-1761.4557"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="1035" cy="-1661.0425" rx="57.0821" ry="18"/>
<text text-anchor="middle" x="1035" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Historian</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1332.6436,-1723.7508C1274.582,-1713.8712 1181.5848,-1697.1921 1102,-1679.0425 1097.3285,-1677.9772 1092.491,-1676.8083 1087.6518,-1675.5937"/>
<polygon fill="#000000" stroke="#000000" points="1088.3256,-1672.1532 1077.7692,-1673.0551 1086.5839,-1678.9331 1088.3256,-1672.1532"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="1143" cy="-1661.0425" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1143" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1337.3638,-1721.8C1295.5034,-1712.125 1235.2574,-1696.9223 1184,-1679.0425 1181.7705,-1678.2648 1179.4928,-1677.4182 1177.2098,-1676.5301"/>
<polygon fill="#000000" stroke="#000000" points="1178.4846,-1673.27 1167.9043,-1672.7149 1175.8291,-1679.7468 1178.4846,-1673.27"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="1225" cy="-1661.0425" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1225" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1354.2198,-1717.7732C1326.38,-1705.5508 1287.5246,-1688.4923 1259.7047,-1676.2787"/>
<polygon fill="#000000" stroke="#000000" points="1260.9243,-1672.9918 1250.3609,-1672.1765 1258.1103,-1679.4013 1260.9243,-1672.9918"/>
</g>
<!-- prose_5 -->
<g id="node6" class="node">
<title>prose_5</title>
<ellipse fill="none" stroke="#000000" cx="1307" cy="-1661.0425" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1307" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;prose_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.1501,-1715.6133C1358.0588,-1705.8746 1344.1239,-1693.6391 1332.2613,-1683.2232"/>
<polygon fill="#000000" stroke="#000000" points="1334.264,-1680.3239 1324.4403,-1676.3559 1329.6454,-1685.584 1334.264,-1680.3239"/>
</g>
<!-- prose_6 -->
<g id="node7" class="node">
<title>prose_6</title>
<ellipse fill="none" stroke="#000000" cx="1389" cy="-1661.0425" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1389" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;prose_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1389,-1714.8739C1389,-1707.1735 1389,-1698.0169 1389,-1689.4591"/>
<polygon fill="#000000" stroke="#000000" points="1392.5001,-1689.4557 1389,-1679.4558 1385.5001,-1689.4558 1392.5001,-1689.4557"/>
</g>
<!-- codeblock_7 -->
<g id="node8" class="node">
<title>codeblock_7</title>
<ellipse fill="none" stroke="#000000" cx="1546" cy="-1661.0425" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1546" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 16&#45;20</text>
</g>
<!-- section_1&#45;&gt;codeblock_7 -->
<g id="edge7" class="edge">
<title>section_1&#45;&gt;codeblock_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1423.0667,-1717.4196C1446.0978,-1706.8575 1476.7375,-1692.8062 1501.666,-1681.374"/>
<polygon fill="#000000" stroke="#000000" points="1503.282,-1684.4835 1510.9127,-1677.1335 1500.364,-1678.1207 1503.282,-1684.4835"/>
</g>
<!-- codeblock_8 -->
<g id="node9" class="node">
<title>codeblock_8</title>
<ellipse fill="none" stroke="#000000" cx="1770" cy="-1661.0425" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="1770" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 22&#45;24</text>
</g>
<!-- section_1&#45;&gt;codeblock_8 -->
<g id="edge8" class="edge">
<title>section_1&#45;&gt;codeblock_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1443.1834,-1722.8031C1510.4852,-1710.0847 1625.4559,-1688.3579 1699.5438,-1674.3571"/>
<polygon fill="#000000" stroke="#000000" points="1700.5412,-1677.7306 1709.7173,-1672.4345 1699.2413,-1670.8524 1700.5412,-1677.7306"/>
</g>
<!-- section_9 -->
<g id="node10" class="node">
<title>section_9</title>
<ellipse fill="none" stroke="#000000" cx="2248" cy="-1661.0425" rx="70.655" ry="18"/>
<text text-anchor="middle" x="2248" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 27&#45;107</text>
</g>
<!-- section_1&#45;&gt;section_9 -->
<g id="edge9" class="edge">
<title>section_1&#45;&gt;section_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1451.8163,-1727.7773C1605.9836,-1714.8553 2002.6767,-1681.6051 2170.8266,-1667.5111"/>
<polygon fill="#000000" stroke="#000000" points="2171.1689,-1670.9947 2180.8416,-1666.6716 2170.5842,-1664.0192 2171.1689,-1670.9947"/>
</g>
<!-- section_10 -->
<g id="node11" class="node">
<title>section_10</title>
<ellipse fill="none" stroke="#000000" cx="3423" cy="-1661.0425" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="3423" y="-1656.8425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 108&#45;154</text>
</g>
<!-- section_1&#45;&gt;section_10 -->
<g id="edge10" class="edge">
<title>section_1&#45;&gt;section_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1454.3711,-1730.7285C1754.4484,-1720.1063 2999.7468,-1676.0249 3337.9272,-1664.0539"/>
<polygon fill="#000000" stroke="#000000" points="3338.2739,-1667.5439 3348.1438,-1663.6923 3338.0262,-1660.5483 3338.2739,-1667.5439"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="1081.5,-1597.9425 988.5,-1597.9425 988.5,-1561.9425 1081.5,-1561.9425 1081.5,-1597.9425"/>
<text text-anchor="middle" x="1035" y="-1576.4425" font-family="Inconsolata" font-size="14.00" fill="#000000">* Historian</text>
</g>
<!-- header_2&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>header_2&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1035,-1642.6397C1035,-1632.5107 1035,-1619.7224 1035,-1608.3412"/>
<polygon fill="#000000" stroke="#000000" points="1038.5001,-1607.9931 1035,-1597.9931 1031.5001,-1607.9932 1038.5001,-1607.9931"/>
</g>
<!-- raw_12 -->
<g id="node13" class="node">
<title>raw_12</title>
<ellipse fill="none" stroke="#000000" cx="1135" cy="-1579.9425" rx="27" ry="18"/>
<text text-anchor="middle" x="1135" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_12 -->
<g id="edge12" class="edge">
<title>prose_3&#45;&gt;raw_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1141.2245,-1643.0438C1140.2166,-1632.8255 1138.9323,-1619.8059 1137.7924,-1608.25"/>
<polygon fill="#000000" stroke="#000000" points="1141.263,-1607.7794 1136.7982,-1598.1713 1134.2968,-1608.4666 1141.263,-1607.7794"/>
</g>
<!-- raw_14 -->
<g id="node15" class="node">
<title>raw_14</title>
<ellipse fill="none" stroke="#000000" cx="1216" cy="-1579.9425" rx="27" ry="18"/>
<text text-anchor="middle" x="1216" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_14 -->
<g id="edge14" class="edge">
<title>prose_4&#45;&gt;raw_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1223.0026,-1643.0438C1221.8686,-1632.8255 1220.4238,-1619.8059 1219.1414,-1608.25"/>
<polygon fill="#000000" stroke="#000000" points="1222.6046,-1607.7242 1218.0229,-1598.1713 1215.6473,-1608.4964 1222.6046,-1607.7242"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="1297" cy="-1579.9425" rx="27" ry="18"/>
<text text-anchor="middle" x="1297" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_5&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_5&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1304.7807,-1643.0438C1303.5119,-1632.754 1301.8929,-1619.6236 1300.4606,-1608.0078"/>
<polygon fill="#000000" stroke="#000000" points="1303.9107,-1607.3874 1299.2131,-1597.8909 1296.9633,-1608.2441 1303.9107,-1607.3874"/>
</g>
<!-- raw_18 -->
<g id="node19" class="node">
<title>raw_18</title>
<ellipse fill="none" stroke="#000000" cx="1379" cy="-1579.9425" rx="27" ry="18"/>
<text text-anchor="middle" x="1379" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_6&#45;&gt;raw_18 -->
<g id="edge18" class="edge">
<title>prose_6&#45;&gt;raw_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1386.7807,-1643.0438C1385.5119,-1632.754 1383.8929,-1619.6236 1382.4606,-1608.0078"/>
<polygon fill="#000000" stroke="#000000" points="1385.9107,-1607.3874 1381.2131,-1597.8909 1378.9633,-1608.2441 1385.9107,-1607.3874"/>
</g>
<!-- leaf_20 -->
<g id="node21" class="node">
<title>leaf_20</title>
<polygon fill="none" stroke="#c0c0c0" points="1706,-1607.1429 1424,-1607.1429 1424,-1552.742 1706,-1552.742 1706,-1607.1429"/>
<text text-anchor="middle" x="1565" y="-1591.8425" font-family="Inconsolata" font-size="14.00" fill="#000000">local Linebuf = require &quot;linebuf&quot;</text>
<text text-anchor="middle" x="1565" y="-1576.4425" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql &#160;&#160;&#160;&#160;= require &quot;sqlayer&quot;</text>
<text text-anchor="middle" x="1565" y="-1561.0424" font-family="Inconsolata" font-size="14.00" fill="#000000">local format &#160;= assert (string.format)</text>
</g>
<!-- codeblock_7&#45;&gt;leaf_20 -->
<g id="edge20" class="edge">
<title>codeblock_7&#45;&gt;leaf_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1550.2167,-1643.0438C1552.0119,-1635.3812 1554.1762,-1626.1432 1556.2881,-1617.1286"/>
<polygon fill="#000000" stroke="#000000" points="1559.7545,-1617.6762 1558.6279,-1607.1415 1552.939,-1616.0795 1559.7545,-1617.6762"/>
</g>
<!-- leaf_21 -->
<g id="node22" class="node">
<title>leaf_21</title>
<polygon fill="none" stroke="#c0c0c0" points="1915.5,-1597.9425 1724.5,-1597.9425 1724.5,-1561.9425 1915.5,-1561.9425 1915.5,-1597.9425"/>
<text text-anchor="middle" x="1820" y="-1576.4425" font-family="Inconsolata" font-size="14.00" fill="#000000">local Historian = meta {}</text>
</g>
<!-- codeblock_8&#45;&gt;leaf_21 -->
<g id="edge21" class="edge">
<title>codeblock_8&#45;&gt;leaf_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1781.0966,-1643.0438C1787.6536,-1632.4084 1796.0814,-1618.7384 1803.4155,-1606.8426"/>
<polygon fill="#000000" stroke="#000000" points="1806.4928,-1608.5204 1808.7615,-1598.1713 1800.5342,-1604.8468 1806.4928,-1608.5204"/>
</g>
<!-- header_22 -->
<g id="node23" class="node">
<title>header_22</title>
<ellipse fill="none" stroke="#000000" cx="2162" cy="-1579.9425" rx="82.2147" ry="18"/>
<text text-anchor="middle" x="2162" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:load()</text>
</g>
<!-- section_9&#45;&gt;header_22 -->
<g id="edge22" class="edge">
<title>section_9&#45;&gt;header_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2229.3393,-1643.445C2217.2808,-1632.0736 2201.4147,-1617.1115 2188.1122,-1604.5669"/>
<polygon fill="#000000" stroke="#000000" points="2190.3009,-1601.8201 2180.6243,-1597.5056 2185.4983,-1606.9128 2190.3009,-1601.8201"/>
</g>
<!-- prose_23 -->
<g id="node24" class="node">
<title>prose_23</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-1579.9425" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2334" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_9&#45;&gt;prose_23 -->
<g id="edge23" class="edge">
<title>section_9&#45;&gt;prose_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2266.6607,-1643.445C2279.2973,-1631.5284 2296.1155,-1615.6685 2309.7828,-1602.7799"/>
<polygon fill="#000000" stroke="#000000" points="2312.5363,-1604.994 2317.4104,-1595.5869 2307.7338,-1599.9013 2312.5363,-1604.994"/>
</g>
<!-- codeblock_24 -->
<g id="node25" class="node">
<title>codeblock_24</title>
<ellipse fill="none" stroke="#000000" cx="2636" cy="-1579.9425" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="2636" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 32&#45;105</text>
</g>
<!-- section_9&#45;&gt;codeblock_24 -->
<g id="edge24" class="edge">
<title>section_9&#45;&gt;codeblock_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2302.768,-1649.5949C2371.9388,-1635.1367 2491.0215,-1610.246 2566.5231,-1594.4646"/>
<polygon fill="#000000" stroke="#000000" points="2567.3483,-1597.8678 2576.4207,-1592.3958 2565.9161,-1591.0159 2567.3483,-1597.8678"/>
</g>
<!-- header_35 -->
<g id="node36" class="node">
<title>header_35</title>
<ellipse fill="none" stroke="#000000" cx="3162" cy="-1579.9425" rx="82.6821" ry="18"/>
<text text-anchor="middle" x="3162" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : Historian:prev()</text>
</g>
<!-- section_10&#45;&gt;header_35 -->
<g id="edge35" class="edge">
<title>section_10&#45;&gt;header_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3376.9392,-1646.7301C3333.0825,-1633.1026 3266.9282,-1612.5466 3219.604,-1597.8416"/>
<polygon fill="#000000" stroke="#000000" points="3220.3944,-1594.4222 3209.8062,-1594.7972 3218.3172,-1601.1069 3220.3944,-1594.4222"/>
</g>
<!-- prose_36 -->
<g id="node37" class="node">
<title>prose_36</title>
<ellipse fill="none" stroke="#000000" cx="3343" cy="-1579.9425" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3343" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_10&#45;&gt;prose_36 -->
<g id="edge36" class="edge">
<title>section_10&#45;&gt;prose_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3405.6412,-1643.445C3393.963,-1631.6063 3378.4458,-1615.8756 3365.7773,-1603.033"/>
<polygon fill="#000000" stroke="#000000" points="3368.2124,-1600.5177 3358.6981,-1595.8564 3363.229,-1605.4335 3368.2124,-1600.5177"/>
</g>
<!-- codeblock_37 -->
<g id="node38" class="node">
<title>codeblock_37</title>
<ellipse fill="none" stroke="#000000" cx="3492" cy="-1579.9425" rx="86.7905" ry="18"/>
<text text-anchor="middle" x="3492" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 110&#45;127</text>
</g>
<!-- section_10&#45;&gt;codeblock_37 -->
<g id="edge37" class="edge">
<title>section_10&#45;&gt;codeblock_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3438.3133,-1643.0438C3447.6932,-1632.0191 3459.8475,-1617.7334 3470.2187,-1605.5434"/>
<polygon fill="#000000" stroke="#000000" points="3472.9152,-1607.7753 3476.7295,-1597.8909 3467.5837,-1603.2393 3472.9152,-1607.7753"/>
</g>
<!-- section_38 -->
<g id="node39" class="node">
<title>section_38</title>
<ellipse fill="none" stroke="#000000" cx="3885" cy="-1579.9425" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="3885" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 130&#45;154</text>
</g>
<!-- section_10&#45;&gt;section_38 -->
<g id="edge38" class="edge">
<title>section_10&#45;&gt;section_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3483.8735,-1650.3567C3569.1316,-1635.3904 3723.7702,-1608.2449 3814.11,-1592.3866"/>
<polygon fill="#000000" stroke="#000000" points="3814.7475,-1595.8283 3823.9917,-1590.6519 3813.5371,-1588.9337 3814.7475,-1595.8283"/>
</g>
<!-- section_39 -->
<g id="node40" class="node">
<title>section_39</title>
<ellipse fill="none" stroke="#000000" cx="4834" cy="-1579.9425" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="4834" y="-1575.7425" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 155&#45;178</text>
</g>
<!-- section_10&#45;&gt;section_39 -->
<g id="edge39" class="edge">
<title>section_10&#45;&gt;section_39</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3496.8748,-1656.7964C3737.2281,-1642.9816 4496.0598,-1599.3662 4750.1596,-1584.7614"/>
<polygon fill="#000000" stroke="#000000" points="4750.6498,-1588.239 4760.4325,-1584.1709 4750.2481,-1581.2506 4750.6498,-1588.239"/>
</g>
<!-- leaf_13 -->
<g id="node14" class="node">
<title>leaf_13</title>
<polygon fill="none" stroke="#c0c0c0" points="324,-991.9426 0,-991.9426 0,-920.1403 324,-920.1403 324,-991.9426"/>
<text text-anchor="middle" x="162" y="-928.5414" font-family="Inconsolata" font-size="14.00" fill="#000000">This module is responsible for REPL history.</text>
</g>
<!-- raw_12&#45;&gt;leaf_13 -->
<g id="edge13" class="edge">
<title>raw_12&#45;&gt;leaf_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.1517,-1566.397C1109.2573,-1561.1704 1099.5991,-1555.757 1090,-1552.8424 1009.4261,-1528.3775 399.4615,-1568.5488 333,-1516.8424 169.9527,-1389.9932 157.9535,-1111.8039 159.9815,-1001.9609"/>
<polygon fill="#000000" stroke="#000000" points="163.4827,-1001.9462 160.217,-991.8672 156.4846,-1001.7829 163.4827,-1001.9462"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="897.5,-983.3418 342.5,-983.3418 342.5,-928.741 897.5,-928.741 897.5,-983.3418"/>
<text text-anchor="middle" x="620" y="-952.2414" font-family="Inconsolata" font-size="14.00" fill="#000000">Eventually this will include persisting and restoring from a SQLite database,</text>
<text text-anchor="middle" x="620" y="-936.8414" font-family="Inconsolata" font-size="14.00" fill="#000000">fuzzy searching, and variable cacheing.</text>
</g>
<!-- raw_14&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>raw_14&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1197.584,-1566.5247C1189.7501,-1561.4505 1180.2895,-1556.1158 1171,-1552.8424 1059.312,-1513.4862 1003.6086,-1585.3252 907,-1516.8424 721.1015,-1385.0648 647.6953,-1096.3363 626.8077,-993.4072"/>
<polygon fill="#000000" stroke="#000000" points="630.2164,-992.6024 624.839,-983.4737 623.3499,-993.9633 630.2164,-992.6024"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1464,-983.3418 916,-983.3418 916,-928.741 1464,-928.741 1464,-983.3418"/>
<text text-anchor="middle" x="1190" y="-952.2414" font-family="Inconsolata" font-size="14.00" fill="#000000">Currently does the basic job of retaining history and not letting subsequent</text>
<text text-anchor="middle" x="1190" y="-936.8414" font-family="Inconsolata" font-size="14.00" fill="#000000">edits munge it.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1293.9131,-1561.9432C1279.2781,-1476.6088 1216.7484,-1112.0072 1196.4156,-993.4497"/>
<polygon fill="#000000" stroke="#000000" points="1199.8324,-992.6664 1194.6924,-983.402 1192.9332,-993.8497 1199.8324,-992.6664"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="2030,-991.3418 1482,-991.3418 1482,-920.7411 2030,-920.7411 2030,-991.3418"/>
<text text-anchor="middle" x="1756" y="-960.2414" font-family="Inconsolata" font-size="14.00" fill="#000000">Next step: now that we clone a new linebuf each time, we have an immutable</text>
<text text-anchor="middle" x="1756" y="-944.8414" font-family="Inconsolata" font-size="14.00" fill="#000000">record. &#160;We should store the line as a string, to facilitate fuzzy matching.</text>
</g>
<!-- raw_18&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>raw_18&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1396.7139,-1566.1116C1402.467,-1561.7542 1408.9324,-1556.9969 1415,-1552.8424 1440.0338,-1535.7017 1452.5127,-1539.2201 1473,-1516.8424 1620.5258,-1355.7043 1710.4616,-1103.3456 1742.6007,-1001.2079"/>
<polygon fill="#000000" stroke="#000000" points="1745.9882,-1002.1015 1745.6191,-991.5131 1739.3046,-1000.0206 1745.9882,-1002.1015"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="2197.5,-974.0414 2048.5,-974.0414 2048.5,-938.0414 2197.5,-938.0414 2197.5,-974.0414"/>
<text text-anchor="middle" x="2123" y="-952.5414" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:load()</text>
</g>
<!-- header_22&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>header_22&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2160.8749,-1561.9432C2155.393,-1474.2479 2131.475,-1091.6193 2124.7593,-984.1858"/>
<polygon fill="#000000" stroke="#000000" points="2128.2469,-983.8759 2124.1297,-974.1137 2121.2605,-984.3127 2128.2469,-983.8759"/>
</g>
<!-- raw_26 -->
<g id="node27" class="node">
<title>raw_26</title>
<ellipse fill="none" stroke="#000000" cx="2243" cy="-956.0414" rx="27" ry="18"/>
<text text-anchor="middle" x="2243" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_23&#45;&gt;raw_26 -->
<g id="edge26" class="edge">
<title>prose_23&#45;&gt;raw_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2315.6669,-1564.9001C2302.9184,-1553.252 2286.8552,-1535.9246 2279,-1516.8424 2200.7272,-1326.7002 2226.9356,-1069.5289 2238.6425,-984.576"/>
<polygon fill="#000000" stroke="#000000" points="2242.1442,-984.8111 2240.0883,-974.4177 2235.2141,-983.8247 2242.1442,-984.8111"/>
</g>
<!-- prespace_27 -->
<g id="node28" class="node">
<title>prespace_27</title>
<ellipse fill="none" stroke="#000000" cx="2334" cy="-956.0414" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="2334" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_23&#45;&gt;prespace_27 -->
<g id="edge27" class="edge">
<title>prose_23&#45;&gt;prespace_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334,-1561.6082C2334,-1473.2621 2334,-1091.3448 2334,-984.1275"/>
<polygon fill="#000000" stroke="#000000" points="2337.5001,-984.0759 2334,-974.0759 2330.5001,-984.0759 2337.5001,-984.0759"/>
</g>
<!-- literal_28 -->
<g id="node29" class="node">
<title>literal_28</title>
<ellipse fill="none" stroke="#000000" cx="2430" cy="-956.0414" rx="31.481" ry="18"/>
<text text-anchor="middle" x="2430" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_23&#45;&gt;literal_28 -->
<g id="edge28" class="edge">
<title>prose_23&#45;&gt;literal_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2352.2828,-1564.8793C2365.0063,-1553.2208 2381.0602,-1535.8895 2389,-1516.8424 2468.1639,-1326.9337 2444.7684,-1069.6115 2434.0277,-984.5979"/>
<polygon fill="#000000" stroke="#000000" points="2437.4655,-983.8937 2432.698,-974.4321 2430.5247,-984.8016 2437.4655,-983.8937"/>
</g>
<!-- raw_29 -->
<g id="node30" class="node">
<title>raw_29</title>
<ellipse fill="none" stroke="#000000" cx="2506" cy="-956.0414" rx="27" ry="18"/>
<text text-anchor="middle" x="2506" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_23&#45;&gt;raw_29 -->
<g id="edge29" class="edge">
<title>prose_23&#45;&gt;raw_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2365.0212,-1574.936C2397.1541,-1567.9592 2445.9619,-1551.9603 2470,-1516.8424 2529.949,-1429.2613 2514.0011,-1085.4737 2507.8624,-984.2363"/>
<polygon fill="#000000" stroke="#000000" points="2511.3498,-983.923 2507.2346,-974.1601 2504.3633,-984.3584 2511.3498,-983.923"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="3057,-1516.6435 2551,-1516.6435 2551,-395.4393 3057,-395.4393 3057,-1516.6435"/>
<text text-anchor="middle" x="2804" y="-1501.6424" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.HISTORY_LIMIT = 50</text>
<text text-anchor="middle" x="2804" y="-1470.2424" font-family="Inconsolata" font-size="14.00" fill="#000000">local create_repl_table = [[</text>
<text text-anchor="middle" x="2804" y="-1454.8424" font-family="Inconsolata" font-size="14.00" fill="#000000">CREATE TABLE repl (</text>
<text text-anchor="middle" x="2804" y="-1439.4423" font-family="Inconsolata" font-size="14.00" fill="#000000">line_id INTEGER PRIMARY KEY AUTOINCREMENT,</text>
<text text-anchor="middle" x="2804" y="-1424.0423" font-family="Inconsolata" font-size="14.00" fill="#000000">project TEXT,</text>
<text text-anchor="middle" x="2804" y="-1408.6423" font-family="Inconsolata" font-size="14.00" fill="#000000">line TEXT,</text>
<text text-anchor="middle" x="2804" y="-1393.2422" font-family="Inconsolata" font-size="14.00" fill="#000000">time DATETIME DEFAULT CURRENT_TIMESTAMP);</text>
<text text-anchor="middle" x="2804" y="-1377.8422" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1346.4422" font-family="Inconsolata" font-size="14.00" fill="#000000">local insert_line_stmt = [[</text>
<text text-anchor="middle" x="2804" y="-1331.0421" font-family="Inconsolata" font-size="14.00" fill="#000000">INSERT INTO repl (project, line) VALUES(?, ?);</text>
<text text-anchor="middle" x="2804" y="-1315.6421" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1284.2421" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_tables = [[</text>
<text text-anchor="middle" x="2804" y="-1268.842" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;</text>
<text text-anchor="middle" x="2804" y="-1253.442" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1222.042" font-family="Inconsolata" font-size="14.00" fill="#000000">local get_recent = [[</text>
<text text-anchor="middle" x="2804" y="-1206.6419" font-family="Inconsolata" font-size="14.00" fill="#000000">SELECT line FROM repl</text>
<text text-anchor="middle" x="2804" y="-1191.2419" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;WHERE project = %s</text>
<text text-anchor="middle" x="2804" y="-1175.8419" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;ORDER BY time</text>
<text text-anchor="middle" x="2804" y="-1160.4419" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;DESC LIMIT %d;</text>
<text text-anchor="middle" x="2804" y="-1145.0418" font-family="Inconsolata" font-size="14.00" fill="#000000">]]</text>
<text text-anchor="middle" x="2804" y="-1113.6418" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.home_dir = io.popen(&quot;echo $HOME&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-1098.2418" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.project = io.popen(&quot;pwd&quot;, &quot;r&quot;):read(&quot;*a&quot;):sub(1, &#45;2)</text>
<text text-anchor="middle" x="2804" y="-1066.8417" font-family="Inconsolata" font-size="14.00" fill="#000000">local function has(table, name)</text>
<text text-anchor="middle" x="2804" y="-1051.4417" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;for _,v in ipairs(table) do</text>
<text text-anchor="middle" x="2804" y="-1036.0417" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if name == v then</text>
<text text-anchor="middle" x="2804" y="-1020.6416" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-1005.2416" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-989.8416" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-974.4415" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return false</text>
<text text-anchor="middle" x="2804" y="-959.0415" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2804" y="-927.6415" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.load(historian)</text>
<text text-anchor="middle" x="2804" y="-912.2414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local conn = sql.open(historian.home_dir .. &quot;/.bridge&quot;)</text>
<text text-anchor="middle" x="2804" y="-896.8414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.conn = conn</text>
<text text-anchor="middle" x="2804" y="-881.4414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local table_names = conn:exec(get_tables)</text>
<text text-anchor="middle" x="2804" y="-866.0414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not table_names or not has(table_names.name, &quot;repl&quot;) then</text>
<text text-anchor="middle" x="2804" y="-850.6413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local success, err = sql.pexec(conn, create_repl_table)</text>
<text text-anchor="middle" x="2804" y="-835.2413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; success is nil for creation, false for error</text>
<text text-anchor="middle" x="2804" y="-819.8413" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if success == false then</text>
<text text-anchor="middle" x="2804" y="-804.4412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;error(err)</text>
<text text-anchor="middle" x="2804" y="-789.0412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-773.6412" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-758.2411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt = conn:prepare(insert_line_stmt)</text>
<text text-anchor="middle" x="2804" y="-742.8411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local pop_stmt = sql.format(get_recent, historian.project,</text>
<text text-anchor="middle" x="2804" y="-727.4411" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian.HISTORY_LIMIT)</text>
<text text-anchor="middle" x="2804" y="-712.041" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local values, err = sql.pexec(conn, pop_stmt)</text>
<text text-anchor="middle" x="2804" y="-696.641" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if values then</text>
<text text-anchor="middle" x="2804" y="-681.241" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.values = values</text>
<text text-anchor="middle" x="2804" y="-665.8409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;for i,v in ipairs(values[1]) do</text>
<text text-anchor="middle" x="2804" y="-650.4409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;historian[i] = Linebuf(v)</text>
<text text-anchor="middle" x="2804" y="-635.0409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-619.6409" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return values</text>
<text text-anchor="middle" x="2804" y="-604.2408" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-588.8408" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2804" y="-557.4408" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.persist(historian, linebuf)</text>
<text text-anchor="middle" x="2804" y="-542.0407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local lb = tostring(linebuf)</text>
<text text-anchor="middle" x="2804" y="-526.6407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.insert_stmt:bind(historian.project, lb)</text>
<text text-anchor="middle" x="2804" y="-511.2407" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local err = historian.insert_stmt:step()</text>
<text text-anchor="middle" x="2804" y="-495.8406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not err then</text>
<text text-anchor="middle" x="2804" y="-480.4406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;historian.insert_stmt:clearbind():reset()</text>
<text text-anchor="middle" x="2804" y="-465.0406" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="2804" y="-449.6405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;error(error)</text>
<text text-anchor="middle" x="2804" y="-434.2405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2804" y="-418.8405" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="2804" y="-403.4404" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_24&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>codeblock_24&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2640.8467,-1561.9432C2643.252,-1553.0109 2646.4811,-1541.0189 2650.3719,-1526.5695"/>
<polygon fill="#000000" stroke="#000000" points="2653.8017,-1527.2929 2653.0223,-1516.7268 2647.0425,-1525.4728 2653.8017,-1527.2929"/>
</g>
<!-- leaf_30 -->
<g id="node31" class="node">
<title>leaf_30</title>
<polygon fill="none" stroke="#c0c0c0" points="2292,-253.2217 1926,-253.2217 1926,-197.4187 2292,-197.4187 2292,-253.2217"/>
<text text-anchor="middle" x="2109" y="-205.8202" font-family="Inconsolata" font-size="14.00" fill="#000000">This is where we either create query or create our</text>
</g>
<!-- raw_26&#45;&gt;leaf_30 -->
<g id="edge30" class="edge">
<title>raw_26&#45;&gt;leaf_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2244.7217,-937.5989C2250.7997,-866.008 2267.7146,-600.3288 2206,-395.2404 2191.0397,-345.5248 2159.367,-294.6045 2136.2705,-261.6395"/>
<polygon fill="#000000" stroke="#000000" points="2138.9496,-259.3674 2130.3022,-253.2459 2133.2447,-263.4239 2138.9496,-259.3674"/>
</g>
<!-- leaf_31 -->
<g id="node32" class="node">
<title>leaf_31</title>
<polygon fill="none" stroke="#c0c0c0" points="2364,-243.3202 2310,-243.3202 2310,-207.3202 2364,-207.3202 2364,-243.3202"/>
<text text-anchor="middle" x="2337" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000"> </text>
</g>
<!-- prespace_27&#45;&gt;leaf_31 -->
<g id="edge31" class="edge">
<title>prespace_27&#45;&gt;leaf_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2334.0742,-937.9785C2334.4758,-840.1555 2336.3903,-373.8175 2336.8838,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="2340.3846,-253.4202 2336.9257,-243.4058 2333.3846,-253.3913 2340.3846,-253.4202"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2466.5,-243.3202 2387.5,-243.3202 2387.5,-207.3202 2466.5,-207.3202 2466.5,-243.3202"/>
<text text-anchor="middle" x="2427" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000">~/.bridge</text>
</g>
<!-- literal_28&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>literal_28&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2429.9258,-937.9785C2429.5242,-840.1555 2427.6097,-373.8175 2427.1162,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="2430.6154,-253.3913 2427.0743,-243.4058 2423.6154,-253.4202 2430.6154,-253.3913"/>
</g>
<!-- leaf_33 -->
<g id="node34" class="node">
<title>leaf_33</title>
<polygon fill="none" stroke="#c0c0c0" points="2571,-245.2223 2485,-245.2223 2485,-205.4181 2571,-205.4181 2571,-245.2223"/>
<text text-anchor="middle" x="2528" y="-229.8202" font-family="Inconsolata" font-size="14.00" fill="#000000"> database.</text>
</g>
<!-- raw_29&#45;&gt;leaf_33 -->
<g id="edge33" class="edge">
<title>raw_29&#45;&gt;leaf_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2506.5438,-937.9785C2509.4759,-840.5904 2523.4046,-377.9561 2527.0988,-255.2516"/>
<polygon fill="#000000" stroke="#000000" points="2530.6022,-255.1907 2527.4048,-245.0899 2523.6053,-254.98 2530.6022,-255.1907"/>
</g>
<!-- leaf_40 -->
<g id="node41" class="node">
<title>leaf_40</title>
<polygon fill="none" stroke="#c0c0c0" points="3224.5,-974.0414 3075.5,-974.0414 3075.5,-938.0414 3224.5,-938.0414 3224.5,-974.0414"/>
<text text-anchor="middle" x="3150" y="-952.5414" font-family="Inconsolata" font-size="14.00" fill="#000000">** Historian:prev()</text>
</g>
<!-- header_35&#45;&gt;leaf_40 -->
<g id="edge40" class="edge">
<title>header_35&#45;&gt;leaf_40</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3161.6474,-1561.6082C3159.9481,-1473.2621 3152.6024,-1091.3448 3150.5402,-984.1275"/>
<polygon fill="#000000" stroke="#000000" points="3154.0386,-984.0067 3150.3469,-974.0759 3147.0399,-984.1414 3154.0386,-984.0067"/>
</g>
<!-- raw_41 -->
<g id="node42" class="node">
<title>raw_41</title>
<ellipse fill="none" stroke="#000000" cx="3270" cy="-956.0414" rx="27" ry="18"/>
<text text-anchor="middle" x="3270" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_36&#45;&gt;raw_41 -->
<g id="edge41" class="edge">
<title>prose_36&#45;&gt;raw_41</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3330.3012,-1563.2873C3321.7844,-1551.1197 3311.2068,-1533.8419 3306,-1516.8424 3245.8417,-1320.4359 3260.2865,-1067.7599 3267.3123,-984.2256"/>
<polygon fill="#000000" stroke="#000000" points="3270.8204,-984.2846 3268.2063,-974.0173 3263.8471,-983.6738 3270.8204,-984.2846"/>
</g>
<!-- leaf_43 -->
<g id="node44" class="node">
<title>leaf_43</title>
<polygon fill="none" stroke="#c0c0c0" points="3717.4016,-1089.8818 3314.5984,-1089.8818 3314.5984,-822.201 3717.4016,-822.201 3717.4016,-1089.8818"/>
<text text-anchor="middle" x="3516" y="-1074.7616" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.prev(historian)</text>
<text text-anchor="middle" x="3516" y="-1059.3616" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="3516" y="-1043.9615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="3516" y="-1028.5615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3516" y="-1013.1615" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local Δ = historian.cursor &gt; 1 and 1 or 0</text>
<text text-anchor="middle" x="3516" y="-994.4015" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf</text>
<text text-anchor="middle" x="3516" y="-979.0014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.up then</text>
<text text-anchor="middle" x="3516" y="-963.6014" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf = historian[historian.cursor + Δ]:clone()</text>
<text text-anchor="middle" x="3516" y="-944.8414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="3516" y="-929.4414" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf = historian[historian.cursor &#45; Δ]:clone()</text>
<text text-anchor="middle" x="3516" y="-910.6814" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="3516" y="-895.2813" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor &#45; Δ</text>
<text text-anchor="middle" x="3516" y="-876.5213" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="3516" y="-861.1213" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.up = true</text>
<text text-anchor="middle" x="3516" y="-845.7213" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="3516" y="-830.3213" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_37&#45;&gt;leaf_43 -->
<g id="edge43" class="edge">
<title>codeblock_37&#45;&gt;leaf_43</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3492.7053,-1561.6082C3495.2926,-1494.3485 3504.4254,-1256.9324 3510.4576,-1100.1198"/>
<polygon fill="#000000" stroke="#000000" points="3513.9633,-1100.0372 3510.8504,-1089.91 3506.9685,-1099.7681 3513.9633,-1100.0372"/>
</g>
<!-- header_44 -->
<g id="node45" class="node">
<title>header_44</title>
<ellipse fill="none" stroke="#000000" cx="3818" cy="-956.0414" rx="82.2061" ry="18"/>
<text text-anchor="middle" x="3818" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:next()</text>
</g>
<!-- section_38&#45;&gt;header_44 -->
<g id="edge44" class="edge">
<title>section_38&#45;&gt;header_44</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3883.0671,-1561.9432C3873.6496,-1474.2479 3832.5596,-1091.6193 3821.0224,-984.1858"/>
<polygon fill="#000000" stroke="#000000" points="3824.4886,-983.6828 3819.9408,-974.1137 3817.5286,-984.4303 3824.4886,-983.6828"/>
</g>
<!-- prose_45 -->
<g id="node46" class="node">
<title>prose_45</title>
<ellipse fill="none" stroke="#000000" cx="3951" cy="-956.0414" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="3951" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_38&#45;&gt;prose_45 -->
<g id="edge45" class="edge">
<title>section_38&#45;&gt;prose_45</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3893.4741,-1561.8745C3898.8819,-1549.485 3905.5099,-1532.5156 3909,-1516.8424 3953.5788,-1316.6477 3953.2774,-1067.3886 3951.7342,-984.3888"/>
<polygon fill="#000000" stroke="#000000" points="3955.2303,-984.1591 3951.5228,-974.2342 3948.2318,-984.3049 3955.2303,-984.1591"/>
</g>
<!-- codeblock_46 -->
<g id="node47" class="node">
<title>codeblock_46</title>
<ellipse fill="none" stroke="#000000" cx="4181" cy="-956.0414" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4181" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 135&#45;152</text>
</g>
<!-- section_38&#45;&gt;codeblock_46 -->
<g id="edge46" class="edge">
<title>section_38&#45;&gt;codeblock_46</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3925.1952,-1564.5928C3947.6509,-1554.1787 3974.5421,-1538.3643 3992,-1516.8424 4129.6244,-1347.1814 4169.0172,-1072.4719 4178.4145,-984.2647"/>
<polygon fill="#000000" stroke="#000000" points="4181.9059,-984.5256 4179.4387,-974.222 4174.9421,-983.8153 4181.9059,-984.5256"/>
</g>
<!-- header_57 -->
<g id="node58" class="node">
<title>header_57</title>
<ellipse fill="none" stroke="#000000" cx="4584" cy="-956.0414" rx="95.2951" ry="18"/>
<text text-anchor="middle" x="4584" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">3 : Historian:append()</text>
</g>
<!-- section_39&#45;&gt;header_57 -->
<g id="edge57" class="edge">
<title>section_39&#45;&gt;header_57</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4788.1156,-1565.6179C4763.5496,-1555.682 4734.7728,-1540.0031 4717,-1516.8424 4587.4736,-1348.0497 4581.3599,-1072.7661 4583.0058,-984.3394"/>
<polygon fill="#000000" stroke="#000000" points="4586.5064,-984.3513 4583.2438,-974.2713 4579.5084,-984.1858 4586.5064,-984.3513"/>
</g>
<!-- prose_58 -->
<g id="node59" class="node">
<title>prose_58</title>
<ellipse fill="none" stroke="#000000" cx="4758" cy="-956.0414" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="4758" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_39&#45;&gt;prose_58 -->
<g id="edge58" class="edge">
<title>section_39&#45;&gt;prose_58</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4827.2097,-1561.9825C4822.7626,-1549.4976 4817.2009,-1532.3749 4814,-1516.8424 4772.5138,-1315.5302 4761.4054,-1066.9876 4758.7548,-984.2809"/>
<polygon fill="#000000" stroke="#000000" points="4762.2495,-984.0519 4758.4469,-974.163 4755.2528,-984.2648 4762.2495,-984.0519"/>
</g>
<!-- codeblock_59 -->
<g id="node60" class="node">
<title>codeblock_59</title>
<ellipse fill="none" stroke="#000000" cx="4910" cy="-956.0414" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="4910" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 157&#45;164</text>
</g>
<!-- section_39&#45;&gt;codeblock_59 -->
<g id="edge59" class="edge">
<title>section_39&#45;&gt;codeblock_59</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4836.1926,-1561.9432C4846.8751,-1474.2479 4893.4847,-1091.6193 4906.5716,-984.1858"/>
<polygon fill="#000000" stroke="#000000" points="4910.0636,-984.4636 4907.7985,-974.1137 4903.1149,-983.6171 4910.0636,-984.4636"/>
</g>
<!-- codeblock_60 -->
<g id="node61" class="node">
<title>codeblock_60</title>
<ellipse fill="none" stroke="#000000" cx="5173" cy="-956.0414" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5173" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 166&#45;174</text>
</g>
<!-- section_39&#45;&gt;codeblock_60 -->
<g id="edge60" class="edge">
<title>section_39&#45;&gt;codeblock_60</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4899.0903,-1570.6447C4935.1204,-1562.2871 4978.1204,-1546.5121 5006,-1516.8424 5154.4168,-1358.8962 5171.4432,-1074.7051 5172.9971,-984.3983"/>
<polygon fill="#000000" stroke="#000000" points="5176.4999,-984.1745 5173.1191,-974.1336 5169.5004,-984.0912 5176.4999,-984.1745"/>
</g>
<!-- codeblock_61 -->
<g id="node62" class="node">
<title>codeblock_61</title>
<ellipse fill="none" stroke="#000000" cx="5395" cy="-956.0414" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="5395" y="-951.8414" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 176&#45;178</text>
</g>
<!-- section_39&#45;&gt;codeblock_61 -->
<g id="edge61" class="edge">
<title>section_39&#45;&gt;codeblock_61</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4905.5964,-1573.9853C5022.1904,-1563.6372 5242.7869,-1541.1121 5269,-1516.8424 5426.0688,-1371.4186 5408.3816,-1075.9596 5398.5216,-984.0025"/>
<polygon fill="#000000" stroke="#000000" points="5401.9988,-983.6027 5397.3986,-974.0586 5395.043,-984.3883 5401.9988,-983.6027"/>
</g>
<!-- leaf_42 -->
<g id="node43" class="node">
<title>leaf_42</title>
<polygon fill="none" stroke="#c0c0c0" points="3297,-243.3202 3243,-243.3202 3243,-207.3202 3297,-207.3202 3297,-243.3202"/>
</g>
<!-- raw_41&#45;&gt;leaf_42 -->
<g id="edge42" class="edge">
<title>raw_41&#45;&gt;leaf_42</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3270,-937.9785C3270,-840.1555 3270,-373.8175 3270,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="3273.5001,-253.4058 3270,-243.4058 3266.5001,-253.4059 3273.5001,-253.4058"/>
</g>
<!-- leaf_47 -->
<g id="node48" class="node">
<title>leaf_47</title>
<polygon fill="none" stroke="#c0c0c0" points="3719,-243.3202 3563,-243.3202 3563,-207.3202 3719,-207.3202 3719,-243.3202"/>
<text text-anchor="middle" x="3641" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:next()</text>
</g>
<!-- header_44&#45;&gt;leaf_47 -->
<g id="edge47" class="edge">
<title>header_44&#45;&gt;leaf_47</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3816.9921,-937.6562C3812.6639,-866.2759 3792.7285,-601.2685 3726,-395.2404 3708.7944,-342.117 3677.174,-284.9472 3657.7275,-252.3135"/>
<polygon fill="#000000" stroke="#000000" points="3660.5107,-250.151 3652.3501,-243.3942 3654.5159,-253.7653 3660.5107,-250.151"/>
</g>
<!-- raw_48 -->
<g id="node49" class="node">
<title>raw_48</title>
<ellipse fill="none" stroke="#000000" cx="3764" cy="-225.3202" rx="27" ry="18"/>
<text text-anchor="middle" x="3764" y="-221.1202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_45&#45;&gt;raw_48 -->
<g id="edge48" class="edge">
<title>prose_45&#45;&gt;raw_48</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3956.0362,-938.0307C3976.0327,-862.3374 4042.4519,-566.0328 3909,-395.2404 3877.5879,-355.0391 3835.0441,-396.3184 3800,-359.2404 3772.8996,-330.5671 3765.7432,-283.7264 3764.1021,-253.727"/>
<polygon fill="#000000" stroke="#000000" points="3767.5911,-253.3639 3763.7203,-243.5015 3760.596,-253.6251 3767.5911,-253.3639"/>
</g>
<!-- prespace_49 -->
<g id="node50" class="node">
<title>prespace_49</title>
<ellipse fill="none" stroke="#000000" cx="3855" cy="-225.3202" rx="46.4736" ry="18"/>
<text text-anchor="middle" x="3855" y="-221.1202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prespace</text>
</g>
<!-- prose_45&#45;&gt;prespace_49 -->
<g id="edge49" class="edge">
<title>prose_45&#45;&gt;prespace_49</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3951.1661,-937.9229C3951.4922,-867.5226 3949.7321,-605.6405 3909,-395.2404 3899.0298,-343.7395 3878.5956,-285.9608 3865.9207,-252.7851"/>
<polygon fill="#000000" stroke="#000000" points="3869.1288,-251.3768 3862.2564,-243.3132 3862.6003,-253.9025 3869.1288,-251.3768"/>
</g>
<!-- literal_50 -->
<g id="node51" class="node">
<title>literal_50</title>
<ellipse fill="none" stroke="#000000" cx="3951" cy="-225.3202" rx="31.481" ry="18"/>
<text text-anchor="middle" x="3951" y="-221.1202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">literal</text>
</g>
<!-- prose_45&#45;&gt;literal_50 -->
<g id="edge50" class="edge">
<title>prose_45&#45;&gt;literal_50</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3951,-937.9785C3951,-840.1555 3951,-373.8175 3951,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="3954.5001,-253.4058 3951,-243.4058 3947.5001,-253.4059 3954.5001,-253.4058"/>
</g>
<!-- raw_51 -->
<g id="node52" class="node">
<title>raw_51</title>
<ellipse fill="none" stroke="#000000" cx="4027" cy="-225.3202" rx="27" ry="18"/>
<text text-anchor="middle" x="4027" y="-221.1202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_45&#45;&gt;raw_51 -->
<g id="edge51" class="edge">
<title>prose_45&#45;&gt;raw_51</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3952.8787,-937.9785C3963.0529,-840.1555 4011.5553,-373.8175 4024.0558,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="4027.5656,-253.7143 4025.119,-243.4058 4020.6032,-252.9901 4027.5656,-253.7143"/>
</g>
<!-- leaf_56 -->
<g id="node57" class="node">
<title>leaf_56</title>
<polygon fill="none" stroke="#c0c0c0" points="4474.4016,-359.1607 4071.5984,-359.1607 4071.5984,-91.4798 4474.4016,-91.4798 4474.4016,-359.1607"/>
<text text-anchor="middle" x="4273" y="-344.0404" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.next(historian)</text>
<text text-anchor="middle" x="4273" y="-328.6404" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local Δ = historian.cursor &lt; #historian and 1 or 0</text>
<text text-anchor="middle" x="4273" y="-309.8804" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if historian.cursor == 0 then</text>
<text text-anchor="middle" x="4273" y="-294.4804" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return Linebuf()</text>
<text text-anchor="middle" x="4273" y="-279.0803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4273" y="-263.6803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local linebuf</text>
<text text-anchor="middle" x="4273" y="-248.2803" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not historian.up then</text>
<text text-anchor="middle" x="4273" y="-232.8802" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf = historian[historian.cursor &#45; Δ]:clone()</text>
<text text-anchor="middle" x="4273" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="4273" y="-198.7202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;linebuf = historian[historian.cursor + Δ]:clone()</text>
<text text-anchor="middle" x="4273" y="-179.9602" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="4273" y="-164.5602" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = historian.cursor + Δ</text>
<text text-anchor="middle" x="4273" y="-145.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;linebuf.cursor = #linebuf.line + 1</text>
<text text-anchor="middle" x="4273" y="-130.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.up = false</text>
<text text-anchor="middle" x="4273" y="-115.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return linebuf</text>
<text text-anchor="middle" x="4273" y="-99.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_46&#45;&gt;leaf_56 -->
<g id="edge56" class="edge">
<title>codeblock_46&#45;&gt;leaf_56</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4183.2742,-937.9785C4192.9876,-860.8283 4231.5602,-554.4607 4254.8526,-369.4584"/>
<polygon fill="#000000" stroke="#000000" points="4258.3458,-369.7312 4256.1224,-359.3723 4251.4006,-368.8568 4258.3458,-369.7312"/>
</g>
<!-- leaf_52 -->
<g id="node53" class="node">
<title>leaf_52</title>
<polygon fill="none" stroke="#c0c0c0" points="3811,-55.6015 3333,-55.6015 3333,.2015 3811,.2015 3811,-55.6015"/>
<text text-anchor="middle" x="3572" y="-8.2" font-family="Inconsolata" font-size="14.00" fill="#000000">Returns the next linebuf in history, and a second flag to tell the</text>
</g>
<!-- raw_48&#45;&gt;leaf_52 -->
<g id="edge52" class="edge">
<title>raw_48&#45;&gt;leaf_52</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3763.9975,-206.9217C3763.0184,-178.6764 3757.1461,-124.4397 3728,-91.4 3716.7565,-78.6545 3702.5817,-68.4133 3687.3852,-60.1961"/>
<polygon fill="#000000" stroke="#000000" points="3688.8337,-57.006 3678.3341,-55.5881 3685.6578,-63.2442 3688.8337,-57.006"/>
</g>
<!-- leaf_53 -->
<g id="node54" class="node">
<title>leaf_53</title>
<polygon fill="none" stroke="#c0c0c0" points="3883,-45.7 3829,-45.7 3829,-9.7 3883,-9.7 3883,-45.7"/>
</g>
<!-- prespace_49&#45;&gt;leaf_53 -->
<g id="edge53" class="edge">
<title>prespace_49&#45;&gt;leaf_53</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3855.0923,-207.0828C3855.2672,-172.5236 3855.6479,-97.2764 3855.8564,-56.071"/>
<polygon fill="#000000" stroke="#000000" points="3859.3572,-55.911 3855.9079,-45.8933 3852.3573,-55.8755 3859.3572,-55.911"/>
</g>
<!-- leaf_54 -->
<g id="node55" class="node">
<title>leaf_54</title>
<polygon fill="none" stroke="#c0c0c0" points="4001,-45.7 3901,-45.7 3901,-9.7 4001,-9.7 4001,-45.7"/>
<text text-anchor="middle" x="3951" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000">modeselektor</text>
</g>
<!-- literal_50&#45;&gt;leaf_54 -->
<g id="edge54" class="edge">
<title>literal_50&#45;&gt;leaf_54</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M3951,-207.0828C3951,-172.5236 3951,-97.2764 3951,-56.071"/>
<polygon fill="#000000" stroke="#000000" points="3954.5001,-55.8933 3951,-45.8933 3947.5001,-55.8934 3954.5001,-55.8933"/>
</g>
<!-- leaf_55 -->
<g id="node56" class="node">
<title>leaf_55</title>
<polygon fill="none" stroke="#c0c0c0" points="4259,-45.7 4019,-45.7 4019,-9.7 4259,-9.7 4259,-45.7"/>
<text text-anchor="middle" x="4139" y="-24.2" font-family="Inconsolata" font-size="14.00" fill="#000000"> it might be time for a new one.</text>
</g>
<!-- raw_51&#45;&gt;leaf_55 -->
<g id="edge55" class="edge">
<title>raw_51&#45;&gt;leaf_55</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4028.4239,-207.0311C4031.2702,-179.8709 4039.5613,-128.1362 4063,-91.4 4072.739,-76.1358 4087.3032,-62.6622 4101.0841,-52.0843"/>
<polygon fill="#000000" stroke="#000000" points="4103.533,-54.6278 4109.5133,-45.8822 4099.3844,-48.9896 4103.533,-54.6278"/>
</g>
<!-- leaf_62 -->
<g id="node63" class="node">
<title>leaf_62</title>
<polygon fill="none" stroke="#c0c0c0" points="4662,-243.3202 4492,-243.3202 4492,-207.3202 4662,-207.3202 4662,-243.3202"/>
<text text-anchor="middle" x="4577" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000">*** Historian:append()</text>
</g>
<!-- header_57&#45;&gt;leaf_62 -->
<g id="edge62" class="edge">
<title>header_57&#45;&gt;leaf_62</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4583.827,-937.9785C4582.8899,-840.1555 4578.4225,-373.8175 4577.2712,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="4580.769,-253.3718 4577.1733,-243.4058 4573.7693,-253.4389 4580.769,-253.3718"/>
</g>
<!-- raw_63 -->
<g id="node64" class="node">
<title>raw_63</title>
<ellipse fill="none" stroke="#000000" cx="4707" cy="-225.3202" rx="27" ry="18"/>
<text text-anchor="middle" x="4707" y="-221.1202" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_58&#45;&gt;raw_63 -->
<g id="edge63" class="edge">
<title>prose_58&#45;&gt;raw_63</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4756.7393,-937.9785C4749.9119,-840.1555 4717.3642,-373.8175 4708.9757,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="4712.4501,-253.1379 4708.2623,-243.4058 4705.4671,-253.6253 4712.4501,-253.1379"/>
</g>
<!-- leaf_65 -->
<g id="node66" class="node">
<title>leaf_65</title>
<polygon fill="none" stroke="#c0c0c0" points="5083.5,-275.7212 4752.5,-275.7212 4752.5,-174.9192 5083.5,-174.9192 5083.5,-275.7212"/>
<text text-anchor="middle" x="4918" y="-260.3203" font-family="Inconsolata" font-size="14.00" fill="#000000">function Historian.append(historian, linebuf)</text>
<text text-anchor="middle" x="4918" y="-244.9203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian[#historian + 1] = linebuf</text>
<text text-anchor="middle" x="4918" y="-229.5203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="4918" y="-214.1202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:persist(linebuf)</text>
<text text-anchor="middle" x="4918" y="-198.7202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return true</text>
<text text-anchor="middle" x="4918" y="-183.3202" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_59&#45;&gt;leaf_65 -->
<g id="edge65" class="edge">
<title>codeblock_59&#45;&gt;leaf_65</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4910.1978,-937.9785C4911.1892,-847.4239 4915.6378,-441.082 4917.3372,-285.8587"/>
<polygon fill="#000000" stroke="#000000" points="4920.8402,-285.6014 4917.4499,-275.5636 4913.8406,-285.5247 4920.8402,-285.6014"/>
</g>
<!-- leaf_66 -->
<g id="node67" class="node">
<title>leaf_66</title>
<polygon fill="none" stroke="#c0c0c0" points="5370,-283.1206 5102,-283.1206 5102,-167.5198 5370,-167.5198 5370,-283.1206"/>
<text text-anchor="middle" x="5236" y="-268.0203" font-family="Inconsolata" font-size="14.00" fill="#000000">local function new(linebuf)</text>
<text text-anchor="middle" x="5236" y="-252.6203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local historian = meta(Historian)</text>
<text text-anchor="middle" x="5236" y="-237.2203" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian:load()</text>
<text text-anchor="middle" x="5236" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;historian.cursor = #historian</text>
<text text-anchor="middle" x="5236" y="-206.4202" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return historian</text>
<text text-anchor="middle" x="5236" y="-191.0202" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="5236" y="-175.6201" font-family="Inconsolata" font-size="14.00" fill="#000000">Historian.idEst = new</text>
</g>
<!-- codeblock_60&#45;&gt;leaf_66 -->
<g id="edge66" class="edge">
<title>codeblock_60&#45;&gt;leaf_66</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5174.5573,-937.9785C5182.238,-848.8926 5216.2686,-454.1796 5230.1126,-293.607"/>
<polygon fill="#000000" stroke="#000000" points="5233.6228,-293.6384 5230.9948,-283.3747 5226.6486,-293.0371 5233.6228,-293.6384"/>
</g>
<!-- leaf_67 -->
<g id="node68" class="node">
<title>leaf_67</title>
<polygon fill="none" stroke="#c0c0c0" points="5474,-243.3202 5388,-243.3202 5388,-207.3202 5474,-207.3202 5474,-243.3202"/>
<text text-anchor="middle" x="5431" y="-221.8202" font-family="Inconsolata" font-size="14.00" fill="#000000">return new</text>
</g>
<!-- codeblock_61&#45;&gt;leaf_67 -->
<g id="edge67" class="edge">
<title>codeblock_61&#45;&gt;leaf_67</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M5395.8899,-937.9785C5400.7093,-840.1555 5423.6841,-373.8175 5429.6054,-253.6284"/>
<polygon fill="#000000" stroke="#000000" points="5433.1126,-253.566 5430.109,-243.4058 5426.1211,-253.2215 5433.1126,-253.566"/>
</g>
<!-- leaf_64 -->
<g id="node65" class="node">
<title>leaf_64</title>
<polygon fill="none" stroke="#c0c0c0" points="4734,-45.7 4680,-45.7 4680,-9.7 4734,-9.7 4734,-45.7"/>
</g>
<!-- raw_63&#45;&gt;leaf_64 -->
<g id="edge64" class="edge">
<title>raw_63&#45;&gt;leaf_64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M4707,-207.0828C4707,-172.5236 4707,-97.2764 4707,-56.071"/>
<polygon fill="#000000" stroke="#000000" points="4710.5001,-55.8933 4707,-45.8933 4703.5001,-55.8934 4710.5001,-55.8933"/>
</g>
</g>
</svg>
