<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="1450pt" height="4775pt"
 viewBox="0.00 0.00 1450.00 4774.63" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4770.6336)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-4770.6336 1446,-4770.6336 1446,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="512.5" cy="-4748.6336" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="512.5" y="-4744.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 293</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="512.5" cy="-4676.6336" rx="55.6456" ry="18"/>
<text text-anchor="middle" x="512.5" y="-4672.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;7</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.5,-4730.465C512.5,-4722.7646 512.5,-4713.608 512.5,-4705.0503"/>
<polygon fill="#000000" stroke="#000000" points="516.0001,-4705.0469 512.5,-4695.0469 509.0001,-4705.0469 516.0001,-4705.0469"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="373.5" cy="-4604.6336" rx="47.4168" ry="18"/>
<text text-anchor="middle" x="373.5" y="-4600.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Femto</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M482.681,-4661.1878C461.6476,-4650.2928 433.3222,-4635.6207 410.7936,-4623.9512"/>
<polygon fill="#000000" stroke="#000000" points="412.3354,-4620.8082 401.8461,-4619.3165 409.1157,-4627.0238 412.3354,-4620.8082"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="471.5" cy="-4604.6336" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="471.5" y="-4600.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.3652,-4658.8359C497.5632,-4650.4031 491.7315,-4640.1622 486.4358,-4630.8624"/>
<polygon fill="#000000" stroke="#000000" points="489.3667,-4628.9361 481.3768,-4621.9782 483.2838,-4632.4 489.3667,-4628.9361"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="553.5" cy="-4604.6336" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="553.5" y="-4600.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.6348,-4658.8359C527.4368,-4650.4031 533.2685,-4640.1622 538.5642,-4630.8624"/>
<polygon fill="#000000" stroke="#000000" points="541.7162,-4632.4 543.6232,-4621.9782 535.6333,-4628.9361 541.7162,-4632.4"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="762.5" cy="-4604.6336" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="762.5" y="-4600.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 8&#45;293</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M554.3444,-4664.5824C596.3023,-4652.4986 661.1367,-4633.8263 707.2903,-4620.534"/>
<polygon fill="#000000" stroke="#000000" points="708.491,-4623.8306 717.1318,-4617.6997 706.5537,-4617.104 708.491,-4623.8306"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="409.5,-4550.6336 337.5,-4550.6336 337.5,-4514.6336 409.5,-4514.6336 409.5,-4550.6336"/>
<text text-anchor="middle" x="373.5" y="-4529.1336" font-family="Inconsolata" font-size="14.00" fill="#000000">* &#160;Femto</text>
</g>
<!-- header_2&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>header_2&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.5,-4586.465C373.5,-4578.7646 373.5,-4569.608 373.5,-4561.0503"/>
<polygon fill="#000000" stroke="#000000" points="377.0001,-4561.0469 373.5,-4551.0469 370.0001,-4561.0469 377.0001,-4561.0469"/>
</g>
<!-- raw_7 -->
<g id="node8" class="node">
<title>raw_7</title>
<ellipse fill="none" stroke="#000000" cx="462.5" cy="-4532.6336" rx="27" ry="18"/>
<text text-anchor="middle" x="462.5" y="-4528.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;raw_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M469.2289,-4586.465C468.2664,-4578.7646 467.1218,-4569.608 466.0521,-4561.0503"/>
<polygon fill="#000000" stroke="#000000" points="469.5151,-4560.5355 464.8017,-4551.0469 462.5691,-4561.4038 469.5151,-4560.5355"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="553.5" cy="-4532.6336" rx="27" ry="18"/>
<text text-anchor="middle" x="553.5" y="-4528.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-4586.465C553.5,-4578.7646 553.5,-4569.608 553.5,-4561.0503"/>
<polygon fill="#000000" stroke="#000000" points="557.0001,-4561.0469 553.5,-4551.0469 550.0001,-4561.0469 557.0001,-4561.0469"/>
</g>
<!-- header_11 -->
<g id="node12" class="node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="710.5" cy="-4532.6336" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="710.5" y="-4528.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : includes</text>
</g>
<!-- section_5&#45;&gt;header_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M749.6461,-4586.8359C743.4749,-4578.2912 735.963,-4567.89 729.176,-4558.4926"/>
<polygon fill="#000000" stroke="#000000" points="731.8984,-4556.2842 723.2061,-4550.2267 726.2236,-4560.3827 731.8984,-4556.2842"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="815.5" cy="-4532.6336" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="815.5" y="-4528.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.6011,-4586.8359C781.9848,-4578.1637 789.7762,-4567.5791 796.7741,-4558.0725"/>
<polygon fill="#000000" stroke="#000000" points="799.805,-4559.8591 802.9145,-4549.7308 794.1676,-4555.7094 799.805,-4559.8591"/>
</g>
<!-- codeblock_13 -->
<g id="node14" class="node">
<title>codeblock_13</title>
<ellipse fill="none" stroke="#000000" cx="1050.5" cy="-4532.6336" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1050.5" y="-4528.4336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;293</text>
</g>
<!-- section_5&#45;&gt;codeblock_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;codeblock_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M811.0296,-4592.5012C859.1469,-4580.4719 933.1484,-4561.9715 986.1484,-4548.7215"/>
<polygon fill="#000000" stroke="#000000" points="987.269,-4552.0492 996.1215,-4546.2282 985.5712,-4545.2582 987.269,-4552.0492"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-2311.218 0,-2311.218 0,-2239.4157 443,-2239.4157 443,-2311.218"/>
<text text-anchor="middle" x="221.5" y="-2247.8168" font-family="Inconsolata" font-size="14.00" fill="#000000">I just got orb stood up in the pylon bootloader distribution.</text>
</g>
<!-- raw_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>raw_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M458.8115,-4514.6922C456.7487,-4504.2117 454.2487,-4490.7117 452.5,-4478.6336 327.5254,-3615.4584 242.7036,-2552.6705 224.9602,-2321.1868"/>
<polygon fill="#000000" stroke="#000000" points="228.4417,-2320.8105 224.1897,-2311.1064 221.4621,-2321.3441 228.4417,-2320.8105"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="645.5,-2295.2189 461.5,-2295.2189 461.5,-2255.4147 645.5,-2255.4147 645.5,-2295.2189"/>
<text text-anchor="middle" x="553.5" y="-2263.8168" font-family="Inconsolata" font-size="14.00" fill="#000000">I am excited about this.</text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-4514.4635C553.5,-4316.1951 553.5,-2557.2299 553.5,-2305.3061"/>
<polygon fill="#000000" stroke="#000000" points="557.0001,-2305.0799 553.5,-2295.0799 550.0001,-2305.08 557.0001,-2305.0799"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="763.5,-2293.3168 663.5,-2293.3168 663.5,-2257.3168 763.5,-2257.3168 763.5,-2293.3168"/>
<text text-anchor="middle" x="713.5" y="-2271.8168" font-family="Inconsolata" font-size="14.00" fill="#000000">** &#160;includes</text>
</g>
<!-- header_11&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>header_11&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M710.5241,-4514.4635C710.7882,-4315.7797 713.1351,-2549.8524 713.4622,-2303.7425"/>
<polygon fill="#000000" stroke="#000000" points="716.9625,-2303.4878 713.4759,-2293.4831 709.9625,-2303.4784 716.9625,-2303.4878"/>
</g>
<!-- raw_15 -->
<g id="node16" class="node">
<title>raw_15</title>
<ellipse fill="none" stroke="#000000" cx="813.5" cy="-2275.3168" rx="27" ry="18"/>
<text text-anchor="middle" x="813.5" y="-2271.1168" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_12&#45;&gt;raw_15 -->
<g id="edge15" class="edge">
<title>prose_12&#45;&gt;raw_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M815.4839,-4514.4635C815.3079,-4315.7797 813.7432,-2549.8524 813.5252,-2303.7425"/>
<polygon fill="#000000" stroke="#000000" points="817.0251,-2303.4799 813.5161,-2293.4831 810.0251,-2303.4862 817.0251,-2303.4799"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1442,-4478.4505 859,-4478.4505 859,-72.1832 1442,-72.1832 1442,-4478.4505"/>
<text text-anchor="middle" x="1150.5" y="-4463.4336" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql = require &quot;sqlite&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4432.0336" font-family="Inconsolata" font-size="14.00" fill="#000000">local lfs = require &quot;lfs&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4416.6336" font-family="Inconsolata" font-size="14.00" fill="#000000">local ffi = require &quot;ffi&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4385.2335" font-family="Inconsolata" font-size="14.00" fill="#000000">local femto = assert(femto)</text>
<text text-anchor="middle" x="1150.5" y="-4353.8335" font-family="Inconsolata" font-size="14.00" fill="#000000">local uv = require &quot;luv&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4322.4335" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4291.0334" font-family="Inconsolata" font-size="14.00" fill="#000000">local a = require &quot;src/anterm&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4259.6334" font-family="Inconsolata" font-size="14.00" fill="#000000">local c = require &quot;src/color&quot;</text>
<text text-anchor="middle" x="1150.5" y="-4228.2334" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;**** utils</text>
<text text-anchor="middle" x="1150.5" y="-4212.8333" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;</text>
<text text-anchor="middle" x="1150.5" y="-4197.4333" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;Copypasta from luvland from here down</text>
<text text-anchor="middle" x="1150.5" y="-4166.0333" font-family="Inconsolata" font-size="14.00" fill="#000000">local usecolors</text>
<text text-anchor="middle" x="1150.5" y="-4150.6333" font-family="Inconsolata" font-size="14.00" fill="#000000">local stdout</text>
<text text-anchor="middle" x="1150.5" y="-4119.2332" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(1) == &quot;tty&quot; then</text>
<text text-anchor="middle" x="1150.5" y="-4103.8332" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;stdout = uv.new_tty(1, false)</text>
<text text-anchor="middle" x="1150.5" y="-4088.4332" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = true</text>
<text text-anchor="middle" x="1150.5" y="-4073.0331" font-family="Inconsolata" font-size="14.00" fill="#000000">else</text>
<text text-anchor="middle" x="1150.5" y="-4057.6331" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;utils.stdout = uv.new_pipe(false)</text>
<text text-anchor="middle" x="1150.5" y="-4042.2331" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.pipe_open(utils.stdout, 1)</text>
<text text-anchor="middle" x="1150.5" y="-4026.833" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = false</text>
<text text-anchor="middle" x="1150.5" y="-4011.433" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-3980.033" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Print replacement that goes through libuv. &#160;This is useful on windows</text>
<text text-anchor="middle" x="1150.5" y="-3964.6329" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; to use libuv&#39;s code to translate ansi escape codes to windows API calls.</text>
<text text-anchor="middle" x="1150.5" y="-3949.2329" font-family="Inconsolata" font-size="14.00" fill="#000000">local function print(...)</text>
<text text-anchor="middle" x="1150.5" y="-3933.8329" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1150.5" y="-3918.4328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local arguments = {...}</text>
<text text-anchor="middle" x="1150.5" y="-3903.0328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, n do</text>
<text text-anchor="middle" x="1150.5" y="-3887.6328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;arguments[i] = tostring(arguments[i])</text>
<text text-anchor="middle" x="1150.5" y="-3872.2328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-3856.8327" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, table.concat(arguments, &quot;\t&quot;) .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-3841.4327" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-3810.0327" font-family="Inconsolata" font-size="14.00" fill="#000000">local function write(str)</text>
<text text-anchor="middle" x="1150.5" y="-3794.6326" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.write(stdout, str)</text>
<text text-anchor="middle" x="1150.5" y="-3779.2326" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-3731.8326" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** tty setup</text>
<text text-anchor="middle" x="1150.5" y="-3700.4325" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(0) ~= &quot;tty&quot; or</text>
<text text-anchor="middle" x="1150.5" y="-3685.0325" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.guess_handle(1) ~= &quot;tty&quot; then</text>
<text text-anchor="middle" x="1150.5" y="-3669.6325" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; Entry point for other consumers!</text>
<text text-anchor="middle" x="1150.5" y="-3654.2324" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;error &quot;stdio must be a tty&quot;</text>
<text text-anchor="middle" x="1150.5" y="-3638.8324" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-3607.4324" font-family="Inconsolata" font-size="14.00" fill="#000000">local stdin = uv.new_tty(0, true)</text>
<text text-anchor="middle" x="1150.5" y="-3576.0323" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; **** colorizer</text>
<text text-anchor="middle" x="1150.5" y="-3544.6323" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; This will be the first thing to go</text>
<text text-anchor="middle" x="1150.5" y="-3513.2323" font-family="Inconsolata" font-size="14.00" fill="#000000">local colors = {</text>
<text text-anchor="middle" x="1150.5" y="-3497.8323" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;black &#160;&#160;= &quot;0;30&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3482.4322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;red &#160;&#160;&#160;&#160;= &quot;0;31&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3467.0322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;green &#160;&#160;= &quot;0;32&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3451.6322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;yellow &#160;= &quot;0;33&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3436.2321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;blue &#160;&#160;&#160;= &quot;0;34&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3420.8321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;magenta = &quot;0;35&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3405.4321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;cyan &#160;&#160;&#160;= &quot;0;36&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3390.032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;white &#160;&#160;= &quot;0;37&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3374.632" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;B &#160;&#160;&#160;&#160;&#160;&#160;&#160;= &quot;1;&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3359.232" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bblack &#160;&#160;= &quot;1;30&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3343.8319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bred &#160;&#160;&#160;&#160;= &quot;1;31&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3328.4319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bgreen &#160;&#160;= &quot;1;32&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3313.0319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Byellow &#160;= &quot;1;33&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3297.6318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bblue &#160;&#160;&#160;= &quot;1;34&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3282.2318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bmagenta = &quot;1;35&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3266.8318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bcyan &#160;&#160;&#160;= &quot;1;36&quot;,</text>
<text text-anchor="middle" x="1150.5" y="-3251.4318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bwhite &#160;&#160;= &quot;1;37&quot;</text>
<text text-anchor="middle" x="1150.5" y="-3236.0317" font-family="Inconsolata" font-size="14.00" fill="#000000">}</text>
<text text-anchor="middle" x="1150.5" y="-3204.6317" font-family="Inconsolata" font-size="14.00" fill="#000000">local function color(color_name)</text>
<text text-anchor="middle" x="1150.5" y="-3189.2317" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if usecolors then</text>
<text text-anchor="middle" x="1150.5" y="-3173.8316" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;\27[&quot; .. (colors[color_name] or &quot;0&quot;) .. &quot;m&quot;</text>
<text text-anchor="middle" x="1150.5" y="-3158.4316" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1150.5" y="-3143.0316" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1150.5" y="-3127.6315" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-3112.2315" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-3080.8315" font-family="Inconsolata" font-size="14.00" fill="#000000">local function colorize(color_name, string, reset_name)</text>
<text text-anchor="middle" x="1150.5" y="-3065.4314" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return color(color_name) .. tostring(string) .. color(reset_name)</text>
<text text-anchor="middle" x="1150.5" y="-3050.0314" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-3018.6314" font-family="Inconsolata" font-size="14.00" fill="#000000">local backslash, null, newline, carriage, tab, quote, quote2, obracket, cbracket</text>
<text text-anchor="middle" x="1150.5" y="-2987.2313" font-family="Inconsolata" font-size="14.00" fill="#000000">local function loadColors(n)</text>
<text text-anchor="middle" x="1150.5" y="-2971.8313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if n ~= nil then usecolors = n end</text>
<text text-anchor="middle" x="1150.5" y="-2956.4313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;backslash = colorize(&quot;Bgreen&quot;, &quot;\\\\&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2941.0313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;null &#160;&#160;&#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &quot;\\0&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2925.6312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;newline &#160;&#160;= colorize(&quot;Bgreen&quot;, &quot;\\n&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2910.2312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;carriage &#160;= colorize(&quot;Bgreen&quot;, &quot;\\r&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2894.8312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;tab &#160;&#160;&#160;&#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &quot;\\t&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2879.4311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;quote &#160;&#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &#39;&quot;&#39;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2864.0311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;quote2 &#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &#39;&quot;&#39;)</text>
<text text-anchor="middle" x="1150.5" y="-2848.6311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;obracket &#160;= colorize(&quot;B&quot;, &#39;[&#39;)</text>
<text text-anchor="middle" x="1150.5" y="-2833.231" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;cbracket &#160;= colorize(&quot;B&quot;, &#39;]&#39;)</text>
<text text-anchor="middle" x="1150.5" y="-2817.831" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-2786.431" font-family="Inconsolata" font-size="14.00" fill="#000000">loadColors()</text>
<text text-anchor="middle" x="1150.5" y="-2755.0309" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = string.gsub</text>
<text text-anchor="middle" x="1150.5" y="-2723.6309" font-family="Inconsolata" font-size="14.00" fill="#000000">local function dump(o, depth)</text>
<text text-anchor="middle" x="1150.5" y="-2708.2309" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local t = type(o)</text>
<text text-anchor="middle" x="1150.5" y="-2692.8308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;string&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2677.4308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return quote .. o:gsub(&quot;\\&quot;, backslash)</text>
<text text-anchor="middle" x="1150.5" y="-2662.0308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;%z&quot;, null)</text>
<text text-anchor="middle" x="1150.5" y="-2646.6308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;\n&quot;, newline)</text>
<text text-anchor="middle" x="1150.5" y="-2631.2307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;\r&quot;, carriage)</text>
<text text-anchor="middle" x="1150.5" y="-2615.8307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;\t&quot;, tab) .. quote2</text>
<text text-anchor="middle" x="1150.5" y="-2600.4307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2585.0306" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;nil&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2569.6306" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;Bblack&quot;, &quot;nil&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-2554.2306" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2538.8305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;boolean&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2523.4305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;yellow&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2508.0305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2492.6304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;number&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2477.2304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;blue&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2461.8304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2446.4303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;userdata&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2431.0303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;magenta&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2415.6303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2400.2303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;thread&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2384.8302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;Bred&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2369.4302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2354.0302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;function&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2338.6301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;cyan&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2323.2301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2307.8301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;cdata&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2292.43" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;Bmagenta&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2277.03" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2261.63" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;table&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2246.2299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if type(depth) == &#39;nil&#39; then</text>
<text text-anchor="middle" x="1150.5" y="-2230.8299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;depth = 0</text>
<text text-anchor="middle" x="1150.5" y="-2215.4299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2200.0298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if depth &gt; 1 then</text>
<text text-anchor="middle" x="1150.5" y="-2184.6298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return colorize(&quot;yellow&quot;, tostring(o))</text>
<text text-anchor="middle" x="1150.5" y="-2169.2298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2153.8298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local indent = (&quot; &#160;&quot;):rep(depth)</text>
<text text-anchor="middle" x="1150.5" y="-2138.4297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Check to see if this is an array</text>
<text text-anchor="middle" x="1150.5" y="-2123.0297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local is_array = true</text>
<text text-anchor="middle" x="1150.5" y="-2107.6297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local i = 1</text>
<text text-anchor="middle" x="1150.5" y="-2092.2296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for k,v in pairs(o) do</text>
<text text-anchor="middle" x="1150.5" y="-2076.8296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not (k == i) then</text>
<text text-anchor="middle" x="1150.5" y="-2061.4296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;is_array = false</text>
<text text-anchor="middle" x="1150.5" y="-2046.0295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-2030.6295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;i = i + 1</text>
<text text-anchor="middle" x="1150.5" y="-2015.2295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1983.8294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local first = true</text>
<text text-anchor="middle" x="1150.5" y="-1968.4294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local lines = {}</text>
<text text-anchor="middle" x="1150.5" y="-1953.0294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;i = 1</text>
<text text-anchor="middle" x="1150.5" y="-1937.6294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local estimated = 0</text>
<text text-anchor="middle" x="1150.5" y="-1922.2293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for k,v in (is_array and ipairs or pairs)(o) do</text>
<text text-anchor="middle" x="1150.5" y="-1906.8293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local s</text>
<text text-anchor="middle" x="1150.5" y="-1891.4293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if is_array then</text>
<text text-anchor="middle" x="1150.5" y="-1876.0292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s = &quot;&quot;</text>
<text text-anchor="middle" x="1150.5" y="-1860.6292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1150.5" y="-1845.2292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if type(k) == &quot;string&quot; and k:find(&quot;^[%a_][%a%d_]*$&quot;) then</text>
<text text-anchor="middle" x="1150.5" y="-1829.8291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s = k .. &#39; = &#39;</text>
<text text-anchor="middle" x="1150.5" y="-1814.4291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1150.5" y="-1799.0291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s = &#39;[&#39; .. dump(k, 100) .. &#39;] = &#39;</text>
<text text-anchor="middle" x="1150.5" y="-1783.629" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1768.229" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1752.829" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;s = s .. dump(v, depth + 1)</text>
<text text-anchor="middle" x="1150.5" y="-1737.4289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lines[i] = s</text>
<text text-anchor="middle" x="1150.5" y="-1722.0289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;estimated = estimated + #s</text>
<text text-anchor="middle" x="1150.5" y="-1706.6289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;i = i + 1</text>
<text text-anchor="middle" x="1150.5" y="-1691.2289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1675.8288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if estimated &gt; 200 then</text>
<text text-anchor="middle" x="1150.5" y="-1660.4288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &quot;{\n &#160;&quot; .. indent</text>
<text text-anchor="middle" x="1150.5" y="-1645.0288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. table.concat(lines, &quot;,\n &#160;&quot; .. indent)</text>
<text text-anchor="middle" x="1150.5" y="-1629.6287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.. &quot;\n&quot; .. indent .. &quot;}&quot;</text>
<text text-anchor="middle" x="1150.5" y="-1614.2287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1150.5" y="-1598.8287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &quot;{ &quot; .. table.concat(lines, &quot;, &quot;) .. &quot; }&quot;</text>
<text text-anchor="middle" x="1150.5" y="-1583.4286" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1568.0286" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1552.6286" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-1521.2285" font-family="Inconsolata" font-size="14.00" fill="#000000">local clr = color</text>
<text text-anchor="middle" x="1150.5" y="-1473.8285" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** utilities</text>
<text text-anchor="middle" x="1150.5" y="-1442.4285" font-family="Inconsolata" font-size="14.00" fill="#000000">local function gatherResults(success, ...)</text>
<text text-anchor="middle" x="1150.5" y="-1427.0284" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1150.5" y="-1411.6284" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return success, { n = n, ... }</text>
<text text-anchor="middle" x="1150.5" y="-1396.2284" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-1364.8284" font-family="Inconsolata" font-size="14.00" fill="#000000">local function printResults(results)</text>
<text text-anchor="middle" x="1150.5" y="-1349.4283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="1150.5" y="-1334.0283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;results[i] = c.ts(results[i])</text>
<text text-anchor="middle" x="1150.5" y="-1318.6283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1303.2282" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;print(table.concat(results, &#39;\t&#39;))</text>
<text text-anchor="middle" x="1150.5" y="-1287.8282" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-1256.4282" font-family="Inconsolata" font-size="14.00" fill="#000000">local buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1150.5" y="-1225.0281" font-family="Inconsolata" font-size="14.00" fill="#000000">local function evaluateLine(line)</text>
<text text-anchor="middle" x="1150.5" y="-1209.6281" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line == &quot;&lt;3\n&quot; then</text>
<text text-anchor="middle" x="1150.5" y="-1194.2281" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;print(&quot;I &quot; .. clr(&quot;Bred&quot;) .. &quot;♥&quot; .. clr() .. &quot; you too!&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-1177.0879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &#39;&gt;&#39;</text>
<text text-anchor="middle" x="1150.5" y="-1161.6879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1146.2879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local chunk &#160;= buffer .. line</text>
<text text-anchor="middle" x="1150.5" y="-1130.8878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local f, err = loadstring(&#39;return &#39; .. chunk, &#39;REPL&#39;) &#45;&#45; first we prefix return</text>
<text text-anchor="middle" x="1150.5" y="-1099.4878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if not f then</text>
<text text-anchor="middle" x="1150.5" y="-1084.0878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;f, err = loadstring(chunk, &#39;REPL&#39;) &#45;&#45; try again without return</text>
<text text-anchor="middle" x="1150.5" y="-1068.6878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-1037.2877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if f then</text>
<text text-anchor="middle" x="1150.5" y="-1021.8877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1150.5" y="-1006.4877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local success, results = gatherResults(xpcall(f, debug.traceback))</text>
<text text-anchor="middle" x="1150.5" y="-975.0876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if success then</text>
<text text-anchor="middle" x="1150.5" y="-959.6876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; successful call</text>
<text text-anchor="middle" x="1150.5" y="-944.2876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if results.n &gt; 0 then</text>
<text text-anchor="middle" x="1150.5" y="-928.8875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;printResults(results)</text>
<text text-anchor="middle" x="1150.5" y="-913.4875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-898.0875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1150.5" y="-882.6874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; error</text>
<text text-anchor="middle" x="1150.5" y="-867.2874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;print(results[1])</text>
<text text-anchor="middle" x="1150.5" y="-851.8874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-836.4873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1150.5" y="-805.0873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if err:match &quot;&#39;&lt;eof&gt;&#39;$&quot; then</text>
<text text-anchor="middle" x="1150.5" y="-789.6873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Lua expects some more input; stow it away for next time</text>
<text text-anchor="middle" x="1150.5" y="-774.2873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = chunk .. &#39;\n&#39;</text>
<text text-anchor="middle" x="1150.5" y="-758.8872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &#39;...&#39;</text>
<text text-anchor="middle" x="1150.5" y="-743.4872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1150.5" y="-728.0872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;print(err)</text>
<text text-anchor="middle" x="1150.5" y="-712.6871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1150.5" y="-697.2871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1150.5" y="-681.8871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-650.487" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return &#39;👉 &#39;</text>
<text text-anchor="middle" x="1150.5" y="-626.2583" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-594.8583" font-family="Inconsolata" font-size="14.00" fill="#000000">local function displayPrompt(prompt)</text>
<text text-anchor="middle" x="1150.5" y="-579.4582" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, prompt)</text>
<text text-anchor="middle" x="1150.5" y="-564.0582" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-532.6582" font-family="Inconsolata" font-size="14.00" fill="#000000">local function onread(err, line)</text>
<text text-anchor="middle" x="1150.5" y="-517.2581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if err then error(err) end</text>
<text text-anchor="middle" x="1150.5" y="-501.8581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line then</text>
<text text-anchor="middle" x="1150.5" y="-486.4581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prompt = evaluateLine(line)</text>
<text text-anchor="middle" x="1150.5" y="-471.058" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;displayPrompt(prompt)</text>
<text text-anchor="middle" x="1150.5" y="-455.658" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1150.5" y="-440.258" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;uv.close(stdin)</text>
<text text-anchor="middle" x="1150.5" y="-424.8579" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1150.5" y="-409.4579" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1150.5" y="-378.0579" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Alternate screen</text>
<text text-anchor="middle" x="1150.5" y="-346.6578" font-family="Inconsolata" font-size="14.00" fill="#000000">coroutine.wrap(function()</text>
<text text-anchor="middle" x="1150.5" y="-331.2578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This switches screens and does a wipe,</text>
<text text-anchor="middle" x="1150.5" y="-315.8578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; then puts the cursor at 1,1.</text>
<text text-anchor="middle" x="1150.5" y="-300.4578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;write &#39;\27[?47h\27[2J\27[H&#39;</text>
<text text-anchor="middle" x="1150.5" y="-285.0577" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;print &quot;an repl, plz reply uwu 👀&quot;</text>
<text text-anchor="middle" x="1150.5" y="-260.829" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;displayPrompt &#39;👉 &#39;</text>
<text text-anchor="middle" x="1150.5" y="-236.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.read_start(stdin, onread)</text>
<text text-anchor="middle" x="1150.5" y="-221.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end)()</text>
<text text-anchor="middle" x="1150.5" y="-189.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">uv.run(&#39;default&#39;)</text>
<text text-anchor="middle" x="1150.5" y="-158.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Restore</text>
<text text-anchor="middle" x="1150.5" y="-127.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">print &#39;\27[?47l&#39;</text>
<text text-anchor="middle" x="1150.5" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">print(&quot;kthxbye&quot;)</text>
<text text-anchor="middle" x="1150.5" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return 0</text>
</g>
<!-- codeblock_13&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>codeblock_13&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1051.3049,-4514.4635C1051.6074,-4507.6352 1051.9919,-4498.9558 1052.4529,-4488.5505"/>
<polygon fill="#000000" stroke="#000000" points="1055.9515,-4488.6583 1052.8976,-4478.5131 1048.9583,-4488.3484 1055.9515,-4488.6583"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="840.5,-36 786.5,-36 786.5,0 840.5,0 840.5,-36"/>
</g>
<!-- raw_15&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_15&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M813.5,-2257.1467C813.5,-2058.4629 813.5,-292.5355 813.5,-46.4257"/>
<polygon fill="#000000" stroke="#000000" points="817.0001,-46.1662 813.5,-36.1663 810.0001,-46.1663 817.0001,-46.1662"/>
</g>
</g>
</svg>
