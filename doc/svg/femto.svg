<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="1854pt" height="2827pt"
 viewBox="0.00 0.00 1854.00 2827.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2823.2298)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2823.2298 1850,-2823.2298 1850,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="512.5" cy="-2801.2298" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="512.5" y="-2797.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 174</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="512.5" cy="-2729.2298" rx="55.6456" ry="18"/>
<text text-anchor="middle" x="512.5" y="-2725.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;8</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.5,-2783.0612C512.5,-2775.3608 512.5,-2766.2042 512.5,-2757.6465"/>
<polygon fill="#000000" stroke="#000000" points="516.0001,-2757.6431 512.5,-2747.6431 509.0001,-2757.6432 516.0001,-2757.6431"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="373.5" cy="-2657.2298" rx="47.4168" ry="18"/>
<text text-anchor="middle" x="373.5" y="-2653.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Femto</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M482.681,-2713.784C461.6476,-2702.8891 433.3222,-2688.2169 410.7936,-2676.5474"/>
<polygon fill="#000000" stroke="#000000" points="412.3354,-2673.4044 401.8461,-2671.9127 409.1157,-2679.62 412.3354,-2673.4044"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="471.5" cy="-2657.2298" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="471.5" y="-2653.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.3652,-2711.4321C497.5632,-2702.9994 491.7315,-2692.7584 486.4358,-2683.4586"/>
<polygon fill="#000000" stroke="#000000" points="489.3667,-2681.5323 481.3768,-2674.5744 483.2838,-2684.9962 489.3667,-2681.5323"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="553.5" cy="-2657.2298" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="553.5" y="-2653.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.6348,-2711.4321C527.4368,-2702.9994 533.2685,-2692.7584 538.5642,-2683.4586"/>
<polygon fill="#000000" stroke="#000000" points="541.7162,-2684.9962 543.6232,-2674.5744 535.6333,-2681.5323 541.7162,-2684.9962"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="818.5" cy="-2657.2298" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="818.5" y="-2653.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 9&#45;31</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.6514,-2718.606C611.6346,-2705.9041 702.0633,-2684.6267 760.9962,-2670.7602"/>
<polygon fill="#000000" stroke="#000000" points="761.9623,-2674.1285 770.8948,-2668.4311 760.359,-2667.3146 761.9623,-2674.1285"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="409.5,-2603.2298 337.5,-2603.2298 337.5,-2567.2298 409.5,-2567.2298 409.5,-2603.2298"/>
<text text-anchor="middle" x="373.5" y="-2581.7299" font-family="Inconsolata" font-size="14.00" fill="#000000">* &#160;Femto</text>
</g>
<!-- header_2&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>header_2&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.5,-2639.0612C373.5,-2631.3608 373.5,-2622.2042 373.5,-2613.6465"/>
<polygon fill="#000000" stroke="#000000" points="377.0001,-2613.6431 373.5,-2603.6431 370.0001,-2613.6432 377.0001,-2613.6431"/>
</g>
<!-- raw_7 -->
<g id="node8" class="node">
<title>raw_7</title>
<ellipse fill="none" stroke="#000000" cx="462.5" cy="-2585.2298" rx="27" ry="18"/>
<text text-anchor="middle" x="462.5" y="-2581.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;raw_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M469.2289,-2639.0612C468.2664,-2631.3608 467.1218,-2622.2042 466.0521,-2613.6465"/>
<polygon fill="#000000" stroke="#000000" points="469.5151,-2613.1317 464.8017,-2603.6431 462.5691,-2614 469.5151,-2613.1317"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="553.5" cy="-2585.2298" rx="27" ry="18"/>
<text text-anchor="middle" x="553.5" y="-2581.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-2639.0612C553.5,-2631.3608 553.5,-2622.2042 553.5,-2613.6465"/>
<polygon fill="#000000" stroke="#000000" points="557.0001,-2613.6431 553.5,-2603.6431 550.0001,-2613.6432 557.0001,-2613.6431"/>
</g>
<!-- header_11 -->
<g id="node12" class="node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="713.5" cy="-2585.2298" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="713.5" y="-2581.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : includes</text>
</g>
<!-- section_5&#45;&gt;header_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M794.147,-2640.5306C779.7322,-2630.6462 761.2981,-2618.0057 745.6936,-2607.3054"/>
<polygon fill="#000000" stroke="#000000" points="747.5856,-2604.359 737.3589,-2601.5903 743.6269,-2610.1322 747.5856,-2604.359"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="818.5" cy="-2585.2298" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="818.5" y="-2581.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M818.5,-2639.0612C818.5,-2631.3608 818.5,-2622.2042 818.5,-2613.6465"/>
<polygon fill="#000000" stroke="#000000" points="822.0001,-2613.6431 818.5,-2603.6431 815.0001,-2613.6432 822.0001,-2613.6431"/>
</g>
<!-- codeblock_13 -->
<g id="node14" class="node">
<title>codeblock_13</title>
<ellipse fill="none" stroke="#000000" cx="959.5" cy="-2585.2298" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="959.5" y="-2581.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 14&#45;29</text>
</g>
<!-- section_5&#45;&gt;codeblock_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;codeblock_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M849.0949,-2641.6069C869.2221,-2631.3292 895.8194,-2617.7476 917.8651,-2606.4902"/>
<polygon fill="#000000" stroke="#000000" points="919.6881,-2609.4893 927.0024,-2601.8244 916.5046,-2603.2551 919.6881,-2609.4893"/>
</g>
<!-- section_14 -->
<g id="node15" class="node">
<title>section_14</title>
<ellipse fill="none" stroke="#000000" cx="1133.5" cy="-2585.2298" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1133.5" y="-2581.0298" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 32&#45;174</text>
</g>
<!-- section_5&#45;&gt;section_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;section_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M866.6846,-2646.2162C921.3444,-2633.7226 1010.6655,-2613.3063 1070.7337,-2599.5764"/>
<polygon fill="#000000" stroke="#000000" points="1071.884,-2602.9039 1080.8527,-2597.2635 1070.3242,-2596.0798 1071.884,-2602.9039"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-2453.5309 0,-2453.5309 0,-2381.7286 443,-2381.7286 443,-2453.5309"/>
<text text-anchor="middle" x="221.5" y="-2390.1297" font-family="Inconsolata" font-size="14.00" fill="#000000">I just got orb stood up in the pylon bootloader distribution.</text>
</g>
<!-- raw_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>raw_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M443.5891,-2572.0785C409.1466,-2548.1259 334.8413,-2496.4514 281.6646,-2459.4704"/>
<polygon fill="#000000" stroke="#000000" points="283.529,-2456.5038 273.3208,-2453.6678 279.5324,-2462.2507 283.529,-2456.5038"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="645.5,-2445.5312 461.5,-2445.5312 461.5,-2389.7282 645.5,-2389.7282 645.5,-2445.5312"/>
<text text-anchor="middle" x="553.5" y="-2414.1297" font-family="Inconsolata" font-size="14.00" fill="#000000">I am excited about this.</text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-2566.9747C553.5,-2540.4488 553.5,-2490.6283 553.5,-2455.8548"/>
<polygon fill="#000000" stroke="#000000" points="557.0001,-2455.5886 553.5,-2445.5886 550.0001,-2455.5886 557.0001,-2455.5886"/>
</g>
<!-- leaf_15 -->
<g id="node16" class="node">
<title>leaf_15</title>
<polygon fill="none" stroke="#c0c0c0" points="763.5,-2435.6297 663.5,-2435.6297 663.5,-2399.6297 763.5,-2399.6297 763.5,-2435.6297"/>
<text text-anchor="middle" x="713.5" y="-2414.1297" font-family="Inconsolata" font-size="14.00" fill="#000000">** &#160;includes</text>
</g>
<!-- header_11&#45;&gt;leaf_15 -->
<g id="edge15" class="edge">
<title>header_11&#45;&gt;leaf_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M713.5,-2566.9747C713.5,-2537.8837 713.5,-2480.7751 713.5,-2446.2237"/>
<polygon fill="#000000" stroke="#000000" points="717.0001,-2445.8624 713.5,-2435.8624 710.0001,-2445.8625 717.0001,-2445.8624"/>
</g>
<!-- raw_16 -->
<g id="node17" class="node">
<title>raw_16</title>
<ellipse fill="none" stroke="#000000" cx="808.5" cy="-2417.6297" rx="27" ry="18"/>
<text text-anchor="middle" x="808.5" y="-2413.4297" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_12&#45;&gt;raw_16 -->
<g id="edge16" class="edge">
<title>prose_12&#45;&gt;raw_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M817.4108,-2566.9747C815.6751,-2537.8837 812.2676,-2480.7751 810.2061,-2446.2237"/>
<polygon fill="#000000" stroke="#000000" points="813.6773,-2445.6362 809.5879,-2435.8624 806.6898,-2446.0532 813.6773,-2445.6362"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1073,-2531.3301 854,-2531.3301 854,-2303.9294 1073,-2303.9294 1073,-2531.3301"/>
<text text-anchor="middle" x="963.5" y="-2516.0298" font-family="Inconsolata" font-size="14.00" fill="#000000">sql = require &quot;sqlite&quot;</text>
<text text-anchor="middle" x="963.5" y="-2484.6298" font-family="Inconsolata" font-size="14.00" fill="#000000">lfs = require &quot;lfs&quot;</text>
<text text-anchor="middle" x="963.5" y="-2469.2298" font-family="Inconsolata" font-size="14.00" fill="#000000">ffi = require &quot;ffi&quot;</text>
<text text-anchor="middle" x="963.5" y="-2437.8298" font-family="Inconsolata" font-size="14.00" fill="#000000">uv = require &quot;luv&quot;</text>
<text text-anchor="middle" x="963.5" y="-2406.4297" font-family="Inconsolata" font-size="14.00" fill="#000000">L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="963.5" y="-2375.0297" font-family="Inconsolata" font-size="14.00" fill="#000000">a = require &quot;src/anterm&quot;</text>
<text text-anchor="middle" x="963.5" y="-2343.6297" font-family="Inconsolata" font-size="14.00" fill="#000000">c = require &quot;src/color&quot;</text>
<text text-anchor="middle" x="963.5" y="-2312.2296" font-family="Inconsolata" font-size="14.00" fill="#000000">watch = require &quot;src/watcher&quot;</text>
</g>
<!-- codeblock_13&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>codeblock_13&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M959.9357,-2566.9747C960.1058,-2559.8481 960.316,-2551.04 960.5486,-2541.2941"/>
<polygon fill="#000000" stroke="#000000" points="964.0483,-2541.3438 960.788,-2531.2631 957.0503,-2541.1767 964.0483,-2541.3438"/>
</g>
<!-- header_19 -->
<g id="node20" class="node">
<title>header_19</title>
<ellipse fill="none" stroke="#000000" cx="1129.5" cy="-2417.6297" rx="38.2457" ry="18"/>
<text text-anchor="middle" x="1129.5" y="-2413.4297" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : utils</text>
</g>
<!-- section_14&#45;&gt;header_19 -->
<g id="edge19" class="edge">
<title>section_14&#45;&gt;header_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1133.0643,-2566.9747C1132.37,-2537.8837 1131.007,-2480.7751 1130.1824,-2446.2237"/>
<polygon fill="#000000" stroke="#000000" points="1133.6728,-2445.776 1129.9351,-2435.8624 1126.6748,-2445.9431 1133.6728,-2445.776"/>
</g>
<!-- prose_20 -->
<g id="node21" class="node">
<title>prose_20</title>
<ellipse fill="none" stroke="#000000" cx="1217.5" cy="-2417.6297" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1217.5" y="-2413.4297" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_14&#45;&gt;prose_20 -->
<g id="edge20" class="edge">
<title>section_14&#45;&gt;prose_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1150.2272,-2567.3124C1158.9379,-2557.2782 1169.253,-2544.2034 1176.5,-2531.2298 1191.9094,-2503.6442 1203.3845,-2469.1702 1210.2175,-2445.477"/>
<polygon fill="#000000" stroke="#000000" points="1213.6223,-2446.2972 1212.9437,-2435.7241 1206.8807,-2444.4127 1213.6223,-2446.2972"/>
</g>
<!-- codeblock_21 -->
<g id="node22" class="node">
<title>codeblock_21</title>
<ellipse fill="none" stroke="#000000" cx="1452.5" cy="-2417.6297" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1452.5" y="-2413.4297" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 34&#45;174</text>
</g>
<!-- section_14&#45;&gt;codeblock_21 -->
<g id="edge21" class="edge">
<title>section_14&#45;&gt;codeblock_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1171.7965,-2570.1056C1196.8244,-2559.8764 1230.0288,-2545.6479 1258.5,-2531.2298 1315.3957,-2502.4173 1378.6969,-2464.1046 1417.0469,-2440.1577"/>
<polygon fill="#000000" stroke="#000000" points="1419.1592,-2442.9645 1425.7731,-2434.6876 1415.4412,-2437.0335 1419.1592,-2442.9645"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1068.5,-1205.3151 520.5,-1205.3151 520.5,-1134.7145 1068.5,-1134.7145 1068.5,-1205.3151"/>
<text text-anchor="middle" x="794.5" y="-1158.2148" font-family="Inconsolata" font-size="14.00" fill="#000000">This all goes into global space for now. &#160;Our more sophisticated loader will</text>
<text text-anchor="middle" x="794.5" y="-1142.8148" font-family="Inconsolata" font-size="14.00" fill="#000000">handle namespace isolation. Meanwhile we&#39;re building a repl, so.</text>
</g>
<!-- raw_16&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>raw_16&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M808.2967,-2399.5121C806.7879,-2265.0564 797.3276,-1421.9936 795.0113,-1215.5834"/>
<polygon fill="#000000" stroke="#000000" points="798.5092,-1215.3614 794.8971,-1205.4013 791.5096,-1215.44 798.5092,-1215.3614"/>
</g>
<!-- leaf_22 -->
<g id="node23" class="node">
<title>leaf_22</title>
<polygon fill="none" stroke="#c0c0c0" points="1172.5,-1188.0148 1086.5,-1188.0148 1086.5,-1152.0148 1172.5,-1152.0148 1172.5,-1188.0148"/>
<text text-anchor="middle" x="1129.5" y="-1166.5148" font-family="Inconsolata" font-size="14.00" fill="#000000">**** utils</text>
</g>
<!-- header_19&#45;&gt;leaf_22 -->
<g id="edge22" class="edge">
<title>header_19&#45;&gt;leaf_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1129.5,-2399.5121C1129.5,-2260.9661 1129.5,-1370.0431 1129.5,-1198.5509"/>
<polygon fill="#000000" stroke="#000000" points="1133.0001,-1198.311 1129.5,-1188.311 1126.0001,-1198.311 1133.0001,-1198.311"/>
</g>
<!-- raw_23 -->
<g id="node24" class="node">
<title>raw_23</title>
<ellipse fill="none" stroke="#000000" cx="1217.5" cy="-1170.0148" rx="27" ry="18"/>
<text text-anchor="middle" x="1217.5" y="-1165.8148" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_20&#45;&gt;raw_23 -->
<g id="edge23" class="edge">
<title>prose_20&#45;&gt;raw_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1217.5,-2399.5121C1217.5,-2260.9661 1217.5,-1370.0431 1217.5,-1198.5509"/>
<polygon fill="#000000" stroke="#000000" points="1221.0001,-1198.311 1217.5,-1188.311 1214.0001,-1198.311 1221.0001,-1198.311"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1846,-2268.0444 1263,-2268.0444 1263,-71.9852 1846,-71.9852 1846,-2268.0444"/>
<text text-anchor="middle" x="1554.5" y="-2236.8296" font-family="Inconsolata" font-size="14.00" fill="#000000">local usecolors</text>
<text text-anchor="middle" x="1554.5" y="-2221.4296" font-family="Inconsolata" font-size="14.00" fill="#000000">stdout = &quot;&quot;</text>
<text text-anchor="middle" x="1554.5" y="-2190.0295" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(1) == &quot;tty&quot; then</text>
<text text-anchor="middle" x="1554.5" y="-2174.6295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;stdout = uv.new_tty(1, false)</text>
<text text-anchor="middle" x="1554.5" y="-2159.2295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = true</text>
<text text-anchor="middle" x="1554.5" y="-2143.8294" font-family="Inconsolata" font-size="14.00" fill="#000000">else</text>
<text text-anchor="middle" x="1554.5" y="-2128.4294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;stdout = uv.new_pipe(false)</text>
<text text-anchor="middle" x="1554.5" y="-2113.0294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.pipe_open(utils.stdout, 1)</text>
<text text-anchor="middle" x="1554.5" y="-2097.6294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = false</text>
<text text-anchor="middle" x="1554.5" y="-2082.2293" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-2050.8293" font-family="Inconsolata" font-size="14.00" fill="#000000">if not usecolors then</text>
<text text-anchor="middle" x="1554.5" y="-2035.4293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;c.ts = tostring</text>
<text text-anchor="middle" x="1554.5" y="-2020.0292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; #todo make this properly black and white ts</text>
<text text-anchor="middle" x="1554.5" y="-2004.6292" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-1973.2292" font-family="Inconsolata" font-size="14.00" fill="#000000">function print(...)</text>
<text text-anchor="middle" x="1554.5" y="-1957.8291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1554.5" y="-1942.4291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local arguments = {...}</text>
<text text-anchor="middle" x="1554.5" y="-1927.0291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, n do</text>
<text text-anchor="middle" x="1554.5" y="-1911.629" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;arguments[i] = tostring(arguments[i])</text>
<text text-anchor="middle" x="1554.5" y="-1896.229" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1554.5" y="-1880.829" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, table.concat(arguments, &quot;\t&quot;) .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1554.5" y="-1865.4289" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-1834.0289" font-family="Inconsolata" font-size="14.00" fill="#000000">function write(str)</text>
<text text-anchor="middle" x="1554.5" y="-1818.6289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.write(stdout, str)</text>
<text text-anchor="middle" x="1554.5" y="-1803.2289" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-1755.8288" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** tty setup</text>
<text text-anchor="middle" x="1554.5" y="-1724.4288" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(0) ~= &quot;tty&quot; or</text>
<text text-anchor="middle" x="1554.5" y="-1709.0288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.guess_handle(1) ~= &quot;tty&quot; then</text>
<text text-anchor="middle" x="1554.5" y="-1693.6287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; Entry point for other consumers!</text>
<text text-anchor="middle" x="1554.5" y="-1678.2287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;error &quot;stdio must be a tty&quot;</text>
<text text-anchor="middle" x="1554.5" y="-1662.8287" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-1631.4286" font-family="Inconsolata" font-size="14.00" fill="#000000">local stdin = uv.new_tty(0, true)</text>
<text text-anchor="middle" x="1554.5" y="-1584.0286" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;[[</text>
<text text-anchor="middle" x="1554.5" y="-1552.6286" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;ll keep this around for a bit, it looks nice</text>
<text text-anchor="middle" x="1554.5" y="-1505.2285" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;]]</text>
<text text-anchor="middle" x="1554.5" y="-1473.8285" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** utilities</text>
<text text-anchor="middle" x="1554.5" y="-1442.4285" font-family="Inconsolata" font-size="14.00" fill="#000000">local function gatherResults(success, ...)</text>
<text text-anchor="middle" x="1554.5" y="-1427.0284" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1554.5" y="-1411.6284" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return success, { n = n, ... }</text>
<text text-anchor="middle" x="1554.5" y="-1396.2284" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-1364.8284" font-family="Inconsolata" font-size="14.00" fill="#000000">local function printResults(results)</text>
<text text-anchor="middle" x="1554.5" y="-1349.4283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="1554.5" y="-1334.0283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;results[i] = c.ts(results[i])</text>
<text text-anchor="middle" x="1554.5" y="-1318.6283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1554.5" y="-1303.2282" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;print(table.concat(results, &#39;\t&#39;))</text>
<text text-anchor="middle" x="1554.5" y="-1287.8282" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-1256.4282" font-family="Inconsolata" font-size="14.00" fill="#000000">local buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1554.5" y="-1225.0281" font-family="Inconsolata" font-size="14.00" fill="#000000">local function evaluateLine(line)</text>
<text text-anchor="middle" x="1554.5" y="-1209.6281" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line == &quot;&lt;3\n&quot; then</text>
<text text-anchor="middle" x="1554.5" y="-1194.2281" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;print(&quot;I &quot; .. a.red(&quot;♥&quot;) .. &quot; you too!&quot;)</text>
<text text-anchor="middle" x="1554.5" y="-1177.0879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &#39;&gt;&#39;</text>
<text text-anchor="middle" x="1554.5" y="-1161.6879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1554.5" y="-1146.2879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local chunk &#160;= buffer .. line</text>
<text text-anchor="middle" x="1554.5" y="-1130.8878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local f, err = loadstring(&#39;return &#39; .. chunk, &#39;REPL&#39;) &#45;&#45; first we prefix return</text>
<text text-anchor="middle" x="1554.5" y="-1099.4878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if not f then</text>
<text text-anchor="middle" x="1554.5" y="-1084.0878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;f, err = loadstring(chunk, &#39;REPL&#39;) &#45;&#45; try again without return</text>
<text text-anchor="middle" x="1554.5" y="-1068.6878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1554.5" y="-1037.2877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if f then</text>
<text text-anchor="middle" x="1554.5" y="-1021.8877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1554.5" y="-1006.4877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local success, results = gatherResults(xpcall(f, debug.traceback))</text>
<text text-anchor="middle" x="1554.5" y="-975.0876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if success then</text>
<text text-anchor="middle" x="1554.5" y="-959.6876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; successful call</text>
<text text-anchor="middle" x="1554.5" y="-944.2876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if results.n &gt; 0 then</text>
<text text-anchor="middle" x="1554.5" y="-928.8875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;printResults(results)</text>
<text text-anchor="middle" x="1554.5" y="-913.4875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1554.5" y="-898.0875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1554.5" y="-882.6874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; error</text>
<text text-anchor="middle" x="1554.5" y="-867.2874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;print(results[1])</text>
<text text-anchor="middle" x="1554.5" y="-851.8874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1554.5" y="-836.4873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1554.5" y="-805.0873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if err:match &quot;&#39;&lt;eof&gt;&#39;$&quot; then</text>
<text text-anchor="middle" x="1554.5" y="-789.6873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Lua expects some more input; stow it away for next time</text>
<text text-anchor="middle" x="1554.5" y="-774.2873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = chunk .. &#39;\n&#39;</text>
<text text-anchor="middle" x="1554.5" y="-758.8872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &#39;...&#39;</text>
<text text-anchor="middle" x="1554.5" y="-743.4872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1554.5" y="-728.0872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;print(err)</text>
<text text-anchor="middle" x="1554.5" y="-712.6871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1554.5" y="-697.2871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1554.5" y="-681.8871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1554.5" y="-650.487" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return &#39;👉 &#39;</text>
<text text-anchor="middle" x="1554.5" y="-626.2583" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-594.8583" font-family="Inconsolata" font-size="14.00" fill="#000000">local function displayPrompt(prompt)</text>
<text text-anchor="middle" x="1554.5" y="-579.4582" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, prompt)</text>
<text text-anchor="middle" x="1554.5" y="-564.0582" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-532.6582" font-family="Inconsolata" font-size="14.00" fill="#000000">local function onread(err, line)</text>
<text text-anchor="middle" x="1554.5" y="-517.2581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if err then error(err) end</text>
<text text-anchor="middle" x="1554.5" y="-501.8581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line then</text>
<text text-anchor="middle" x="1554.5" y="-486.4581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prompt = evaluateLine(line)</text>
<text text-anchor="middle" x="1554.5" y="-471.058" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;displayPrompt(prompt)</text>
<text text-anchor="middle" x="1554.5" y="-455.658" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1554.5" y="-440.258" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;uv.close(stdin)</text>
<text text-anchor="middle" x="1554.5" y="-424.8579" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1554.5" y="-409.4579" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1554.5" y="-378.0579" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Alternate screen</text>
<text text-anchor="middle" x="1554.5" y="-346.6578" font-family="Inconsolata" font-size="14.00" fill="#000000">coroutine.wrap(function()</text>
<text text-anchor="middle" x="1554.5" y="-331.2578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This switches screens and does a wipe,</text>
<text text-anchor="middle" x="1554.5" y="-315.8578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; then puts the cursor at 1,1.</text>
<text text-anchor="middle" x="1554.5" y="-300.4578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;write &#39;\27[?47h\27[2J\27[H&#39;</text>
<text text-anchor="middle" x="1554.5" y="-285.0577" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;print &quot;an repl, plz reply uwu 👀&quot;</text>
<text text-anchor="middle" x="1554.5" y="-260.829" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;displayPrompt &#39;👉 &#39;</text>
<text text-anchor="middle" x="1554.5" y="-236.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.read_start(stdin, onread)</text>
<text text-anchor="middle" x="1554.5" y="-221.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end)()</text>
<text text-anchor="middle" x="1554.5" y="-189.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">uv.run(&#39;default&#39;)</text>
<text text-anchor="middle" x="1554.5" y="-158.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Restore</text>
<text text-anchor="middle" x="1554.5" y="-127.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">print &#39;\27[?47l&#39;</text>
<text text-anchor="middle" x="1554.5" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">print(&quot;kthxbye&quot;)</text>
<text text-anchor="middle" x="1554.5" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return 0</text>
</g>
<!-- codeblock_21&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>codeblock_21&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1453.9812,-2399.5121C1455.8243,-2376.968 1459.2961,-2334.5029 1463.8781,-2278.4579"/>
<polygon fill="#000000" stroke="#000000" points="1467.3888,-2278.4693 1464.7154,-2268.2173 1460.4121,-2277.8988 1467.3888,-2278.4693"/>
</g>
<!-- leaf_24 -->
<g id="node25" class="node">
<title>leaf_24</title>
<polygon fill="none" stroke="#c0c0c0" points="1244.5,-36 1190.5,-36 1190.5,0 1244.5,0 1244.5,-36"/>
</g>
<!-- raw_23&#45;&gt;leaf_24 -->
<g id="edge24" class="edge">
<title>raw_23&#45;&gt;leaf_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1217.5,-1151.9194C1217.5,-1020.123 1217.5,-208.4009 1217.5,-46.192"/>
<polygon fill="#000000" stroke="#000000" points="1221.0001,-46.0555 1217.5,-36.0556 1214.0001,-46.0556 1221.0001,-46.0555"/>
</g>
</g>
</svg>
