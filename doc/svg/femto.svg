<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="3036pt" height="2786pt"
 viewBox="0.00 0.00 3035.50 2785.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2781.8326)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-2781.8326 3031.5,-2781.8326 3031.5,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="593.5" cy="-2759.8326" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="593.5" y="-2755.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 230</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="593.5" cy="-2687.8326" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="593.5" y="-2683.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;159</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M593.5,-2741.664C593.5,-2733.9636 593.5,-2724.807 593.5,-2716.2493"/>
<polygon fill="#000000" stroke="#000000" points="597.0001,-2716.2459 593.5,-2706.2459 590.0001,-2716.2459 597.0001,-2716.2459"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="413.5" cy="-2615.8326" rx="47.4168" ry="18"/>
<text text-anchor="middle" x="413.5" y="-2611.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Femto</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.2039,-2672.9142C526.9345,-2661.2064 486.1825,-2644.9056 455.7178,-2632.7197"/>
<polygon fill="#000000" stroke="#000000" points="456.8003,-2629.3832 446.2157,-2628.9189 454.2006,-2635.8825 456.8003,-2629.3832"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="511.5" cy="-2615.8326" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="511.5" y="-2611.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.6501,-2670.4034C562.5588,-2660.6647 548.6239,-2648.4292 536.7613,-2638.0133"/>
<polygon fill="#000000" stroke="#000000" points="538.764,-2635.114 528.9403,-2631.146 534.1454,-2640.3741 538.764,-2635.114"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="593.5" cy="-2615.8326" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="593.5" y="-2611.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M593.5,-2669.664C593.5,-2661.9636 593.5,-2652.807 593.5,-2644.2493"/>
<polygon fill="#000000" stroke="#000000" points="597.0001,-2644.2459 593.5,-2634.2459 590.0001,-2644.2459 597.0001,-2644.2459"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="818.5" cy="-2615.8326" rx="60.9826" ry="18"/>
<text text-anchor="middle" x="818.5" y="-2611.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 9&#45;35</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M636.3504,-2674.1205C673.6112,-2662.197 727.6778,-2644.8957 767.2268,-2632.24"/>
<polygon fill="#000000" stroke="#000000" points="768.4923,-2635.51 776.9498,-2629.1287 766.3589,-2628.843 768.4923,-2635.51"/>
</g>
<!-- section_6 -->
<g id="node7" class="node">
<title>section_6</title>
<ellipse fill="none" stroke="#000000" cx="2168.5" cy="-2615.8326" rx="75.4916" ry="18"/>
<text text-anchor="middle" x="2168.5" y="-2611.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 160&#45;230</text>
</g>
<!-- section_1&#45;&gt;section_6 -->
<g id="edge6" class="edge">
<title>section_1&#45;&gt;section_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M658.6735,-2684.8533C908.2625,-2673.4435 1803.3062,-2632.5272 2083.8087,-2619.7042"/>
<polygon fill="#000000" stroke="#000000" points="2084.0944,-2623.1949 2093.9241,-2619.2418 2083.7746,-2616.2022 2084.0944,-2623.1949"/>
</g>
<!-- leaf_7 -->
<g id="node8" class="node">
<title>leaf_7</title>
<polygon fill="none" stroke="#c0c0c0" points="449.5,-2561.8326 377.5,-2561.8326 377.5,-2525.8326 449.5,-2525.8326 449.5,-2561.8326"/>
<text text-anchor="middle" x="413.5" y="-2540.3326" font-family="Inconsolata" font-size="14.00" fill="#000000">* &#160;Femto</text>
</g>
<!-- header_2&#45;&gt;leaf_7 -->
<g id="edge7" class="edge">
<title>header_2&#45;&gt;leaf_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.5,-2597.664C413.5,-2589.9636 413.5,-2580.807 413.5,-2572.2493"/>
<polygon fill="#000000" stroke="#000000" points="417.0001,-2572.2459 413.5,-2562.2459 410.0001,-2572.2459 417.0001,-2572.2459"/>
</g>
<!-- raw_8 -->
<g id="node9" class="node">
<title>raw_8</title>
<ellipse fill="none" stroke="#000000" cx="502.5" cy="-2543.8326" rx="27" ry="18"/>
<text text-anchor="middle" x="502.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_8 -->
<g id="edge8" class="edge">
<title>prose_3&#45;&gt;raw_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M509.2289,-2597.664C508.2664,-2589.9636 507.1218,-2580.807 506.0521,-2572.2493"/>
<polygon fill="#000000" stroke="#000000" points="509.5151,-2571.7345 504.8017,-2562.2459 502.5691,-2572.6028 509.5151,-2571.7345"/>
</g>
<!-- raw_10 -->
<g id="node11" class="node">
<title>raw_10</title>
<ellipse fill="none" stroke="#000000" cx="583.5" cy="-2543.8326" rx="27" ry="18"/>
<text text-anchor="middle" x="583.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_10 -->
<g id="edge10" class="edge">
<title>prose_4&#45;&gt;raw_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590.9766,-2597.664C589.9071,-2589.9636 588.6353,-2580.807 587.4468,-2572.2493"/>
<polygon fill="#000000" stroke="#000000" points="590.8999,-2571.6693 586.0574,-2562.2459 583.9664,-2572.6323 590.8999,-2571.6693"/>
</g>
<!-- header_12 -->
<g id="node13" class="node">
<title>header_12</title>
<ellipse fill="none" stroke="#000000" cx="713.5" cy="-2543.8326" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="713.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : includes</text>
</g>
<!-- section_5&#45;&gt;header_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;header_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M794.147,-2599.1334C779.7322,-2589.249 761.2981,-2576.6085 745.6936,-2565.9082"/>
<polygon fill="#000000" stroke="#000000" points="747.5856,-2562.9618 737.3589,-2560.193 743.6269,-2568.7349 747.5856,-2562.9618"/>
</g>
<!-- prose_13 -->
<g id="node14" class="node">
<title>prose_13</title>
<ellipse fill="none" stroke="#000000" cx="818.5" cy="-2543.8326" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="818.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;prose_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M818.5,-2597.664C818.5,-2589.9636 818.5,-2580.807 818.5,-2572.2493"/>
<polygon fill="#000000" stroke="#000000" points="822.0001,-2572.2459 818.5,-2562.2459 815.0001,-2572.2459 822.0001,-2572.2459"/>
</g>
<!-- codeblock_14 -->
<g id="node15" class="node">
<title>codeblock_14</title>
<ellipse fill="none" stroke="#000000" cx="958.5" cy="-2543.8326" rx="77.4211" ry="18"/>
<text text-anchor="middle" x="958.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 14&#45;33</text>
</g>
<!-- section_5&#45;&gt;codeblock_14 -->
<g id="edge14" class="edge">
<title>section_5&#45;&gt;codeblock_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.8779,-2600.2097C868.8623,-2589.932 895.2711,-2576.3504 917.1604,-2565.093"/>
<polygon fill="#000000" stroke="#000000" points="918.9407,-2568.1132 926.2329,-2560.4271 915.7392,-2561.8882 918.9407,-2568.1132"/>
</g>
<!-- section_15 -->
<g id="node16" class="node">
<title>section_15</title>
<ellipse fill="none" stroke="#000000" cx="1187.5" cy="-2543.8326" rx="70.655" ry="18"/>
<text text-anchor="middle" x="1187.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 36&#45;159</text>
</g>
<!-- section_5&#45;&gt;section_15 -->
<g id="edge15" class="edge">
<title>section_5&#45;&gt;section_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M869.4205,-2605.8969C935.0376,-2593.0936 1049.2402,-2570.8101 1121.4681,-2556.7169"/>
<polygon fill="#000000" stroke="#000000" points="1122.2272,-2560.1349 1131.3718,-2554.7845 1120.8866,-2553.2644 1122.2272,-2560.1349"/>
</g>
<!-- header_27 -->
<g id="node28" class="node">
<title>header_27</title>
<ellipse fill="none" stroke="#000000" cx="1996.5" cy="-2543.8326" rx="80.7697" ry="18"/>
<text text-anchor="middle" x="1996.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : onkey(err, key)</text>
</g>
<!-- section_6&#45;&gt;header_27 -->
<g id="edge27" class="edge">
<title>section_6&#45;&gt;header_27</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2130.7539,-2600.0319C2105.2777,-2589.3675 2071.4485,-2575.2064 2044.1224,-2563.7676"/>
<polygon fill="#000000" stroke="#000000" points="2045.3284,-2560.4782 2034.7525,-2559.8453 2042.6254,-2566.9353 2045.3284,-2560.4782"/>
</g>
<!-- prose_28 -->
<g id="node29" class="node">
<title>prose_28</title>
<ellipse fill="none" stroke="#000000" cx="2127.5" cy="-2543.8326" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2127.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_28 -->
<g id="edge28" class="edge">
<title>section_6&#45;&gt;prose_28</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2158.154,-2597.664C2153.3857,-2589.2905 2147.637,-2579.1952 2142.4125,-2570.0204"/>
<polygon fill="#000000" stroke="#000000" points="2145.4083,-2568.2082 2137.4184,-2561.2503 2139.3254,-2571.6721 2145.4083,-2568.2082"/>
</g>
<!-- prose_29 -->
<g id="node30" class="node">
<title>prose_29</title>
<ellipse fill="none" stroke="#000000" cx="2209.5" cy="-2543.8326" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="2209.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_6&#45;&gt;prose_29 -->
<g id="edge29" class="edge">
<title>section_6&#45;&gt;prose_29</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2178.846,-2597.664C2183.6143,-2589.2905 2189.363,-2579.1952 2194.5875,-2570.0204"/>
<polygon fill="#000000" stroke="#000000" points="2197.6746,-2571.6721 2199.5816,-2561.2503 2191.5917,-2568.2082 2197.6746,-2571.6721"/>
</g>
<!-- codeblock_30 -->
<g id="node31" class="node">
<title>codeblock_30</title>
<ellipse fill="none" stroke="#000000" cx="2406.5" cy="-2543.8326" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2406.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 167&#45;202</text>
</g>
<!-- section_6&#45;&gt;codeblock_30 -->
<g id="edge30" class="edge">
<title>section_6&#45;&gt;codeblock_30</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2215.2372,-2601.6936C2253.0062,-2590.2677 2306.4055,-2574.1133 2347.1858,-2561.7764"/>
<polygon fill="#000000" stroke="#000000" points="2348.4418,-2565.0532 2356.9999,-2558.8074 2346.4149,-2558.353 2348.4418,-2565.0532"/>
</g>
<!-- codeblock_31 -->
<g id="node32" class="node">
<title>codeblock_31</title>
<ellipse fill="none" stroke="#000000" cx="2731.5" cy="-2543.8326" rx="87.0948" ry="18"/>
<text text-anchor="middle" x="2731.5" y="-2539.6326" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 204&#45;230</text>
</g>
<!-- section_6&#45;&gt;codeblock_31 -->
<g id="edge31" class="edge">
<title>section_6&#45;&gt;codeblock_31</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2235.2944,-2607.2905C2338.0709,-2594.1468 2534.8578,-2568.9805 2647.2654,-2554.6051"/>
<polygon fill="#000000" stroke="#000000" points="2647.7324,-2558.0739 2657.2076,-2553.3336 2646.8444,-2551.1305 2647.7324,-2558.0739"/>
</g>
<!-- leaf_9 -->
<g id="node10" class="node">
<title>leaf_9</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-2259.3333 0,-2259.3333 0,-2187.531 443,-2187.531 443,-2259.3333"/>
<text text-anchor="middle" x="221.5" y="-2195.9321" font-family="Inconsolata" font-size="14.00" fill="#000000">I just got orb stood up in the pylon bootloader distribution.</text>
</g>
<!-- raw_8&#45;&gt;leaf_9 -->
<g id="edge9" class="edge">
<title>raw_8&#45;&gt;leaf_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M487.9237,-2528.3599C477.8768,-2517.6296 464.2666,-2502.9637 452.5,-2489.8326 383.1383,-2412.4278 304.173,-2320.5168 258.8521,-2267.3885"/>
<polygon fill="#000000" stroke="#000000" points="261.2955,-2264.8596 252.1443,-2259.5203 255.9685,-2269.401 261.2955,-2264.8596"/>
</g>
<!-- leaf_11 -->
<g id="node12" class="node">
<title>leaf_11</title>
<polygon fill="none" stroke="#c0c0c0" points="645.5,-2251.3336 461.5,-2251.3336 461.5,-2195.5306 645.5,-2195.5306 645.5,-2251.3336"/>
<text text-anchor="middle" x="553.5" y="-2219.9321" font-family="Inconsolata" font-size="14.00" fill="#000000">I am excited about this.</text>
</g>
<!-- raw_10&#45;&gt;leaf_11 -->
<g id="edge11" class="edge">
<title>raw_10&#45;&gt;leaf_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M581.8011,-2525.6885C577.0498,-2474.9442 563.5496,-2330.7624 557.0639,-2261.495"/>
<polygon fill="#000000" stroke="#000000" points="560.5398,-2261.0727 556.1227,-2251.4426 553.5703,-2261.7253 560.5398,-2261.0727"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="763.5,-2241.4321 663.5,-2241.4321 663.5,-2205.4321 763.5,-2205.4321 763.5,-2241.4321"/>
<text text-anchor="middle" x="713.5" y="-2219.9321" font-family="Inconsolata" font-size="14.00" fill="#000000">** &#160;includes</text>
</g>
<!-- header_12&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>header_12&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M713.5,-2525.6885C713.5,-2472.5037 713.5,-2316.6777 713.5,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="717.0001,-2251.7744 713.5,-2241.7744 710.0001,-2251.7744 717.0001,-2251.7744"/>
</g>
<!-- raw_17 -->
<g id="node18" class="node">
<title>raw_17</title>
<ellipse fill="none" stroke="#000000" cx="808.5" cy="-2223.4321" rx="27" ry="18"/>
<text text-anchor="middle" x="808.5" y="-2219.2321" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_13&#45;&gt;raw_17 -->
<g id="edge17" class="edge">
<title>prose_13&#45;&gt;raw_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M817.9337,-2525.6885C816.2738,-2472.5037 811.4103,-2316.6777 809.3929,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="812.8828,-2251.6603 809.0725,-2241.7744 805.8862,-2251.8787 812.8828,-2251.6603"/>
</g>
<!-- leaf_19 -->
<g id="node20" class="node">
<title>leaf_19</title>
<polygon fill="none" stroke="#c0c0c0" points="1087,-2368.4324 854,-2368.4324 854,-2078.4318 1087,-2078.4318 1087,-2368.4324"/>
<text text-anchor="middle" x="970.5" y="-2353.2323" font-family="Inconsolata" font-size="14.00" fill="#000000">sql = require &quot;sqlite&quot;</text>
<text text-anchor="middle" x="970.5" y="-2321.8322" font-family="Inconsolata" font-size="14.00" fill="#000000">lfs = require &quot;lfs&quot;</text>
<text text-anchor="middle" x="970.5" y="-2306.4322" font-family="Inconsolata" font-size="14.00" fill="#000000">ffi = require &quot;ffi&quot;</text>
<text text-anchor="middle" x="970.5" y="-2275.0322" font-family="Inconsolata" font-size="14.00" fill="#000000">ffi.reflect = require &quot;reflect&quot;</text>
<text text-anchor="middle" x="970.5" y="-2243.6322" font-family="Inconsolata" font-size="14.00" fill="#000000">uv = require &quot;luv&quot;</text>
<text text-anchor="middle" x="970.5" y="-2212.2321" font-family="Inconsolata" font-size="14.00" fill="#000000">L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="970.5" y="-2180.8321" font-family="Inconsolata" font-size="14.00" fill="#000000">a = require &quot;anterm&quot;</text>
<text text-anchor="middle" x="970.5" y="-2149.4321" font-family="Inconsolata" font-size="14.00" fill="#000000">c = require &quot;color&quot;</text>
<text text-anchor="middle" x="970.5" y="-2118.032" font-family="Inconsolata" font-size="14.00" fill="#000000">core = require &quot;core&quot;</text>
<text text-anchor="middle" x="970.5" y="-2086.632" font-family="Inconsolata" font-size="14.00" fill="#000000">watch = require &quot;watcher&quot;</text>
</g>
<!-- codeblock_14&#45;&gt;leaf_19 -->
<g id="edge19" class="edge">
<title>codeblock_14&#45;&gt;leaf_19</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M959.1796,-2525.6885C960.2646,-2496.7184 962.4902,-2437.2942 964.6832,-2378.742"/>
<polygon fill="#000000" stroke="#000000" points="968.1864,-2378.7188 965.0632,-2368.5948 961.1913,-2378.4568 968.1864,-2378.7188"/>
</g>
<!-- header_20 -->
<g id="node21" class="node">
<title>header_20</title>
<ellipse fill="none" stroke="#000000" cx="1143.5" cy="-2223.4321" rx="38.2457" ry="18"/>
<text text-anchor="middle" x="1143.5" y="-2219.2321" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">4 : utils</text>
</g>
<!-- section_15&#45;&gt;header_20 -->
<g id="edge20" class="edge">
<title>section_15&#45;&gt;header_20</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1185.0083,-2525.6885C1177.7045,-2472.5037 1156.3052,-2316.6777 1147.4286,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="1150.847,-2251.2052 1146.0189,-2241.7744 1143.912,-2252.1576 1150.847,-2251.2052"/>
</g>
<!-- prose_21 -->
<g id="node22" class="node">
<title>prose_21</title>
<ellipse fill="none" stroke="#000000" cx="1231.5" cy="-2223.4321" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="1231.5" y="-2219.2321" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_15&#45;&gt;prose_21 -->
<g id="edge21" class="edge">
<title>section_15&#45;&gt;prose_21</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1189.9917,-2525.6885C1197.2955,-2472.5037 1218.6948,-2316.6777 1227.5714,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="1231.088,-2252.1576 1228.9811,-2241.7744 1224.153,-2251.2052 1231.088,-2252.1576"/>
</g>
<!-- codeblock_22 -->
<g id="node23" class="node">
<title>codeblock_22</title>
<ellipse fill="none" stroke="#000000" cx="1468.5" cy="-2223.4321" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1468.5" y="-2219.2321" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 38&#45;157</text>
</g>
<!-- section_15&#45;&gt;codeblock_22 -->
<g id="edge22" class="edge">
<title>section_15&#45;&gt;codeblock_22</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1218.9468,-2527.6012C1235.8882,-2517.9729 1256.5281,-2504.7487 1272.5,-2489.8326 1353.4873,-2414.1992 1423.7562,-2301.203 1453.4416,-2250.1595"/>
<polygon fill="#000000" stroke="#000000" points="1456.5448,-2251.7843 1458.5057,-2241.3725 1450.4799,-2248.289 1456.5448,-2251.7843"/>
</g>
<!-- leaf_18 -->
<g id="node19" class="node">
<title>leaf_18</title>
<polygon fill="none" stroke="#c0c0c0" points="1082.5,-1031.8162 534.5,-1031.8162 534.5,-961.2155 1082.5,-961.2155 1082.5,-1031.8162"/>
<text text-anchor="middle" x="808.5" y="-984.7158" font-family="Inconsolata" font-size="14.00" fill="#000000">This all goes into global space for now. &#160;Our more sophisticated loader will</text>
<text text-anchor="middle" x="808.5" y="-969.3158" font-family="Inconsolata" font-size="14.00" fill="#000000">handle namespace isolation. Meanwhile we&#39;re building a repl, so.</text>
</g>
<!-- raw_17&#45;&gt;leaf_18 -->
<g id="edge18" class="edge">
<title>raw_17&#45;&gt;leaf_18</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M808.5,-2205.1361C808.5,-2071.5281 808.5,-1245.6368 808.5,-1041.906"/>
<polygon fill="#000000" stroke="#000000" points="812.0001,-1041.8504 808.5,-1031.8504 805.0001,-1041.8504 812.0001,-1041.8504"/>
</g>
<!-- leaf_23 -->
<g id="node24" class="node">
<title>leaf_23</title>
<polygon fill="none" stroke="#c0c0c0" points="1186.5,-1014.5158 1100.5,-1014.5158 1100.5,-978.5158 1186.5,-978.5158 1186.5,-1014.5158"/>
<text text-anchor="middle" x="1143.5" y="-993.0158" font-family="Inconsolata" font-size="14.00" fill="#000000">**** utils</text>
</g>
<!-- header_20&#45;&gt;leaf_23 -->
<g id="edge23" class="edge">
<title>header_20&#45;&gt;leaf_23</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1143.5,-2205.1361C1143.5,-2067.4584 1143.5,-1194.6813 1143.5,-1025.058"/>
<polygon fill="#000000" stroke="#000000" points="1147.0001,-1024.9173 1143.5,-1014.9174 1140.0001,-1024.9174 1147.0001,-1024.9173"/>
</g>
<!-- raw_24 -->
<g id="node25" class="node">
<title>raw_24</title>
<ellipse fill="none" stroke="#000000" cx="1231.5" cy="-996.5158" rx="27" ry="18"/>
<text text-anchor="middle" x="1231.5" y="-992.3158" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_21&#45;&gt;raw_24 -->
<g id="edge24" class="edge">
<title>prose_21&#45;&gt;raw_24</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1231.5,-2205.1361C1231.5,-2067.4584 1231.5,-1194.6813 1231.5,-1025.058"/>
<polygon fill="#000000" stroke="#000000" points="1235.0001,-1024.9173 1231.5,-1014.9174 1228.0001,-1024.9174 1235.0001,-1024.9173"/>
</g>
<!-- leaf_26 -->
<g id="node27" class="node">
<title>leaf_26</title>
<polygon fill="none" stroke="#c0c0c0" points="1866.5,-1921.0474 1276.5,-1921.0474 1276.5,-71.9842 1866.5,-71.9842 1866.5,-1921.0474"/>
<text text-anchor="middle" x="1571.5" y="-1889.8316" font-family="Inconsolata" font-size="14.00" fill="#000000">local usecolors</text>
<text text-anchor="middle" x="1571.5" y="-1874.4316" font-family="Inconsolata" font-size="14.00" fill="#000000">stdout = &quot;&quot;</text>
<text text-anchor="middle" x="1571.5" y="-1843.0316" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(1) == &quot;tty&quot; then</text>
<text text-anchor="middle" x="1571.5" y="-1827.6315" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;stdout = uv.new_tty(1, false)</text>
<text text-anchor="middle" x="1571.5" y="-1812.2315" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = true</text>
<text text-anchor="middle" x="1571.5" y="-1796.8315" font-family="Inconsolata" font-size="14.00" fill="#000000">else</text>
<text text-anchor="middle" x="1571.5" y="-1781.4314" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;stdout = uv.new_pipe(false)</text>
<text text-anchor="middle" x="1571.5" y="-1766.0314" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.pipe_open(utils.stdout, 1)</text>
<text text-anchor="middle" x="1571.5" y="-1750.6314" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = false</text>
<text text-anchor="middle" x="1571.5" y="-1735.2313" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-1703.8313" font-family="Inconsolata" font-size="14.00" fill="#000000">if not usecolors then</text>
<text text-anchor="middle" x="1571.5" y="-1688.4313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;c.ts = tostring</text>
<text text-anchor="middle" x="1571.5" y="-1673.0312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; #todo make this properly black and white ts</text>
<text text-anchor="middle" x="1571.5" y="-1657.6312" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-1626.2312" font-family="Inconsolata" font-size="14.00" fill="#000000">function print(...)</text>
<text text-anchor="middle" x="1571.5" y="-1610.8312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1571.5" y="-1595.4311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local arguments = {...}</text>
<text text-anchor="middle" x="1571.5" y="-1580.0311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, n do</text>
<text text-anchor="middle" x="1571.5" y="-1564.6311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;arguments[i] = tostring(arguments[i])</text>
<text text-anchor="middle" x="1571.5" y="-1549.231" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1571.5" y="-1533.831" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, table.concat(arguments, &quot;\t&quot;) .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1571.5" y="-1518.431" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-1487.0309" font-family="Inconsolata" font-size="14.00" fill="#000000">function write(str)</text>
<text text-anchor="middle" x="1571.5" y="-1471.6309" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.write(stdout, str)</text>
<text text-anchor="middle" x="1571.5" y="-1456.2309" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-1408.8308" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** tty setup</text>
<text text-anchor="middle" x="1571.5" y="-1377.4308" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(0) ~= &quot;tty&quot; or</text>
<text text-anchor="middle" x="1571.5" y="-1362.0308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.guess_handle(1) ~= &quot;tty&quot; then</text>
<text text-anchor="middle" x="1571.5" y="-1346.6307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; Entry point for other consumers!</text>
<text text-anchor="middle" x="1571.5" y="-1331.2307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;error &quot;stdio must be a tty&quot;</text>
<text text-anchor="middle" x="1571.5" y="-1315.8307" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-1284.4307" font-family="Inconsolata" font-size="14.00" fill="#000000">local stdin = uv.new_tty(0, true)</text>
<text text-anchor="middle" x="1571.5" y="-1237.0306" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;[[</text>
<text text-anchor="middle" x="1571.5" y="-1205.6306" font-family="Inconsolata" font-size="14.00" fill="#000000">I&#39;ll keep this around for a bit, it looks nice</text>
<text text-anchor="middle" x="1571.5" y="-1158.2306" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;]]</text>
<text text-anchor="middle" x="1571.5" y="-1126.8305" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** utilities</text>
<text text-anchor="middle" x="1571.5" y="-1095.4305" font-family="Inconsolata" font-size="14.00" fill="#000000">local function gatherResults(success, ...)</text>
<text text-anchor="middle" x="1571.5" y="-1080.0305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1571.5" y="-1064.6304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return success, { n = n, ... }</text>
<text text-anchor="middle" x="1571.5" y="-1049.2304" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-1017.8304" font-family="Inconsolata" font-size="14.00" fill="#000000">local function printResults(results)</text>
<text text-anchor="middle" x="1571.5" y="-1002.4303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="1571.5" y="-987.0303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;results[i] = c.ts(results[i])</text>
<text text-anchor="middle" x="1571.5" y="-971.6303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1571.5" y="-956.2303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;print(table.concat(results, &#39;\t&#39;))</text>
<text text-anchor="middle" x="1571.5" y="-940.8302" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-909.4302" font-family="Inconsolata" font-size="14.00" fill="#000000">local buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1571.5" y="-878.0302" font-family="Inconsolata" font-size="14.00" fill="#000000">local function evaluateLine(line)</text>
<text text-anchor="middle" x="1571.5" y="-862.6301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if string.byte(line) == 17 then &#45;&#45; ^Q</text>
<text text-anchor="middle" x="1571.5" y="-847.2301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;uv.stop()</text>
<text text-anchor="middle" x="1571.5" y="-831.8301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 0</text>
<text text-anchor="middle" x="1571.5" y="-816.43" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1571.5" y="-801.03" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local chunk &#160;= buffer .. line</text>
<text text-anchor="middle" x="1571.5" y="-785.63" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;local f, err = loadstring(&#39;return &#39; .. chunk, &#39;REPL&#39;) &#45;&#45; first we prefix return</text>
<text text-anchor="middle" x="1571.5" y="-754.2299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if not f then</text>
<text text-anchor="middle" x="1571.5" y="-738.8299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;f, err = loadstring(chunk, &#39;REPL&#39;) &#45;&#45; try again without return</text>
<text text-anchor="middle" x="1571.5" y="-723.4299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1571.5" y="-692.0298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if f then</text>
<text text-anchor="middle" x="1571.5" y="-676.6298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1571.5" y="-661.2298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local success, results = gatherResults(xpcall(f, debug.traceback))</text>
<text text-anchor="middle" x="1571.5" y="-629.8298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if success then</text>
<text text-anchor="middle" x="1571.5" y="-614.4297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; successful call</text>
<text text-anchor="middle" x="1571.5" y="-599.0297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if results.n &gt; 0 then</text>
<text text-anchor="middle" x="1571.5" y="-583.6297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;printResults(results)</text>
<text text-anchor="middle" x="1571.5" y="-568.2296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1571.5" y="-552.8296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1571.5" y="-537.4296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; error</text>
<text text-anchor="middle" x="1571.5" y="-522.0295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;print(results[1])</text>
<text text-anchor="middle" x="1571.5" y="-506.6295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1571.5" y="-491.2295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;else</text>
<text text-anchor="middle" x="1571.5" y="-475.8294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if err:match &quot;&#39;&lt;eof&gt;&#39;$&quot; then</text>
<text text-anchor="middle" x="1571.5" y="-460.4294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;&#45; Lua expects some more input; stow it away for next time</text>
<text text-anchor="middle" x="1571.5" y="-445.0294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;buffer = chunk .. &#39;\n&#39;</text>
<text text-anchor="middle" x="1571.5" y="-429.6293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return &#39;...&#39;</text>
<text text-anchor="middle" x="1571.5" y="-414.2293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1571.5" y="-398.8293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;print(err)</text>
<text text-anchor="middle" x="1571.5" y="-383.4293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1571.5" y="-368.0292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1571.5" y="-352.6292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="1571.5" y="-321.2292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return &#39;ðŸ‘‰ &#160;&#39;</text>
<text text-anchor="middle" x="1571.5" y="-297.0004" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-265.6004" font-family="Inconsolata" font-size="14.00" fill="#000000">local function displayPrompt(prompt)</text>
<text text-anchor="middle" x="1571.5" y="-250.2003" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, prompt)</text>
<text text-anchor="middle" x="1571.5" y="-234.8003" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1571.5" y="-203.4003" font-family="Inconsolata" font-size="14.00" fill="#000000">local function onread(err, line)</text>
<text text-anchor="middle" x="1571.5" y="-188.0002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if err then error(err) end</text>
<text text-anchor="middle" x="1571.5" y="-172.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line then</text>
<text text-anchor="middle" x="1571.5" y="-157.2002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prompt = evaluateLine(line)</text>
<text text-anchor="middle" x="1571.5" y="-141.8002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;displayPrompt(prompt)</text>
<text text-anchor="middle" x="1571.5" y="-126.4001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1571.5" y="-111.0001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;uv.close(stdin)</text>
<text text-anchor="middle" x="1571.5" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1571.5" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_22&#45;&gt;leaf_26 -->
<g id="edge26" class="edge">
<title>codeblock_22&#45;&gt;leaf_26</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1470.036,-2205.1361C1473.417,-2164.862 1482.0787,-2061.685 1492.9988,-1931.6067"/>
<polygon fill="#000000" stroke="#000000" points="1496.5079,-1931.6439 1493.8569,-1921.3861 1489.5325,-1931.0582 1496.5079,-1931.6439"/>
</g>
<!-- leaf_25 -->
<g id="node26" class="node">
<title>leaf_25</title>
<polygon fill="none" stroke="#c0c0c0" points="1258.5,-36 1204.5,-36 1204.5,0 1258.5,0 1258.5,-36"/>
</g>
<!-- raw_24&#45;&gt;leaf_25 -->
<g id="edge25" class="edge">
<title>raw_24&#45;&gt;leaf_25</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1231.5,-978.2718C1231.5,-859.1935 1231.5,-192.9864 1231.5,-46.4907"/>
<polygon fill="#000000" stroke="#000000" points="1235.0001,-46.1182 1231.5,-36.1182 1228.0001,-46.1183 1235.0001,-46.1182"/>
</g>
<!-- leaf_32 -->
<g id="node33" class="node">
<title>leaf_32</title>
<polygon fill="none" stroke="#c0c0c0" points="2067.5,-2241.4321 1925.5,-2241.4321 1925.5,-2205.4321 2067.5,-2205.4321 2067.5,-2241.4321"/>
<text text-anchor="middle" x="1996.5" y="-2219.9321" font-family="Inconsolata" font-size="14.00" fill="#000000">** onkey(err, key)</text>
</g>
<!-- header_27&#45;&gt;leaf_32 -->
<g id="edge32" class="edge">
<title>header_27&#45;&gt;leaf_32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1996.5,-2525.6885C1996.5,-2472.5037 1996.5,-2316.6777 1996.5,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="2000.0001,-2251.7744 1996.5,-2241.7744 1993.0001,-2251.7744 2000.0001,-2251.7744"/>
</g>
<!-- raw_33 -->
<g id="node34" class="node">
<title>raw_33</title>
<ellipse fill="none" stroke="#000000" cx="2127.5" cy="-2223.4321" rx="27" ry="18"/>
<text text-anchor="middle" x="2127.5" y="-2219.2321" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_28&#45;&gt;raw_33 -->
<g id="edge33" class="edge">
<title>prose_28&#45;&gt;raw_33</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2127.5,-2525.6885C2127.5,-2472.5037 2127.5,-2316.6777 2127.5,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="2131.0001,-2251.7744 2127.5,-2241.7744 2124.0001,-2251.7744 2131.0001,-2251.7744"/>
</g>
<!-- raw_35 -->
<g id="node36" class="node">
<title>raw_35</title>
<ellipse fill="none" stroke="#000000" cx="2204.5" cy="-2223.4321" rx="27" ry="18"/>
<text text-anchor="middle" x="2204.5" y="-2219.2321" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_29&#45;&gt;raw_35 -->
<g id="edge35" class="edge">
<title>prose_29&#45;&gt;raw_35</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2209.2169,-2525.6885C2208.3869,-2472.5037 2205.9551,-2316.6777 2204.9464,-2252.0395"/>
<polygon fill="#000000" stroke="#000000" points="2208.4419,-2251.7185 2204.7862,-2241.7744 2201.4428,-2251.8278 2208.4419,-2251.7185"/>
</g>
<!-- leaf_37 -->
<g id="node38" class="node">
<title>leaf_37</title>
<polygon fill="none" stroke="#c0c0c0" points="2671.5,-2489.7332 2249.5,-2489.7332 2249.5,-1957.1311 2671.5,-1957.1311 2671.5,-2489.7332"/>
<text text-anchor="middle" x="2460.5" y="-2474.6326" font-family="Inconsolata" font-size="14.00" fill="#000000">local keybuf = {}</text>
<text text-anchor="middle" x="2460.5" y="-2459.2326" font-family="Inconsolata" font-size="14.00" fill="#000000">local byte = string.byte</text>
<text text-anchor="middle" x="2460.5" y="-2443.8326" font-family="Inconsolata" font-size="14.00" fill="#000000">local concat = table.concat</text>
<text text-anchor="middle" x="2460.5" y="-2412.4325" font-family="Inconsolata" font-size="14.00" fill="#000000">local function recognize(seq)</text>
<text text-anchor="middle" x="2460.5" y="-2397.0325" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.write(stdout, seq)</text>
<text text-anchor="middle" x="2460.5" y="-2381.6325" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="2460.5" y="-2350.2324" font-family="Inconsolata" font-size="14.00" fill="#000000">local function onkey(err, key)</text>
<text text-anchor="middle" x="2460.5" y="-2334.8324" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if err then error(err) end</text>
<text text-anchor="middle" x="2460.5" y="-2319.4324" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if key == &quot;\17&quot; then</text>
<text text-anchor="middle" x="2460.5" y="-2304.0323" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;femto.disableRawMode()</text>
<text text-anchor="middle" x="2460.5" y="-2288.6323" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;uv.stop()</text>
<text text-anchor="middle" x="2460.5" y="-2273.2323" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return 0</text>
<text text-anchor="middle" x="2460.5" y="-2257.8322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2460.5" y="-2242.4322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if key == &quot;\27&quot; then</text>
<text text-anchor="middle" x="2460.5" y="-2227.0322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;keybuf[#keybuf + 1] &#160;= key</text>
<text text-anchor="middle" x="2460.5" y="-2211.6322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return</text>
<text text-anchor="middle" x="2460.5" y="-2196.2321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2460.5" y="-2180.8321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;if #keybuf &gt; 0 then</text>
<text text-anchor="middle" x="2460.5" y="-2165.4321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local char = byte(key)</text>
<text text-anchor="middle" x="2460.5" y="-2150.032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; [A&#45;Za&#45;z]</text>
<text text-anchor="middle" x="2460.5" y="-2134.632" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if (char &gt;= 65 and char &lt;= 90)</text>
<text text-anchor="middle" x="2460.5" y="-2119.232" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;or (char &gt;= 97 and char &lt;= 122) then</text>
<text text-anchor="middle" x="2460.5" y="-2103.8319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;local esc_val = concat(keybuf) .. key</text>
<text text-anchor="middle" x="2460.5" y="-2088.4319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for i, _ in ipairs(keybuf) do keybuf[i] = nil end</text>
<text text-anchor="middle" x="2460.5" y="-2073.0319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return recognize(esc_val)</text>
<text text-anchor="middle" x="2460.5" y="-2057.6318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="2460.5" y="-2042.2318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;keybuf[#keybuf + 1] = key</text>
<text text-anchor="middle" x="2460.5" y="-2026.8318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;return</text>
<text text-anchor="middle" x="2460.5" y="-2011.4317" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="2460.5" y="-1996.0317" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;end</text>
<text text-anchor="middle" x="2460.5" y="-1980.6317" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;return recognize(key)</text>
<text text-anchor="middle" x="2460.5" y="-1965.2317" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
</g>
<!-- codeblock_30&#45;&gt;leaf_37 -->
<g id="edge37" class="edge">
<title>codeblock_30&#45;&gt;leaf_37</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2409.558,-2525.6885C2410.7331,-2518.7163 2412.2055,-2509.9801 2413.9015,-2499.9167"/>
<polygon fill="#000000" stroke="#000000" points="2417.3831,-2500.3185 2415.5938,-2489.8759 2410.4805,-2499.1551 2417.3831,-2500.3185"/>
</g>
<!-- leaf_38 -->
<g id="node39" class="node">
<title>leaf_38</title>
<polygon fill="none" stroke="#c0c0c0" points="3027.5,-2430.6902 2689.5,-2430.6902 2689.5,-2016.174 3027.5,-2016.174 3027.5,-2430.6902"/>
<text text-anchor="middle" x="2858.5" y="-2415.3611" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Alternate screen</text>
<text text-anchor="middle" x="2858.5" y="-2383.9611" font-family="Inconsolata" font-size="14.00" fill="#000000">coroutine.wrap(function()</text>
<text text-anchor="middle" x="2858.5" y="-2368.5611" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; Get names for as many values as possible</text>
<text text-anchor="middle" x="2858.5" y="-2353.161" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; into the colorizer</text>
<text text-anchor="middle" x="2858.5" y="-2337.761" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;c.allNames()</text>
<text text-anchor="middle" x="2858.5" y="-2322.361" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This switches screens and does a wipe,</text>
<text text-anchor="middle" x="2858.5" y="-2306.961" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; then puts the cursor at 1,1.</text>
<text text-anchor="middle" x="2858.5" y="-2291.5609" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;write &#39;\27[?47h\27[2J\27[H&#39;</text>
<text text-anchor="middle" x="2858.5" y="-2276.1609" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;print &quot;an repl, plz reply uwu ðŸ‘€&quot;</text>
<text text-anchor="middle" x="2858.5" y="-2251.9321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;displayPrompt &#39;ðŸ‘‰ &#160;&#39;</text>
<text text-anchor="middle" x="2858.5" y="-2227.7034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;femto.enableRawMode()</text>
<text text-anchor="middle" x="2858.5" y="-2212.3034" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.read_start(stdin, onkey)</text>
<text text-anchor="middle" x="2858.5" y="-2196.9033" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45;uv.read_start(stdin, onread)</text>
<text text-anchor="middle" x="2858.5" y="-2181.5033" font-family="Inconsolata" font-size="14.00" fill="#000000">end)()</text>
<text text-anchor="middle" x="2858.5" y="-2118.1033" font-family="Inconsolata" font-size="14.00" fill="#000000">local retcode = uv.run(&#39;default&#39;)</text>
<text text-anchor="middle" x="2858.5" y="-2102.7032" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Restore</text>
<text text-anchor="middle" x="2858.5" y="-2071.3032" font-family="Inconsolata" font-size="14.00" fill="#000000">print &#39;\27[?47l&#39;</text>
<text text-anchor="middle" x="2858.5" y="-2039.9032" font-family="Inconsolata" font-size="14.00" fill="#000000">print(&quot;kthxbye&quot;)</text>
<text text-anchor="middle" x="2858.5" y="-2024.5031" font-family="Inconsolata" font-size="14.00" fill="#000000">return retcode</text>
</g>
<!-- codeblock_31&#45;&gt;leaf_38 -->
<g id="edge38" class="edge">
<title>codeblock_31&#45;&gt;leaf_38</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2738.692,-2525.6885C2746.0858,-2507.035 2758.4843,-2475.7556 2772.5728,-2440.2126"/>
<polygon fill="#000000" stroke="#000000" points="2775.9566,-2441.1739 2776.3878,-2430.5879 2769.4492,-2438.5945 2775.9566,-2441.1739"/>
</g>
<!-- leaf_34 -->
<g id="node35" class="node">
<title>leaf_34</title>
<polygon fill="none" stroke="#c0c0c0" points="2370,-1024.4173 1885,-1024.4173 1885,-968.6143 2370,-968.6143 2370,-1024.4173"/>
<text text-anchor="middle" x="2127.5" y="-977.0158" font-family="Inconsolata" font-size="14.00" fill="#000000">We buffer escape sequences, which terminate in an alphabetic value.</text>
</g>
<!-- raw_33&#45;&gt;leaf_34 -->
<g id="edge34" class="edge">
<title>raw_33&#45;&gt;leaf_34</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2127.5,-2205.1361C2127.5,-2069.8255 2127.5,-1224.476 2127.5,-1034.4235"/>
<polygon fill="#000000" stroke="#000000" points="2131.0001,-1034.3562 2127.5,-1024.3563 2124.0001,-1034.3563 2131.0001,-1034.3562"/>
</g>
<!-- leaf_36 -->
<g id="node37" class="node">
<title>leaf_36</title>
<polygon fill="none" stroke="#c0c0c0" points="2936.5,-1023.8162 2388.5,-1023.8162 2388.5,-969.2154 2936.5,-969.2154 2936.5,-1023.8162"/>
<text text-anchor="middle" x="2662.5" y="-992.7158" font-family="Inconsolata" font-size="14.00" fill="#000000">No special effort to detect &quot;^[[&quot; (as opposed to just &quot;^[&quot;) is made, that is</text>
<text text-anchor="middle" x="2662.5" y="-977.3158" font-family="Inconsolata" font-size="14.00" fill="#000000">handled at the recognizer layer.</text>
</g>
<!-- raw_35&#45;&gt;leaf_36 -->
<g id="edge36" class="edge">
<title>raw_35&#45;&gt;leaf_36</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2200.8493,-2205.4948C2192.3619,-2158.2674 2176.593,-2029.17 2240.5,-1957.0316 2282.5319,-1909.5859 2332.7293,-1964.8816 2378.5,-1921.0316 2643.195,-1667.444 2662.971,-1174.0228 2663.0571,-1034.2389"/>
<polygon fill="#000000" stroke="#000000" points="2666.5566,-1034.0343 2663.0277,-1024.0445 2659.5566,-1034.0546 2666.5566,-1034.0343"/>
</g>
</g>
</svg>
