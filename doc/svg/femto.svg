<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: lpegNode Pages: 1 -->
<svg width="1562pt" height="4728pt"
 viewBox="0.00 0.00 1562.00 4727.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4723.8336)">
<title>lpegNode</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-4723.8336 1558,-4723.8336 1558,4 -4,4"/>
<!-- doc_0 -->
<g id="node1" class="node">
<title>doc_0</title>
<ellipse fill="none" stroke="#000000" cx="512.5" cy="-4701.8336" rx="46.9581" ry="18"/>
<text text-anchor="middle" x="512.5" y="-4697.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">doc &#45; 290</text>
</g>
<!-- section_1 -->
<g id="node2" class="node">
<title>section_1</title>
<ellipse fill="none" stroke="#000000" cx="512.5" cy="-4629.8336" rx="55.6456" ry="18"/>
<text text-anchor="middle" x="512.5" y="-4625.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 1&#45;7</text>
</g>
<!-- doc_0&#45;&gt;section_1 -->
<g id="edge1" class="edge">
<title>doc_0&#45;&gt;section_1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M512.5,-4683.6649C512.5,-4675.9645 512.5,-4666.8079 512.5,-4658.2502"/>
<polygon fill="#000000" stroke="#000000" points="516.0001,-4658.2468 512.5,-4648.2468 509.0001,-4658.2469 516.0001,-4658.2468"/>
</g>
<!-- header_2 -->
<g id="node3" class="node">
<title>header_2</title>
<ellipse fill="none" stroke="#000000" cx="373.5" cy="-4557.8336" rx="47.4168" ry="18"/>
<text text-anchor="middle" x="373.5" y="-4553.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">1 : Femto</text>
</g>
<!-- section_1&#45;&gt;header_2 -->
<g id="edge2" class="edge">
<title>section_1&#45;&gt;header_2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M482.681,-4614.3878C461.6476,-4603.4928 433.3222,-4588.8206 410.7936,-4577.1511"/>
<polygon fill="#000000" stroke="#000000" points="412.3354,-4574.0081 401.8461,-4572.5164 409.1157,-4580.2237 412.3354,-4574.0081"/>
</g>
<!-- prose_3 -->
<g id="node4" class="node">
<title>prose_3</title>
<ellipse fill="none" stroke="#000000" cx="471.5" cy="-4557.8336" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="471.5" y="-4553.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_3 -->
<g id="edge3" class="edge">
<title>section_1&#45;&gt;prose_3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M502.3652,-4612.0358C497.5632,-4603.6031 491.7315,-4593.3621 486.4358,-4584.0623"/>
<polygon fill="#000000" stroke="#000000" points="489.3667,-4582.1361 481.3768,-4575.1781 483.2838,-4585.6 489.3667,-4582.1361"/>
</g>
<!-- prose_4 -->
<g id="node5" class="node">
<title>prose_4</title>
<ellipse fill="none" stroke="#000000" cx="553.5" cy="-4557.8336" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="553.5" y="-4553.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_1&#45;&gt;prose_4 -->
<g id="edge4" class="edge">
<title>section_1&#45;&gt;prose_4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M522.6348,-4612.0358C527.4368,-4603.6031 533.2685,-4593.3621 538.5642,-4584.0623"/>
<polygon fill="#000000" stroke="#000000" points="541.7162,-4585.6 543.6232,-4575.1781 535.6333,-4582.1361 541.7162,-4585.6"/>
</g>
<!-- section_5 -->
<g id="node6" class="node">
<title>section_5</title>
<ellipse fill="none" stroke="#000000" cx="762.5" cy="-4557.8336" rx="65.8187" ry="18"/>
<text text-anchor="middle" x="762.5" y="-4553.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">section: 8&#45;290</text>
</g>
<!-- section_1&#45;&gt;section_5 -->
<g id="edge5" class="edge">
<title>section_1&#45;&gt;section_5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M554.3444,-4617.7824C596.3023,-4605.6985 661.1367,-4587.0262 707.2903,-4573.7339"/>
<polygon fill="#000000" stroke="#000000" points="708.491,-4577.0305 717.1318,-4570.8996 706.5537,-4570.3039 708.491,-4577.0305"/>
</g>
<!-- leaf_6 -->
<g id="node7" class="node">
<title>leaf_6</title>
<polygon fill="none" stroke="#c0c0c0" points="409.5,-4503.8336 337.5,-4503.8336 337.5,-4467.8336 409.5,-4467.8336 409.5,-4503.8336"/>
<text text-anchor="middle" x="373.5" y="-4482.3336" font-family="Inconsolata" font-size="14.00" fill="#000000">* &#160;Femto</text>
</g>
<!-- header_2&#45;&gt;leaf_6 -->
<g id="edge6" class="edge">
<title>header_2&#45;&gt;leaf_6</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.5,-4539.6649C373.5,-4531.9645 373.5,-4522.8079 373.5,-4514.2502"/>
<polygon fill="#000000" stroke="#000000" points="377.0001,-4514.2468 373.5,-4504.2468 370.0001,-4514.2469 377.0001,-4514.2468"/>
</g>
<!-- raw_7 -->
<g id="node8" class="node">
<title>raw_7</title>
<ellipse fill="none" stroke="#000000" cx="462.5" cy="-4485.8336" rx="27" ry="18"/>
<text text-anchor="middle" x="462.5" y="-4481.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_3&#45;&gt;raw_7 -->
<g id="edge7" class="edge">
<title>prose_3&#45;&gt;raw_7</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M469.2289,-4539.6649C468.2664,-4531.9645 467.1218,-4522.8079 466.0521,-4514.2502"/>
<polygon fill="#000000" stroke="#000000" points="469.5151,-4513.7355 464.8017,-4504.2468 462.5691,-4514.6038 469.5151,-4513.7355"/>
</g>
<!-- raw_9 -->
<g id="node10" class="node">
<title>raw_9</title>
<ellipse fill="none" stroke="#000000" cx="553.5" cy="-4485.8336" rx="27" ry="18"/>
<text text-anchor="middle" x="553.5" y="-4481.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_4&#45;&gt;raw_9 -->
<g id="edge9" class="edge">
<title>prose_4&#45;&gt;raw_9</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-4539.6649C553.5,-4531.9645 553.5,-4522.8079 553.5,-4514.2502"/>
<polygon fill="#000000" stroke="#000000" points="557.0001,-4514.2468 553.5,-4504.2468 550.0001,-4514.2469 557.0001,-4514.2468"/>
</g>
<!-- header_11 -->
<g id="node12" class="node">
<title>header_11</title>
<ellipse fill="none" stroke="#000000" cx="710.5" cy="-4485.8336" rx="54.6851" ry="18"/>
<text text-anchor="middle" x="710.5" y="-4481.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">2 : includes</text>
</g>
<!-- section_5&#45;&gt;header_11 -->
<g id="edge11" class="edge">
<title>section_5&#45;&gt;header_11</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M749.6461,-4540.0358C743.4749,-4531.4912 735.963,-4521.09 729.176,-4511.6926"/>
<polygon fill="#000000" stroke="#000000" points="731.8984,-4509.4842 723.2061,-4503.4266 726.2236,-4513.5826 731.8984,-4509.4842"/>
</g>
<!-- prose_12 -->
<g id="node13" class="node">
<title>prose_12</title>
<ellipse fill="none" stroke="#000000" cx="815.5" cy="-4485.8336" rx="32.4585" ry="18"/>
<text text-anchor="middle" x="815.5" y="-4481.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">prose</text>
</g>
<!-- section_5&#45;&gt;prose_12 -->
<g id="edge12" class="edge">
<title>section_5&#45;&gt;prose_12</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M775.6011,-4540.0358C781.9848,-4531.3636 789.7762,-4520.7791 796.7741,-4511.2725"/>
<polygon fill="#000000" stroke="#000000" points="799.805,-4513.059 802.9145,-4502.9308 794.1676,-4508.9093 799.805,-4513.059"/>
</g>
<!-- codeblock_13 -->
<g id="node14" class="node">
<title>codeblock_13</title>
<ellipse fill="none" stroke="#000000" cx="1078.5" cy="-4485.8336" rx="82.2579" ry="18"/>
<text text-anchor="middle" x="1078.5" y="-4481.6336" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">code block 10&#45;290</text>
</g>
<!-- section_5&#45;&gt;codeblock_13 -->
<g id="edge13" class="edge">
<title>section_5&#45;&gt;codeblock_13</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M813.2709,-4546.2655C867.0359,-4534.0152 952.1664,-4514.6184 1011.4266,-4501.1161"/>
<polygon fill="#000000" stroke="#000000" points="1012.4681,-4504.4686 1021.4406,-4498.8344 1010.913,-4497.6435 1012.4681,-4504.4686"/>
</g>
<!-- leaf_8 -->
<g id="node9" class="node">
<title>leaf_8</title>
<polygon fill="none" stroke="#c0c0c0" points="443,-2287.8179 0,-2287.8179 0,-2216.0156 443,-2216.0156 443,-2287.8179"/>
<text text-anchor="middle" x="221.5" y="-2224.4168" font-family="Inconsolata" font-size="14.00" fill="#000000">I just got orb stood up in the pylon bootloader distribution.</text>
</g>
<!-- raw_7&#45;&gt;leaf_8 -->
<g id="edge8" class="edge">
<title>raw_7&#45;&gt;leaf_8</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M458.8166,-4467.8914C456.7554,-4457.4107 454.2554,-4443.9107 452.5,-4431.8336 328.4303,-3578.258 242.9877,-2527.4594 225.0221,-2297.6721"/>
<polygon fill="#000000" stroke="#000000" points="228.5085,-2297.3602 224.2417,-2287.6626 221.5297,-2297.9044 228.5085,-2297.3602"/>
</g>
<!-- leaf_10 -->
<g id="node11" class="node">
<title>leaf_10</title>
<polygon fill="none" stroke="#c0c0c0" points="645.5,-2271.8189 461.5,-2271.8189 461.5,-2232.0147 645.5,-2232.0147 645.5,-2271.8189"/>
<text text-anchor="middle" x="553.5" y="-2240.4168" font-family="Inconsolata" font-size="14.00" fill="#000000">I am excited about this.</text>
</g>
<!-- raw_9&#45;&gt;leaf_10 -->
<g id="edge10" class="edge">
<title>raw_9&#45;&gt;leaf_10</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-4467.5234C553.5,-4269.8003 553.5,-2532.4327 553.5,-2281.9539"/>
<polygon fill="#000000" stroke="#000000" points="557.0001,-2281.7786 553.5,-2271.7787 550.0001,-2281.7787 557.0001,-2281.7786"/>
</g>
<!-- leaf_14 -->
<g id="node15" class="node">
<title>leaf_14</title>
<polygon fill="none" stroke="#c0c0c0" points="763.5,-2269.9168 663.5,-2269.9168 663.5,-2233.9168 763.5,-2233.9168 763.5,-2269.9168"/>
<text text-anchor="middle" x="713.5" y="-2248.4168" font-family="Inconsolata" font-size="14.00" fill="#000000">** &#160;includes</text>
</g>
<!-- header_11&#45;&gt;leaf_14 -->
<g id="edge14" class="edge">
<title>header_11&#45;&gt;leaf_14</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M710.5246,-4467.5234C710.7907,-4269.3857 713.1331,-2525.1411 713.4618,-2280.3981"/>
<polygon fill="#000000" stroke="#000000" points="716.9619,-2280.1919 713.4755,-2270.1872 709.9619,-2280.1824 716.9619,-2280.1919"/>
</g>
<!-- raw_15 -->
<g id="node16" class="node">
<title>raw_15</title>
<ellipse fill="none" stroke="#000000" cx="813.5" cy="-2251.9168" rx="27" ry="18"/>
<text text-anchor="middle" x="813.5" y="-2247.7168" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">raw</text>
</g>
<!-- prose_12&#45;&gt;raw_15 -->
<g id="edge15" class="edge">
<title>prose_12&#45;&gt;raw_15</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M815.4836,-4467.5234C815.3062,-4269.3857 813.7446,-2525.1411 813.5255,-2280.3981"/>
<polygon fill="#000000" stroke="#000000" points="817.0254,-2280.184 813.5164,-2270.1872 810.0254,-2280.1903 817.0254,-2280.184"/>
</g>
<!-- leaf_17 -->
<g id="node18" class="node">
<title>leaf_17</title>
<polygon fill="none" stroke="#c0c0c0" points="1554,-4431.7503 859,-4431.7503 859,-72.0832 1554,-72.0832 1554,-4431.7503"/>
<text text-anchor="middle" x="1206.5" y="-4416.6336" font-family="Inconsolata" font-size="14.00" fill="#000000">local sql = require &quot;sqlite&quot;</text>
<text text-anchor="middle" x="1206.5" y="-4385.2335" font-family="Inconsolata" font-size="14.00" fill="#000000">local lfs = require &quot;lfs&quot;</text>
<text text-anchor="middle" x="1206.5" y="-4369.8335" font-family="Inconsolata" font-size="14.00" fill="#000000">local ffi = require &quot;ffi&quot;</text>
<text text-anchor="middle" x="1206.5" y="-4338.4335" font-family="Inconsolata" font-size="14.00" fill="#000000">local femto = assert(femto)</text>
<text text-anchor="middle" x="1206.5" y="-4307.0334" font-family="Inconsolata" font-size="14.00" fill="#000000">local uv = require &quot;luv&quot;</text>
<text text-anchor="middle" x="1206.5" y="-4275.6334" font-family="Inconsolata" font-size="14.00" fill="#000000">local L = require &quot;lpeg&quot;</text>
<text text-anchor="middle" x="1206.5" y="-4244.2334" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;**** utils</text>
<text text-anchor="middle" x="1206.5" y="-4228.8333" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45;</text>
<text text-anchor="middle" x="1206.5" y="-4213.4333" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;Copypasta from luvland from here down</text>
<text text-anchor="middle" x="1206.5" y="-4182.0333" font-family="Inconsolata" font-size="14.00" fill="#000000">local usecolors</text>
<text text-anchor="middle" x="1206.5" y="-4166.6333" font-family="Inconsolata" font-size="14.00" fill="#000000">local stdout</text>
<text text-anchor="middle" x="1206.5" y="-4135.2332" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(1) == &quot;tty&quot; then</text>
<text text-anchor="middle" x="1206.5" y="-4119.8332" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;stdout = uv.new_tty(1, false)</text>
<text text-anchor="middle" x="1206.5" y="-4104.4332" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = true</text>
<text text-anchor="middle" x="1206.5" y="-4089.0331" font-family="Inconsolata" font-size="14.00" fill="#000000">else</text>
<text text-anchor="middle" x="1206.5" y="-4073.6331" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;utils.stdout = uv.new_pipe(false)</text>
<text text-anchor="middle" x="1206.5" y="-4058.2331" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.pipe_open(utils.stdout, 1)</text>
<text text-anchor="middle" x="1206.5" y="-4042.833" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;usecolors = false</text>
<text text-anchor="middle" x="1206.5" y="-4027.433" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-3996.033" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Print replacement that goes through libuv. &#160;This is useful on windows</text>
<text text-anchor="middle" x="1206.5" y="-3980.6329" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; to use libuv&#39;s code to translate ansi escape codes to windows API calls.</text>
<text text-anchor="middle" x="1206.5" y="-3965.2329" font-family="Inconsolata" font-size="14.00" fill="#000000">local function print(...)</text>
<text text-anchor="middle" x="1206.5" y="-3949.8329" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1206.5" y="-3934.4328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local arguments = {...}</text>
<text text-anchor="middle" x="1206.5" y="-3919.0328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, n do</text>
<text text-anchor="middle" x="1206.5" y="-3903.6328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;arguments[i] = tostring(arguments[i])</text>
<text text-anchor="middle" x="1206.5" y="-3888.2328" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-3872.8327" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, table.concat(arguments, &quot;\t&quot;) .. &quot;\n&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-3857.4327" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-3826.0327" font-family="Inconsolata" font-size="14.00" fill="#000000">local function write(str)</text>
<text text-anchor="middle" x="1206.5" y="-3810.6326" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.write(stdout, str)</text>
<text text-anchor="middle" x="1206.5" y="-3795.2326" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-3747.8326" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** tty setup</text>
<text text-anchor="middle" x="1206.5" y="-3716.4325" font-family="Inconsolata" font-size="14.00" fill="#000000">if uv.guess_handle(0) ~= &quot;tty&quot; or</text>
<text text-anchor="middle" x="1206.5" y="-3701.0325" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.guess_handle(1) ~= &quot;tty&quot; then</text>
<text text-anchor="middle" x="1206.5" y="-3685.6325" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; Entry point for other consumers!</text>
<text text-anchor="middle" x="1206.5" y="-3670.2324" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;error &quot;stdio must be a tty&quot;</text>
<text text-anchor="middle" x="1206.5" y="-3654.8324" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-3623.4324" font-family="Inconsolata" font-size="14.00" fill="#000000">local stdin = uv.new_tty(0, true)</text>
<text text-anchor="middle" x="1206.5" y="-3592.0323" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; **** colorizer</text>
<text text-anchor="middle" x="1206.5" y="-3560.6323" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; This will be the first thing to go</text>
<text text-anchor="middle" x="1206.5" y="-3529.2323" font-family="Inconsolata" font-size="14.00" fill="#000000">local colors = {</text>
<text text-anchor="middle" x="1206.5" y="-3513.8323" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;black &#160;&#160;= &quot;0;30&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3498.4322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;red &#160;&#160;&#160;&#160;= &quot;0;31&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3483.0322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;green &#160;&#160;= &quot;0;32&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3467.6322" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;yellow &#160;= &quot;0;33&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3452.2321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;blue &#160;&#160;&#160;= &quot;0;34&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3436.8321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;magenta = &quot;0;35&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3421.4321" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;cyan &#160;&#160;&#160;= &quot;0;36&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3406.032" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;white &#160;&#160;= &quot;0;37&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3390.632" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;B &#160;&#160;&#160;&#160;&#160;&#160;&#160;= &quot;1;&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3375.232" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bblack &#160;&#160;= &quot;1;30&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3359.8319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bred &#160;&#160;&#160;&#160;= &quot;1;31&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3344.4319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bgreen &#160;&#160;= &quot;1;32&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3329.0319" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Byellow &#160;= &quot;1;33&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3313.6318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bblue &#160;&#160;&#160;= &quot;1;34&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3298.2318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bmagenta = &quot;1;35&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3282.8318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bcyan &#160;&#160;&#160;= &quot;1;36&quot;,</text>
<text text-anchor="middle" x="1206.5" y="-3267.4318" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;Bwhite &#160;&#160;= &quot;1;37&quot;</text>
<text text-anchor="middle" x="1206.5" y="-3252.0317" font-family="Inconsolata" font-size="14.00" fill="#000000">}</text>
<text text-anchor="middle" x="1206.5" y="-3220.6317" font-family="Inconsolata" font-size="14.00" fill="#000000">local function color(color_name)</text>
<text text-anchor="middle" x="1206.5" y="-3205.2317" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if usecolors then</text>
<text text-anchor="middle" x="1206.5" y="-3189.8316" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;\27[&quot; .. (colors[color_name] or &quot;0&quot;) .. &quot;m&quot;</text>
<text text-anchor="middle" x="1206.5" y="-3174.4316" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1206.5" y="-3159.0316" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &quot;&quot;</text>
<text text-anchor="middle" x="1206.5" y="-3143.6315" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-3128.2315" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-3096.8315" font-family="Inconsolata" font-size="14.00" fill="#000000">local function colorize(color_name, string, reset_name)</text>
<text text-anchor="middle" x="1206.5" y="-3081.4314" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return color(color_name) .. tostring(string) .. color(reset_name)</text>
<text text-anchor="middle" x="1206.5" y="-3066.0314" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-3034.6314" font-family="Inconsolata" font-size="14.00" fill="#000000">local backslash, null, newline, carriage, tab, quote, quote2, obracket, cbracket</text>
<text text-anchor="middle" x="1206.5" y="-3003.2313" font-family="Inconsolata" font-size="14.00" fill="#000000">local function loadColors(n)</text>
<text text-anchor="middle" x="1206.5" y="-2987.8313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if n ~= nil then usecolors = n end</text>
<text text-anchor="middle" x="1206.5" y="-2972.4313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;backslash = colorize(&quot;Bgreen&quot;, &quot;\\\\&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2957.0313" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;null &#160;&#160;&#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &quot;\\0&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2941.6312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;newline &#160;&#160;= colorize(&quot;Bgreen&quot;, &quot;\\n&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2926.2312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;carriage &#160;= colorize(&quot;Bgreen&quot;, &quot;\\r&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2910.8312" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;tab &#160;&#160;&#160;&#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &quot;\\t&quot;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2895.4311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;quote &#160;&#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &#39;&quot;&#39;, &quot;green&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2880.0311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;quote2 &#160;&#160;&#160;= colorize(&quot;Bgreen&quot;, &#39;&quot;&#39;)</text>
<text text-anchor="middle" x="1206.5" y="-2864.6311" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;obracket &#160;= colorize(&quot;B&quot;, &#39;[&#39;)</text>
<text text-anchor="middle" x="1206.5" y="-2849.231" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;cbracket &#160;= colorize(&quot;B&quot;, &#39;]&#39;)</text>
<text text-anchor="middle" x="1206.5" y="-2833.831" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-2802.431" font-family="Inconsolata" font-size="14.00" fill="#000000">loadColors()</text>
<text text-anchor="middle" x="1206.5" y="-2771.0309" font-family="Inconsolata" font-size="14.00" fill="#000000">local gsub = string.gsub</text>
<text text-anchor="middle" x="1206.5" y="-2739.6309" font-family="Inconsolata" font-size="14.00" fill="#000000">local function dump(o, depth)</text>
<text text-anchor="middle" x="1206.5" y="-2724.2309" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local t = type(o)</text>
<text text-anchor="middle" x="1206.5" y="-2708.8308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;string&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2693.4308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return quote .. o:gsub(&quot;\\&quot;, backslash)</text>
<text text-anchor="middle" x="1206.5" y="-2678.0308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;%z&quot;, null)</text>
<text text-anchor="middle" x="1206.5" y="-2662.6308" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;\n&quot;, newline)</text>
<text text-anchor="middle" x="1206.5" y="-2647.2307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;\r&quot;, carriage)</text>
<text text-anchor="middle" x="1206.5" y="-2631.8307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;:gsub(&quot;\t&quot;, tab) .. quote2</text>
<text text-anchor="middle" x="1206.5" y="-2616.4307" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2601.0306" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;nil&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2585.6306" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;Bblack&quot;, &quot;nil&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-2570.2306" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2554.8305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;boolean&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2539.4305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;yellow&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2524.0305" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2508.6304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;number&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2493.2304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;blue&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2477.8304" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2462.4303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;userdata&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2447.0303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;magenta&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2431.6303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2416.2303" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;thread&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2400.8302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;Bred&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2385.4302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2370.0302" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;function&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2354.6301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;cyan&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2339.2301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2323.8301" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;cdata&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2308.43" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return colorize(&quot;Bmagenta&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2293.03" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2277.63" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if t == &#39;table&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2262.2299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if type(depth) == &#39;nil&#39; then</text>
<text text-anchor="middle" x="1206.5" y="-2246.8299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;depth = 0</text>
<text text-anchor="middle" x="1206.5" y="-2231.4299" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2216.0298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if depth &gt; 1 then</text>
<text text-anchor="middle" x="1206.5" y="-2200.6298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return colorize(&quot;yellow&quot;, tostring(o))</text>
<text text-anchor="middle" x="1206.5" y="-2185.2298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2169.8298" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local indent = (&quot; &#160;&quot;):rep(depth)</text>
<text text-anchor="middle" x="1206.5" y="-2154.4297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#45;&#45; Check to see if this is an array</text>
<text text-anchor="middle" x="1206.5" y="-2139.0297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local is_array = true</text>
<text text-anchor="middle" x="1206.5" y="-2123.6297" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local i = 1</text>
<text text-anchor="middle" x="1206.5" y="-2108.2296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for k,v in pairs(o) do</text>
<text text-anchor="middle" x="1206.5" y="-2092.8296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if not (k == i) then</text>
<text text-anchor="middle" x="1206.5" y="-2077.4296" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;is_array = false</text>
<text text-anchor="middle" x="1206.5" y="-2062.0295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-2046.6295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;i = i + 1</text>
<text text-anchor="middle" x="1206.5" y="-2031.2295" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1999.8294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local first = true</text>
<text text-anchor="middle" x="1206.5" y="-1984.4294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local lines = {}</text>
<text text-anchor="middle" x="1206.5" y="-1969.0294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;i = 1</text>
<text text-anchor="middle" x="1206.5" y="-1953.6294" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local estimated = 0</text>
<text text-anchor="middle" x="1206.5" y="-1938.2293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;for k,v in (is_array and ipairs or pairs)(o) do</text>
<text text-anchor="middle" x="1206.5" y="-1922.8293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;local s</text>
<text text-anchor="middle" x="1206.5" y="-1907.4293" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if is_array then</text>
<text text-anchor="middle" x="1206.5" y="-1892.0292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;s = &quot;&quot;</text>
<text text-anchor="middle" x="1206.5" y="-1876.6292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1206.5" y="-1861.2292" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;if type(k) == &quot;string&quot; and k:find(&quot;^[%a_][%a%d_]*$&quot;) then</text>
<text text-anchor="middle" x="1206.5" y="-1845.8291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s = k .. &#39; = &#39;</text>
<text text-anchor="middle" x="1206.5" y="-1830.4291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1206.5" y="-1815.0291" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s = &#39;[&#39; .. dump(k, 100) .. &#39;] = &#39;</text>
<text text-anchor="middle" x="1206.5" y="-1799.629" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1784.229" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1768.829" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;s = s .. dump(v, depth + 1)</text>
<text text-anchor="middle" x="1206.5" y="-1753.4289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;lines[i] = s</text>
<text text-anchor="middle" x="1206.5" y="-1738.0289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;estimated = estimated + #s</text>
<text text-anchor="middle" x="1206.5" y="-1722.6289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;i = i + 1</text>
<text text-anchor="middle" x="1206.5" y="-1707.2289" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1691.8288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if estimated &gt; 200 then</text>
<text text-anchor="middle" x="1206.5" y="-1676.4288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &quot;{\n &#160;&quot; .. indent .. table.concat(lines, &quot;,\n &#160;&quot; .. indent) .. &quot;\n&quot; .. indent .. &quot;}&quot;</text>
<text text-anchor="middle" x="1206.5" y="-1661.0288" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1206.5" y="-1645.6287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &quot;{ &quot; .. table.concat(lines, &quot;, &quot;) .. &quot; }&quot;</text>
<text text-anchor="middle" x="1206.5" y="-1630.2287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1614.8287" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1599.4286" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#45;&#45; This doesn&#39;t happen right?</text>
<text text-anchor="middle" x="1206.5" y="-1584.0286" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return tostring(o)</text>
<text text-anchor="middle" x="1206.5" y="-1568.6286" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-1537.2285" font-family="Inconsolata" font-size="14.00" fill="#000000">local c = color</text>
<text text-anchor="middle" x="1206.5" y="-1489.8285" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; &#160;*** utilities</text>
<text text-anchor="middle" x="1206.5" y="-1458.4285" font-family="Inconsolata" font-size="14.00" fill="#000000">local function gatherResults(success, ...)</text>
<text text-anchor="middle" x="1206.5" y="-1443.0284" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local n = select(&#39;#&#39;, ...)</text>
<text text-anchor="middle" x="1206.5" y="-1427.6284" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return success, { n = n, ... }</text>
<text text-anchor="middle" x="1206.5" y="-1412.2284" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-1380.8284" font-family="Inconsolata" font-size="14.00" fill="#000000">local function printResults(results)</text>
<text text-anchor="middle" x="1206.5" y="-1365.4283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;for i = 1, results.n do</text>
<text text-anchor="middle" x="1206.5" y="-1350.0283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;results[i] = dump(results[i])</text>
<text text-anchor="middle" x="1206.5" y="-1334.6283" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1319.2282" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;print(table.concat(results, &#39;\t&#39;))</text>
<text text-anchor="middle" x="1206.5" y="-1303.8282" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-1272.4282" font-family="Inconsolata" font-size="14.00" fill="#000000">local buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1206.5" y="-1241.0281" font-family="Inconsolata" font-size="14.00" fill="#000000">local function evaluateLine(line)</text>
<text text-anchor="middle" x="1206.5" y="-1225.6281" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line == &quot;&lt;3\n&quot; then</text>
<text text-anchor="middle" x="1206.5" y="-1210.2281" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;print(&quot;I &quot; .. c(&quot;Bred&quot;) .. &quot;â™¥&quot; .. c() .. &quot; you too!&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-1193.0879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;return &#39;&gt;&#39;</text>
<text text-anchor="middle" x="1206.5" y="-1177.6879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1162.2879" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local chunk &#160;= buffer .. line</text>
<text text-anchor="middle" x="1206.5" y="-1146.8878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;local f, err = loadstring(&#39;return &#39; .. chunk, &#39;REPL&#39;) &#45;&#45; first we prefix return</text>
<text text-anchor="middle" x="1206.5" y="-1115.4878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if not f then</text>
<text text-anchor="middle" x="1206.5" y="-1100.0878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;f, err = loadstring(chunk, &#39;REPL&#39;) &#45;&#45; try again without return</text>
<text text-anchor="middle" x="1206.5" y="-1084.6878" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-1053.2877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if f then</text>
<text text-anchor="middle" x="1206.5" y="-1037.8877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1206.5" y="-1022.4877" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local success, results = gatherResults(xpcall(f, debug.traceback))</text>
<text text-anchor="middle" x="1206.5" y="-991.0876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if success then</text>
<text text-anchor="middle" x="1206.5" y="-975.6876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; successful call</text>
<text text-anchor="middle" x="1206.5" y="-960.2876" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;if results.n &gt; 0 then</text>
<text text-anchor="middle" x="1206.5" y="-944.8875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;printResults(results)</text>
<text text-anchor="middle" x="1206.5" y="-929.4875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-914.0875" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1206.5" y="-898.6874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; error</text>
<text text-anchor="middle" x="1206.5" y="-883.2874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;print(results[1])</text>
<text text-anchor="middle" x="1206.5" y="-867.8874" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-852.4873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1206.5" y="-821.0873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;if err:match &quot;&#39;&lt;eof&gt;&#39;$&quot; then</text>
<text text-anchor="middle" x="1206.5" y="-805.6873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;&#45;&#45; Lua expects some more input; stow it away for next time</text>
<text text-anchor="middle" x="1206.5" y="-790.2873" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = chunk .. &#39;\n&#39;</text>
<text text-anchor="middle" x="1206.5" y="-774.8872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;return &#39;...&#39;</text>
<text text-anchor="middle" x="1206.5" y="-759.4872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;else</text>
<text text-anchor="middle" x="1206.5" y="-744.0872" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;print(err)</text>
<text text-anchor="middle" x="1206.5" y="-728.6871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;&#160;&#160;buffer = &#39;&#39;</text>
<text text-anchor="middle" x="1206.5" y="-713.2871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;end</text>
<text text-anchor="middle" x="1206.5" y="-697.8871" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-666.487" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;return &#39;ðŸ‘‰ &#39;</text>
<text text-anchor="middle" x="1206.5" y="-642.2583" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-610.8583" font-family="Inconsolata" font-size="14.00" fill="#000000">local function displayPrompt(prompt)</text>
<text text-anchor="middle" x="1206.5" y="-595.4582" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;uv.write(stdout, prompt)</text>
<text text-anchor="middle" x="1206.5" y="-580.0582" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-548.6582" font-family="Inconsolata" font-size="14.00" fill="#000000">local function onread(err, line)</text>
<text text-anchor="middle" x="1206.5" y="-533.2581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if err then error(err) end</text>
<text text-anchor="middle" x="1206.5" y="-517.8581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;if line then</text>
<text text-anchor="middle" x="1206.5" y="-502.4581" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;local prompt = evaluateLine(line)</text>
<text text-anchor="middle" x="1206.5" y="-487.058" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;displayPrompt(prompt)</text>
<text text-anchor="middle" x="1206.5" y="-471.658" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;else</text>
<text text-anchor="middle" x="1206.5" y="-456.258" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#160;uv.close(stdin)</text>
<text text-anchor="middle" x="1206.5" y="-440.8579" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;end</text>
<text text-anchor="middle" x="1206.5" y="-425.4579" font-family="Inconsolata" font-size="14.00" fill="#000000">end</text>
<text text-anchor="middle" x="1206.5" y="-394.0579" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Alternate screen</text>
<text text-anchor="middle" x="1206.5" y="-346.6578" font-family="Inconsolata" font-size="14.00" fill="#000000">coroutine.wrap(function()</text>
<text text-anchor="middle" x="1206.5" y="-331.2578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; This switches screens and does a wipe,</text>
<text text-anchor="middle" x="1206.5" y="-315.8578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;&#45;&#45; then puts the cursor at 1,1.</text>
<text text-anchor="middle" x="1206.5" y="-300.4578" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;write &#39;\27[?47h\27[2J\27[H&#39;</text>
<text text-anchor="middle" x="1206.5" y="-285.0577" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;print &quot;an repl, plz reply uwu ðŸ‘€&quot;</text>
<text text-anchor="middle" x="1206.5" y="-260.829" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;displayPrompt &#39;ðŸ‘‰ &#39;</text>
<text text-anchor="middle" x="1206.5" y="-236.6002" font-family="Inconsolata" font-size="14.00" fill="#000000"> &#160;&#160;uv.read_start(stdin, onread)</text>
<text text-anchor="middle" x="1206.5" y="-221.2002" font-family="Inconsolata" font-size="14.00" fill="#000000">end)()</text>
<text text-anchor="middle" x="1206.5" y="-189.8002" font-family="Inconsolata" font-size="14.00" fill="#000000">uv.run()</text>
<text text-anchor="middle" x="1206.5" y="-158.4001" font-family="Inconsolata" font-size="14.00" fill="#000000">&#45;&#45; Restore</text>
<text text-anchor="middle" x="1206.5" y="-127.0001" font-family="Inconsolata" font-size="14.00" fill="#000000">print &#39;\27[?47l&#39;</text>
<text text-anchor="middle" x="1206.5" y="-95.6001" font-family="Inconsolata" font-size="14.00" fill="#000000">print(&quot;kthxbye&quot;)</text>
<text text-anchor="middle" x="1206.5" y="-80.2" font-family="Inconsolata" font-size="14.00" fill="#000000">return 0</text>
</g>
<!-- codeblock_13&#45;&gt;leaf_17 -->
<g id="edge17" class="edge">
<title>codeblock_13&#45;&gt;leaf_17</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1079.5491,-4467.5234C1079.9333,-4460.8193 1080.4188,-4452.3452 1080.999,-4442.219"/>
<polygon fill="#000000" stroke="#000000" points="1084.5063,-4442.1918 1081.5841,-4432.008 1077.5177,-4441.7913 1084.5063,-4442.1918"/>
</g>
<!-- leaf_16 -->
<g id="node17" class="node">
<title>leaf_16</title>
<polygon fill="none" stroke="#c0c0c0" points="840.5,-36 786.5,-36 786.5,0 840.5,0 840.5,-36"/>
</g>
<!-- raw_15&#45;&gt;leaf_16 -->
<g id="edge16" class="edge">
<title>raw_15&#45;&gt;leaf_16</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M813.5,-2233.6066C813.5,-2035.4689 813.5,-291.2243 813.5,-46.4813"/>
<polygon fill="#000000" stroke="#000000" points="817.0001,-46.2704 813.5,-36.2704 810.0001,-46.2704 817.0001,-46.2704"/>
</g>
</g>
</svg>
